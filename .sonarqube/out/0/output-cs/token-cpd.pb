å9
KD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\BaseCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

abstract 
class 
BaseCollector '
:( )
IPlatformRunnable* ;
{ 
public 
ConcurrentStack 
< 
CollectObject ,
>, -
Results. 5
{6 7
get8 ;
;; <
}= >
=? @
newA D
ConcurrentStackE T
<T U
CollectObjectU b
>b c
(c d
)d e
;e f
public 

RUN_STATUS 
	RunStatus #
{ 	
get 
; 
private 
set 
; 
} 	
public 
abstract 
bool 
CanRunOnPlatform -
(- .
). /
;/ 0
public 
void 
Start 
( 
) 
{ 	
	RunStatus 
= 

RUN_STATUS "
." #
RUNNING# *
;* +
watch   
=   
	Stopwatch   
.   
StartNew   &
(  & '
)  ' (
;  ( )
Log!! 
.!! 
Information!! 
(!! 
Strings!! #
.!!# $
Get!!$ '
(!!' (
$str!!( 2
)!!2 3
,!!3 4
GetType!!5 <
(!!< =
)!!= >
.!!> ?
Name!!? C
)!!C D
;!!D E
}"" 	
public$$ 
void$$ 
Stop$$ 
($$ 
)$$ 
{%% 	
	RunStatus&& 
=&& 

RUN_STATUS&& "
.&&" #
	COMPLETED&&# ,
;&&, -
watch'' 
?'' 
.'' 
Stop'' 
('' 
)'' 
;'' 
TimeSpan(( 
t(( 
=(( 
TimeSpan(( !
.((! "
FromMilliseconds((" 2
(((2 3
watch((3 8
?((8 9
.((9 :
ElapsedMilliseconds((: M
??((N P
$num((Q R
)((R S
;((S T
string)) 
answer)) 
=)) 
string)) "
.))" #
Format))# )
())) *
CultureInfo))* 5
.))5 6
InvariantCulture))6 F
,))F G
$str))H j
,))j k
t**$ %
.**% &
Hours**& +
,**+ ,
t++$ %
.++% &
Minutes++& -
,++- .
t,,$ %
.,,% &
Seconds,,& -
,,,- .
t--$ %
.--% &
Milliseconds--& 2
)--2 3
;--3 4
Log.. 
... 
Information.. 
(.. 
Strings.. #
...# $
Get..$ '
(..' (
$str..( 3
)..3 4
,..4 5
GetType..6 =
(..= >
)..> ?
...? @
Name..@ D
,..D E
answer..F L
)..L M
;..M N
}// 	
public11 
void11 

TryExecute11 
(11 
CancellationToken11 0
?110 1
token112 7
=118 9
null11: >
)11> ?
{22 	
var33 
cancellationToken33 !
=33" #
token33$ )
is33* ,
CancellationToken33- >
cancelToken33? J
?33K L
cancelToken33M X
:33Y Z
GetPlaceholderToken33[ n
(33n o
)33o p
;33p q
Start44 
(44 
)44 
;44 
if55 
(55 
!55 
CanRunOnPlatform55 !
(55! "
)55" #
)55# $
{66 
Log77 
.77 
Warning77 
(77 
Strings77 #
.77# $
Get77$ '
(77' (
$str77( :
)77: ;
,77; <
GetType77= D
(77D E
)77E F
.77F G
ToString77G O
(77O P
)77P Q
)77Q R
;77R S
}88 
else99 
{:: 
try;; 
{<< 
ExecuteInternal== #
(==# $
cancellationToken==$ 5
)==5 6
;==6 7
}>> 
catch?? 
(?? 
	Exception??  
e??! "
)??" #
{@@ 
LogAA 
.AA 
DebugAA 
(AA 
$strAA ;
,AA; <
GetTypeAA= D
(AAD E
)AAE F
,AAF G
eAAH I
.AAI J
GetTypeAAJ Q
(AAQ R
)AAR S
,AAS T
eAAU V
.AAV W
MessageAAW ^
)AA^ _
;AA_ `
}BB 
}CC 
StopDD 
(DD 
)DD 
;DD 
}EE 	
internalGG 
CollectorOptionsGG !
optsGG" &
=GG' (
newGG) ,
CollectorOptionsGG- =
(GG= >
)GG> ?
;GG? @
internalII 
abstractII 
voidII 
ExecuteInternalII .
(II. /
CancellationTokenII/ @
cancellationTokenIIA R
)IIR S
;IIS T
internalKK 
voidKK 
HandleChangeKK "
(KK" #
CollectObjectKK# 0
collectObjectKK1 >
)KK> ?
{LL 	
ifMM 
(MM 
changeHandlerMM 
!=MM  
nullMM! %
)MM% &
{NN 
changeHandlerOO 
(OO 
collectObjectOO +
)OO+ ,
;OO, -
}PP 
elseQQ 
{RR 
ResultsSS 
.SS 
PushSS 
(SS 
collectObjectSS *
)SS* +
;SS+ ,
}TT 
}UU 	
	protectedWW 
BaseCollectorWW 
(WW  
CollectorOptionsWW  0
?WW0 1
optsWW2 6
,WW6 7
ActionWW8 >
<WW> ?
CollectObjectWW? L
>WWL M
?WWM N
changeHandlerWWO \
)WW\ ]
{XX 	
thisYY 
.YY 
optsYY 
=YY 
optsYY 
??YY 
newYY  #
CollectorOptionsYY$ 4
(YY4 5
)YY5 6
;YY6 7
thisZZ 
.ZZ 
changeHandlerZZ 
=ZZ  
changeHandlerZZ! .
;ZZ. /
}[[ 	
private]] 
readonly]] 
Action]] 
<]]  
CollectObject]]  -
>]]- .
?]]. /
changeHandler]]0 =
;]]= >
private__ 
	Stopwatch__ 
?__ 
watch__  
;__  !
privateaa 
staticaa 
CancellationTokenaa (
GetPlaceholderTokenaa) <
(aa< =
)aa= >
{bb 	
usingcc 
varcc 
sourcecc 
=cc 
newcc "#
CancellationTokenSourcecc# :
(cc: ;
)cc; <
;cc< =
returndd 
sourcedd 
.dd 
Tokendd 
;dd  
}ee 	
}ff 
}gg é∫
ID:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\BaseCompare.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
BaseCompare 
{ 
public 
BaseCompare 
( 
) 
{ 	
Results 
= 
new  
ConcurrentDictionary .
<. /
(/ 0
RESULT_TYPE0 ;
,; <
CHANGE_TYPE= H
)H I
,I J
ListK O
<O P
CompareResultP ]
>] ^
>^ _
(_ `
)` a
;a b
foreach 
( 
RESULT_TYPE  
?  !
result_type" -
in. 0
Enum1 5
.5 6
	GetValues6 ?
(? @
typeof@ F
(F G
RESULT_TYPEG R
)R S
)S T
)T U
{ 
foreach 
( 
CHANGE_TYPE $
?$ %
change_type& 1
in2 4
Enum5 9
.9 :
	GetValues: C
(C D
typeofD J
(J K
CHANGE_TYPEK V
)V W
)W X
)X Y
{ 
if 
( 
result_type #
is$ &
RESULT_TYPE' 2
r3 4
&&5 7
change_type8 C
isD F
CHANGE_TYPEG R
cS T
)T U
{ 
Results 
[  
(  !
r! "
," #
c$ %
)% &
]& '
=( )
new* -
List. 2
<2 3
CompareResult3 @
>@ A
(A B
)B C
;C D
}   
}!! 
}"" 
}## 	
public%%  
ConcurrentDictionary%% #
<%%# $
(%%$ %
RESULT_TYPE%%% 0
,%%0 1
CHANGE_TYPE%%2 =
)%%= >
,%%> ?
List%%@ D
<%%D E
CompareResult%%E R
>%%R S
>%%S T
Results%%U \
{%%] ^
get%%_ b
;%%b c
}%%d e
public.. 
static.. 
List.. 
<.. 
Diff.. 
>..  
GetDiffs..! )
(..) *
PropertyInfo..* 6
prop..7 ;
,..; <
object..= C
?..C D
added..E J
,..J K
object..L R
?..R S
removed..T [
)..[ \
{// 	
List00 
<00 
Diff00 
>00 
diffsOut00 
=00  !
new00" %
List00& *
<00* +
Diff00+ /
>00/ 0
(000 1
)001 2
;002 3
if11 
(11 
added11 
!=11 
null11 
&&11  
prop11! %
!=11& (
null11) -
)11- .
{22 
diffsOut33 
.33 
Add33 
(33 
new33  
Diff33! %
(33% &
FieldIn33& -
:33- .
prop33/ 3
.333 4
Name334 8
,338 9
AfterIn33: A
:33A B
added33C H
)33H I
)33I J
;33J K
}44 
if55 
(55 
removed55 
!=55 
null55 
&&55  "
prop55# '
!=55( *
null55+ /
)55/ 0
{66 
diffsOut77 
.77 
Add77 
(77 
new77  
Diff77! %
(77% &
FieldIn77& -
:77- .
prop77/ 3
.773 4
Name774 8
,778 9
BeforeIn77: B
:77B C
removed77D K
)77K L
)77L M
;77M N
}88 
return99 
diffsOut99 
;99 
}:: 	
public<< 
void<< 
Compare<< 
(<< 
IEnumerable<< '
<<<' (
CollectObject<<( 5
><<5 6
FirstRunObjects<<7 F
,<<F G
IEnumerable<<H S
<<<S T
CollectObject<<T a
><<a b
SecondRunObjects<<c s
,<<s t
string<<u {
?<<{ |

firstRunId	<<} á
,
<<á à
string
<<â è
secondRunId
<<ê õ
)
<<õ ú
{== 	
if>> 
(>> 

firstRunId>> 
==>> 
null>> "
)>>" #
{?? 
throw@@ 
new@@ !
ArgumentNullException@@ /
(@@/ 0
nameof@@0 6
(@@6 7

firstRunId@@7 A
)@@A B
)@@B C
;@@C D
}AA 
ifBB 
(BB 
secondRunIdBB 
==BB 
nullBB #
)BB# $
{CC 
throwDD 
newDD !
ArgumentNullExceptionDD /
(DD/ 0
nameofDD0 6
(DD6 7
secondRunIdDD7 B
)DDB C
)DDC D
;DDD E
}EE 
varGG !
differentObjectsAddedGG %
=GG& '
FirstRunObjectsGG( 7
.GG7 8
WhereGG8 =
(GG= >
xGG> ?
=>GG@ B
!GGC D
SecondRunObjectsGGD T
.GGT U
AnyGGU X
(GGX Y
yGGY Z
=>GG[ ]
xGG^ _
.GG_ `
IdentityGG` h
==GGi k
yGGl m
.GGm n
IdentityGGn v
&&GGw y
xGGz {
.GG{ |

ResultType	GG| Ü
==
GGá â
y
GGä ã
.
GGã å

ResultType
GGå ñ
)
GGñ ó
)
GGó ò
.
GGò ô
Select
GGô ü
(
GGü †
y
GG† °
=>
GG¢ §
(
GG• ¶
y
GG¶ ß
,
GGß ®

firstRunId
GG© ≥
)
GG≥ ¥
)
GG¥ µ
;
GGµ ∂
varHH #
differentObjectsRemovedHH '
=HH( )
SecondRunObjectsHH* :
.HH: ;
WhereHH; @
(HH@ A
xHHA B
=>HHC E
!HHF G
FirstRunObjectsHHG V
.HHV W
AnyHHW Z
(HHZ [
yHH[ \
=>HH] _
xHH` a
.HHa b
IdentityHHb j
==HHk m
yHHn o
.HHo p
IdentityHHp x
&&HHy {
xHH| }
.HH} ~

ResultType	HH~ à
==
HHâ ã
y
HHå ç
.
HHç é

ResultType
HHé ò
)
HHò ô
)
HHô ö
.
HHö õ
Select
HHõ °
(
HH° ¢
y
HH¢ £
=>
HH§ ¶
(
HHß ®
y
HH® ©
,
HH© ™
secondRunId
HH´ ∂
)
HH∂ ∑
)
HH∑ ∏
;
HH∏ π
varII 
differentObjectsII  
=II! "!
differentObjectsAddedII# 8
.II8 9
UnionII9 >
(II> ?#
differentObjectsRemovedII? V
)IIV W
;IIW X
varKK 
modifiedObjectsKK 
=KK  !
FirstRunObjectsKK" 1
.KK1 2

SelectManyKK2 <
(KK< =
xKK= >
=>KK? A
SecondRunObjectsKKB R
.KKR S
WhereKKS X
(KKX Y
yKKY Z
=>KK[ ]
xKK^ _
.KK_ `
IdentityKK` h
==KKi k
yKKl m
.KKm n
IdentityKKn v
&&KKw y
xKKz {
.KK{ |

ResultType	KK| Ü
==
KKá â
y
KKä ã
.
KKã å

ResultType
KKå ñ
&&
KKó ô
x
KKö õ
.
KKõ ú
RowKey
KKú ¢
!=
KK£ •
y
KK¶ ß
.
KKß ®
RowKey
KK® Æ
)
KKÆ Ø
.
KKØ ∞
SelectLL$ *
(LL* +
zLL+ ,
=>LL- /
(LL0 1
xLL1 2
,LL2 3
zLL4 5
)LL5 6
)LL6 7
)LL7 8
;LL8 9
CompareNN 
(NN 
differentObjectsNN $
,NN$ %
modifiedObjectsNN& 5
,NN5 6

firstRunIdNN7 A
,NNA B
secondRunIdNNC N
)NNN O
;NNO P
}OO 	
publicVV 
voidVV 
CompareVV 
(VV 
stringVV "
?VV" #

firstRunIdVV$ .
,VV. /
stringVV0 6
secondRunIdVV7 B
,VVB C
DatabaseManagerVVD S
databaseManagerVVT c
)VVc d
{WW 	
ifXX 
(XX 

firstRunIdXX 
==XX 
nullXX "
)XX" #
{YY 
ifZZ 
(ZZ 
secondRunIdZZ 
==ZZ  "
nullZZ# '
)ZZ' (
{[[ 
throw\\ 
new\\ !
ArgumentNullException\\ 3
(\\3 4
nameof\\4 :
(\\: ;

firstRunId\\; E
)\\E F
)\\F G
;\\G H
}]] 
}^^ 
if`` 
(`` 
databaseManager`` 
==``  "
null``# '
)``' (
{aa 
throwbb 
newbb !
ArgumentNullExceptionbb /
(bb/ 0
nameofbb0 6
(bb6 7
databaseManagerbb7 F
)bbF G
)bbG H
;bbH I
}cc 
IEnumerableee 
<ee 
(ee 
CollectObjectee &
,ee& '
stringee( .
)ee. /
>ee/ 0
differentObjectsee1 A
;eeA B
IEnumerableff 
<ff 
(ff 
CollectObjectff &
,ff& '
CollectObjectff( 5
)ff5 6
>ff6 7
modifyObjectsff8 E
=ffF G
newffH K
ListffL P
<ffP Q
(ffQ R
CollectObjectffR _
,ff_ `
CollectObjectffa n
)ffn o
>ffo p
(ffp q
)ffq r
;ffr s
ifhh 
(hh 

firstRunIdhh 
==hh 
nullhh "
)hh" #
{ii 
differentObjectsjj  
=jj! "
databaseManagerjj# 2
.jj2 3
GetResultsByRunidjj3 D
(jjD E
secondRunIdjjE P
)jjP Q
.jjQ R
SelectjjR X
(jjX Y
xjjY Z
=>jj[ ]
(jj^ _
xjj_ `
.jj` a
ColObjjja g
,jjg h
xjji j
.jjj k
RunIdjjk p
)jjp q
)jjq r
;jjr s
}kk 
elsell 
{mm 
differentObjectsnn  
=nn! "
databaseManagernn# 2
.nn2 3
GetAllMissingnn3 @
(nn@ A

firstRunIdnnA K
,nnK L
secondRunIdnnM X
)nnX Y
.nnY Z
SelectnnZ `
(nn` a
ynna b
=>nnc e
(nnf g
ynng h
.nnh i
ColObjnni o
,nno p
ynnq r
.nnr s
RunIdnns x
)nnx y
)nny z
;nnz {
modifyObjectsoo 
=oo 
databaseManageroo  /
.oo/ 0
GetModifiedoo0 ;
(oo; <

firstRunIdoo< F
,ooF G
secondRunIdooH S
)ooS T
.ooT U
SelectooU [
(oo[ \
yoo\ ]
=>oo^ `
(ooa b
yoob c
.ooc d
Item1ood i
.ooi j
ColObjooj p
,oop q
yoor s
.oos t
Item2oot y
.ooy z
ColObj	ooz Ä
)
ooÄ Å
)
ooÅ Ç
;
ooÇ É
}pp 
Comparerr 
(rr 
differentObjectsrr $
,rr$ %
modifyObjectsrr& 3
,rr3 4

firstRunIdrr5 ?
,rr? @
secondRunIdrrA L
)rrL M
;rrM N
}ss 	
publicuu 
voiduu 
Compareuu 
(uu 
IEnumerableuu '
<uu' (
(uu( )
CollectObjectuu) 6
,uu6 7
stringuu8 >
)uu> ?
>uu? @
differentObjectsuuA Q
,uuQ R
IEnumerableuuS ^
<uu^ _
(uu_ `
CollectObjectuu` m
,uum n
CollectObjectuuo |
)uu| }
>uu} ~
modifiedObjects	uu é
,
uué è
string
uuê ñ
?
uuñ ó

firstRunId
uuò ¢
,
uu¢ £
string
uu§ ™
secondRunId
uu´ ∂
)
uu∂ ∑
{vv 	
differentObjectsww 
?ww 
.ww 

AsParallelww (
(ww( )
)ww) *
.ww* +
ForAllww+ 1
(ww1 2
	differentww2 ;
=>ww< >
{xx 
varyy 
colObjyy 
=yy 
	differentyy &
.yy& '
Item1yy' ,
;yy, -
varzz 
objzz 
=zz 
newzz 
CompareResultzz +
(zz+ ,
)zz, -
{{{ 
	BaseRunId|| 
=|| 

firstRunId||  *
,||* +
CompareRunId}}  
=}}! "
secondRunId}}# .
,}}. /
}~~ 
;~~ 
if
ÄÄ 
(
ÄÄ 
	different
ÄÄ 
.
ÄÄ 
Item2
ÄÄ #
.
ÄÄ# $
Equals
ÄÄ$ *
(
ÄÄ* +

firstRunId
ÄÄ+ 5
)
ÄÄ5 6
)
ÄÄ6 7
{
ÅÅ 
obj
ÇÇ 
.
ÇÇ 
Base
ÇÇ 
=
ÇÇ 
colObj
ÇÇ %
;
ÇÇ% &
Results
ÉÉ 
[
ÉÉ 
(
ÉÉ 
colObj
ÉÉ #
.
ÉÉ# $

ResultType
ÉÉ$ .
,
ÉÉ. /
CHANGE_TYPE
ÉÉ0 ;
.
ÉÉ; <
DELETED
ÉÉ< C
)
ÉÉC D
]
ÉÉD E
.
ÉÉE F
Add
ÉÉF I
(
ÉÉI J
obj
ÉÉJ M
)
ÉÉM N
;
ÉÉN O
}
ÑÑ 
else
ÖÖ 
if
ÖÖ 
(
ÖÖ 
	different
ÖÖ "
.
ÖÖ" #
Item2
ÖÖ# (
.
ÖÖ( )
Equals
ÖÖ) /
(
ÖÖ/ 0
secondRunId
ÖÖ0 ;
)
ÖÖ; <
)
ÖÖ< =
{
ÜÜ 
obj
áá 
.
áá 
Compare
áá 
=
áá  !
colObj
áá" (
;
áá( )
Results
àà 
[
àà 
(
àà 
colObj
àà #
.
àà# $

ResultType
àà$ .
,
àà. /
CHANGE_TYPE
àà0 ;
.
àà; <
CREATED
àà< C
)
ààC D
]
ààD E
.
ààE F
Add
ààF I
(
ààI J
obj
ààJ M
)
ààM N
;
ààN O
}
ââ 
}
ää 
)
ää 
;
ää 
modifiedObjects
åå 
?
åå 
.
åå 

AsParallel
åå '
(
åå' (
)
åå( )
.
åå) *
ForAll
åå* 0
(
åå0 1
modified
åå1 9
=>
åå: <
{
çç 
var
éé 
compareLogic
éé  
=
éé! "
new
éé# &
CompareLogic
éé' 3
(
éé3 4
)
éé4 5
;
éé5 6
compareLogic
èè 
.
èè 
Config
èè #
.
èè# $#
IgnoreCollectionOrder
èè$ 9
=
èè: ;
true
èè< @
;
èè@ A
var
êê 
first
êê 
=
êê 
modified
êê $
.
êê$ %
Item1
êê% *
;
êê* +
var
ëë 
second
ëë 
=
ëë 
modified
ëë %
.
ëë% &
Item2
ëë& +
;
ëë+ ,
if
ìì 
(
ìì 
first
ìì 
!=
ìì 
null
ìì !
&&
ìì" $
second
ìì% +
!=
ìì, .
null
ìì/ 3
)
ìì3 4
{
îî 
var
ïï 
obj
ïï 
=
ïï 
new
ïï !
CompareResult
ïï" /
(
ïï/ 0
)
ïï0 1
{
ññ 
Base
óó 
=
óó 
first
óó $
,
óó$ %
Compare
òò 
=
òò  !
second
òò" (
,
òò( )
	BaseRunId
ôô !
=
ôô" #

firstRunId
ôô$ .
,
ôô. /
CompareRunId
öö $
=
öö% &
secondRunId
öö' 2
}
õõ 
;
õõ 
var
ùù 

properties
ùù "
=
ùù# $
first
ùù% *
.
ùù* +
GetType
ùù+ 2
(
ùù2 3
)
ùù3 4
.
ùù4 5
GetProperties
ùù5 B
(
ùùB C
)
ùùC D
;
ùùD E
if
üü 
(
üü 

properties
üü "
is
üü# %
PropertyInfo
üü& 2
[
üü2 3
]
üü3 4
)
üü4 5
{
†† 
foreach
°° 
(
°°  !
var
°°! $
prop
°°% )
in
°°* ,

properties
°°- 7
)
°°7 8
{
¢¢ 
try
££ 
{
§§ 
if
••  "
(
••# $
	Attribute
••$ -
.
••- .
	IsDefined
••. 7
(
••7 8
prop
••8 <
,
••< =
typeof
••> D
(
••D E"
SkipCompareAttribute
••E Y
)
••Y Z
)
••Z [
)
••[ \
{
¶¶  !
continue
ßß$ ,
;
ßß, -
}
®®  !
List
©©  $
<
©©$ %
Diff
©©% )
>
©©) *
diffs
©©+ 0
;
©©0 1
object
™™  &
?
™™& '
added
™™( -
=
™™. /
null
™™0 4
;
™™4 5
object
´´  &
?
´´& '
removed
´´( /
=
´´0 1
null
´´2 6
;
´´6 7
object
≠≠  &
?
≠≠& '
	firstProp
≠≠( 1
=
≠≠2 3
prop
≠≠4 8
.
≠≠8 9
GetValue
≠≠9 A
(
≠≠A B
first
≠≠B G
)
≠≠G H
;
≠≠H I
object
ÆÆ  &
?
ÆÆ& '

secondProp
ÆÆ( 2
=
ÆÆ3 4
prop
ÆÆ5 9
.
ÆÆ9 :
GetValue
ÆÆ: B
(
ÆÆB C
second
ÆÆC I
)
ÆÆI J
;
ÆÆJ K
if
ØØ  "
(
ØØ# $
	firstProp
ØØ$ -
==
ØØ. 0
null
ØØ1 5
&&
ØØ6 8

secondProp
ØØ9 C
==
ØØD F
null
ØØG K
)
ØØK L
{
∞∞  !
continue
±±$ ,
;
±±, -
}
≤≤  !
else
≥≥  $
if
≥≥% '
(
≥≥( )
	firstProp
≥≥) 2
==
≥≥3 5
null
≥≥6 :
&&
≥≥; =

secondProp
≥≥> H
!=
≥≥I K
null
≥≥L P
)
≥≥P Q
{
¥¥  !
added
µµ$ )
=
µµ* +
prop
µµ, 0
.
µµ0 1
GetValue
µµ1 9
(
µµ9 :
second
µµ: @
)
µµ@ A
;
µµA B
diffs
∂∂$ )
=
∂∂* +
GetDiffs
∂∂, 4
(
∂∂4 5
prop
∂∂5 9
,
∂∂9 :
added
∂∂; @
,
∂∂@ A
null
∂∂B F
)
∂∂F G
;
∂∂G H
}
∑∑  !
else
∏∏  $
if
∏∏% '
(
∏∏( )

secondProp
∏∏) 3
==
∏∏4 6
null
∏∏7 ;
&&
∏∏< >
	firstProp
∏∏? H
!=
∏∏I K
null
∏∏L P
)
∏∏P Q
{
ππ  !
removed
∫∫$ +
=
∫∫, -
prop
∫∫. 2
.
∫∫2 3
GetValue
∫∫3 ;
(
∫∫; <
first
∫∫< A
)
∫∫A B
;
∫∫B C
diffs
ªª$ )
=
ªª* +
GetDiffs
ªª, 4
(
ªª4 5
prop
ªª5 9
,
ªª9 :
null
ªª; ?
,
ªª? @
removed
ªªA H
)
ªªH I
;
ªªI J
}
ºº  !
else
ΩΩ  $
{
ææ  !
var
øø$ '
firstVal
øø( 0
=
øø1 2
prop
øø3 7
.
øø7 8
GetValue
øø8 @
(
øø@ A
first
øøA F
)
øøF G
;
øøG H
var
¿¿$ '
	secondVal
¿¿( 1
=
¿¿2 3
prop
¿¿4 8
.
¿¿8 9
GetValue
¿¿9 A
(
¿¿A B
second
¿¿B H
)
¿¿H I
;
¿¿I J
if
¬¬$ &
(
¬¬' (
firstVal
¬¬( 0
is
¬¬1 3
List
¬¬4 8
<
¬¬8 9
string
¬¬9 ?
>
¬¬? @
&&
¬¬A C
	secondVal
¬¬D M
is
¬¬N P
List
¬¬Q U
<
¬¬U V
string
¬¬V \
>
¬¬\ ]
)
¬¬] ^
{
√√$ %
added
ƒƒ( -
=
ƒƒ. /
(
ƒƒ0 1
(
ƒƒ1 2
List
ƒƒ2 6
<
ƒƒ6 7
string
ƒƒ7 =
>
ƒƒ= >
)
ƒƒ> ?
	secondVal
ƒƒ? H
)
ƒƒH I
.
ƒƒI J
Except
ƒƒJ P
(
ƒƒP Q
(
ƒƒQ R
List
ƒƒR V
<
ƒƒV W
string
ƒƒW ]
>
ƒƒ] ^
)
ƒƒ^ _
firstVal
ƒƒ_ g
)
ƒƒg h
;
ƒƒh i
removed
≈≈( /
=
≈≈0 1
(
≈≈2 3
(
≈≈3 4
List
≈≈4 8
<
≈≈8 9
string
≈≈9 ?
>
≈≈? @
)
≈≈@ A
firstVal
≈≈A I
)
≈≈I J
.
≈≈J K
Except
≈≈K Q
(
≈≈Q R
(
≈≈R S
List
≈≈S W
<
≈≈W X
string
≈≈X ^
>
≈≈^ _
)
≈≈_ `
	secondVal
≈≈` i
)
≈≈i j
;
≈≈j k
if
∆∆( *
(
∆∆+ ,
!
∆∆, -
(
∆∆- .
(
∆∆. /
IEnumerable
∆∆/ :
<
∆∆: ;
string
∆∆; A
>
∆∆A B
)
∆∆B C
added
∆∆C H
)
∆∆H I
.
∆∆I J
Any
∆∆J M
(
∆∆M N
)
∆∆N O
)
∆∆O P
{
««( )
added
»», 1
=
»»2 3
null
»»4 8
;
»»8 9
}
……( )
if
  ( *
(
  + ,
!
  , -
(
  - .
(
  . /
IEnumerable
  / :
<
  : ;
string
  ; A
>
  A B
)
  B C
removed
  C J
)
  J K
.
  K L
Any
  L O
(
  O P
)
  P Q
)
  Q R
{
ÀÀ( )
removed
ÃÃ, 3
=
ÃÃ4 5
null
ÃÃ6 :
;
ÃÃ: ;
}
ÕÕ( )
}
ŒŒ$ %
else
œœ$ (
if
œœ) +
(
œœ, -
firstVal
œœ- 5
is
œœ6 8
List
œœ9 =
<
œœ= >
KeyValuePair
œœ> J
<
œœJ K
string
œœK Q
,
œœQ R
string
œœS Y
>
œœY Z
>
œœZ [
&&
œœ\ ^
	secondVal
œœ_ h
is
œœi k
List
œœl p
<
œœp q
KeyValuePair
œœq }
<
œœ} ~
stringœœ~ Ñ
,œœÑ Ö
stringœœÜ å
>œœå ç
>œœç é
)œœé è
{
––$ %
added
——( -
=
——. /
(
——0 1
(
——1 2
List
——2 6
<
——6 7
KeyValuePair
——7 C
<
——C D
string
——D J
,
——J K
string
——L R
>
——R S
>
——S T
)
——T U
	secondVal
——U ^
)
——^ _
.
——_ `
Except
——` f
(
——f g
(
——g h
List
——h l
<
——l m
KeyValuePair
——m y
<
——y z
string——z Ä
,——Ä Å
string——Ç à
>——à â
>——â ä
)——ä ã
firstVal——ã ì
)——ì î
;——î ï
removed
““( /
=
““0 1
(
““2 3
(
““3 4
List
““4 8
<
““8 9
KeyValuePair
““9 E
<
““E F
string
““F L
,
““L M
string
““N T
>
““T U
>
““U V
)
““V W
firstVal
““W _
)
““_ `
.
““` a
Except
““a g
(
““g h
(
““h i
List
““i m
<
““m n
KeyValuePair
““n z
<
““z {
string““{ Å
,““Å Ç
string““É â
>““â ä
>““ä ã
)““ã å
	secondVal““å ï
)““ï ñ
;““ñ ó
if
””( *
(
””+ ,
!
””, -
(
””- .
(
””. /
IEnumerable
””/ :
<
””: ;
KeyValuePair
””; G
<
””G H
string
””H N
,
””N O
string
””P V
>
””V W
>
””W X
)
””X Y
added
””Y ^
)
””^ _
.
””_ `
Any
””` c
(
””c d
)
””d e
)
””e f
{
‘‘( )
added
’’, 1
=
’’2 3
null
’’4 8
;
’’8 9
}
÷÷( )
if
◊◊( *
(
◊◊+ ,
!
◊◊, -
(
◊◊- .
(
◊◊. /
IEnumerable
◊◊/ :
<
◊◊: ;
KeyValuePair
◊◊; G
<
◊◊G H
string
◊◊H N
,
◊◊N O
string
◊◊P V
>
◊◊V W
>
◊◊W X
)
◊◊X Y
removed
◊◊Y `
)
◊◊` a
.
◊◊a b
Any
◊◊b e
(
◊◊e f
)
◊◊f g
)
◊◊g h
{
ÿÿ( )
removed
ŸŸ, 3
=
ŸŸ4 5
null
ŸŸ6 :
;
ŸŸ: ;
}
⁄⁄( )
}
€€$ %
else
‹‹$ (
if
‹‹) +
(
‹‹, -
firstVal
‹‹- 5
is
‹‹6 8

Dictionary
‹‹9 C
<
‹‹C D
string
‹‹D J
,
‹‹J K
string
‹‹L R
>
‹‹R S
&&
‹‹T V
	secondVal
‹‹W `
is
‹‹a c

Dictionary
‹‹d n
<
‹‹n o
string
‹‹o u
,
‹‹u v
string
‹‹w }
>
‹‹} ~
)
‹‹~ 
{
››$ %
added
ﬁﬁ( -
=
ﬁﬁ. /
(
ﬁﬁ0 1
(
ﬁﬁ1 2

Dictionary
ﬁﬁ2 <
<
ﬁﬁ< =
string
ﬁﬁ= C
,
ﬁﬁC D
string
ﬁﬁE K
>
ﬁﬁK L
)
ﬁﬁL M
	secondVal
ﬁﬁM V
)
ﬁﬁV W
.
ﬂﬂ, -
Except
ﬂﬂ- 3
(
ﬂﬂ3 4
(
ﬂﬂ4 5

Dictionary
ﬂﬂ5 ?
<
ﬂﬂ? @
string
ﬂﬂ@ F
,
ﬂﬂF G
string
ﬂﬂH N
>
ﬂﬂN O
)
ﬂﬂO P
firstVal
ﬂﬂP X
)
ﬂﬂX Y
.
‡‡, -
ToDictionary
‡‡- 9
(
‡‡9 :
x
‡‡: ;
=>
‡‡< >
x
‡‡? @
.
‡‡@ A
Key
‡‡A D
,
‡‡D E
x
‡‡F G
=>
‡‡H J
x
‡‡K L
.
‡‡L M
Value
‡‡M R
)
‡‡R S
;
‡‡S T
removed
‚‚( /
=
‚‚0 1
(
‚‚2 3
(
‚‚3 4

Dictionary
‚‚4 >
<
‚‚> ?
string
‚‚? E
,
‚‚E F
string
‚‚G M
>
‚‚M N
)
‚‚N O
firstVal
‚‚O W
)
‚‚W X
.
„„, -
Except
„„- 3
(
„„3 4
(
„„4 5

Dictionary
„„5 ?
<
„„? @
string
„„@ F
,
„„F G
string
„„H N
>
„„N O
)
„„O P
	secondVal
„„P Y
)
„„Y Z
.
‰‰, -
ToDictionary
‰‰- 9
(
‰‰9 :
x
‰‰: ;
=>
‰‰< >
x
‰‰? @
.
‰‰@ A
Key
‰‰A D
,
‰‰D E
x
‰‰F G
=>
‰‰H J
x
‰‰K L
.
‰‰L M
Value
‰‰M R
)
‰‰R S
;
‰‰S T
if
ÂÂ( *
(
ÂÂ+ ,
!
ÂÂ, -
(
ÂÂ- .
(
ÂÂ. /
IEnumerable
ÂÂ/ :
<
ÂÂ: ;
KeyValuePair
ÂÂ; G
<
ÂÂG H
string
ÂÂH N
,
ÂÂN O
string
ÂÂP V
>
ÂÂV W
>
ÂÂW X
)
ÂÂX Y
added
ÂÂY ^
)
ÂÂ^ _
.
ÂÂ_ `
Any
ÂÂ` c
(
ÂÂc d
)
ÂÂd e
)
ÂÂe f
{
ÊÊ( )
added
ÁÁ, 1
=
ÁÁ2 3
null
ÁÁ4 8
;
ÁÁ8 9
}
ËË( )
if
ÈÈ( *
(
ÈÈ+ ,
!
ÈÈ, -
(
ÈÈ- .
(
ÈÈ. /
IEnumerable
ÈÈ/ :
<
ÈÈ: ;
KeyValuePair
ÈÈ; G
<
ÈÈG H
string
ÈÈH N
,
ÈÈN O
string
ÈÈP V
>
ÈÈV W
>
ÈÈW X
)
ÈÈX Y
removed
ÈÈY `
)
ÈÈ` a
.
ÈÈa b
Any
ÈÈb e
(
ÈÈe f
)
ÈÈf g
)
ÈÈg h
{
ÍÍ( )
removed
ÎÎ, 3
=
ÎÎ4 5
null
ÎÎ6 :
;
ÎÎ: ;
}
ÏÏ( )
}
ÌÌ$ %
else
ÓÓ$ (
if
ÓÓ) +
(
ÓÓ, -
firstVal
ÓÓ- 5
is
ÓÓ6 8

Dictionary
ÓÓ9 C
<
ÓÓC D
string
ÓÓD J
,
ÓÓJ K
List
ÓÓL P
<
ÓÓP Q
string
ÓÓQ W
>
ÓÓW X
>
ÓÓX Y
firstDictionary
ÓÓZ i
&&
ÓÓj l
	secondVal
ÓÓm v
is
ÓÓw y

DictionaryÓÓz Ñ
<ÓÓÑ Ö
stringÓÓÖ ã
,ÓÓã å
ListÓÓç ë
<ÓÓë í
stringÓÓí ò
>ÓÓò ô
>ÓÓô ö 
secondDictionaryÓÓõ ´
)ÓÓ´ ¨
{
ÔÔ$ %
added
( -
=
. /
secondDictionary
0 @
.
ÒÒ, -
Except
ÒÒ- 3
(
ÒÒ3 4
firstDictionary
ÒÒ4 C
)
ÒÒC D
.
ÚÚ, -
ToDictionary
ÚÚ- 9
(
ÚÚ9 :
x
ÚÚ: ;
=>
ÚÚ< >
x
ÚÚ? @
.
ÚÚ@ A
Key
ÚÚA D
,
ÚÚD E
x
ÚÚF G
=>
ÚÚH J
x
ÚÚK L
.
ÚÚL M
Value
ÚÚM R
)
ÚÚR S
;
ÚÚS T
removed
ÙÙ( /
=
ÙÙ0 1
firstDictionary
ÙÙ2 A
.
ıı, -
Except
ıı- 3
(
ıı3 4
secondDictionary
ıı4 D
)
ııD E
.
ˆˆ, -
ToDictionary
ˆˆ- 9
(
ˆˆ9 :
x
ˆˆ: ;
=>
ˆˆ< >
x
ˆˆ? @
.
ˆˆ@ A
Key
ˆˆA D
,
ˆˆD E
x
ˆˆF G
=>
ˆˆH J
x
ˆˆK L
.
ˆˆL M
Value
ˆˆM R
)
ˆˆR S
;
ˆˆS T
if
˜˜( *
(
˜˜+ ,
!
˜˜, -
(
˜˜- .
(
˜˜. /

Dictionary
˜˜/ 9
<
˜˜9 :
string
˜˜: @
,
˜˜@ A
List
˜˜B F
<
˜˜F G
string
˜˜G M
>
˜˜M N
>
˜˜N O
)
˜˜O P
added
˜˜P U
)
˜˜U V
.
˜˜V W
Any
˜˜W Z
(
˜˜Z [
)
˜˜[ \
)
˜˜\ ]
{
¯¯( )
added
˘˘, 1
=
˘˘2 3
null
˘˘4 8
;
˘˘8 9
}
˙˙( )
if
˚˚( *
(
˚˚+ ,
!
˚˚, -
(
˚˚- .
(
˚˚. /

Dictionary
˚˚/ 9
<
˚˚9 :
string
˚˚: @
,
˚˚@ A
List
˚˚B F
<
˚˚F G
string
˚˚G M
>
˚˚M N
>
˚˚N O
)
˚˚O P
removed
˚˚P W
)
˚˚W X
.
˚˚X Y
Any
˚˚Y \
(
˚˚\ ]
)
˚˚] ^
)
˚˚^ _
{
¸¸( )
removed
˝˝, 3
=
˝˝4 5
null
˝˝6 :
;
˝˝: ;
}
˛˛( )
}
ˇˇ$ %
else
ÄÄ$ (
if
ÄÄ) +
(
ÄÄ, -
firstVal
ÄÄ- 5
is
ÄÄ6 8

Dictionary
ÄÄ9 C
<
ÄÄC D
(
ÄÄD E
TpmAlgId
ÄÄE M
,
ÄÄM N
uint
ÄÄO S
)
ÄÄS T
,
ÄÄT U
byte
ÄÄV Z
[
ÄÄZ [
]
ÄÄ[ \
>
ÄÄ\ ]
firstTpmAlgDict
ÄÄ^ m
&&
ÄÄn p
	secondVal
ÄÄq z
is
ÄÄ{ }

DictionaryÄÄ~ à
<ÄÄà â
(ÄÄâ ä
TpmAlgIdÄÄä í
,ÄÄí ì
uintÄÄî ò
)ÄÄò ô
,ÄÄô ö
byteÄÄõ ü
[ÄÄü †
]ÄÄ† °
>ÄÄ° ¢ 
secondTpmAlgDictÄÄ£ ≥
)ÄÄ≥ ¥
{
ÅÅ$ %
added
ÇÇ( -
=
ÇÇ. /
secondTpmAlgDict
ÇÇ0 @
.
ÇÇ@ A
Where
ÇÇA F
(
ÇÇF G
x
ÇÇG H
=>
ÇÇI K
!
ÇÇL M
firstTpmAlgDict
ÇÇM \
.
ÇÇ\ ]
ContainsKey
ÇÇ] h
(
ÇÇh i
x
ÇÇi j
.
ÇÇj k
Key
ÇÇk n
)
ÇÇn o
||
ÇÇp r
!
ÇÇs t
firstTpmAlgDictÇÇt É
[ÇÇÉ Ñ
xÇÇÑ Ö
.ÇÇÖ Ü
KeyÇÇÜ â
]ÇÇâ ä
.ÇÇä ã
SequenceEqualÇÇã ò
(ÇÇò ô
xÇÇô ö
.ÇÇö õ
ValueÇÇõ †
)ÇÇ† °
)ÇÇ° ¢
;ÇÇ¢ £
removed
ÉÉ( /
=
ÉÉ0 1
firstTpmAlgDict
ÉÉ2 A
.
ÉÉA B
Where
ÉÉB G
(
ÉÉG H
x
ÉÉH I
=>
ÉÉJ L
!
ÉÉM N
secondTpmAlgDict
ÉÉN ^
.
ÉÉ^ _
ContainsKey
ÉÉ_ j
(
ÉÉj k
x
ÉÉk l
.
ÉÉl m
Key
ÉÉm p
)
ÉÉp q
||
ÉÉr t
!
ÉÉu v
secondTpmAlgDictÉÉv Ü
[ÉÉÜ á
xÉÉá à
.ÉÉà â
KeyÉÉâ å
]ÉÉå ç
.ÉÉç é
SequenceEqualÉÉé õ
(ÉÉõ ú
xÉÉú ù
.ÉÉù û
ValueÉÉû £
)ÉÉ£ §
)ÉÉ§ •
;ÉÉ• ¶
if
ÖÖ( *
(
ÖÖ+ ,
!
ÖÖ, -
(
ÖÖ- .
(
ÖÖ. /
IEnumerable
ÖÖ/ :
<
ÖÖ: ;
KeyValuePair
ÖÖ; G
<
ÖÖG H
(
ÖÖH I
TpmAlgId
ÖÖI Q
,
ÖÖQ R
uint
ÖÖS W
)
ÖÖW X
,
ÖÖX Y
byte
ÖÖZ ^
[
ÖÖ^ _
]
ÖÖ_ `
>
ÖÖ` a
>
ÖÖa b
)
ÖÖb c
added
ÖÖc h
)
ÖÖh i
.
ÖÖi j
Any
ÖÖj m
(
ÖÖm n
)
ÖÖn o
)
ÖÖo p
{
ÜÜ( )
added
áá, 1
=
áá2 3
null
áá4 8
;
áá8 9
}
àà( )
if
ââ( *
(
ââ+ ,
!
ââ, -
(
ââ- .
(
ââ. /
IEnumerable
ââ/ :
<
ââ: ;
KeyValuePair
ââ; G
<
ââG H
(
ââH I
TpmAlgId
ââI Q
,
ââQ R
uint
ââS W
)
ââW X
,
ââX Y
byte
ââZ ^
[
ââ^ _
]
ââ_ `
>
ââ` a
>
ââa b
)
ââb c
removed
ââc j
)
ââj k
.
ââk l
Any
ââl o
(
ââo p
)
ââp q
)
ââq r
{
ää( )
removed
ãã, 3
=
ãã4 5
null
ãã6 :
;
ãã: ;
}
åå( )
}
çç$ %
else
éé$ (
if
éé) +
(
éé, -
(
éé- .
firstVal
éé. 6
is
éé7 9
string
éé: @
||
ééA C
firstVal
ééD L
is
ééM O
int
ééP S
||
ééT V
firstVal
ééW _
is
éé` b
bool
ééc g
)
éég h
&&
ééi k
(
éél m
	secondVal
éém v
is
ééw y
stringééz Ä
||ééÅ É
	secondValééÑ ç
isééé ê
intééë î
||ééï ó
	secondValééò °
iséé¢ §
booléé• ©
)éé© ™
)éé™ ´
{
èè$ %
if
êê( *
(
êê+ ,
!
êê, -
compareLogic
êê- 9
.
êê9 :
Compare
êê: A
(
êêA B
firstVal
êêB J
,
êêJ K
	secondVal
êêL U
)
êêU V
.
êêV W
AreEqual
êêW _
)
êê_ `
{
ëë( )
obj
íí, /
.
íí/ 0
Diffs
íí0 5
.
íí5 6
Add
íí6 9
(
íí9 :
new
íí: =
Diff
íí> B
(
ííB C
prop
ííC G
.
ííG H
Name
ííH L
,
ííL M
firstVal
ííN V
,
ííV W
	secondVal
ííX a
)
íía b
)
ííb c
;
ííc d
}
ìì( )
}
îî$ %
else
ïï$ (
if
ïï) +
(
ïï, -
	firstProp
ïï- 6
!=
ïï7 9
null
ïï: >
&&
ïï? A

secondProp
ïïB L
!=
ïïM O
null
ïïP T
&&
ïïU W
compareLogic
ïïX d
.
ïïd e
Compare
ïïe l
(
ïïl m
firstVal
ïïm u
,
ïïu v
	secondValïïw Ä
)ïïÄ Å
.ïïÅ Ç
AreEqualïïÇ ä
)ïïä ã
{
ññ$ %
continue
óó( 0
;
óó0 1
}
òò$ %
else
ôô$ (
{
öö$ %
obj
õõ( +
.
õõ+ ,
Diffs
õõ, 1
.
õõ1 2
Add
õõ2 5
(
õõ5 6
new
õõ6 9
Diff
õõ: >
(
õõ> ?
prop
õõ? C
.
õõC D
Name
õõD H
,
õõH I
firstVal
õõJ R
,
õõR S
	secondVal
õõT ]
)
õõ] ^
)
õõ^ _
;
õõ_ `
}
úú$ %
diffs
ûû$ )
=
ûû* +
GetDiffs
ûû, 4
(
ûû4 5
prop
ûû5 9
,
ûû9 :
added
ûû; @
,
ûû@ A
removed
ûûB I
)
ûûI J
;
ûûJ K
}
üü  !
foreach
††  '
(
††( )
var
††) ,
diff
††- 1
in
††2 4
diffs
††5 :
)
††: ;
{
°°  !
obj
¢¢$ '
.
¢¢' (
Diffs
¢¢( -
.
¢¢- .
Add
¢¢. 1
(
¢¢1 2
diff
¢¢2 6
)
¢¢6 7
;
¢¢7 8
}
££  !
}
§§ 
catch
•• !
(
••" #"
InvalidCastException
••# 7
e
••8 9
)
••9 :
{
¶¶ 
Log
ßß  #
.
ßß# $
Debug
ßß$ )
(
ßß) *
e
ßß* +
,
ßß+ ,
$"
ßß- /
$str
ßß/ >
{
ßß> ?
JsonConvert
ßß? J
.
ßßJ K
SerializeObject
ßßK Z
(
ßßZ [
prop
ßß[ _
)
ßß_ `
}
ßß` a
"
ßßa b
)
ßßb c
;
ßßc d
}
®® 
catch
©© !
(
©©" #
	Exception
©©# ,
e
©©- .
)
©©. /
{
™™ 
Log
´´  #
.
´´# $
Debug
´´$ )
(
´´) *
e
´´* +
,
´´+ ,
$str
´´- T
)
´´T U
;
´´U V
}
¨¨ 
}
≠≠ 
}
ÆÆ 
Results
∞∞ 
[
∞∞ 
(
∞∞ 
first
∞∞ "
.
∞∞" #

ResultType
∞∞# -
,
∞∞- .
CHANGE_TYPE
∞∞/ :
.
∞∞: ;
MODIFIED
∞∞; C
)
∞∞C D
]
∞∞D E
.
∞∞E F
Add
∞∞F I
(
∞∞I J
obj
∞∞J M
)
∞∞M N
;
∞∞N O
}
±± 
}
≤≤ 
)
≤≤ 
;
≤≤ 
foreach
¥¥ 
(
¥¥ 
var
¥¥ 
empty
¥¥ 
in
¥¥ !
Results
¥¥" )
.
¥¥) *
Where
¥¥* /
(
¥¥/ 0
x
¥¥0 1
=>
¥¥2 4
x
¥¥5 6
.
¥¥6 7
Value
¥¥7 <
.
¥¥< =
Count
¥¥= B
==
¥¥C E
$num
¥¥F G
)
¥¥G H
)
¥¥H I
{
µµ 
Results
∂∂ 
.
∂∂ 
Remove
∂∂ 
(
∂∂ 
empty
∂∂ $
.
∂∂$ %
Key
∂∂% (
,
∂∂( )
out
∂∂* -
_
∂∂. /
)
∂∂/ 0
;
∂∂0 1
}
∑∑ 
}
∏∏ 	
public
ææ 

RUN_STATUS
ææ 
	IsRunning
ææ #
(
ææ# $
)
ææ$ %
{
øø 	
return
¿¿ 
_running
¿¿ 
;
¿¿ 
}
¡¡ 	
public
∆∆ 
void
∆∆ 
Start
∆∆ 
(
∆∆ 
)
∆∆ 
{
«« 	
_running
»» 
=
»» 

RUN_STATUS
»» !
.
»»! "
RUNNING
»»" )
;
»») *
}
…… 	
public
ŒŒ 
void
ŒŒ 
Stop
ŒŒ 
(
ŒŒ 
)
ŒŒ 
{
œœ 	
_running
–– 
=
–– 

RUN_STATUS
–– !
.
––! "
	COMPLETED
––" +
;
––+ ,
}
—— 	
public
ŸŸ 
bool
ŸŸ 

TryCompare
ŸŸ 
(
ŸŸ 
string
ŸŸ %
?
ŸŸ% &

firstRunId
ŸŸ' 1
,
ŸŸ1 2
string
ŸŸ3 9
secondRunId
ŸŸ: E
,
ŸŸE F
DatabaseManager
ŸŸG V
databaseManager
ŸŸW f
)
ŸŸf g
{
⁄⁄ 	
Start
€€ 
(
€€ 
)
€€ 
;
€€ 
Compare
‹‹ 
(
‹‹ 

firstRunId
‹‹ 
,
‹‹ 
secondRunId
‹‹  +
,
‹‹+ ,
databaseManager
‹‹- <
)
‹‹< =
;
‹‹= >
Stop
›› 
(
›› 
)
›› 
;
›› 
return
ﬁﬁ 
true
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 	
private
·· 

RUN_STATUS
·· 
_running
·· #
=
··$ %

RUN_STATUS
··& 0
.
··0 1
NOT_STARTED
··1 <
;
··< =
}
‚‚ 
}„„ Í
ID:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\BaseMonitor.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

abstract 
class 
BaseMonitor %
:& '
IPlatformRunnable( 9
{ 
public

 
string

 
RunId

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 

RUN_STATUS 
	RunStatus #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
abstract 
bool 
CanRunOnPlatform -
(- .
). /
;/ 0
public 
abstract 
void 
StartRun %
(% &
)& '
;' (
public 
abstract 
void 
StopRun $
($ %
)% &
;& '
} 
} ‰n
RD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\CertificateCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class  
CertificateCollector %
:& '
BaseCollector( 5
{ 
public  
CertificateCollector #
(# $
CollectorOptions$ 4
?4 5
opts6 :
=; <
null= A
,A B
ActionC I
<I J
CollectObjectJ W
>W X
?X Y
changeHandlerZ g
=h i
nullj n
)n o
:p q
baser v
(v w
optsw {
,{ |
changeHandler	} ä
)
ä ã
{
å ç
}
é è
public 
override 
bool 
CanRunOnPlatform -
(- .
). /
{ 	
return 
RuntimeInformation %
.% &
IsOSPlatform& 2
(2 3

OSPlatform3 =
.= >
Windows> E
)E F
||G I
RuntimeInformationJ \
.\ ]
IsOSPlatform] i
(i j

OSPlatformj t
.t u
Linuxu z
)z {
||| ~
RuntimeInformation	 ë
.
ë í
IsOSPlatform
í û
(
û ü

OSPlatform
ü ©
.
© ™
OSX
™ ≠
)
≠ Æ
;
Æ Ø
} 	
internal!! 
override!! 
void!! 
ExecuteInternal!! .
(!!. /
CancellationToken!!/ @
cancellationToken!!A R
)!!R S
{"" 	
if## 
(## 
RuntimeInformation## "
.##" #
IsOSPlatform### /
(##/ 0

OSPlatform##0 :
.##: ;
Windows##; B
)##B C
)##C D
{$$ 
ExecuteWindows%% 
(%% 
cancellationToken%% 0
)%%0 1
;%%1 2
}&& 
else'' 
if'' 
('' 
RuntimeInformation'' '
.''' (
IsOSPlatform''( 4
(''4 5

OSPlatform''5 ?
.''? @
Linux''@ E
)''E F
)''F G
{(( 
ExecuteLinux)) 
()) 
cancellationToken)) .
))). /
;))/ 0
}** 
else++ 
if++ 
(++ 
RuntimeInformation++ '
.++' (
IsOSPlatform++( 4
(++4 5

OSPlatform++5 ?
.++? @
OSX++@ C
)++C D
)++D E
{,, 
ExecuteMacOs-- 
(-- 
cancellationToken-- .
)--. /
;--/ 0
}.. 
}// 	
internal66 
void66 
ExecuteLinux66 "
(66" #
CancellationToken66# 4
cancellationToken665 F
)66F G
{77 	
try88 
{99 
if:: 
(:: !
ExternalCommandRunner:: )
.::) *
RunExternalCommand::* <
(::< =
$str::= A
,::A B
$str::C V
,::V W
out::X [
string::\ b
result::c i
,::i j
out::k n
string::o u
_::v w
)::w x
==::y {
$num::| }
)::} ~
{;; 
foreach<< 
(<< 
var<<  
_line<<! &
in<<' )
result<<* 0
.<<0 1
Split<<1 6
(<<6 7
$char<<7 ;
)<<; <
)<<< =
{== 
if>> 
(>> 
cancellationToken>> -
.>>- .#
IsCancellationRequested>>. E
)>>E F
{>>G H
return>>I O
;>>O P
}>>Q R
Log?? 
.?? 
Debug?? !
(??! "
$str??" '
,??' (
_line??) .
)??. /
;??/ 0
try@@ 
{AA 
usingBB !
X509Certificate2BB" 2
certificateBB3 >
=BB? @
newBBA D
X509Certificate2BBE U
(BBU V
$strBBV g
+BBh i
_lineBBj o
)BBo p
;BBp q
varDD 
objDD  #
=DD$ %
newDD& )
CertificateObjectDD* ;
(DD; <
StoreLocationEE  -
:EE- .
StoreLocationEE/ <
.EE< =
LocalMachineEE= I
.EEI J
ToStringEEJ R
(EER S
)EES T
,EET U
	StoreNameFF  )
:FF) *
	StoreNameFF+ 4
.FF4 5
RootFF5 9
.FF9 :
ToStringFF: B
(FFB C
)FFC D
,FFD E
CertificateGG  +
:GG+ ,
newGG- 0#
SerializableCertificateGG1 H
(GGH I
certificateGGI T
)GGT U
)GGU V
;GGV W
HandleChangeHH (
(HH( )
objHH) ,
)HH, -
;HH- .
}II 
catchJJ 
(JJ 
	ExceptionJJ (
eJJ) *
)JJ* +
{KK 
LogLL 
.LL  
DebugLL  %
(LL% &
$strLL& f
,LLf g
eLLh i
.LLi j
GetTypeLLj q
(LLq r
)LLr s
.LLs t
ToStringLLt |
(LL| }
)LL} ~
,LL~ 
e
LLÄ Å
.
LLÅ Ç
Message
LLÇ â
,
LLâ ä
_line
LLã ê
)
LLê ë
;
LLë í
LogMM 
.MM  
DebugMM  %
(MM% &
$strMM& +
,MM+ ,
eMM- .
.MM. /

StackTraceMM/ 9
)MM9 :
;MM: ;
}NN 
}OO 
}PP 
}QQ 
catchRR 
(RR 
	ExceptionRR 
eRR 
)RR 
{SS 
LogTT 
.TT 
ErrorTT 
(TT 
eTT 
,TT 
$strTT W
)TTW X
;TTX Y
}UU 
}VV 	
internal^^ 
void^^ 
ExecuteMacOs^^ "
(^^" #
CancellationToken^^# 4
cancellationToken^^5 F
)^^F G
{__ 	
try`` 
{aa 
ifbb 
(bb !
ExternalCommandRunnerbb )
.bb) *
RunExternalCommandbb* <
(bb< =
$strbb= G
,bbG H
$str	bbI ô
,
bbô ö
out
bbõ û
string
bbü •
result
bb¶ ¨
,
bb¨ ≠
out
bbÆ ±
string
bb≤ ∏
_
bbπ ∫
)
bb∫ ª
==
bbº æ
$num
bbø ¿
)
bb¿ ¡
{cc 
stringdd 
tmpPathdd "
=dd# $
Pathdd% )
.dd) *
Combinedd* 1
(dd1 2
	Directorydd2 ;
.dd; <
GetCurrentDirectorydd< O
(ddO P
)ddP Q
,ddQ R
$strddS `
)dd` a
;dda b
stringee 
pkPathee !
=ee" #
Pathee$ (
.ee( )
Combineee) 0
(ee0 1
	Directoryee1 :
.ee: ;
GetCurrentDirectoryee; N
(eeN O
)eeO P
,eeP Q
$streeR `
)ee` a
;eea b
Filegg 
.gg 
WriteAllTextgg %
(gg% &
tmpPathgg& -
,gg- .
resultgg/ 5
)gg5 6
;gg6 7
ifhh 
(hh !
ExternalCommandRunnerhh -
.hh- .
RunExternalCommandhh. @
(hh@ A
$strhhA J
,hhJ K
$"hhL N
$strhhN j
{hhj k
pkPathhhk q
}hhq r
$str	hhr ä
{
hhä ã
tmpPath
hhã í
}
hhí ì
"
hhì î
,
hhî ï
out
hhñ ô
string
hhö †
_
hh° ¢
,
hh¢ £
out
hh§ ß
string
hh® Æ
_
hhØ ∞
)
hh∞ ±
==
hh≤ ¥
$num
hhµ ∂
)
hh∂ ∑
{ii &
X509Certificate2Collectionjj 2
xcertjj3 8
=jj9 :
newjj; >&
X509Certificate2Collectionjj? Y
(jjY Z
)jjZ [
;jj[ \
xcertkk 
.kk 
Importkk $
(kk$ %
pkPathkk% +
,kk+ ,
$strkk- 3
,kk3 4
X509KeyStorageFlagskk5 H
.kkH I
DefaultKeySetkkI V
)kkV W
;kkW X
Filemm 
.mm 
Deletemm #
(mm# $
tmpPathmm$ +
)mm+ ,
;mm, -
Filenn 
.nn 
Deletenn #
(nn# $
pkPathnn$ *
)nn* +
;nn+ ,
varpp &
X509Certificate2Enumeratorpp 6
=pp7 8
xcertpp9 >
.pp> ?
GetEnumeratorpp? L
(ppL M
)ppM N
;ppN O
whilerr 
(rr &
X509Certificate2Enumeratorrr 9
.rr9 :
MoveNextrr: B
(rrB C
)rrC D
)rrD E
{ss 
iftt 
(tt  
cancellationTokentt  1
.tt1 2#
IsCancellationRequestedtt2 I
)ttI J
{ttK L
returnttM S
;ttS T
}ttU V
varvv 
certificatevv  +
=vv, -&
X509Certificate2Enumeratorvv. H
.vvH I
CurrentvvI P
;vvP Q
varxx 
objxx  #
=xx$ %
newxx& )
CertificateObjectxx* ;
(xx; <
StoreLocationyy  -
:yy- .
StoreLocationyy/ <
.yy< =
LocalMachineyy= I
.yyI J
ToStringyyJ R
(yyR S
)yyS T
,yyT U
	StoreNamezz  )
:zz) *
	StoreNamezz+ 4
.zz4 5
Rootzz5 9
.zz9 :
ToStringzz: B
(zzB C
)zzC D
,zzD E
Certificate{{  +
:{{+ ,
new{{- 0#
SerializableCertificate{{1 H
({{H I
certificate{{I T
){{T U
){{U V
;{{V W
HandleChange|| (
(||( )
obj||) ,
)||, -
;||- .
}}} 
}~~ 
else 
{
ÄÄ 
Log
ÅÅ 
.
ÅÅ 
Debug
ÅÅ !
(
ÅÅ! "
$str
ÅÅ" N
)
ÅÅN O
;
ÅÅO P
}
ÇÇ 
}
ÉÉ 
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
e
ÖÖ 
)
ÖÖ 
{
ÜÜ 
Log
áá 
.
áá 
Error
áá 
(
áá 
$str
áá U
)
ááU V
;
ááV W
Log
àà 
.
àà 
Debug
àà 
(
àà 
e
àà 
,
àà 
$str
àà -
)
àà- .
;
àà. /
}
ââ 
}
ää 	
internal
èè 
void
èè 
ExecuteWindows
èè $
(
èè$ %
CancellationToken
èè% 6
cancellationToken
èè7 H
)
èèH I
{
êê 	
foreach
ëë 
(
ëë 
StoreLocation
ëë "
storeLocation
ëë# 0
in
ëë1 3
(
ëë4 5
StoreLocation
ëë5 B
[
ëëB C
]
ëëC D
)
ëëD E
Enum
ëëE I
.
ëëI J
	GetValues
ëëJ S
(
ëëS T
typeof
ëëT Z
(
ëëZ [
StoreLocation
ëë[ h
)
ëëh i
)
ëëi j
)
ëëj k
{
íí 
foreach
ìì 
(
ìì 
	StoreName
ìì "
	storeName
ìì# ,
in
ìì- /
(
ìì0 1
	StoreName
ìì1 :
[
ìì: ;
]
ìì; <
)
ìì< =
Enum
ìì= A
.
ììA B
	GetValues
ììB K
(
ììK L
typeof
ììL R
(
ììR S
	StoreName
ììS \
)
ìì\ ]
)
ìì] ^
)
ìì^ _
{
îî 
try
ïï 
{
ññ 
using
óó 
	X509Store
óó '
store
óó( -
=
óó. /
new
óó0 3
	X509Store
óó4 =
(
óó= >
	storeName
óó> G
,
óóG H
storeLocation
óóI V
)
óóV W
;
óóW X
store
òò 
.
òò 
Open
òò "
(
òò" #
	OpenFlags
òò# ,
.
òò, -
ReadOnly
òò- 5
)
òò5 6
;
òò6 7
foreach
öö 
(
öö  !
X509Certificate2
öö! 1
certificate
öö2 =
in
öö> @
store
ööA F
.
ööF G
Certificates
ööG S
)
ööS T
{
õõ 
if
úú 
(
úú  
cancellationToken
úú  1
.
úú1 2%
IsCancellationRequested
úú2 I
)
úúI J
{
úúK L
return
úúM S
;
úúS T
}
úúU V
var
ùù 
obj
ùù  #
=
ùù$ %
new
ùù& )
CertificateObject
ùù* ;
(
ùù; <
StoreLocation
ûû  -
:
ûû- .
storeLocation
ûû/ <
.
ûû< =
ToString
ûû= E
(
ûûE F
)
ûûF G
,
ûûG H
	StoreName
üü  )
:
üü) *
	storeName
üü+ 4
.
üü4 5
ToString
üü5 =
(
üü= >
)
üü> ?
,
üü? @
Certificate
††  +
:
††+ ,
new
††- 0%
SerializableCertificate
††1 H
(
††H I
certificate
††I T
)
††T U
)
††U V
;
††V W
HandleChange
°° (
(
°°( )
obj
°°) ,
)
°°, -
;
°°- .
}
¢¢ 
store
££ 
.
££ 
Close
££ #
(
££# $
)
££$ %
;
££% &
}
§§ 
catch
•• 
(
•• $
CryptographicException
•• 1
e
••2 3
)
••3 4
{
¶¶ 
Log
ßß 
.
ßß 
Debug
ßß !
(
ßß! "
e
ßß" #
,
ßß# $
$"
ßß% '
$str
ßß' F
{
ßßF G
storeLocation
ßßG T
}
ßßT U
$str
ßßU V
{
ßßV W
	storeName
ßßW `
}
ßß` a
"
ßßa b
)
ßßb c
;
ßßc d
}
®® 
}
©© 
}
™™ 
}
´´ 	
}
¨¨ 
}≠≠ ¢ç
PD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\ComObjectCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
ComObjectCollector #
:$ %
BaseCollector& 3
{ 
public 
ComObjectCollector !
(! "
CollectorOptions" 2
?2 3
opts4 8
=9 :
null; ?
,? @
ActionA G
<G H
CollectObjectH U
>U V
?V W
changeHandlerX e
=f g
nullh l
)l m
:n o
basep t
(t u
optsu y
,y z
changeHandler	{ à
)
à â
{ 	
} 	
public 
static 
IEnumerable !
<! "
CollectObject" /
>/ 0
ParseComObjects1 @
(@ A
RegistryKeyA L
	SearchKeyM V
,V W
RegistryViewX d
Viewe i
,i j
boolk o
SingleThreadedp ~
=	 Ä
false
Å Ü
)
Ü á
{ 	
if 
( 
! 
RuntimeInformation #
.# $
IsOSPlatform$ 0
(0 1

OSPlatform1 ;
.; <
Windows< C
)C D
)D E
{F G
returnH N
newO R
ListS W
<W X
CollectObjectX e
>e f
(f g
)g h
;h i
}j k
if   
(   
	SearchKey   
==   
null   !
)  ! "
{  # $
return  % +
new  , /
List  0 4
<  4 5
CollectObject  5 B
>  B C
(  C D
)  D E
;  E F
}  G H
List!! 
<!! 
	ComObject!! 
>!! 

comObjects!! &
=!!' (
new!!) ,
List!!- 1
<!!1 2
	ComObject!!2 ;
>!!; <
(!!< =
)!!= >
;!!> ?
var"" 
fsc"" 
="" 
new"" 
FileSystemCollector"" -
(""- .
new"". 1
CollectorOptions""2 B
(""B C
)""C D
{""E F
SingleThread""G S
=""T U
SingleThreaded""V d
}""e f
)""f g
;""g h
Action## 
<## 
string## 
>## 
ParseComObjectsIn## ,
=##- .

SubKeyName##/ 9
=>##: <
{$$ 
try%% 
{&& 
RegistryKey'' 

CurrentKey''  *
=''+ ,
	SearchKey''- 6
.''6 7

OpenSubKey''7 A
(''A B

SubKeyName''B L
)''L M
;''M N
var)) 
RegObj)) 
=))  
RegistryWalker))! /
.))/ 0'
RegistryKeyToRegistryObject))0 K
())K L

CurrentKey))L V
,))V W
View))X \
)))\ ]
;))] ^
if++ 
(++ 
RegObj++ 
!=++ !
null++" &
)++& '
{,, 
	ComObject-- !
	comObject--" +
=--, -
new--. 1
	ComObject--2 ;
(--; <
RegObj--< B
)--B C
;--C D
foreach// 
(//  !
string//! '

ComDetails//( 2
in//3 5

CurrentKey//6 @
.//@ A
GetSubKeyNames//A O
(//O P
)//P Q
)//Q R
{00 
if11 
(11  

ComDetails11  *
.11* +
Contains11+ 3
(113 4
$str114 D
)11D E
)11E F
{22 
var33  #
ComKey33$ *
=33+ ,

CurrentKey33- 7
.337 8

OpenSubKey338 B
(33B C

ComDetails33C M
)33M N
;33N O
var44  #
obj44$ '
=44( )
RegistryWalker44* 8
.448 9'
RegistryKeyToRegistryObject449 T
(44T U
ComKey44U [
,44[ \
View44] a
)44a b
;44b c
string55  &
?55& '
BinaryPath3255( 4
=555 6
null557 ;
;55; <
if77  "
(77# $
obj77$ '
!=77( *
null77+ /
&&770 2
obj773 6
.776 7
Values777 =
?77= >
.77> ?
TryGetValue77? J
(77J K
$str77K M
,77M N
out77O R
BinaryPath3277S _
)77_ `
is77a c
bool77d h

successful77i s
)77s t
{88  !
if99$ &
(99' (

successful99( 2
&&993 5
BinaryPath32996 B
!=99C E
null99F J
)99J K
{::$ %
BinaryPath32==( 4
===5 6
BinaryPath32==7 C
.==C D
Trim==D H
(==H I
)==I J
;==J K
if??( *
(??+ ,
BinaryPath32??, 8
.??8 9

StartsWith??9 C
(??C D
$str??D H
)??H I
&&??J L
BinaryPath32??M Y
.??Y Z
EndsWith??Z b
(??b c
$str??c g
)??g h
)??h i
{@@( )
BinaryPath32AA, 8
=AA9 :
BinaryPath32AA; G
.AAG H
AsSpanAAH N
(AAN O
)AAO P
.AAP Q
SliceAAQ V
(AAV W
$numAAW X
,AAX Y
BinaryPath32AAZ f
.AAf g
LengthAAg m
-AAn o
$numAAp q
)AAq r
.AAr s
ToStringAAs {
(AA{ |
)AA| }
;AA} ~
}BB( )
ifDD( *
(DD+ ,
!DD, -
BinaryPath32DD- 9
.DD9 :
ContainsDD: B
(DDB C
$strDDC G
)DDG H
&&DDI K
!DDL M
BinaryPath32DDM Y
.DDY Z
ContainsDDZ b
(DDb c
$strDDc f
)DDf g
)DDg h
{EE( )
BinaryPath32FF, 8
=FF9 :
PathFF; ?
.FF? @
CombineFF@ G
(FFG H
EnvironmentFFH S
.FFS T
SystemDirectoryFFT c
,FFc d
BinaryPath32FFe q
.FFq r
TrimFFr v
(FFv w
)FFw x
)FFx y
;FFy z
}GG( )
	comObjectII( 1
.II1 2

x86_BinaryII2 <
=II= >
fscII? B
.IIB C&
FilePathToFileSystemObjectIIC ]
(II] ^
BinaryPath32II^ j
.IIj k
TrimIIk o
(IIo p
)IIp q
)IIq r
;IIr s
}JJ$ %
}KK  !
}LL 
ifMM 
(MM  

ComDetailsMM  *
.MM* +
ContainsMM+ 3
(MM3 4
$strMM4 D
)MMD E
)MME F
{NN 
varOO  #
ComKeyOO$ *
=OO+ ,

CurrentKeyOO- 7
.OO7 8

OpenSubKeyOO8 B
(OOB C

ComDetailsOOC M
)OOM N
;OON O
varPP  #
objPP$ '
=PP( )
RegistryWalkerPP* 8
.PP8 9'
RegistryKeyToRegistryObjectPP9 T
(PPT U
ComKeyPPU [
,PP[ \
ViewPP] a
)PPa b
;PPb c
stringQQ  &
?QQ& '
BinaryPath64QQ( 4
=QQ5 6
nullQQ7 ;
;QQ; <
ifSS  "
(SS# $
objSS$ '
!=SS( *
nullSS+ /
&&SS0 2
objSS3 6
.SS6 7
ValuesSS7 =
?SS= >
.SS> ?
TryGetValueSS? J
(SSJ K
$strSSK M
,SSM N
outSSO R
BinaryPath64SSS _
)SS_ `
isSSa c
boolSSd h

successfulSSi s
)SSs t
{TT  !
ifUU$ &
(UU' (

successfulUU( 2
&&UU3 5
BinaryPath64UU6 B
!=UUC E
nullUUF J
)UUJ K
{VV$ %
BinaryPath64YY( 4
=YY5 6
BinaryPath64YY7 C
.YYC D
TrimYYD H
(YYH I
)YYI J
;YYJ K
if[[( *
([[+ ,
BinaryPath64[[, 8
.[[8 9

StartsWith[[9 C
([[C D
$str[[D H
)[[H I
&&[[J L
BinaryPath64[[M Y
.[[Y Z
EndsWith[[Z b
([[b c
$str[[c g
)[[g h
)[[h i
{\\( )
BinaryPath64]], 8
=]]9 :
BinaryPath64]]; G
.]]G H
AsSpan]]H N
(]]N O
)]]O P
.]]P Q
Slice]]Q V
(]]V W
$num]]W X
,]]X Y
BinaryPath64]]Z f
.]]f g
Length]]g m
-]]n o
$num]]p q
)]]q r
.]]r s
ToString]]s {
(]]{ |
)]]| }
;]]} ~
}^^( )
if``( *
(``+ ,
!``, -
BinaryPath64``- 9
.``9 :
Contains``: B
(``B C
$str``C G
)``G H
&&``I K
!``L M
BinaryPath64``M Y
.``Y Z
Contains``Z b
(``b c
$str``c f
)``f g
)``g h
{aa( )
BinaryPath64bb, 8
=bb9 :
Pathbb; ?
.bb? @
Combinebb@ G
(bbG H
EnvironmentbbH S
.bbS T
SystemDirectorybbT c
,bbc d
BinaryPath64bbe q
.bbq r
Trimbbr v
(bbv w
)bbw x
)bbx y
;bby z
}cc( )
	comObjectee( 1
.ee1 2

x64_Binaryee2 <
=ee= >
fscee? B
.eeB C&
FilePathToFileSystemObjecteeC ]
(ee] ^
BinaryPath64ee^ j
.eej k
Trimeek o
(eeo p
)eep q
)eeq r
;eer s
}ff$ %
}gg  !
}hh 
}ii 

comObjectskk "
.kk" #
Addkk# &
(kk& '
	comObjectkk' 0
)kk0 1
;kk1 2
}ll 
}mm 
catchnn 
(nn 
	Exceptionnn  
enn! "
)nn" #
whennn$ (
(nn) *
eoo 
isoo 
Systemoo 
.oo  
Securityoo  (
.oo( )
SecurityExceptionoo) :
||pp 
epp 
ispp #
ObjectDisposedExceptionpp 3
||qq 
eqq 
isqq '
UnauthorizedAccessExceptionqq 7
||rr 
err 
isrr 
IOExceptionrr '
)rr' (
{ss 
Logtt 
.tt 
Debugtt 
(tt 
$"tt  
$strtt  /
{tt/ 0

SubKeyNamett0 :
}tt: ;
"tt; <
)tt< =
;tt= >
}uu 
}vv 
;vv 
tryxx 
{yy 
ifzz 
(zz 
SingleThreadedzz "
)zz" #
{{{ 
foreach|| 
(|| 
var||  
subKey||! '
in||( *
	SearchKey||+ 4
.||4 5
GetSubKeyNames||5 C
(||C D
)||D E
)||E F
{}} 
ParseComObjectsIn~~ )
(~~) *
subKey~~* 0
)~~0 1
;~~1 2
} 
}
ÄÄ 
else
ÅÅ 
{
ÇÇ 
	SearchKey
ÉÉ 
.
ÉÉ 
GetSubKeyNames
ÉÉ ,
(
ÉÉ, -
)
ÉÉ- .
.
ÉÉ. /

AsParallel
ÉÉ/ 9
(
ÉÉ9 :
)
ÉÉ: ;
.
ÉÉ; <
ForAll
ÉÉ< B
(
ÉÉB C
subKey
ÉÉC I
=>
ÉÉJ L
ParseComObjectsIn
ÉÉM ^
(
ÉÉ^ _
subKey
ÉÉ_ e
)
ÉÉe f
)
ÉÉf g
;
ÉÉg h
}
ÑÑ 
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
e
ÜÜ 
)
ÜÜ 
{
áá 
Log
àà 
.
àà 
Debug
àà 
(
àà 
$str
àà ?
,
àà? @
	SearchKey
ààA J
.
ààJ K
Name
ààK O
,
ààO P
e
ààQ R
.
ààR S
GetType
ààS Z
(
ààZ [
)
àà[ \
)
àà\ ]
;
àà] ^
}
ââ 
return
ãã 

comObjects
ãã 
;
ãã 
}
åå 	
public
íí 
override
íí 
bool
íí 
CanRunOnPlatform
íí -
(
íí- .
)
íí. /
{
ìì 	
return
îî  
RuntimeInformation
îî %
.
îî% &
IsOSPlatform
îî& 2
(
îî2 3

OSPlatform
îî3 =
.
îî= >
Windows
îî> E
)
îîE F
;
îîF G
}
ïï 	
internal
õõ 
override
õõ 
void
õõ 
ExecuteInternal
õõ .
(
õõ. /
CancellationToken
õõ/ @
cancellationToken
õõA R
)
õõR S
{
úú 	
if
ùù 
(
ùù  
RuntimeInformation
ùù "
.
ùù" #
IsOSPlatform
ùù# /
(
ùù/ 0

OSPlatform
ùù0 :
.
ùù: ;
Windows
ùù; B
)
ùùB C
)
ùùC D
{
ûû 
	ParseView
üü 
(
üü 
RegistryView
üü &
.
üü& '

Registry64
üü' 1
,
üü1 2
cancellationToken
üü3 D
)
üüD E
;
üüE F
	ParseView
†† 
(
†† 
RegistryView
†† &
.
††& '

Registry32
††' 1
,
††1 2
cancellationToken
††3 D
)
††D E
;
††E F
}
°° 
}
¢¢ 	
internal
§§ 
void
§§ 
	ParseView
§§ 
(
§§  
RegistryView
§§  ,
view
§§- 1
,
§§1 2
CancellationToken
§§3 D
cancellationToken
§§E V
)
§§V W
{
•• 	
try
¶¶ 
{
ßß 
using
©© 
var
©© 
	SearchKey
©© #
=
©©$ %
RegistryKey
©©& 1
.
©©1 2
OpenBaseKey
©©2 =
(
©©= >
RegistryHive
©©> J
.
©©J K
LocalMachine
©©K W
,
©©W X
view
©©Y ]
)
©©] ^
;
©©^ _
var
™™ 
CLDIDs
™™ 
=
™™ 
	SearchKey
™™ &
.
™™& '

OpenSubKey
™™' 1
(
™™1 2
$str
™™2 L
)
™™L M
;
™™M N
foreach
´´ 
(
´´ 
var
´´ 
comObj
´´ #
in
´´$ &
ParseComObjects
´´' 6
(
´´6 7
CLDIDs
´´7 =
,
´´= >
view
´´? C
,
´´C D
opts
´´E I
.
´´I J
SingleThread
´´J V
)
´´V W
)
´´W X
{
¨¨ 
if
≠≠ 
(
≠≠ 
cancellationToken
≠≠ )
.
≠≠) *%
IsCancellationRequested
≠≠* A
)
≠≠A B
{
≠≠C D
return
≠≠E K
;
≠≠K L
}
≠≠M N
HandleChange
ÆÆ  
(
ÆÆ  !
comObj
ÆÆ! '
)
ÆÆ' (
;
ÆÆ( )
}
ØØ 
}
∞∞ 
catch
±± 
(
±± 
	Exception
±± 
e
±± 
)
±± 
when
±±  $
(
±±% &
e
≤≤ 
is
≤≤ 
ArgumentException
≤≤ &
||
≥≥ 
e
≥≥ 
is
≥≥ )
UnauthorizedAccessException
≥≥ 3
||
¥¥ 
e
¥¥ 
is
¥¥ 
System
¥¥ 
.
¥¥ 
Security
¥¥ '
.
¥¥' (
SecurityException
¥¥( 9
)
¥¥9 :
{
µµ 
}
∂∂ 
try
∏∏ 
{
ππ 
using
ªª 
var
ªª 
	SearchKey
ªª #
=
ªª$ %
RegistryKey
ªª& 1
.
ªª1 2
OpenBaseKey
ªª2 =
(
ªª= >
RegistryHive
ªª> J
.
ªªJ K
Users
ªªK P
,
ªªP Q
view
ªªR V
)
ªªV W
;
ªªW X
var
ºº 
subkeyNames
ºº 
=
ºº  !
	SearchKey
ºº" +
.
ºº+ ,
GetSubKeyNames
ºº, :
(
ºº: ;
)
ºº; <
;
ºº< =
foreach
ΩΩ 
(
ΩΩ 
string
ΩΩ 

subkeyName
ΩΩ  *
in
ΩΩ+ -
subkeyNames
ΩΩ. 9
)
ΩΩ9 :
{
ææ 
if
øø 
(
øø 
cancellationToken
øø )
.
øø) *%
IsCancellationRequested
øø* A
)
øøA B
{
øøC D
return
øøE K
;
øøK L
}
øøM N
if
¡¡ 
(
¡¡ 

subkeyName
¡¡ "
.
¡¡" #
EndsWith
¡¡# +
(
¡¡+ ,
$str
¡¡, 5
)
¡¡5 6
)
¡¡6 7
{
¬¬ 
using
√√ 
var
√√ !
ComKey
√√" (
=
√√) *
	SearchKey
√√+ 4
.
√√4 5

OpenSubKey
√√5 ?
(
√√? @

subkeyName
√√@ J
)
√√J K
.
√√K L

OpenSubKey
√√L V
(
√√V W
$str
√√W ^
)
√√^ _
;
√√_ `
foreach
ƒƒ 
(
ƒƒ  !
var
ƒƒ! $
comObj
ƒƒ% +
in
ƒƒ, .
ParseComObjects
ƒƒ/ >
(
ƒƒ> ?
ComKey
ƒƒ? E
,
ƒƒE F
view
ƒƒG K
,
ƒƒK L
opts
ƒƒM Q
.
ƒƒQ R
SingleThread
ƒƒR ^
)
ƒƒ^ _
)
ƒƒ_ `
{
≈≈ 
HandleChange
∆∆ (
(
∆∆( )
comObj
∆∆) /
)
∆∆/ 0
;
∆∆0 1
}
«« 
}
»» 
}
…… 
}
   
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
e
ÀÀ 
)
ÀÀ 
when
ÀÀ  $
(
ÀÀ% &
e
ÃÃ 
is
ÃÃ 
ArgumentException
ÃÃ &
||
ÕÕ 
e
ÕÕ 
is
ÕÕ )
UnauthorizedAccessException
ÕÕ 3
||
ŒŒ 
e
ŒŒ 
is
ŒŒ 
System
ŒŒ 
.
ŒŒ 
Security
ŒŒ '
.
ŒŒ' (
SecurityException
ŒŒ( 9
)
ŒŒ9 :
{
œœ 
}
–– 
}
—— 	
}
““ 
}”” Œ
WD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\CryptographicKeyCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public		 

class		 %
CryptographicKeyCollector		 *
:		+ ,
BaseCollector		- :
{

 
public %
CryptographicKeyCollector (
(( )
CollectorOptions) 9
?9 :
opts; ?
=@ A
nullB F
,F G
ActionH N
<N O
CollectObjectO \
>\ ]
?] ^
changeHandler_ l
=m n
nullo s
)s t
:u v
basew {
({ |
opts	| Ä
,
Ä Å
changeHandler
Ç è
)
è ê
{ 	
} 	
public 
override 
bool 
CanRunOnPlatform -
(- .
). /
{ 	
return 
RuntimeInformation %
.% &
IsOSPlatform& 2
(2 3

OSPlatform3 =
.= >
Windows> E
)E F
;F G
} 	
internal 
override 
void 
ExecuteInternal .
(. /
CancellationToken/ @
cancellationTokenA R
)R S
{ 	
if 
( 
RuntimeInformation "
." #
IsOSPlatform# /
(/ 0

OSPlatform0 :
.: ;
Windows; B
)B C
)C D
{ 
} 
} 	
} 
} °†
MD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\DriverCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
DriverCollector  
:! "
BaseCollector# 0
{ 
public 
DriverCollector 
( 
CollectorOptions /
?/ 0
opts1 5
=6 7
null8 <
,< =
Action> D
<D E
CollectObjectE R
>R S
?S T
changeHandlerU b
=c d
nulle i
)i j
:k l
basem q
(q r
optsr v
,v w
changeHandler	x Ö
)
Ö Ü
{
á à
}
â ä
public 
override 
bool 
CanRunOnPlatform -
(- .
). /
{ 	
return 
RuntimeInformation %
.% &
IsOSPlatform& 2
(2 3

OSPlatform3 =
.= >
Windows> E
)E F
||G I
RuntimeInformationJ \
.\ ]
IsOSPlatform] i
(i j

OSPlatformj t
.t u
OSXu x
)x y
||z |
RuntimeInformation	} è
.
è ê
IsOSPlatform
ê ú
(
ú ù

OSPlatform
ù ß
.
ß ®
Linux
® ≠
)
≠ Æ
;
Æ Ø
} 	
internal"" 
override"" 
void"" 
ExecuteInternal"" .
("". /
CancellationToken""/ @
cancellationToken""A R
)""R S
{## 	
if$$ 
($$ 
RuntimeInformation$$ "
.$$" #
IsOSPlatform$$# /
($$/ 0

OSPlatform$$0 :
.$$: ;
Windows$$; B
)$$B C
)$$C D
{%% 
ExecuteWindows&& 
(&& 
cancellationToken&& 0
)&&0 1
;&&1 2
}'' 
else(( 
if(( 
((( 
RuntimeInformation(( '
.((' (
IsOSPlatform((( 4
(((4 5

OSPlatform((5 ?
.((? @
Linux((@ E
)((E F
)((F G
{)) 
ExecuteLinux** 
(** 
cancellationToken** .
)**. /
;**/ 0
}++ 
else,, 
if,, 
(,, 
RuntimeInformation,, '
.,,' (
IsOSPlatform,,( 4
(,,4 5

OSPlatform,,5 ?
.,,? @
OSX,,@ C
),,C D
),,D E
{-- 
ExecuteMacOs.. 
(.. 
cancellationToken.. .
)... /
;../ 0
}// 
}00 	
private22 
void22 
ExecuteLinux22 !
(22! "
CancellationToken22" 3
cancellationToken224 E
)22E F
{33 	
var44 
command44 
=44 
Command44 !
.44! "
Run44" %
(44% &
$str44& -
)44- .
;44. /
command55 
.55 
Wait55 
(55 
)55 
;55 
var66 
result66 
=66 
command66  
.66  !
Result66! '
;66' (
if88 
(88 
result88 
!=88 
null88 
)88 
{99 
var:: 
lines:: 
=:: 
result:: "
.::" #
StandardOutput::# 1
.::1 2
Split::2 7
(::7 8
Environment::8 C
.::C D
NewLine::D K
)::K L
[::L M
$num::M N
..::N P
]::P Q
;::Q R
Parallel;; 
.;; 
ForEach;;  
(;;  !
lines;;! &
,;;& '
new;;( +
ParallelOptions;;, ;
(;;; <
);;< =
{;;> ?
CancellationToken;;@ Q
=;;R S
cancellationToken;;T e
};;f g
,;;g h

driverLine;;i s
=>;;t v
{<< 
if== 
(== 
cancellationToken== )
.==) *#
IsCancellationRequested==* A
)==A B
{>> 
return?? 
;?? 
}@@ 
varBB 
driverLineSplitsBB (
=BB) *

driverLineBB+ 5
.BB5 6
SplitBB6 ;
(BB; <
$charBB< ?
)BB? @
;BB@ A
varCC 
innerCommandCC $
=CC% &
CommandCC' .
.CC. /
RunCC/ 2
(CC2 3
$strCC3 <
,CC< =
driverLineSplitsCC> N
[CCN O
$numCCO P
]CCP Q
)CCQ R
;CCR S
innerCommandDD  
.DD  !
WaitDD! %
(DD% &
)DD& '
;DD' (
varEE 
innerResultEE #
=EE$ %
innerCommandEE& 2
.EE2 3
ResultEE3 9
;EE9 :
ifGG 
(GG 
innerResultGG #
!=GG$ &
nullGG' +
)GG+ ,
{HH 
varII 
modInfoLinesII (
=II) *
innerResultII+ 6
.II6 7
StandardOutputII7 E
.IIE F
SplitIIF K
(IIK L
EnvironmentIIL W
.IIW X
NewLineIIX _
)II_ `
;II` a
varJJ 
modInfoDictJJ '
=JJ( )
newJJ* -

DictionaryJJ. 8
<JJ8 9
stringJJ9 ?
,JJ? @
stringJJA G
>JJG H
(JJH I
)JJI J
;JJJ K
foreachLL 
(LL  !
varLL! $
modInfoLineLL% 0
inLL1 3
modInfoLinesLL4 @
)LL@ A
{MM 
varNN 
	lineSplitNN  )
=NN* +
modInfoLineNN, 7
.NN7 8
SplitNN8 =
(NN= >
$charNN> A
)NNA B
;NNB C
modInfoDictOO '
[OO' (
	lineSplitOO( 1
[OO1 2
$numOO2 3
]OO3 4
.OO4 5
TrimOO5 9
(OO9 :
$charOO: =
)OO= >
]OO> ?
=OO@ A
	lineSplitOOB K
[OOK L
$numOOL M
]OOM N
;OON O
}PP 
varSS 
objSS 
=SS  !
newSS" %
DriverObjectSS& 2
(SS2 3
modInfoDictSS3 >
[SS> ?
$strSS? I
]SSI J
)SSJ K
{TT 
DescriptionUU '
=UU( )
modInfoDictUU* 5
[UU5 6
$strUU6 C
]UUC D
,UUD E
VersionVV #
=VV$ %
modInfoDictVV& 1
[VV1 2
$strVV2 >
]VV> ?
,VV? @

PropertiesWW &
=WW' (
modInfoDictWW) 4
,WW4 5
SizeXX  
=XX! "
driverLineSplitsXX# 3
[XX3 4
$numXX4 5
]XX5 6
,XX6 7
LinkedAgainstYY )
=YY* +
driverLineSplitsYY, <
.YY< =
LengthYY= C
>YYD E
$numYYF G
?YYH I
driverLineSplitsYYJ Z
[YYZ [
$numYY[ \
]YY\ ]
.YY] ^
SplitYY^ c
(YYc d
$charYYd g
)YYg h
.YYh i
ToListYYi o
(YYo p
)YYp q
:YYr s
nullYYt x
}ZZ 
;ZZ 
HandleChange\\ $
(\\$ %
obj\\% (
)\\( )
;\\) *
}]] 
}^^ 
)^^ 
;^^ 
}__ 
}`` 	
privatebb 
voidbb 
ExecuteMacOsbb !
(bb! "
CancellationTokenbb" 3
cancellationTokenbb4 E
)bbE F
{cc 	
vardd 
commanddd 
=dd 
Commanddd !
.dd! "
Rundd" %
(dd% &
$strdd& 0
,dd0 1
$strdd2 6
,dd6 7
$strdd8 <
)dd< =
;dd= >
commandff 
.ff 
Waitff 
(ff 
)ff 
;ff 
vargg 
resultgg 
=gg 
commandgg  
.gg  !
Resultgg! '
;gg' (
varii 
resultsii 
=ii 
newii 
Listii "
<ii" #
DriverObjectii# /
>ii/ 0
(ii0 1
)ii1 2
;ii2 3
ifjj 
(jj 
resultjj 
!=jj 
nulljj 
)jj 
{kk 
foreachll 
(ll 
varll 

driverLinell '
inll( *
resultll+ 1
.ll1 2
StandardOutputll2 @
.ll@ A
SplitllA F
(llF G
EnvironmentllG R
.llR S
NewLinellS Z
)llZ [
.ll[ \
Wherell\ a
(lla b
xllb c
=>lld f
!llg h
stringllh n
.lln o
IsNullOrEmptyllo |
(ll| }
xll} ~
)ll~ 
)	ll Ä
)
llÄ Å
{mm 
ifnn 
(nn 
cancellationTokennn )
.nn) *#
IsCancellationRequestednn* A
)nnA B
{oo 
returnpp 
;pp 
}qq 
tryrr 
{ss 
stringtt 
[tt 
]tt  
partstt! &
=tt' (

driverLinett) 3
.tt3 4
Splittt4 9
(tt9 :
$chartt: =
)tt= >
.tt> ?
Wherett? D
(ttD E
xttE F
=>ttG I
!ttJ K
stringttK Q
.ttQ R
IsNullOrEmptyttR _
(tt_ `
xtt` a
)tta b
)ttb c
.ttc d
ToArrayttd k
(ttk l
)ttl m
;ttm n
intuu 
[uu 
]uu 
linksuu #
=uu$ %
partsuu& +
.uu+ ,
Lengthuu, 2
>uu3 4
$numuu5 6
?uu7 8
partsuu9 >
[uu> ?
$numuu? @
..uu@ B
]uuB C
.uuC D
SelectuuD J
(uuJ K
xuuK L
=>uuM O
intuuP S
.uuS T
ParseuuT Y
(uuY Z
xuuZ [
.uu[ \
Replaceuu\ c
(uuc d
$struud g
,uug h
$struui k
)uuk l
.uul m
Replaceuum t
(uut u
$struuu x
,uux y
$struuz |
)uu| }
,uu} ~
CultureInfo	uu ä
.
uuä ã
InvariantCulture
uuã õ
)
uuõ ú
)
uuú ù
.
uuù û
ToArray
uuû •
(
uu• ¶
)
uu¶ ß
:
uu® ©
Array
uu™ Ø
.
uuØ ∞
Empty
uu∞ µ
<
uuµ ∂
int
uu∂ π
>
uuπ ∫
(
uu∫ ª
)
uuª º
;
uuº Ω
varvv 
objvv 
=vv  !
newvv" %
DriverObjectvv& 2
(vv2 3
partsvv3 8
[vv8 9
$numvv9 :
]vv: ;
)vv; <
{ww 
Indexxx !
=xx" #
intxx$ '
.xx' (
Parsexx( -
(xx- .
partsxx. 3
[xx3 4
$numxx4 5
]xx5 6
,xx6 7
CultureInfoxx8 C
.xxC D
InvariantCulturexxD T
)xxT U
,xxU V
Refsyy  
=yy! "
intyy# &
.yy& '
Parseyy' ,
(yy, -
partsyy- 2
[yy2 3
$numyy3 4
]yy4 5
,yy5 6
CultureInfoyy7 B
.yyB C
InvariantCultureyyC S
)yyS T
,yyT U
Addresszz #
=zz$ %
partszz& +
[zz+ ,
$numzz, -
]zz- .
,zz. /
Size{{  
={{! "
parts{{# (
[{{( )
$num{{) *
]{{* +
,{{+ ,
Wired|| !
=||" #
parts||$ )
[||) *
$num||* +
]||+ ,
,||, -
Architecture}} (
=}}) *
parts}}+ 0
[}}0 1
$num}}1 2
]}}2 3
,}}3 4
Version~~ #
=~~$ %
parts~~& +
[~~+ ,
$num~~, -
]~~- .
.~~. /
Trim~~/ 3
(~~3 4
$char~~4 7
)~~7 8
.~~8 9
Trim~~9 =
(~~= >
$char~~> A
)~~A B
,~~B C
UUID  
=! "
parts# (
[( )
$num) *
]* +
,+ ,
LinkedAgainst
ÄÄ )
=
ÄÄ* +
results
ÄÄ, 3
.
ÄÄ3 4
Where
ÄÄ4 9
(
ÄÄ9 :
x
ÄÄ: ;
=>
ÄÄ< >
links
ÄÄ? D
.
ÄÄD E
Any
ÄÄE H
(
ÄÄH I
y
ÄÄI J
=>
ÄÄK M
y
ÄÄN O
==
ÄÄP R
x
ÄÄS T
.
ÄÄT U
Index
ÄÄU Z
)
ÄÄZ [
)
ÄÄ[ \
.
ÄÄ\ ]
Select
ÄÄ] c
(
ÄÄc d
x
ÄÄd e
=>
ÄÄf h
x
ÄÄi j
.
ÄÄj k
Identity
ÄÄk s
)
ÄÄs t
.
ÄÄt u
ToList
ÄÄu {
(
ÄÄ{ |
)
ÄÄ| }
}
ÅÅ 
;
ÅÅ 
HandleChange
ÇÇ $
(
ÇÇ$ %
obj
ÇÇ% (
)
ÇÇ( )
;
ÇÇ) *
results
ÉÉ 
.
ÉÉ  
Add
ÉÉ  #
(
ÉÉ# $
obj
ÉÉ$ '
)
ÉÉ' (
;
ÉÉ( )
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ $
e
ÖÖ% &
)
ÖÖ& '
{
ÜÜ 
Log
áá 
.
áá 
Debug
áá !
(
áá! "
$str
áá" B
,
ááB C

driverLine
ááD N
,
ááN O
e
ááP Q
.
ááQ R
GetType
ááR Y
(
ááY Z
)
ááZ [
,
áá[ \
e
áá] ^
.
áá^ _
Message
áá_ f
)
ááf g
;
áág h
}
àà 
}
ââ 
}
ää 
}
ãã 	
private
çç 
void
çç 
ExecuteWindows
çç #
(
çç# $
CancellationToken
çç$ 5
cancellationToken
çç6 G
)
ççG H
{
éé 	
var
èè 
command
èè 
=
èè 
Command
èè !
.
èè! "
Run
èè" %
(
èè% &
$str
èè& 3
,
èè3 4
$str
èè5 :
,
èè: ;
$str
èè< A
,
èèA B
$str
èèC H
,
èèH I
$str
èèJ N
)
èèN O
;
èèO P
command
ëë 
.
ëë 
Wait
ëë 
(
ëë 
)
ëë 
;
ëë 
var
íí 
result
íí 
=
íí 
command
íí  
.
íí  !
Result
íí! '
;
íí' (
if
ìì 
(
ìì 
result
ìì 
!=
ìì 
null
ìì 
)
ìì 
{
îî 
Parallel
ïï 
.
ïï 
ForEach
ïï  
(
ïï  !
result
ïï! '
.
ïï' (
StandardOutput
ïï( 6
.
ïï6 7
Split
ïï7 <
(
ïï< =
Environment
ïï= H
.
ïïH I
NewLine
ïïI P
)
ïïP Q
,
ïïQ R
new
ïïS V
ParallelOptions
ïïW f
(
ïïf g
)
ïïg h
{
ïïi j
CancellationToken
ïïk |
=
ïï} ~ 
cancellationTokenïï ê
}ïïë í
,ïïí ì

driverLineïïî û
=>ïïü °
{
ññ 
var
óó 
parts
óó 
=
óó 

driverLine
óó  *
.
óó* +
Split
óó+ 0
(
óó0 1
$char
óó1 4
)
óó4 5
.
óó5 6
Where
óó6 ;
(
óó; <
x
óó< =
=>
óó> @
x
óóA B
!=
óóC E
$str
óóF I
)
óóI J
.
óóJ K
ToArray
óóK R
(
óóR S
)
óóS T
[
óóT U
$num
óóU V
..
óóV X
]
óóX Y
;
óóY Z
if
òò 
(
òò 
parts
òò 
.
òò 
Length
òò $
>=
òò% '
$num
òò( *
)
òò* +
HandleChange
ôô $
(
ôô$ %
new
ôô% (
DriverObject
ôô) 5
(
ôô5 6
parts
ôô6 ;
[
ôô; <
$num
ôô< =
]
ôô= >
)
ôô> ?
{
öö 
DisplayName
õõ '
=
õõ( )
parts
õõ* /
[
õõ/ 0
$num
õõ0 1
]
õõ1 2
,
õõ2 3
Description
úú '
=
úú( )
parts
úú* /
[
úú/ 0
$num
úú0 1
]
úú1 2
,
úú2 3

DriverType
ùù &
=
ùù' (
parts
ùù) .
[
ùù. /
$num
ùù/ 0
]
ùù0 1
,
ùù1 2
	StartMode
ûû %
=
ûû& '
parts
ûû( -
[
ûû- .
$num
ûû. /
]
ûû/ 0
,
ûû0 1
State
üü !
=
üü" #
parts
üü$ )
[
üü) *
$num
üü* +
]
üü+ ,
,
üü, -
Status
†† "
=
††# $
parts
††% *
[
††* +
$num
††+ ,
]
††, -
,
††- .

AcceptStop
°° &
=
°°' (
bool
°°) -
.
°°- .
Parse
°°. 3
(
°°3 4
parts
°°4 9
[
°°9 :
$num
°°: ;
]
°°; <
)
°°< =
,
°°= >
AcceptPause
¢¢ '
=
¢¢( )
bool
¢¢* .
.
¢¢. /
Parse
¢¢/ 4
(
¢¢4 5
parts
¢¢5 :
[
¢¢: ;
$num
¢¢; <
]
¢¢< =
)
¢¢= >
,
¢¢> ?
	PagedPool
££ %
=
££& '
long
££( ,
.
££, -
Parse
££- 2
(
££2 3
parts
££3 8
[
££8 9
$num
££9 :
]
££: ;
.
££; <
Replace
££< C
(
££C D
$str
££D G
,
££G H
$str
££I K
)
££K L
,
££L M
CultureInfo
££N Y
.
££Y Z
InvariantCulture
££Z j
)
££j k
,
££k l
Code
§§  
=
§§! "
long
§§# '
.
§§' (
Parse
§§( -
(
§§- .
parts
§§. 3
[
§§3 4
$num
§§4 6
]
§§6 7
.
§§7 8
Replace
§§8 ?
(
§§? @
$str
§§@ C
,
§§C D
$str
§§E G
)
§§G H
,
§§H I
CultureInfo
§§J U
.
§§U V
InvariantCulture
§§V f
)
§§f g
,
§§g h
BSS
•• 
=
••  !
long
••" &
.
••& '
Parse
••' ,
(
••, -
parts
••- 2
[
••2 3
$num
••3 5
]
••5 6
.
••6 7
Replace
••7 >
(
••> ?
$str
••? B
,
••B C
$str
••D F
)
••F G
,
••G H
CultureInfo
••I T
.
••T U
InvariantCulture
••U e
)
••e f
,
••f g
LinkDate
¶¶ $
=
¶¶% &
string
¶¶' -
.
¶¶- .
IsNullOrEmpty
¶¶. ;
(
¶¶; <
parts
¶¶< A
[
¶¶A B
$num
¶¶B D
]
¶¶D E
)
¶¶E F
?
¶¶G H
DateTime
¶¶I Q
.
¶¶Q R
MinValue
¶¶R Z
:
¶¶[ \
DateTime
¶¶] e
.
¶¶e f
Parse
¶¶f k
(
¶¶k l
parts
¶¶l q
[
¶¶q r
$num
¶¶r t
]
¶¶t u
,
¶¶u v
CultureInfo¶¶w Ç
.¶¶Ç É 
InvariantCulture¶¶É ì
)¶¶ì î
,¶¶î ï
Path
ßß  
=
ßß! "
parts
ßß# (
[
ßß( )
$num
ßß) +
]
ßß+ ,
,
ßß, -
Init
®®  
=
®®! "
long
®®# '
.
®®' (
Parse
®®( -
(
®®- .
parts
®®. 3
[
®®3 4
$num
®®4 6
]
®®6 7
.
®®7 8
Replace
®®8 ?
(
®®? @
$str
®®@ C
,
®®C D
$str
®®E G
)
®®G H
,
®®H I
CultureInfo
®®J U
.
®®U V
InvariantCulture
®®V f
)
®®f g
,
®®g h
	Signature
©© %
=
©©& '$
WindowsFileSystemUtils
©©( >
.
©©> ? 
GetSignatureStatus
©©? Q
(
©©Q R
parts
©©R W
[
©©W X
$num
©©X Z
]
©©Z [
)
©©[ \
}
™™ 
)
™™ 
;
™™ 
}
´´ 
)
´´ 
;
´´ 
}
¨¨ 
}
≠≠ 	
}
ÆÆ 
}ØØ ¡¿
OD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\EventLogCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
EventLogCollector "
:# $
BaseCollector% 2
{ 
public 
EventLogCollector  
(  !
CollectorOptions! 1
?1 2
opts3 7
=8 9
null: >
,> ?
Action@ F
<F G
CollectObjectG T
>T U
?U V
changeHandlerW d
=e f
nullg k
)k l
:m n
baseo s
(s t
optst x
,x y
changeHandler	z á
)
á à
{ 	
} 	
public 
override 
bool 
CanRunOnPlatform -
(- .
). /
{ 	
return 
RuntimeInformation %
.% &
IsOSPlatform& 2
(2 3

OSPlatform3 =
.= >
OSX> A
)A B
||C E
RuntimeInformationF X
.X Y
IsOSPlatformY e
(e f

OSPlatformf p
.p q
Windowsq x
)x y
||z |
RuntimeInformation	} è
.
è ê
IsOSPlatform
ê ú
(
ú ù

OSPlatform
ù ß
.
ß ®
Linux
® ≠
)
≠ Æ
;
Æ Ø
} 	
public## 
void## 
ExecuteLinux##  
(##  !
CancellationToken##! 2
cancellationToken##3 D
)##D E
{$$ 	
Regex%% 
	LogHeader%% 
=%% 
new%% !
Regex%%" '
(%%' (
$str%%( _
,%%_ `
RegexOptions%%a m
.%%m n
Compiled%%n v
)%%v w
;%%w x
void'' 
HandleLinuxEvent'' !
(''! "
string''" (
entry'') .
,''. /
string''0 6
path''7 ;
)''; <
{(( 
if++ 
(++ 
	LogHeader++ 
.++ 
IsMatch++ %
(++% &
entry++& +
)+++ ,
)++, -
{,, 
var-- 
obj-- 
=-- 
new-- !
EventLogObject--" 0
(--0 1
entry--1 6
)--6 7
{.. 
Summary// 
=//  !
	LogHeader//" +
.//+ ,
Matches//, 3
(//3 4
entry//4 9
)//9 :
.//: ;
Single//; A
(//A B
)//B C
.//C D
Groups//D J
[//J K
$num//K L
]//L M
.//M N
Captures//N V
[//V W
$num//W X
]//X Y
.//Y Z
Value//Z _
,//_ `
Source00 
=00  
path00! %
,00% &
Process11 
=11  !
	LogHeader11" +
.11+ ,
Matches11, 3
(113 4
entry114 9
)119 :
.11: ;
Single11; A
(11A B
)11B C
.11C D
Groups11D J
[11J K
$num11K L
]11L M
.11M N
Captures11N V
[11V W
$num11W X
]11X Y
.11Y Z
Value11Z _
,11_ `
}22 
;22 
if33 
(33 
DateTime33  
.33  !
TryParse33! )
(33) *
	LogHeader33* 3
.333 4
Matches334 ;
(33; <
entry33< A
)33A B
.33B C
Single33C I
(33I J
)33J K
.33K L
Groups33L R
[33R S
$num33S T
]33T U
.33U V
Captures33V ^
[33^ _
$num33_ `
]33` a
.33a b
Value33b g
,33g h
out33i l
DateTime33m u
	Timestamp33v 
)	33 Ä
)
33Ä Å
{44 
obj55 
.55 
	Timestamp55 %
=55& '
	Timestamp55( 1
;551 2
}66 
HandleChange77  
(77  !
obj77! $
)77$ %
;77% &
}88 
}99 
void;; 
ParseLinuxLog;; 
(;; 
string;; %
path;;& *
);;* +
{<< 
try== 
{>> 
string?? 
[?? 
]?? 
log??  
=??! "
File??# '
.??' (
ReadAllLines??( 4
(??4 5
path??5 9
)??9 :
;??: ;
ifAA 
(AA 
optsAA 
.AA 
SingleThreadAA )
)AA) *
{BB 
foreachCC 
(CC  !
varCC! $
entryCC% *
inCC+ -
logCC. 1
)CC1 2
{DD 
ifEE 
(EE  
cancellationTokenEE  1
.EE1 2#
IsCancellationRequestedEE2 I
)EEI J
{FF 
breakGG  %
;GG% &
}HH 
HandleLinuxEventII ,
(II, -
entryII- 2
,II2 3
pathII4 8
)II8 9
;II9 :
}JJ 
}KK 
elseLL 
{MM 
ParallelOptionsNN '
poNN( *
=NN+ ,
newNN- 0
ParallelOptionsNN1 @
(NN@ A
)NNA B
{NNC D
CancellationTokenNNE V
=NNW X
cancellationTokenNNY j
}NNk l
;NNl m
ParallelOO  
.OO  !
ForEachOO! (
(OO( )
logOO) ,
,OO, -
poOO. 0
,OO0 1
entryOO2 7
=>OO8 :
HandleLinuxEventOO; K
(OOK L
entryOOL Q
,OOQ R
pathOOS W
)OOW X
)OOX Y
;OOY Z
}PP 
}QQ 
catchRR 
(RR 
	ExceptionRR  
eRR! "
)RR" #
whenRR$ (
(RR) *
eSS 
isSS 
ArgumentExceptionSS *
||TT 
eTT 
isTT !
ArgumentNullExceptionTT 1
||UU 
eUU 
isUU &
DirectoryNotFoundExceptionUU 6
||VV 
eVV 
isVV  
PathTooLongExceptionVV 0
||WW 
eWW 
isWW !
FileNotFoundExceptionWW 1
||XX 
eXX 
isXX 
IOExceptionXX '
||YY 
eYY 
isYY !
NotSupportedExceptionYY 1
||ZZ 
eZZ 
isZZ 
SystemZZ "
.ZZ" #
SecurityZZ# +
.ZZ+ ,
SecurityExceptionZZ, =
||[[ 
e[[ 
is[[ '
UnauthorizedAccessException[[ 7
)[[7 8
{\\ 
Log]] 
.]] 
Debug]] 
(]] 
$str]] 3
,]]3 4
path]]5 9
)]]9 :
;]]: ;
}^^ 
}__ 
ParseLinuxLogaa 
(aa 
$straa -
)aa- .
;aa. /
ParseLinuxLogbb 
(bb 
$strbb +
)bb+ ,
;bb, -
}cc 	
publichh 
voidhh 
ExecuteMacOshh  
(hh  !
CancellationTokenhh! 2
cancellationTokenhh3 D
)hhD E
{ii 	
Regexll 
MacLogHeaderll 
=ll  
newll! $
Regexll% *
(ll* +
$str	ll+ ‘
,
ll‘ ’
RegexOptions
ll÷ ‚
.
ll‚ „
Compiled
ll„ Î
)
llÎ Ï
;
llÏ Ì
EventLogObjectmm 
?mm 
	curObjectmm %
=mm& '
nullmm( ,
;mm, -
usingoo 
varoo 
processoo 
=oo 
newoo  #
Processoo$ +
(oo+ ,
)oo, -
{pp 
	StartInfoqq 
=qq 
newqq 
ProcessStartInfoqq  0
{rr 
FileNamess 
=ss 
$strss $
,ss$ %
	Argumentstt 
=tt 
optstt  $
.tt$ %
GatherVerboseLogstt% 6
?tt7 8
$strtt9 ?
:tt@ A
$strttB 
,	tt Ä"
RedirectStandardOutputuu *
=uu+ ,
trueuu- 1
,uu1 2!
RedirectStandardErrorvv )
=vv* +
truevv, 0
,vv0 1
UseShellExecuteww #
=ww$ %
falseww& +
,ww+ ,
CreateNoWindowxx "
=xx# $
truexx% )
,xx) *
WindowStyleyy 
=yy  !
ProcessWindowStyleyy" 4
.yy4 5
Hiddenyy5 ;
}zz 
}{{ 
;{{ 
var}} 
stdError}} 
=}} 
new}} 
StringBuilder}} ,
(}}, -
)}}- .
;}}. /
process~~ 
.~~ 
ErrorDataReceived~~ %
+=~~& (
(~~) *
sender~~* 0
,~~0 1
args~~2 6
)~~6 7
=>~~8 :
stdError~~; C
.~~C D

AppendLine~~D N
(~~N O
args~~O S
.~~S T
Data~~T X
)~~X Y
;~~Y Z
try 
{
ÄÄ 
process
ÅÅ 
.
ÅÅ 
Start
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ  
process
ÉÉ 
.
ÉÉ 
StandardOutput
ÉÉ &
.
ÉÉ& '
ReadLine
ÉÉ' /
(
ÉÉ/ 0
)
ÉÉ0 1
;
ÉÉ1 2
while
ÖÖ 
(
ÖÖ 
!
ÖÖ 
process
ÖÖ 
.
ÖÖ  
StandardOutput
ÖÖ  .
.
ÖÖ. /
EndOfStream
ÖÖ/ :
)
ÖÖ: ;
{
ÜÜ 
if
áá 
(
áá 
cancellationToken
áá )
.
áá) *%
IsCancellationRequested
áá* A
)
ááA B
{
àà 
break
ââ 
;
ââ 
}
ää 
var
ãã 
evt
ãã 
=
ãã 
process
ãã %
.
ãã% &
StandardOutput
ãã& 4
.
ãã4 5
ReadLine
ãã5 =
(
ãã= >
)
ãã> ?
;
ãã? @
if
çç 
(
çç 
evt
çç 
!=
çç 
null
çç #
&&
çç$ &
MacLogHeader
çç' 3
.
çç3 4
IsMatch
çç4 ;
(
çç; <
evt
çç< ?
)
çç? @
)
çç@ A
{
éé 
if
èè 
(
èè 
	curObject
èè %
!=
èè& (
null
èè) -
)
èè- .
{
êê 
HandleChange
ëë (
(
ëë( )
	curObject
ëë) 2
)
ëë2 3
;
ëë3 4
}
íí 
	curObject
îî !
=
îî" #
new
îî$ '
EventLogObject
îî( 6
(
îî6 7
evt
îî7 :
)
îî: ;
{
ïï 
Level
ññ !
=
ññ" #
MacLogHeader
ññ$ 0
.
ññ0 1
Matches
ññ1 8
(
ññ8 9
evt
ññ9 <
)
ññ< =
.
ññ= >
Single
ññ> D
(
ññD E
)
ññE F
.
ññF G
Groups
ññG M
[
ññM N
$num
ññN O
]
ññO P
.
ññP Q
Value
ññQ V
,
ññV W
Summary
óó #
=
óó$ %
$"
óó& (
{
óó( )
MacLogHeader
óó) 5
.
óó5 6
Matches
óó6 =
(
óó= >
evt
óó> A
)
óóA B
.
óóB C
Single
óóC I
(
óóI J
)
óóJ K
.
óóK L
Groups
óóL R
[
óóR S
$num
óóS T
]
óóT U
.
óóU V
Captures
óóV ^
[
óó^ _
$num
óó_ `
]
óó` a
.
óóa b
Value
óób g
}
óóg h
$str
óóh i
{
óói j
MacLogHeader
óój v
.
óóv w
Matches
óów ~
(
óó~ 
evtóó Ç
)óóÇ É
.óóÉ Ñ
SingleóóÑ ä
(óóä ã
)óóã å
.óóå ç
Groupsóóç ì
[óóì î
$numóóî ï
]óóï ñ
.óóñ ó
Capturesóóó ü
[óóü †
$numóó† °
]óó° ¢
.óó¢ £
Valueóó£ ®
}óó® ©
"óó© ™
,óó™ ´
Source
òò "
=
òò# $
MacLogHeader
òò% 1
.
òò1 2
Matches
òò2 9
(
òò9 :
evt
òò: =
)
òò= >
.
òò> ?
Single
òò? E
(
òòE F
)
òòF G
.
òòG H
Groups
òòH N
[
òòN O
$num
òòO P
]
òòP Q
.
òòQ R
Captures
òòR Z
[
òòZ [
$num
òò[ \
]
òò\ ]
.
òò] ^
Value
òò^ c
,
òòc d
}
ôô 
;
ôô 
if
öö 
(
öö 
DateTime
öö $
.
öö$ %
TryParse
öö% -
(
öö- .
MacLogHeader
öö. :
.
öö: ;
Matches
öö; B
(
ööB C
evt
ööC F
)
ööF G
.
ööG H
Single
ööH N
(
ööN O
)
ööO P
.
ööP Q
Groups
ööQ W
[
ööW X
$num
ööX Y
]
ööY Z
.
ööZ [
Captures
öö[ c
[
ööc d
$num
ööd e
]
ööe f
.
ööf g
Value
öög l
,
ööl m
out
öön q
DateTime
öör z
	Timestampöö{ Ñ
)ööÑ Ö
)ööÖ Ü
{
õõ 
	curObject
úú %
.
úú% &
	Timestamp
úú& /
=
úú0 1
	Timestamp
úú2 ;
;
úú; <
}
ùù 
}
ûû 
else
üü 
{
†† 
if
°° 
(
°° 
	curObject
°° %
!=
°°& (
null
°°) -
)
°°- .
{
¢¢ 
if
££ 
(
££  
evt
££  #
!=
££$ &
null
££' +
)
££+ ,
{
§§ 
if
••  "
(
••# $
	curObject
••$ -
.
••- .
Data
••. 2
==
••3 5
null
••6 :
)
••: ;
{
¶¶  !
	curObject
ßß$ -
.
ßß- .
Data
ßß. 2
=
ßß3 4
new
ßß5 8
List
ßß9 =
<
ßß= >
string
ßß> D
>
ßßD E
(
ßßE F
)
ßßF G
;
ßßG H
}
®®  !
	curObject
©©  )
.
©©) *
Data
©©* .
.
©©. /
Add
©©/ 2
(
©©2 3
evt
©©3 6
)
©©6 7
;
©©7 8
}
™™ 
}
´´ 
}
¨¨ 
}
≠≠ 
process
ÆÆ 
.
ÆÆ 
WaitForExit
ÆÆ #
(
ÆÆ# $
)
ÆÆ$ %
;
ÆÆ% &
if
ØØ 
(
ØØ 
	curObject
ØØ 
!=
ØØ  
null
ØØ! %
)
ØØ% &
{
∞∞ 
HandleChange
±±  
(
±±  !
	curObject
±±! *
)
±±* +
;
±±+ ,
}
≤≤ 
}
≥≥ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
e
¥¥ 
)
¥¥ 
{
µµ 
Log
∂∂ 
.
∂∂ 
Debug
∂∂ 
(
∂∂ 
e
∂∂ 
,
∂∂ 
$str
∂∂ I
,
∂∂I J
stdError
∂∂K S
)
∂∂S T
;
∂∂T U
}
∑∑ 
}
∏∏ 	
[
ΩΩ 	
System
ΩΩ	 
.
ΩΩ 
Diagnostics
ΩΩ 
.
ΩΩ 
CodeAnalysis
ΩΩ (
.
ΩΩ( )
SuppressMessage
ΩΩ) 8
(
ΩΩ8 9
$str
ΩΩ9 A
,
ΩΩA B
$str
ΩΩC p
,
ΩΩp q
Justification
ΩΩr 
=ΩΩÄ Å
$strΩΩÇ ≈
)ΩΩ≈ ∆
]ΩΩ∆ «
public
ææ 
void
ææ 
ExecuteWindows
ææ "
(
ææ" #
CancellationToken
ææ# 4
cancellationToken
ææ5 F
)
ææF G
{
øø 	
if
¿¿ 
(
¿¿ 
!
¿¿  
RuntimeInformation
¿¿ #
.
¿¿# $
IsOSPlatform
¿¿$ 0
(
¿¿0 1

OSPlatform
¿¿1 ;
.
¿¿; <
Windows
¿¿< C
)
¿¿C D
)
¿¿D E
{
¡¡ 
return
¬¬ 
;
¬¬ 
}
√√ 
void
ƒƒ 
ParseWindowsLog
ƒƒ  
(
ƒƒ  !
EventLogEntry
ƒƒ! .
entry
ƒƒ/ 4
)
ƒƒ4 5
{
≈≈ 
if
∆∆ 
(
∆∆ 
opts
∆∆ 
.
∆∆ 
GatherVerboseLogs
∆∆ *
||
∆∆+ -
entry
∆∆. 3
.
∆∆3 4
	EntryType
∆∆4 =
.
∆∆= >
ToString
∆∆> F
(
∆∆F G
)
∆∆G H
==
∆∆I K
$str
∆∆L U
||
∆∆V X
entry
∆∆Y ^
.
∆∆^ _
	EntryType
∆∆_ h
.
∆∆h i
ToString
∆∆i q
(
∆∆q r
)
∆∆r s
==
∆∆t v
$str
∆∆w ~
)
∆∆~ 
{
«« 
var
»» 
	sentences
»» !
=
»»" #
entry
»»$ )
.
»») *
Message
»»* 1
.
»»1 2
Split
»»2 7
(
»»7 8
$char
»»8 ;
)
»»; <
;
»»< =
for
ÀÀ 
(
ÀÀ 
var
ÀÀ 
i
ÀÀ 
=
ÀÀ  
$num
ÀÀ! "
;
ÀÀ" #
i
ÀÀ$ %
<
ÀÀ& '
	sentences
ÀÀ( 1
.
ÀÀ1 2
Length
ÀÀ2 8
;
ÀÀ8 9
i
ÀÀ: ;
++
ÀÀ; =
)
ÀÀ= >
{
ÃÃ 
	sentences
ÕÕ !
[
ÕÕ! "
i
ÕÕ" #
]
ÕÕ# $
=
ÕÕ% &
string
ÕÕ' -
.
ÕÕ- .
Concat
ÕÕ. 4
(
ÕÕ4 5
	sentences
ÕÕ5 >
[
ÕÕ> ?
i
ÕÕ? @
]
ÕÕ@ A
,
ÕÕA B
$str
ÕÕC F
)
ÕÕF G
;
ÕÕG H
}
ŒŒ 
EventLogObject
–– "
obj
––# &
=
––' (
new
––) ,
EventLogObject
––- ;
(
––; <
$"
––< >
{
––> ?
entry
––? D
.
––D E
TimeGenerated
––E R
.
––R S
ToString
––S [
(
––[ \
$str
––\ _
,
––_ `
CultureInfo
––a l
.
––l m
InvariantCulture
––m }
)
––} ~
}
––~ 
$str–– Ä
{––Ä Å
entry––Å Ü
.––Ü á
	EntryType––á ê
.––ê ë
ToString––ë ô
(––ô ö
)––ö õ
}––õ ú
$str––ú ù
{––ù û
entry––û £
.––£ §
Message––§ ´
}––´ ¨
"––¨ ≠
)––≠ Æ
{
—— 
Level
““ 
=
““ 
entry
““  %
.
““% &
	EntryType
““& /
.
““/ 0
ToString
““0 8
(
““8 9
)
““9 :
,
““: ;
Summary
”” 
=
””  !
	sentences
””" +
[
””+ ,
$num
””, -
]
””- .
,
””. /
Source
‘‘ 
=
‘‘  
string
‘‘! '
.
‘‘' (
IsNullOrEmpty
‘‘( 5
(
‘‘5 6
entry
‘‘6 ;
.
‘‘; <
Source
‘‘< B
)
‘‘B C
?
‘‘D E
null
‘‘F J
:
‘‘K L
entry
‘‘M R
.
‘‘R S
Source
‘‘S Y
,
‘‘Y Z
	Timestamp
’’ !
=
’’" #
entry
’’$ )
.
’’) *
TimeGenerated
’’* 7
,
’’7 8
Data
÷÷ 
=
÷÷ 
new
÷÷ "
List
÷÷# '
<
÷÷' (
string
÷÷( .
>
÷÷. /
(
÷÷/ 0
)
÷÷0 1
{
÷÷2 3
entry
÷÷4 9
.
÷÷9 :
Message
÷÷: A
}
÷÷B C
}
◊◊ 
;
◊◊ 
HandleChange
ÿÿ  
(
ÿÿ  !
obj
ÿÿ! $
)
ÿÿ$ %
;
ÿÿ% &
}
ŸŸ 
}
⁄⁄ 
EventLog
€€ 
[
€€ 
]
€€ 
logs
€€ 
=
€€ 
EventLog
€€ &
.
€€& '
GetEventLogs
€€' 3
(
€€3 4
)
€€4 5
;
€€5 6
foreach
‹‹ 
(
‹‹ 
var
‹‹ 
log
‹‹ 
in
‹‹ 
logs
‹‹  $
)
‹‹$ %
{
›› 
if
ﬁﬁ 
(
ﬁﬁ 
cancellationToken
ﬁﬁ %
.
ﬁﬁ% &%
IsCancellationRequested
ﬁﬁ& =
)
ﬁﬁ= >
{
ﬂﬂ 
break
‡‡ 
;
‡‡ 
}
·· 
try
‚‚ 
{
„„ %
EventLogEntryCollection
‰‰ +
coll
‰‰, 0
=
‰‰1 2
log
‰‰3 6
.
‰‰6 7
Entries
‰‰7 >
;
‰‰> ?
if
ÊÊ 
(
ÊÊ 
opts
ÊÊ 
.
ÊÊ 
SingleThread
ÊÊ )
)
ÊÊ) *
{
ÁÁ 
foreach
ËË 
(
ËË  !
EventLogEntry
ËË! .
?
ËË. /
entry
ËË0 5
in
ËË6 8
coll
ËË9 =
)
ËË= >
{
ÈÈ 
if
ÍÍ 
(
ÍÍ  
cancellationToken
ÍÍ  1
.
ÍÍ1 2%
IsCancellationRequested
ÍÍ2 I
)
ÍÍI J
{
ÎÎ 
break
ÏÏ  %
;
ÏÏ% &
}
ÌÌ 
if
ÓÓ 
(
ÓÓ  
entry
ÓÓ  %
!=
ÓÓ& (
null
ÓÓ) -
)
ÓÓ- .
{
ÔÔ 
ParseWindowsLog
  /
(
/ 0
entry
0 5
)
5 6
;
6 7
}
ÒÒ 
}
ÚÚ 
}
ÛÛ 
else
ÙÙ 
{
ıı 
List
ˆˆ 
<
ˆˆ 
EventLogEntry
ˆˆ *
>
ˆˆ* +
coll2
ˆˆ, 1
=
ˆˆ2 3
new
ˆˆ4 7
List
ˆˆ8 <
<
ˆˆ< =
EventLogEntry
ˆˆ= J
>
ˆˆJ K
(
ˆˆK L
)
ˆˆL M
;
ˆˆM N
ParallelOptions
˜˜ '
po
˜˜( *
=
˜˜+ ,
new
˜˜- 0
ParallelOptions
˜˜1 @
(
˜˜@ A
)
˜˜A B
;
˜˜B C
po
¯¯ 
.
¯¯ 
CancellationToken
¯¯ ,
=
¯¯- .
cancellationToken
¯¯/ @
;
¯¯@ A
foreach
˘˘ 
(
˘˘  !
EventLogEntry
˘˘! .
?
˘˘. /
entry
˘˘0 5
in
˘˘6 8
coll
˘˘9 =
)
˘˘= >
{
˙˙ 
if
˚˚ 
(
˚˚  
entry
˚˚  %
!=
˚˚& (
null
˚˚) -
)
˚˚- .
{
¸¸ 
coll2
˝˝  %
.
˝˝% &
Add
˝˝& )
(
˝˝) *
entry
˝˝* /
)
˝˝/ 0
;
˝˝0 1
}
˛˛ 
}
ˇˇ 
Parallel
ÄÄ  
.
ÄÄ  !
ForEach
ÄÄ! (
(
ÄÄ( )
coll2
ÄÄ) .
,
ÄÄ. /
po
ÄÄ0 2
,
ÄÄ2 3
entry
ÄÄ4 9
=>
ÄÄ: <
ParseWindowsLog
ÄÄ= L
(
ÄÄL M
entry
ÄÄM R
)
ÄÄR S
)
ÄÄS T
;
ÄÄT U
}
ÅÅ 
}
ÇÇ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ  
e
ÉÉ! "
)
ÉÉ" #
{
ÑÑ 
Log
ÖÖ 
.
ÖÖ 
Debug
ÖÖ 
(
ÖÖ 
e
ÖÖ 
,
ÖÖ  
$str
ÖÖ! 8
,
ÖÖ8 9
log
ÖÖ: =
.
ÖÖ= >
Source
ÖÖ> D
)
ÖÖD E
;
ÖÖE F
}
ÜÜ 
}
áá 
}
àà 	
internal
ää 
override
ää 
void
ää 
ExecuteInternal
ää .
(
ää. /
CancellationToken
ää/ @
cancellationToken
ääA R
)
ääR S
{
ãã 	
if
åå 
(
åå  
RuntimeInformation
åå "
.
åå" #
IsOSPlatform
åå# /
(
åå/ 0

OSPlatform
åå0 :
.
åå: ;
Windows
åå; B
)
ååB C
)
ååC D
{
çç 
ExecuteWindows
éé 
(
éé 
cancellationToken
éé 0
)
éé0 1
;
éé1 2
}
èè 
else
êê 
if
êê 
(
êê  
RuntimeInformation
êê '
.
êê' (
IsOSPlatform
êê( 4
(
êê4 5

OSPlatform
êê5 ?
.
êê? @
Linux
êê@ E
)
êêE F
)
êêF G
{
ëë 
ExecuteLinux
íí 
(
íí 
cancellationToken
íí .
)
íí. /
;
íí/ 0
}
ìì 
else
îî 
if
îî 
(
îî  
RuntimeInformation
îî '
.
îî' (
IsOSPlatform
îî( 4
(
îî4 5

OSPlatform
îî5 ?
.
îî? @
OSX
îî@ C
)
îîC D
)
îîD E
{
ïï 
ExecuteMacOs
ññ 
(
ññ 
cancellationToken
ññ .
)
ññ. /
;
ññ/ 0
}
óó 
}
òò 	
}
ôô 
}öö çä
QD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\FileSystemCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
FileSystemCollector $
:% &
BaseCollector' 4
{ 
public 
FileSystemCollector "
(" #
CollectorOptions# 3
?3 4
opts5 9
=: ;
null< @
,@ A
ActionB H
<H I
CollectObjectI V
>V W
?W X
changeHandlerY f
=g h
nulli m
)m n
:o p
baseq u
(u v
optsv z
,z {
changeHandler	| â
)
â ä
{   	
Roots!! 
.!! 
AddRange!! 
(!! 
opts!! 
?!!  
.!!  !
SelectedDirectories!!! 4
??!!5 7
new!!8 ;
List!!< @
<!!@ A
string!!A G
>!!G H
(!!H I
)!!I J
)!!J K
;!!K L
if## 
(## 
!## 
Roots## 
.## 
Any## 
(## 
)## 
)## 
{$$ 
if%% 
(%% 
RuntimeInformation%% &
.%%& '
IsOSPlatform%%' 3
(%%3 4

OSPlatform%%4 >
.%%> ?
Windows%%? F
)%%F G
)%%G H
{&& 
foreach'' 
('' 
var''  
	driveInfo''! *
in''+ -
	DriveInfo''. 7
.''7 8
	GetDrives''8 A
(''A B
)''B C
)''C D
{(( 
if)) 
()) 
	driveInfo)) %
.))% &
IsReady))& -
&&)). 0
	driveInfo))1 :
.)): ;
	DriveType)); D
==))E G
	DriveType))H Q
.))Q R
Fixed))R W
)))W X
{** 
Roots++ !
.++! "
Add++" %
(++% &
	driveInfo++& /
.++/ 0
Name++0 4
)++4 5
;++5 6
},, 
}-- 
}.. 
else// 
if// 
(// 
RuntimeInformation// +
.//+ ,
IsOSPlatform//, 8
(//8 9

OSPlatform//9 C
.//C D
Linux//D I
)//I J
)//J K
{00 
foreach11 
(11 
var11  
	directory11! *
in11+ -
	Directory11. 7
.117 8 
EnumerateDirectories118 L
(11L M
$str11M P
)11P Q
)11Q R
{22 
if33 
(33 
!33 
	directory33 &
.33& '
Equals33' -
(33- .
$str33. 5
)335 6
&&337 9
!33: ;
	directory33; D
.33D E
Equals33E K
(33K L
$str33L R
)33R S
)33S T
{44 
Roots55 !
.55! "
Add55" %
(55% &
	directory55& /
)55/ 0
;550 1
}66 
else77 
{88 
Log99 
.99  
Debug99  %
(99% &
$str	99& ó
)
99ó ò
;
99ò ô
}:: 
};; 
}<< 
else== 
if== 
(== 
RuntimeInformation== +
.==+ ,
IsOSPlatform==, 8
(==8 9

OSPlatform==9 C
.==C D
OSX==D G
)==G H
)==H I
{>> 
Roots?? 
.?? 
Add?? 
(?? 
$str?? !
)??! "
;??" #
}@@ 
}AA 
}BB 	
publicDD 
staticDD  
ConcurrentDictionaryDD *
<DD* +
stringDD+ 1
,DD1 2
uintDD3 7
>DD7 8
ClusterSizesDD9 E
{DDF G
getDDH K
;DDK L
setDDM P
;DDP Q
}DDR S
=DDT U
newDDV Y 
ConcurrentDictionaryDDZ n
<DDn o
stringDDo u
,DDu v
uintDDw {
>DD{ |
(DD| }
)DD} ~
;DD~ 
publicEE 
ListEE 
<EE 
stringEE 
>EE 
RootsEE !
{EE" #
getEE$ '
;EE' (
}EE) *
=EE+ ,
newEE- 0
ListEE1 5
<EE5 6
stringEE6 <
>EE< =
(EE= >
)EE> ?
;EE? @
publicFF 
overrideFF 
boolFF 
CanRunOnPlatformFF -
(FF- .
)FF. /
{GG 	
returnHH 
RuntimeInformationHH %
.HH% &
IsOSPlatformHH& 2
(HH2 3

OSPlatformHH3 =
.HH= >
WindowsHH> E
)HHE F
||HHG I
RuntimeInformationHHJ \
.HH\ ]
IsOSPlatformHH] i
(HHi j

OSPlatformHHj t
.HHt u
LinuxHHu z
)HHz {
||HH| ~
RuntimeInformation	HH ë
.
HHë í
IsOSPlatform
HHí û
(
HHû ü

OSPlatform
HHü ©
.
HH© ™
OSX
HH™ ≠
)
HH≠ Æ
;
HHÆ Ø
}II 	
publicTT 
FileSystemObjectTT &
FilePathToFileSystemObjectTT  :
(TT: ;
stringTT; A
pathTTB F
)TTF G
{UU 	
FileSystemObjectVV 
objVV  
=VV! "
newVV# &
FileSystemObjectVV' 7
(VV7 8
pathVV8 <
)VV< =
;VV= >
ifYY 
(YY 
RuntimeInformationYY "
.YY" #
IsOSPlatformYY# /
(YY/ 0

OSPlatformYY0 :
.YY: ;
WindowsYY; B
)YYB C
)YYC D
{ZZ 
try[[ 
{\\ 
var]] 
fileSecurity]] $
=]]% &
new]]' *
FileSecurity]]+ 7
(]]7 8
path]]8 <
,]]< =!
AccessControlSections]]> S
.]]S T
Owner]]T Y
)]]Y Z
;]]Z [
IdentityReference^^ %
?^^% &
oid^^' *
=^^+ ,
fileSecurity^^- 9
.^^9 :
GetOwner^^: B
(^^B C
typeof^^C I
(^^I J
SecurityIdentifier^^J \
)^^\ ]
)^^] ^
;^^^ _
obj__ 
.__ 
Owner__ 
=__ 

AsaHelpers__  *
.__* +
	SidToName__+ 4
(__4 5
oid__5 8
)__8 9
;__9 :
}`` 
catchaa 
(aa 
	Exceptionaa  
eaa! "
)aa" #
{bb 
Logcc 
.cc 
Verbosecc 
(cc  
$strcc  G
,ccG H
pathccI M
,ccM N
eccO P
.ccP Q
GetTypeccQ X
(ccX Y
)ccY Z
,ccZ [
ecc\ ]
.cc] ^
Messagecc^ e
)cce f
;ccf g
}dd 
tryee 
{ff 
vargg 
fileSecuritygg $
=gg% &
newgg' *
FileSecuritygg+ 7
(gg7 8
pathgg8 <
,gg< =!
AccessControlSectionsgg> S
.ggS T
GroupggT Y
)ggY Z
;ggZ [
IdentityReferencehh %
?hh% &
gidhh' *
=hh+ ,
fileSecurityhh- 9
.hh9 :
GetGrouphh: B
(hhB C
typeofhhC I
(hhI J
SecurityIdentifierhhJ \
)hh\ ]
)hh] ^
;hh^ _
objii 
.ii 
Groupii 
=ii 

AsaHelpersii  *
.ii* +
	SidToNameii+ 4
(ii4 5
gidii5 8
)ii8 9
;ii9 :
}jj 
catchkk 
(kk 
	Exceptionkk  
ekk! "
)kk" #
{ll 
Logmm 
.mm 
Verbosemm 
(mm  
$strmm  G
,mmG H
pathmmI M
,mmM N
emmO P
.mmP Q
GetTypemmQ X
(mmX Y
)mmY Z
,mmZ [
emm\ ]
.mm] ^
Messagemm^ e
)mme f
;mmf g
}nn 
tryoo 
{pp 
varqq 
fileSecurityqq $
=qq% &
newqq' *
FileSecurityqq+ 7
(qq7 8
pathqq8 <
,qq< =!
AccessControlSectionsqq> S
.qqS T
AccessqqT Z
)qqZ [
;qq[ \
varrr 
rulesrr 
=rr 
fileSecurityrr  ,
.rr, -
GetAccessRulesrr- ;
(rr; <
truerr< @
,rr@ A
truerrB F
,rrF G
typeofrrH N
(rrN O
SecurityIdentifierrrO a
)rra b
)rrb c
;rrc d
objss 
.ss 
Permissionsss #
=ss$ %
newss& )

Dictionaryss* 4
<ss4 5
stringss5 ;
,ss; <
stringss= C
>ssC D
(ssD E
)ssE F
;ssF G
foreachtt 
(tt  
FileSystemAccessRulett 1
?tt1 2
rulett3 7
intt8 :
rulestt; @
)tt@ A
{uu 
ifvv 
(vv 
rulevv  
!=vv! #
nullvv$ (
)vv( )
{ww 
stringxx "
namexx# '
=xx( )

AsaHelpersxx* 4
.xx4 5
	SidToNamexx5 >
(xx> ?
rulexx? C
.xxC D
IdentityReferencexxD U
)xxU V
;xxV W
foreachzz #
(zz$ %
varzz% (

permissionzz) 3
inzz4 6
rulezz7 ;
.zz; <
FileSystemRightszz< L
.zzL M
ToStringzzM U
(zzU V
)zzV W
.zzW X
SplitzzX ]
(zz] ^
$charzz^ a
)zza b
)zzb c
{{{ 
if||  "
(||# $
obj||$ '
.||' (
Permissions||( 3
.||3 4
ContainsKey||4 ?
(||? @
name||@ D
)||D E
)||E F
{}}  !
obj~~$ '
.~~' (
Permissions~~( 3
[~~3 4
name~~4 8
]~~8 9
=~~: ;
$"~~< >
{~~> ?
obj~~? B
.~~B C
Permissions~~C N
[~~N O
name~~O S
]~~S T
}~~T U
$str~~U V
{~~V W

permission~~W a
}~~a b
"~~b c
;~~c d
}  !
else
ÄÄ  $
{
ÅÅ  !
obj
ÇÇ$ '
.
ÇÇ' (
Permissions
ÇÇ( 3
.
ÇÇ3 4
Add
ÇÇ4 7
(
ÇÇ7 8
name
ÇÇ8 <
,
ÇÇ< =

permission
ÇÇ> H
)
ÇÇH I
;
ÇÇI J
}
ÉÉ  !
}
ÑÑ 
}
ÖÖ 
}
ÜÜ 
}
áá 
catch
àà 
(
àà 
	Exception
àà  
e
àà! "
)
àà" #
{
ââ 
Log
ää 
.
ää 
Verbose
ää 
(
ää  
$str
ää  N
,
ääN O
path
ääP T
,
ääT U
e
ääV W
.
ääW X
GetType
ääX _
(
ää_ `
)
ää` a
,
ääa b
e
ääc d
.
ääd e
Message
ääe l
)
ääl m
;
ääm n
}
ãã 
}
åå 
else
çç 
if
çç 
(
çç  
RuntimeInformation
çç '
.
çç' (
IsOSPlatform
çç( 4
(
çç4 5

OSPlatform
çç5 ?
.
çç? @
Linux
çç@ E
)
ççE F
||
ççG I 
RuntimeInformation
ççJ \
.
çç\ ]
IsOSPlatform
çç] i
(
ççi j

OSPlatform
ççj t
.
ççt u
OSX
ççu x
)
ççx y
)
ççy z
{
éé 
try
èè 
{
êê 
var
ëë 
file
ëë 
=
ëë 
new
ëë ""
UnixSymbolicLinkInfo
ëë# 7
(
ëë7 8
path
ëë8 <
)
ëë< =
;
ëë= >
obj
íí 
.
íí 
Owner
íí 
=
íí 
file
íí  $
.
íí$ %
	OwnerUser
íí% .
.
íí. /
UserName
íí/ 7
;
íí7 8
obj
ìì 
.
ìì 
Group
ìì 
=
ìì 
file
ìì  $
.
ìì$ %

OwnerGroup
ìì% /
.
ìì/ 0
	GroupName
ìì0 9
;
ìì9 :
obj
îî 
.
îî 
SetGid
îî 
=
îî  
file
îî! %
.
îî% &

IsSetGroup
îî& 0
;
îî0 1
obj
ïï 
.
ïï 
SetUid
ïï 
=
ïï  
file
ïï! %
.
ïï% &
	IsSetUser
ïï& /
;
ïï/ 0
obj
óó 
.
óó 
Permissions
óó #
=
óó$ %
new
óó& )

Dictionary
óó* 4
<
óó4 5
string
óó5 ;
,
óó; <
string
óó= C
>
óóC D
(
óóD E
)
óóE F
;
óóF G
if
òò 
(
òò 
file
òò 
.
òò #
FileAccessPermissions
òò 2
.
òò2 3
ToString
òò3 ;
(
òò; <
)
òò< =
.
òò= >
Equals
òò> D
(
òòD E
$str
òòE U
,
òòU V
StringComparison
òòW g
.
òòg h
InvariantCulture
òòh x
)
òòx y
)
òòy z
{
ôô 
obj
öö 
.
öö 
Permissions
öö '
.
öö' (
Add
öö( +
(
öö+ ,
$str
öö, 2
,
öö2 3
$str
öö4 H
)
ööH I
;
ööI J
obj
õõ 
.
õõ 
Permissions
õõ '
.
õõ' (
Add
õõ( +
(
õõ+ ,
$str
õõ, 3
,
õõ3 4
$str
õõ5 I
)
õõI J
;
õõJ K
obj
úú 
.
úú 
Permissions
úú '
.
úú' (
Add
úú( +
(
úú+ ,
$str
úú, 3
,
úú3 4
$str
úú5 I
)
úúI J
;
úúJ K
}
ùù 
else
ûû 
{
üü 
var
†† 
keys
††  
=
††! "
new
††# &
List
††' +
<
††+ ,
string
††, 2
>
††2 3
(
††3 4
)
††4 5
{
††6 7
$str
††8 >
,
††> ?
$str
††@ G
,
††G H
$str
††I P
}
††Q R
;
††R S
var
°° 
splits
°° "
=
°°# $
file
°°% )
.
°°) *#
FileAccessPermissions
°°* ?
.
°°? @
ToString
°°@ H
(
°°H I
)
°°I J
.
°°J K
Split
°°K P
(
°°P Q
$char
°°Q T
)
°°T U
.
°°U V
Select
°°V \
(
°°\ ]
x
°°] ^
=>
°°_ a
x
°°b c
.
°°c d
Trim
°°d h
(
°°h i
)
°°i j
)
°°j k
;
°°k l
foreach
¢¢ 
(
¢¢  !
var
¢¢! $
key
¢¢% (
in
¢¢) +
keys
¢¢, 0
)
¢¢0 1
{
££ 
foreach
§§ #
(
§§$ %
var
§§% (

permission
§§) 3
in
§§4 6
splits
§§7 =
.
§§= >
Where
§§> C
(
§§C D
(
§§D E
x
§§E F
)
§§F G
=>
§§H J
x
§§K L
.
§§L M

StartsWith
§§M W
(
§§W X
key
§§X [
,
§§[ \
StringComparison
§§] m
.
§§m n
InvariantCulture
§§n ~
)
§§~ 
)§§ Ä
)§§Ä Å
{
•• 
if
¶¶  "
(
¶¶# $

permission
¶¶$ .
.
¶¶. /
Contains
¶¶/ 7
(
¶¶7 8
$str
¶¶8 J
,
¶¶J K
StringComparison
¶¶L \
.
¶¶\ ]
InvariantCulture
¶¶] m
)
¶¶m n
)
¶¶n o
{
ßß  !
obj
®®$ '
.
®®' (
Permissions
®®( 3
.
®®3 4
Add
®®4 7
(
®®7 8
key
®®8 ;
,
®®; <
$str
®®= Q
)
®®Q R
;
®®R S
}
©©  !
else
™™  $
{
´´  !
if
¨¨$ &
(
¨¨' (
obj
¨¨( +
.
¨¨+ ,
Permissions
¨¨, 7
.
¨¨7 8
ContainsKey
¨¨8 C
(
¨¨C D
key
¨¨D G
)
¨¨G H
)
¨¨H I
{
≠≠$ %
obj
ÆÆ( +
.
ÆÆ+ ,
Permissions
ÆÆ, 7
[
ÆÆ7 8
key
ÆÆ8 ;
]
ÆÆ; <
=
ÆÆ= >
$"
ÆÆ? A
{
ÆÆA B
obj
ÆÆB E
.
ÆÆE F
Permissions
ÆÆF Q
[
ÆÆQ R
key
ÆÆR U
]
ÆÆU V
}
ÆÆV W
$str
ÆÆW X
{
ÆÆX Y

permission
ÆÆY c
.
ÆÆc d
Trim
ÆÆd h
(
ÆÆh i
)
ÆÆi j
.
ÆÆj k
	Substring
ÆÆk t
(
ÆÆt u
key
ÆÆu x
.
ÆÆx y
Length
ÆÆy 
)ÆÆ Ä
}ÆÆÄ Å
"ÆÆÅ Ç
;ÆÆÇ É
}
ØØ$ %
else
∞∞$ (
{
±±$ %
obj
≤≤( +
.
≤≤+ ,
Permissions
≤≤, 7
.
≤≤7 8
Add
≤≤8 ;
(
≤≤; <
key
≤≤< ?
,
≤≤? @

permission
≤≤A K
.
≤≤K L
Trim
≤≤L P
(
≤≤P Q
)
≤≤Q R
.
≤≤R S
	Substring
≤≤S \
(
≤≤\ ]
key
≤≤] `
.
≤≤` a
Length
≤≤a g
)
≤≤g h
)
≤≤h i
;
≤≤i j
}
≥≥$ %
}
¥¥  !
}
µµ 
}
∂∂ 
}
∑∑ 
}
∏∏ 
catch
ππ 
(
ππ 
	Exception
ππ  
e
ππ! "
)
ππ" #
when
ππ$ (
(
ππ) *
e
∫∫ 
is
∫∫ #
ArgumentNullException
∫∫ .
||
ªª 
e
ªª 
is
ªª 
ArgumentException
ªª -
||
ºº 
e
ºº 
is
ºº '
InvalidOperationException
ºº 5
)
ºº5 6
{
ΩΩ 
Log
ææ 
.
ææ 
Verbose
ææ 
(
ææ  
$str
ææ  M
,
ææM N
path
ææO S
,
ææS T
e
ææU V
.
ææV W
GetType
ææW ^
(
ææ^ _
)
ææ_ `
,
ææ` a
e
ææb c
.
ææc d
Message
ææd k
)
ææk l
;
ææl m
}
øø 
}
¿¿ 
try
¬¬ 
{
√√ 
if
ƒƒ 
(
ƒƒ  
RuntimeInformation
ƒƒ &
.
ƒƒ& '
IsOSPlatform
ƒƒ' 3
(
ƒƒ3 4

OSPlatform
ƒƒ4 >
.
ƒƒ> ?
Windows
ƒƒ? F
)
ƒƒF G
)
ƒƒG H
{
≈≈ 
if
∆∆ 
(
∆∆ 
	Directory
∆∆ !
.
∆∆! "
Exists
∆∆" (
(
∆∆( )
path
∆∆) -
)
∆∆- .
)
∆∆. /
{
«« 
var
»» 
fileInfo
»» $
=
»»% &
new
»»' *
DirectoryInfo
»»+ 8
(
»»8 9
path
»»9 =
)
»»= >
;
»»> ?
if
…… 
(
…… 
fileInfo
…… $
.
……$ %

Attributes
……% /
.
……/ 0
HasFlag
……0 7
(
……7 8
FileAttributes
……8 F
.
……F G
ReparsePoint
……G S
)
……S T
)
……T U
{
   
obj
ÀÀ 
.
ÀÀ  
IsLink
ÀÀ  &
=
ÀÀ' (
true
ÀÀ) -
;
ÀÀ- .
obj
ÃÃ 
.
ÃÃ  
Target
ÃÃ  &
=
ÃÃ' (
NativeMethods
ÃÃ) 6
.
ÃÃ6 7
GetFinalPathName
ÃÃ7 G
(
ÃÃG H
path
ÃÃH L
)
ÃÃL M
;
ÃÃM N
}
ÕÕ 
else
ŒŒ 
{
œœ 
obj
–– 
.
––  
IsDirectory
––  +
=
––, -
true
––. 2
;
––2 3
}
—— 
}
““ 
else
”” 
{
‘‘ 
var
’’ 
fileInfo
’’ $
=
’’% &
new
’’' *
FileInfo
’’+ 3
(
’’3 4
path
’’4 8
)
’’8 9
;
’’9 :
obj
÷÷ 
.
÷÷ 
Size
÷÷  
=
÷÷! "
fileInfo
÷÷# +
.
÷÷+ ,
Length
÷÷, 2
;
÷÷2 3
obj
◊◊ 
.
◊◊ 

SizeOnDisk
◊◊ &
=
◊◊' (
WindowsSizeOnDisk
◊◊) :
(
◊◊: ;
fileInfo
◊◊; C
)
◊◊C D
;
◊◊D E
if
‹‹ 
(
‹‹ 
opts
‹‹  
.
‹‹  !
DownloadCloud
‹‹! .
||
‹‹/ 1
obj
‹‹2 5
.
‹‹5 6

SizeOnDisk
‹‹6 @
>
‹‹A B
$num
‹‹C D
||
‹‹E G$
WindowsFileSystemUtils
‹‹H ^
.
‹‹^ _
IsLocal
‹‹_ f
(
‹‹f g
obj
‹‹g j
.
‹‹j k
Path
‹‹k o
)
‹‹o p
)
‹‹p q
{
›› 
obj
ﬁﬁ 
.
ﬁﬁ  
LastModified
ﬁﬁ  ,
=
ﬁﬁ- .
File
ﬁﬁ/ 3
.
ﬁﬁ3 4!
GetLastWriteTimeUtc
ﬁﬁ4 G
(
ﬁﬁG H
path
ﬁﬁH L
)
ﬁﬁL M
;
ﬁﬁM N
obj
ﬂﬂ 
.
ﬂﬂ  
Created
ﬂﬂ  '
=
ﬂﬂ( )
File
ﬂﬂ* .
.
ﬂﬂ. / 
GetCreationTimeUtc
ﬂﬂ/ A
(
ﬂﬂA B
path
ﬂﬂB F
)
ﬂﬂF G
;
ﬂﬂG H
if
·· 
(
··  
opts
··  $
.
··$ %
GatherHashes
··% 1
==
··2 4
true
··5 9
)
··9 :
{
‚‚ 
obj
„„  #
.
„„# $
ContentHash
„„$ /
=
„„0 1
FileSystemUtils
„„2 A
.
„„A B
GetFileHash
„„B M
(
„„M N
fileInfo
„„N V
)
„„V W
;
„„W X
}
‰‰ 
var
ÊÊ 
exeType
ÊÊ  '
=
ÊÊ( )
FileSystemUtils
ÊÊ* 9
.
ÊÊ9 :
GetExecutableType
ÊÊ: K
(
ÊÊK L
path
ÊÊL P
)
ÊÊP Q
;
ÊÊQ R
if
ËË 
(
ËË  
exeType
ËË  '
!=
ËË( *
EXECUTABLE_TYPE
ËË+ :
.
ËË: ;
NONE
ËË; ?
&&
ËË@ B
exeType
ËËC J
!=
ËËK M
EXECUTABLE_TYPE
ËËN ]
.
ËË] ^
UNKNOWN
ËË^ e
)
ËËe f
{
ÈÈ 
obj
ÍÍ  #
.
ÍÍ# $
IsExecutable
ÍÍ$ 0
=
ÍÍ1 2
true
ÍÍ3 7
;
ÍÍ7 8
}
ÎÎ 
if
ÌÌ 
(
ÌÌ  
exeType
ÌÌ  '
==
ÌÌ( *
EXECUTABLE_TYPE
ÌÌ+ :
.
ÌÌ: ;
WINDOWS
ÌÌ; B
)
ÌÌB C
{
ÓÓ 
obj
ÔÔ  #
.
ÔÔ# $
SignatureStatus
ÔÔ$ 3
=
ÔÔ4 5$
WindowsFileSystemUtils
ÔÔ6 L
.
ÔÔL M 
GetSignatureStatus
ÔÔM _
(
ÔÔ_ `
path
ÔÔ` d
)
ÔÔd e
;
ÔÔe f
obj
  #
.
# $
Characteristics
$ 3
=
4 5$
WindowsFileSystemUtils
6 L
.
L M#
GetDllCharacteristics
M b
(
b c
path
c g
)
g h
;
h i
}
ÒÒ 
else
ÚÚ  
if
ÚÚ! #
(
ÚÚ$ %
exeType
ÚÚ% ,
==
ÚÚ- /
EXECUTABLE_TYPE
ÚÚ0 ?
.
ÚÚ? @
MACOS
ÚÚ@ E
)
ÚÚE F
{
ÛÛ 
obj
ÙÙ  #
.
ÙÙ# $ 
MacSignatureStatus
ÙÙ$ 6
=
ÙÙ7 8
FileSystemUtils
ÙÙ9 H
.
ÙÙH I
GetMacSignature
ÙÙI X
(
ÙÙX Y
path
ÙÙY ]
)
ÙÙ] ^
;
ÙÙ^ _
}
ıı 
}
ˆˆ 
}
˜˜ 
}
¯¯ 
else
˘˘ 
{
˙˙ "
UnixSymbolicLinkInfo
˚˚ (
i
˚˚) *
=
˚˚+ ,
new
˚˚- 0"
UnixSymbolicLinkInfo
˚˚1 E
(
˚˚E F
path
˚˚F J
)
˚˚J K
;
˚˚K L
obj
¸¸ 
.
¸¸ 
FileType
¸¸  
=
¸¸! "
i
¸¸# $
.
¸¸$ %
FileType
¸¸% -
.
¸¸- .
ToString
¸¸. 6
(
¸¸6 7
)
¸¸7 8
;
¸¸8 9
obj
˝˝ 
.
˝˝ 
Size
˝˝ 
=
˝˝ 
i
˝˝  
.
˝˝  !
Length
˝˝! '
;
˝˝' (
obj
˛˛ 
.
˛˛ 
IsDirectory
˛˛ #
=
˛˛$ %
false
˛˛& +
;
˛˛+ ,
switch
ˇˇ 
(
ˇˇ 
i
ˇˇ 
.
ˇˇ 
FileType
ˇˇ &
)
ˇˇ& '
{
ÄÄ 
case
ÅÅ 
	FileTypes
ÅÅ &
.
ÅÅ& '
SymbolicLink
ÅÅ' 3
:
ÅÅ3 4
obj
ÇÇ 
.
ÇÇ  
IsLink
ÇÇ  &
=
ÇÇ' (
true
ÇÇ) -
;
ÇÇ- .
obj
ÉÉ 
.
ÉÉ  
Target
ÉÉ  &
=
ÉÉ' (
i
ÉÉ) *
.
ÉÉ* +
ContentsPath
ÉÉ+ 7
;
ÉÉ7 8
break
ÑÑ !
;
ÑÑ! "
case
ÜÜ 
	FileTypes
ÜÜ &
.
ÜÜ& '
Fifo
ÜÜ' +
:
ÜÜ+ ,
case
áá 
	FileTypes
áá &
.
áá& '
Socket
áá' -
:
áá- .
case
àà 
	FileTypes
àà &
.
àà& '
BlockDevice
àà' 2
:
àà2 3
case
ââ 
	FileTypes
ââ &
.
ââ& '
CharacterDevice
ââ' 6
:
ââ6 7
case
ää 
	FileTypes
ää &
.
ää& '
	Directory
ää' 0
:
ää0 1
obj
ãã 
.
ãã  
IsDirectory
ãã  +
=
ãã, -
true
ãã. 2
;
ãã2 3
if
åå 
(
åå  
path
åå  $
?
åå$ %
.
åå% &
EndsWith
åå& .
(
åå. /
$str
åå/ 5
,
åå5 6
StringComparison
åå7 G
.
ååG H(
InvariantCultureIgnoreCase
ååH b
)
ååb c
??
ååd f
false
ååg l
)
åål m
{
çç 
obj
éé  #
.
éé# $ 
MacSignatureStatus
éé$ 6
=
éé7 8
FileSystemUtils
éé9 H
.
ééH I
GetMacSignature
ééI X
(
ééX Y
path
ééY ]
)
éé] ^
;
éé^ _
}
èè 
break
êê !
;
êê! "
case
íí 
	FileTypes
íí &
.
íí& '
RegularFile
íí' 2
:
íí2 3
var
ìì 
fileInfo
ìì  (
=
ìì) *
new
ìì+ .
FileInfo
ìì/ 7
(
ìì7 8
path
ìì8 <
)
ìì< =
;
ìì= >
obj
îî 
.
îî  

SizeOnDisk
îî  *
=
îî+ ,
i
îî- .
.
îî. /
BlocksAllocated
îî/ >
*
îî? @
i
îîA B
.
îîB C
	BlockSize
îîC L
;
îîL M
if
ïï 
(
ïï  
opts
ïï  $
.
ïï$ %
DownloadCloud
ïï% 2
||
ïï3 5
obj
ïï6 9
.
ïï9 :

SizeOnDisk
ïï: D
>
ïïE F
$num
ïïG H
)
ïïH I
{
ññ 
obj
óó  #
.
óó# $
LastModified
óó$ 0
=
óó1 2
File
óó3 7
.
óó7 8!
GetLastWriteTimeUtc
óó8 K
(
óóK L
path
óóL P
)
óóP Q
;
óóQ R
obj
òò  #
.
òò# $
Created
òò$ +
=
òò, -
File
òò. 2
.
òò2 3 
GetCreationTimeUtc
òò3 E
(
òòE F
path
òòF J
)
òòJ K
;
òòK L
if
öö  "
(
öö# $
opts
öö$ (
.
öö( )
GatherHashes
öö) 5
)
öö5 6
{
õõ  !
obj
úú$ '
.
úú' (
ContentHash
úú( 3
=
úú4 5
FileSystemUtils
úú6 E
.
úúE F
GetFileHash
úúF Q
(
úúQ R
path
úúR V
)
úúV W
;
úúW X
}
ùù  !
var
üü  #
exeType
üü$ +
=
üü, -
FileSystemUtils
üü. =
.
üü= >
GetExecutableType
üü> O
(
üüO P
path
üüP T
)
üüT U
;
üüU V
if
°°  "
(
°°# $
exeType
°°$ +
!=
°°, .
EXECUTABLE_TYPE
°°/ >
.
°°> ?
NONE
°°? C
&&
°°D F
exeType
°°G N
!=
°°O Q
EXECUTABLE_TYPE
°°R a
.
°°a b
UNKNOWN
°°b i
)
°°i j
{
¢¢  !
obj
££$ '
.
££' (
IsExecutable
££( 4
=
££5 6
true
££7 ;
;
££; <
}
§§  !
if
¶¶  "
(
¶¶# $
exeType
¶¶$ +
==
¶¶, .
EXECUTABLE_TYPE
¶¶/ >
.
¶¶> ?
WINDOWS
¶¶? F
)
¶¶F G
{
ßß  !
obj
®®$ '
.
®®' (
SignatureStatus
®®( 7
=
®®8 9$
WindowsFileSystemUtils
®®: P
.
®®P Q 
GetSignatureStatus
®®Q c
(
®®c d
path
®®d h
)
®®h i
;
®®i j
obj
©©$ '
.
©©' (
Characteristics
©©( 7
=
©©8 9$
WindowsFileSystemUtils
©©: P
.
©©P Q#
GetDllCharacteristics
©©Q f
(
©©f g
path
©©g k
)
©©k l
;
©©l m
}
™™  !
else
´´  $
if
´´% '
(
´´( )
exeType
´´) 0
==
´´1 3
EXECUTABLE_TYPE
´´4 C
.
´´C D
MACOS
´´D I
)
´´I J
{
¨¨  !
obj
≠≠$ '
.
≠≠' ( 
MacSignatureStatus
≠≠( :
=
≠≠; <
FileSystemUtils
≠≠= L
.
≠≠L M
GetMacSignature
≠≠M \
(
≠≠\ ]
path
≠≠] a
)
≠≠a b
;
≠≠b c
}
ÆÆ  !
}
ØØ 
break
∞∞ !
;
∞∞! "
}
±± 
}
≤≤ 
}
≥≥ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
e
¥¥ 
)
¥¥ 
when
¥¥  $
(
¥¥% &
e
µµ 
is
µµ #
ArgumentNullException
µµ *
||
µµ+ -
e
∂∂ 
is
∂∂ 
SecurityException
∂∂ &
||
∂∂' )
e
∑∑ 
is
∑∑ 
ArgumentException
∑∑ &
||
∑∑' )
e
∏∏ 
is
∏∏ )
UnauthorizedAccessException
∏∏ 0
||
∏∏1 3
e
ππ 
is
ππ "
PathTooLongException
ππ )
||
ππ* ,
e
∫∫ 
is
∫∫ #
NotSupportedException
∫∫ *
||
∫∫+ -
e
ªª 
is
ªª '
InvalidOperationException
ªª .
||
ªª/ 1
e
ºº 
is
ºº #
FileNotFoundException
ºº *
||
ºº+ -
e
ΩΩ 
is
ΩΩ 
Win32Exception
ΩΩ #
||
ΩΩ$ &
e
ææ 
is
ææ 
IOException
ææ  
)
ææ  !
{
øø 
Log
¿¿ 
.
¿¿ 
Verbose
¿¿ 
(
¿¿ 
$str
¿¿ R
,
¿¿R S
path
¿¿T X
,
¿¿X Y
e
¿¿Z [
.
¿¿[ \
GetType
¿¿\ c
(
¿¿c d
)
¿¿d e
,
¿¿e f
e
¿¿g h
.
¿¿h i
Message
¿¿i p
)
¿¿p q
;
¿¿q r
}
¡¡ 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
e
¬¬ 
)
¬¬ 
{
√√ 
Log
ƒƒ 
.
ƒƒ 
Debug
ƒƒ 
(
ƒƒ 
$str
ƒƒ G
,
ƒƒG H
e
ƒƒI J
.
ƒƒJ K
GetType
ƒƒK R
(
ƒƒR S
)
ƒƒS T
.
ƒƒT U
ToString
ƒƒU ]
(
ƒƒ] ^
)
ƒƒ^ _
,
ƒƒ_ `
path
ƒƒa e
)
ƒƒe f
;
ƒƒf g
}
≈≈ 
if
«« 
(
«« 
path
«« 
is
«« 
not
«« 
null
««  
)
««  !
{
»» 
try
…… 
{
   
obj
ÀÀ 
.
ÀÀ 
LastModified
ÀÀ $
=
ÀÀ% &
File
ÀÀ' +
.
ÀÀ+ ,!
GetLastWriteTimeUtc
ÀÀ, ?
(
ÀÀ? @
path
ÀÀ@ D
)
ÀÀD E
;
ÀÀE F
obj
ÃÃ 
.
ÃÃ 
Created
ÃÃ 
=
ÃÃ  !
File
ÃÃ" &
.
ÃÃ& ' 
GetCreationTimeUtc
ÃÃ' 9
(
ÃÃ9 :
path
ÃÃ: >
)
ÃÃ> ?
;
ÃÃ? @
}
ÕÕ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ  
e
ŒŒ! "
)
ŒŒ" #
{
œœ 
Log
–– 
.
–– 
Verbose
–– 
(
––  
$str
––  O
,
––O P
path
––Q U
,
––U V
e
––W X
.
––X Y
GetType
––Y `
(
––` a
)
––a b
,
––b c
e
––d e
.
––e f
Message
––f m
)
––m n
;
––n o
}
—— 
}
““ 
return
‘‘ 
obj
‘‘ 
;
‘‘ 
}
’’ 	
internal
◊◊ 
override
◊◊ 
void
◊◊ 
ExecuteInternal
◊◊ .
(
◊◊. /
CancellationToken
◊◊/ @
cancellationToken
◊◊A R
)
◊◊R S
{
ÿÿ 	
foreach
ŸŸ 
(
ŸŸ 
var
ŸŸ 
Root
ŸŸ 
in
ŸŸ  
Roots
ŸŸ! &
.
ŸŸ& '
Where
ŸŸ' ,
(
ŸŸ, -
x
ŸŸ- .
=>
ŸŸ/ 1
!
ŸŸ2 3
opts
ŸŸ3 7
.
ŸŸ7 8
SkipDirectories
ŸŸ8 G
.
ŸŸG H
Any
ŸŸH K
(
ŸŸK L
y
ŸŸL M
=>
ŸŸN P
x
ŸŸQ R
.
ŸŸR S

StartsWith
ŸŸS ]
(
ŸŸ] ^
y
ŸŸ^ _
)
ŸŸ_ `
)
ŸŸ` a
)
ŸŸa b
)
ŸŸb c
{
⁄⁄ 
Log
€€ 
.
€€ 
Information
€€ 
(
€€  
$str
€€  .
,
€€. /
Strings
€€0 7
.
€€7 8
Get
€€8 ;
(
€€; <
$str
€€< F
)
€€F G
,
€€G H
Root
€€I M
)
€€M N
;
€€N O
var
‹‹ 
directories
‹‹ 
=
‹‹  !
	Directory
‹‹" +
.
‹‹+ ,"
EnumerateDirectories
‹‹, @
(
‹‹@ A
Root
‹‹A E
,
‹‹E F
$str
‹‹G J
,
‹‹J K
new
‹‹L O
System
‹‹P V
.
‹‹V W
IO
‹‹W Y
.
‹‹Y Z 
EnumerationOptions
‹‹Z l
(
‹‹l m
)
‹‹m n
{
›› &
ReturnSpecialDirectories
ﬁﬁ ,
=
ﬁﬁ- .
false
ﬁﬁ/ 4
,
ﬁﬁ4 5 
IgnoreInaccessible
ﬂﬂ &
=
ﬂﬂ' (
true
ﬂﬂ) -
,
ﬂﬂ- .#
RecurseSubdirectories
‡‡ )
=
‡‡* +
true
‡‡, 0
}
·· 
)
·· 
.
·· 
Where
·· 
(
·· 
x
·· 
=>
·· 
!
·· 
opts
·· #
.
··# $
SkipDirectories
··$ 3
.
··3 4
Any
··4 7
(
··7 8
y
··8 9
=>
··: <
x
··= >
.
··> ?

StartsWith
··? I
(
··I J
y
··J K
)
··K L
)
··L M
)
··M N
;
··N O#
TryIterateOnDirectory
‰‰ %
(
‰‰% &
Root
‰‰& *
)
‰‰* +
;
‰‰+ ,
if
ÊÊ 
(
ÊÊ 
!
ÊÊ 
opts
ÊÊ 
.
ÊÊ 
SingleThread
ÊÊ &
==
ÊÊ' )
true
ÊÊ* .
)
ÊÊ. /
{
ÁÁ 
ParallelOptions
ËË #
po
ËË$ &
=
ËË' (
new
ËË) ,
ParallelOptions
ËË- <
(
ËË< =
)
ËË= >
{
ËË? @
CancellationToken
ËËA R
=
ËËS T
cancellationToken
ËËU f
}
ËËg h
;
ËËh i
Parallel
ÈÈ 
.
ÈÈ 
ForEach
ÈÈ $
(
ÈÈ$ %
directories
ÈÈ% 0
,
ÈÈ0 1
po
ÈÈ2 4
,
ÈÈ4 5
filePath
ÈÈ6 >
=>
ÈÈ? A
{
ÍÍ #
TryIterateOnDirectory
ÎÎ -
(
ÎÎ- .
filePath
ÎÎ. 6
)
ÎÎ6 7
;
ÎÎ7 8
}
ÏÏ 
)
ÏÏ 
;
ÏÏ 
}
ÌÌ 
else
ÓÓ 
{
ÔÔ 
foreach
 
(
 
var
  
filePath
! )
in
* ,
directories
- 8
)
8 9
{
ÒÒ 
if
ÚÚ 
(
ÚÚ 
cancellationToken
ÚÚ -
.
ÚÚ- .%
IsCancellationRequested
ÚÚ. E
)
ÚÚE F
{
ÛÛ 
break
ÙÙ !
;
ÙÙ! "
}
ıı #
TryIterateOnDirectory
ˆˆ -
(
ˆˆ- .
filePath
ˆˆ. 6
)
ˆˆ6 7
;
ˆˆ7 8
}
˜˜ 
}
¯¯ 
}
˘˘ 
}
˙˙ 	
private
¸¸ 
static
¸¸ 
long
¸¸ 
WindowsSizeOnDisk
¸¸ -
(
¸¸- .
FileInfo
¸¸. 6
path
¸¸7 ;
)
¸¸; <
{
˝˝ 	
if
˛˛ 
(
˛˛  
RuntimeInformation
˛˛ "
.
˛˛" #
IsOSPlatform
˛˛# /
(
˛˛/ 0

OSPlatform
˛˛0 :
.
˛˛: ;
Windows
˛˛; B
)
˛˛B C
)
˛˛C D
{
ˇˇ 
try
ÄÄ 
{
ÅÅ 
uint
ÇÇ 
clusterSize
ÇÇ $
=
ÇÇ% &
$num
ÇÇ' (
;
ÇÇ( )
var
ÉÉ 
root
ÉÉ 
=
ÉÉ 
path
ÉÉ #
.
ÉÉ# $
	Directory
ÉÉ$ -
?
ÉÉ- .
.
ÉÉ. /
Root
ÉÉ/ 3
.
ÉÉ3 4
FullName
ÉÉ4 <
;
ÉÉ< =
if
ÑÑ 
(
ÑÑ 
root
ÑÑ 
is
ÑÑ 
null
ÑÑ  $
)
ÑÑ$ %
{
ÖÖ 
throw
ÜÜ 
new
ÜÜ !#
ArgumentNullException
ÜÜ" 7
(
ÜÜ7 8
nameof
ÜÜ8 >
(
ÜÜ> ?
path
ÜÜ? C
.
ÜÜC D
	Directory
ÜÜD M
)
ÜÜM N
)
ÜÜN O
;
ÜÜO P
}
áá 
if
àà 
(
àà 
!
àà 
ClusterSizes
àà %
.
àà% &
ContainsKey
àà& 1
(
àà1 2
root
àà2 6
)
àà6 7
)
àà7 8
{
ââ 
NativeMethods
ää %
.
ää% &
GetDiskFreeSpace
ää& 6
(
ää6 7
root
ää7 ;
,
ää; <
out
ää= @
uint
ääA E!
lpSectorsPerCluster
ääF Y
,
ääY Z
out
ää[ ^
uint
ää_ c
lpBytesPerSector
ääd t
,
äät u
out
ääv y
_
ääz {
,
ää{ |
outää} Ä
_ääÅ Ç
)ääÇ É
;ääÉ Ñ
ClusterSizes
ãã $
[
ãã$ %
root
ãã% )
]
ãã) *
=
ãã+ ,!
lpSectorsPerCluster
ãã- @
*
ããA B
lpBytesPerSector
ããC S
;
ããS T
}
åå 
clusterSize
çç 
=
çç  !
ClusterSizes
çç" .
[
çç. /
root
çç/ 3
]
çç3 4
;
çç4 5
if
èè 
(
èè 
clusterSize
èè #
>
èè$ %
$num
èè& '
)
èè' (
{
êê 
uint
ëë 
lowSize
ëë $
=
ëë% &
NativeMethods
ëë' 4
.
ëë4 5$
GetCompressedFileSizeW
ëë5 K
(
ëëK L
path
ëëL P
.
ëëP Q
FullName
ëëQ Y
,
ëëY Z
out
ëë[ ^
uint
ëë_ c
highSize
ëëd l
)
ëël m
;
ëëm n
long
íí 
size
íí !
=
íí" #
(
íí$ %
long
íí% )
)
íí) *
highSize
íí* 2
<<
íí3 5
$num
íí6 8
|
íí9 :
lowSize
íí; B
;
ííB C
return
ìì 
(
ìì  
(
ìì  !
size
ìì! %
+
ìì& '
clusterSize
ìì( 3
-
ìì4 5
$num
ìì6 7
)
ìì7 8
/
ìì9 :
clusterSize
ìì; F
)
ììF G
*
ììH I
clusterSize
ììJ U
;
ììU V
}
îî 
}
ïï 
catch
ññ 
(
ññ 
	Exception
ññ  
e
ññ! "
)
ññ" #
{
óó 
Log
òò 
.
òò 
Debug
òò 
(
òò 
$str
òò L
,
òòL M
path
òòN R
.
òòR S
FullName
òòS [
,
òò[ \
e
òò] ^
.
òò^ _
GetType
òò_ f
(
òòf g
)
òòg h
,
òòh i
e
òòj k
.
òòk l
Message
òòl s
)
òòs t
;
òòt u
}
ôô 
}
öö 
return
õõ 
-
õõ 
$num
õõ 
;
õõ 
}
úú 	
private
ûû 
FileSystemObject
ûû  )
FileEntryToFileSystemObject
ûû! <
(
ûû< =
	FileEntry
ûû= F
	fileEntry
ûûG P
)
ûûP Q
{
üü 	
var
†† 
fso
†† 
=
†† 
new
†† 
FileSystemObject
†† *
(
††* +
Path
††+ /
:
††/ 0
	fileEntry
††1 :
.
††: ;
FullPath
††; C
)
††C D
{
°° 
Size
¢¢ 
=
¢¢ 
	fileEntry
¢¢  
.
¢¢  !
Content
¢¢! (
.
¢¢( )
Length
¢¢) /
}
££ 
;
££ 
if
•• 
(
•• 
opts
•• 
.
•• 
GatherHashes
•• !
==
••" $
true
••% )
)
••) *
{
¶¶ 
fso
ßß 
.
ßß 
ContentHash
ßß 
=
ßß  !
CryptoHelpers
ßß" /
.
ßß/ 0

CreateHash
ßß0 :
(
ßß: ;
	fileEntry
ßß; D
.
ßßD E
Content
ßßE L
)
ßßL M
;
ßßM N
}
®® 
var
™™ 
exeType
™™ 
=
™™ 
FileSystemUtils
™™ )
.
™™) *
GetExecutableType
™™* ;
(
™™; <
	fileEntry
™™< E
.
™™E F
FullPath
™™F N
,
™™N O
	fileEntry
™™P Y
.
™™Y Z
Content
™™Z a
)
™™a b
;
™™b c
if
¨¨ 
(
¨¨ 
exeType
¨¨ 
!=
¨¨ 
EXECUTABLE_TYPE
¨¨ *
.
¨¨* +
NONE
¨¨+ /
&&
¨¨0 2
exeType
¨¨3 :
!=
¨¨; =
EXECUTABLE_TYPE
¨¨> M
.
¨¨M N
UNKNOWN
¨¨N U
)
¨¨U V
{
≠≠ 
fso
ÆÆ 
.
ÆÆ 
IsExecutable
ÆÆ  
=
ÆÆ! "
true
ÆÆ# '
;
ÆÆ' (
}
ØØ 
if
±± 
(
±± 
exeType
±± 
==
±± 
EXECUTABLE_TYPE
±± *
.
±±* +
WINDOWS
±±+ 2
)
±±2 3
{
≤≤ 
fso
≥≥ 
.
≥≥ 
SignatureStatus
≥≥ #
=
≥≥$ %$
WindowsFileSystemUtils
≥≥& <
.
≥≥< = 
GetSignatureStatus
≥≥= O
(
≥≥O P
	fileEntry
≥≥P Y
.
≥≥Y Z
FullPath
≥≥Z b
,
≥≥b c
	fileEntry
≥≥d m
.
≥≥m n
Content
≥≥n u
)
≥≥u v
;
≥≥v w
fso
¥¥ 
.
¥¥ 
Characteristics
¥¥ #
=
¥¥$ %$
WindowsFileSystemUtils
¥¥& <
.
¥¥< =#
GetDllCharacteristics
¥¥= R
(
¥¥R S
	fileEntry
¥¥S \
.
¥¥\ ]
FullPath
¥¥] e
,
¥¥e f
	fileEntry
¥¥g p
.
¥¥p q
Content
¥¥q x
)
¥¥x y
;
¥¥y z
}
µµ 
return
∑∑ 
fso
∑∑ 
;
∑∑ 
}
∏∏ 	
private
∫∫ 
void
∫∫ 
	ParseFile
∫∫ 
(
∫∫ 
string
∫∫ %
path
∫∫& *
)
∫∫* +
{
ªª 	
Log
ºº 
.
ºº 
Verbose
ºº 
(
ºº 
$str
ºº -
,
ºº- .
path
ºº/ 3
)
ºº3 4
;
ºº4 5
FileSystemObject
ΩΩ 
obj
ΩΩ  
=
ΩΩ! "(
FilePathToFileSystemObject
ΩΩ# =
(
ΩΩ= >
path
ΩΩ> B
)
ΩΩB C
;
ΩΩC D
if
ææ 
(
ææ 
obj
ææ 
!=
ææ 
null
ææ 
)
ææ 
{
øø 
HandleChange
¿¿ 
(
¿¿ 
obj
¿¿  
)
¿¿  !
;
¿¿! "
if
√√ 
(
√√ 
opts
√√ 
.
√√ 
CrawlArchives
√√ &
&&
√√' )
	MiniMagic
√√* 3
.
√√3 4
DetectFileType
√√4 B
(
√√B C
path
√√C G
)
√√G H
!=
√√I K
ArchiveFileType
√√L [
.
√√[ \
UNKNOWN
√√\ c
)
√√c d
{
ƒƒ 
var
≈≈ 
opts
≈≈ 
=
≈≈ 
new
≈≈ "
ExtractorOptions
≈≈# 3
(
≈≈3 4
)
≈≈4 5
{
≈≈6 7
ExtractSelfOnFail
≈≈8 I
=
≈≈J K
false
≈≈L Q
}
≈≈R S
;
≈≈S T
	Extractor
∆∆ 
	extractor
∆∆ '
=
∆∆( )
new
∆∆* -
	Extractor
∆∆. 7
(
∆∆7 8
)
∆∆8 9
;
∆∆9 :
foreach
«« 
(
«« 
var
««  
fso
««! $
in
««% '
	extractor
««( 1
.
««1 2
Extract
««2 9
(
««9 :
path
««: >
,
««> ?
opts
««@ D
)
««D E
.
««E F
Select
««F L
(
««L M
	fileEntry
««M V
=>
««W Y)
FileEntryToFileSystemObject
««Z u
(
««u v
	fileEntry
««v 
)«« Ä
)««Ä Å
)««Å Ç
{
»» 
HandleChange
…… $
(
……$ %
fso
……% (
)
……( )
;
……) *
}
   
}
ÀÀ 
if
ŒŒ 
(
ŒŒ 
path
ŒŒ 
.
ŒŒ 
EndsWith
ŒŒ !
(
ŒŒ! "
$str
ŒŒ" (
,
ŒŒ( )
StringComparison
ŒŒ* :
.
ŒŒ: ;
CurrentCulture
ŒŒ; I
)
ŒŒI J
||
ŒŒK M
path
œœ 
.
œœ 
EndsWith
œœ !
(
œœ! "
$str
œœ" (
,
œœ( )
StringComparison
œœ* :
.
œœ: ;
CurrentCulture
œœ; I
)
œœI J
||
œœK M
path
–– 
.
–– 
EndsWith
–– !
(
––! "
$str
––" (
,
––( )
StringComparison
––* :
.
––: ;
CurrentCulture
––; I
)
––I J
||
––K M
path
—— 
.
—— 
EndsWith
—— !
(
——! "
$str
——" (
,
——( )
StringComparison
——* :
.
——: ;
CurrentCulture
——; I
)
——I J
)
——J K
{
““ 
try
”” 
{
‘‘ 
using
’’ 
var
’’ !
certificate
’’" -
=
’’. /
new
’’0 3
X509Certificate2
’’4 D
(
’’D E
path
’’E I
)
’’I J
;
’’J K
var
◊◊ 
certObj
◊◊ #
=
◊◊$ %
new
◊◊& )
CertificateObject
◊◊* ;
(
◊◊; <
StoreLocation
ÿÿ )
:
ÿÿ) *
StoreLocation
ÿÿ+ 8
.
ÿÿ8 9
LocalMachine
ÿÿ9 E
.
ÿÿE F
ToString
ÿÿF N
(
ÿÿN O
)
ÿÿO P
,
ÿÿP Q
	StoreName
ŸŸ %
:
ŸŸ% &
	StoreName
ŸŸ' 0
.
ŸŸ0 1
Root
ŸŸ1 5
.
ŸŸ5 6
ToString
ŸŸ6 >
(
ŸŸ> ?
)
ŸŸ? @
,
ŸŸ@ A
Certificate
⁄⁄ '
:
⁄⁄' (
new
⁄⁄) ,%
SerializableCertificate
⁄⁄- D
(
⁄⁄D E
certificate
⁄⁄E P
)
⁄⁄P Q
)
⁄⁄Q R
;
⁄⁄R S
HandleChange
‹‹ $
(
‹‹$ %
certObj
‹‹% ,
)
‹‹, -
;
‹‹- .
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
	Exception
ﬁﬁ $
e
ﬁﬁ% &
)
ﬁﬁ& '
{
ﬂﬂ 
Log
‡‡ 
.
‡‡ 
Verbose
‡‡ #
(
‡‡# $
$str
‡‡$ Z
,
‡‡Z [
path
‡‡\ `
,
‡‡` a
e
‡‡b c
.
‡‡c d
GetType
‡‡d k
(
‡‡k l
)
‡‡l m
,
‡‡m n
e
‡‡o p
.
‡‡p q
Message
‡‡q x
)
‡‡x y
;
‡‡y z
}
·· 
}
‚‚ 
}
„„ 
Log
‰‰ 
.
‰‰ 
Verbose
‰‰ 
(
‰‰ 
$str
‰‰ .
,
‰‰. /
path
‰‰0 4
)
‰‰4 5
;
‰‰5 6
}
ÂÂ 	
private
ÁÁ 
void
ÁÁ #
TryIterateOnDirectory
ÁÁ *
(
ÁÁ* +
string
ÁÁ+ 1
path
ÁÁ2 6
)
ÁÁ6 7
{
ËË 	
try
ÈÈ 
{
ÍÍ 
Log
ÎÎ 
.
ÎÎ 
Verbose
ÎÎ 
(
ÎÎ 
$str
ÎÎ 1
,
ÎÎ1 2
path
ÎÎ3 7
)
ÎÎ7 8
;
ÎÎ8 9
var
ÌÌ 
files
ÌÌ 
=
ÌÌ 
	Directory
ÌÌ %
.
ÌÌ% &
EnumerateFiles
ÌÌ& 4
(
ÌÌ4 5
path
ÌÌ5 9
,
ÌÌ9 :
$str
ÌÌ; >
,
ÌÌ> ?
new
ÌÌ@ C
System
ÌÌD J
.
ÌÌJ K
IO
ÌÌK M
.
ÌÌM N 
EnumerationOptions
ÌÌN `
(
ÌÌ` a
)
ÌÌa b
{
ÓÓ  
IgnoreInaccessible
ÔÔ &
=
ÔÔ' (
true
ÔÔ) -
}
 
)
 
;
 
if
ÚÚ 
(
ÚÚ 
opts
ÚÚ 
.
ÚÚ 
SingleThread
ÚÚ %
)
ÚÚ% &
{
ÛÛ 
foreach
ÙÙ 
(
ÙÙ 
var
ÙÙ  
file
ÙÙ! %
in
ÙÙ& (
files
ÙÙ) .
)
ÙÙ. /
{
ıı 
	ParseFile
ˆˆ !
(
ˆˆ! "
file
ˆˆ" &
)
ˆˆ& '
;
ˆˆ' (
}
˜˜ 
}
¯¯ 
else
˘˘ 
{
˙˙ 
Parallel
˚˚ 
.
˚˚ 
ForEach
˚˚ $
(
˚˚$ %
files
˚˚% *
,
˚˚* +
file
˚˚, 0
=>
˚˚1 3
	ParseFile
˚˚4 =
(
˚˚= >
file
˚˚> B
)
˚˚B C
)
˚˚C D
;
˚˚D E
}
¸¸ 
}
˝˝ 
catch
˛˛ 
(
˛˛ 
	Exception
˛˛ 
e
˛˛ 
)
˛˛ 
{
ˇˇ 
Log
ÄÄ 
.
ÄÄ 
Verbose
ÄÄ 
(
ÄÄ 
$str
ÄÄ C
,
ÄÄC D
path
ÄÄE I
,
ÄÄI J
e
ÄÄK L
.
ÄÄL M
GetType
ÄÄM T
(
ÄÄT U
)
ÄÄU V
,
ÄÄV W
e
ÄÄX Y
.
ÄÄY Z
Message
ÄÄZ a
)
ÄÄa b
;
ÄÄb c
}
ÅÅ 
Log
ÇÇ 
.
ÇÇ 
Verbose
ÇÇ 
(
ÇÇ 
$str
ÇÇ .
,
ÇÇ. /
path
ÇÇ0 4
)
ÇÇ4 5
;
ÇÇ5 6
}
ÉÉ 	
}
ÑÑ 
}ÖÖ ˝Ê
OD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\FileSystemMonitor.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
FileSystemMonitor "
:# $
BaseMonitor% 0
,0 1
IDisposable2 =
{ 
private 
readonly 
List 
< 
FileSystemWatcher /
>/ 0
watchers1 9
=: ;
new< ?
List@ D
<D E
FileSystemWatcherE V
>V W
(W X
)X Y
;Y Z
private 
readonly  
ConcurrentDictionary -
<- .
string. 4
,4 5
FileSystemEventArgs6 I
>I J
filesAccessedK X
=Y Z
new[ ^ 
ConcurrentDictionary_ s
<s t
stringt z
,z { 
FileSystemEventArgs	| è
>
è ê
(
ê ë
)
ë í
;
í ì
private 
readonly 
Action 
<  
FileMonitorObject  1
>1 2
changeHandler3 @
;@ A
public 
static 
readonly 
NotifyFilters ,
[, -
]- .
defaultFiltersList/ A
=B C
newD G
NotifyFiltersH U
[U V
]V W
{ 	
NotifyFilters 
. 

Attributes $
,$ %
NotifyFilters 
. 
CreationTime &
,& '
NotifyFilters 
. 
DirectoryName '
,' (
NotifyFilters 
. 
FileName "
," #
NotifyFilters   
.   

LastAccess   $
,  $ %
NotifyFilters!! 
.!! 
	LastWrite!! #
,!!# $
NotifyFilters"" 
."" 
Security"" "
,""" #
NotifyFilters## 
.## 
Size## 
}$$ 	
;$$	 

private&& 
readonly&& !
MonitorCommandOptions&& .
options&&/ 6
;&&6 7
private(( 
readonly(( 
FileSystemCollector(( ,
fsc((- 0
;((0 1
public** 
override** 
void** 
StartRun** %
(**% &
)**& '
{++ 	
watchers,, 
.,, 
ForEach,, 
(,, 
x,, 
=>,, !
x,," #
.,,# $
EnableRaisingEvents,,$ 7
=,,8 9
true,,: >
),,> ?
;,,? @
	RunStatus-- 
=-- 

RUN_STATUS-- "
.--" #
RUNNING--# *
;--* +
}.. 	
public00 
override00 
void00 
StopRun00 $
(00$ %
)00% &
{11 	
watchers22 
.22 
ForEach22 
(22 
x22 
=>22 !
x22" #
.22# $
EnableRaisingEvents22$ 7
=228 9
false22: ?
)22? @
;22@ A
Parallel55 
.55 
ForEach55 
(55 
filesAccessed55 *
,55* +
e55, -
=>55. 0
{66 
var77 
ToWrite77 
=77 
new77 !
FileMonitorObject77" 3
(773 4
e774 5
.775 6
Value776 ;
.77; <
FullPath77< D
)77D E
{88 

ResultType99 
=99  
RESULT_TYPE99! ,
.99, -
FILEMONITOR99- 8
,998 9

ChangeType:: 
=::  (
ChangeTypeStringToChangeType::! =
(::= >
e::> ?
.::? @
Value::@ E
.::E F

ChangeType::F P
.::P Q
ToString::Q Y
(::Y Z
)::Z [
)::[ \
,::\ ]
Name;; 
=;; 
e;; 
.;; 
Value;; "
.;;" #
Name;;# '
,;;' (
	Timestamp<< 
=<< 
DateTime<<  (
.<<( )
Now<<) ,
.<<, -
ToString<<- 5
(<<5 6
$str<<6 9
,<<9 :
CultureInfo<<; F
.<<F G
InvariantCulture<<G W
)<<W X
,<<X Y
FileSystemObject== $
===% &
fsc==' *
.==* +&
FilePathToFileSystemObject==+ E
(==E F
e==F G
.==G H
Value==H M
.==M N
FullPath==N V
)==V W
,==W X
NotifyFilters>> !
=>>" #
NotifyFilters>>$ 1
.>>1 2

LastAccess>>2 <
}?? 
;?? 
changeHandler@@ 
(@@ 
ToWrite@@ %
)@@% &
;@@& '
}AA 
)AA 
;AA 
	RunStatusCC 
=CC 

RUN_STATUSCC "
.CC" #
	COMPLETEDCC# ,
;CC, -
}DD 	
publicFF 
overrideFF 
boolFF 
CanRunOnPlatformFF -
(FF- .
)FF. /
{GG 	
returnHH 
RuntimeInformationHH %
.HH% &
IsOSPlatformHH& 2
(HH2 3

OSPlatformHH3 =
.HH= >
WindowsHH> E
)HHE F
||HHG I
RuntimeInformationHHJ \
.HH\ ]
IsOSPlatformHH] i
(HHi j

OSPlatformHHj t
.HHt u
OSXHHu x
)HHx y
;HHy z
}II 	
publicKK 
FileSystemMonitorKK  
(KK  !!
MonitorCommandOptionsKK! 6
optsKK7 ;
,KK; <
ActionKK= C
<KKC D
FileMonitorObjectKKD U
>KKU V
changeHandlerKKW d
)KKd e
{LL 	
optionsMM 
=MM 
optsMM 
??MM 
newMM !!
MonitorCommandOptionsMM" 7
(MM7 8
)MM8 9
;MM9 :
thisNN 
.NN 
changeHandlerNN 
=NN  
changeHandlerNN! .
??NN/ 1
throwNN2 7
newNN8 ;"
NullReferenceExceptionNN< R
(NNR S
nameofNNS Y
(NNY Z
changeHandlerNNZ g
)NNg h
)NNh i
;NNi j
fscPP 
=PP 
newPP 
FileSystemCollectorPP )
(PP) *
newPP* -
CollectorOptionsPP. >
(PP> ?
)PP? @
{QQ 
DownloadCloudRR 
=RR 
falseRR  %
,RR% &
GatherHashesSS 
=SS 
optionsSS &
.SS& '
GatherHashesSS' 3
,SS3 4
}TT 
)TT 
;TT 
foreachVV 
(VV 
varVV 
dirVV 
inVV 
(VV  !
optionsVV! (
?VV( )
.VV) * 
MonitoredDirectoriesVV* >
.VV> ?
AnyVV? B
(VVB C
)VVC D
isVVE G
trueVVH L
)VVL M
?VVN O
optionsVVP W
.VVW X 
MonitoredDirectoriesVVX l
:VVm n
fscVVo r
.VVr s
RootsVVs x
.VVx y
ToListVVy 
(	VV Ä
)
VVÄ Å
)
VVÅ Ç
{WW 
foreachXX 
(XX 
varXX 
filterXX #
inXX$ &
defaultFiltersListXX' 9
)XX9 :
{YY 
varZZ 
watcherZZ 
=ZZ  !
newZZ" %
FileSystemWatcherZZ& 7
{[[ 
Path\\ 
=\\ 
dir\\ "
,\\" #
NotifyFilter]] $
=]]% &
filter]]' -
,]]- .!
IncludeSubdirectories^^ -
=^^. /
true^^0 4
}__ 
;__ 
watcherbb 
.bb 
Changedbb #
+=bb$ &$
GetFunctionForFilterTypebb' ?
(bb? @
filterbb@ F
)bbF G
;bbG H
watchercc 
.cc 
Createdcc #
+=cc$ &$
GetFunctionForFilterTypecc' ?
(cc? @
filtercc@ F
)ccF G
;ccG H
watcherdd 
.dd 
Deleteddd #
+=dd$ &$
GetFunctionForFilterTypedd' ?
(dd? @
filterdd@ F
)ddF G
;ddG H
watchergg 
.gg 
Renamedgg #
+=gg$ &+
GetRenamedFunctionForFilterTypegg' F
(ggF G
filterggG M
)ggM N
;ggN O
watchersii 
.ii 
Addii  
(ii  !
watcherii! (
)ii( )
;ii) *
}jj 
}kk 
}ll 	
privatenn 
RenamedEventHandlernn #
?nn# $+
GetRenamedFunctionForFilterTypenn% D
(nnD E
NotifyFiltersnnE R
filternnS Y
)nnY Z
{oo 	
returnpp 
filterpp 
switchpp  
{qq 
NotifyFiltersrr 
.rr 

Attributesrr (
=>rr) +!
WriteAttributesRenamerr, A
,rrA B
NotifyFiltersss 
.ss 
CreationTimess *
=>ss+ -#
WriteCreationTimeRenamess. E
,ssE F
NotifyFilterstt 
.tt 
DirectoryNamett +
=>tt, .$
WriteDirectoryNameRenamett/ G
,ttG H
NotifyFiltersuu 
.uu 
FileNameuu &
=>uu' )
WriteFileNameRenameuu* =
,uu= >
NotifyFiltersvv 
.vv 

LastAccessvv (
=>vv) +!
WriteLastAccessRenamevv, A
,vvA B
NotifyFiltersww 
.ww 
	LastWriteww '
=>ww( * 
WriteLastWriteRenameww+ ?
,ww? @
NotifyFiltersxx 
.xx 
Securityxx &
=>xx' )
WriteSecurityRenamexx* =
,xx= >
NotifyFiltersyy 
.yy 
Sizeyy "
=>yy# %
WriteSizeRenameyy& 5
,yy5 6
_zz 
=>zz 
nullzz 
,zz 
}{{ 
;{{ 
}|| 	
private~~ "
FileSystemEventHandler~~ &
?~~& '$
GetFunctionForFilterType~~( @
(~~@ A
NotifyFilters~~A N
filter~~O U
)~~U V
{ 	
return
ÄÄ 
filter
ÄÄ 
switch
ÄÄ  
{
ÅÅ 
NotifyFilters
ÇÇ 
.
ÇÇ 

Attributes
ÇÇ (
=>
ÇÇ) +#
WriteAttributesChange
ÇÇ, A
,
ÇÇA B
NotifyFilters
ÉÉ 
.
ÉÉ 
CreationTime
ÉÉ *
=>
ÉÉ+ -%
WriteCreationTimeChange
ÉÉ. E
,
ÉÉE F
NotifyFilters
ÑÑ 
.
ÑÑ 
DirectoryName
ÑÑ +
=>
ÑÑ, .&
WriteDirectoryNameChange
ÑÑ/ G
,
ÑÑG H
NotifyFilters
ÖÖ 
.
ÖÖ 
FileName
ÖÖ &
=>
ÖÖ' )!
WriteFileNameChange
ÖÖ* =
,
ÖÖ= >
NotifyFilters
ÜÜ 
.
ÜÜ 

LastAccess
ÜÜ (
=>
ÜÜ) +#
WriteLastAccessChange
ÜÜ, A
,
ÜÜA B
NotifyFilters
áá 
.
áá 
	LastWrite
áá '
=>
áá( *"
WriteLastWriteChange
áá+ ?
,
áá? @
NotifyFilters
àà 
.
àà 
Security
àà &
=>
àà' )!
WriteSecurityChange
àà* =
,
àà= >
NotifyFilters
ââ 
.
ââ 
Size
ââ "
=>
ââ# %
WriteSizeChange
ââ& 5
,
ââ5 6
_
ää 
=>
ää 
null
ää 
,
ää 
}
ãã 
;
ãã 
}
åå 	
public
éé 
bool
éé 
	IsRunning
éé 
(
éé 
)
éé 
{
èè 	
return
êê 
watchers
êê 
.
êê 
Any
êê 
(
êê  
x
êê  !
=>
êê" $
x
êê% &
.
êê& '!
EnableRaisingEvents
êê' :
)
êê: ;
;
êê; <
}
ëë 	
private
ìì 
void
ìì #
WriteAttributesChange
ìì *
(
ìì* +
object
ìì+ 1
source
ìì2 8
,
ìì8 9!
FileSystemEventArgs
ìì: M
e
ììN O
)
ììO P
{
îî 	
WriteChange
ïï 
(
ïï 
e
ïï 
,
ïï 
NotifyFilters
ïï (
.
ïï( )

Attributes
ïï) 3
)
ïï3 4
;
ïï4 5
}
ññ 	
private
òò 
void
òò %
WriteCreationTimeChange
òò ,
(
òò, -
object
òò- 3
source
òò4 :
,
òò: ;!
FileSystemEventArgs
òò< O
e
òòP Q
)
òòQ R
{
ôô 	
WriteChange
öö 
(
öö 
e
öö 
,
öö 
NotifyFilters
öö (
.
öö( )
CreationTime
öö) 5
)
öö5 6
;
öö6 7
}
õõ 	
private
ùù 
void
ùù &
WriteDirectoryNameChange
ùù -
(
ùù- .
object
ùù. 4
source
ùù5 ;
,
ùù; <!
FileSystemEventArgs
ùù= P
e
ùùQ R
)
ùùR S
{
ûû 	
WriteChange
üü 
(
üü 
e
üü 
,
üü 
NotifyFilters
üü (
.
üü( )
DirectoryName
üü) 6
)
üü6 7
;
üü7 8
}
†† 	
private
¢¢ 
void
¢¢ !
WriteFileNameChange
¢¢ (
(
¢¢( )
object
¢¢) /
source
¢¢0 6
,
¢¢6 7!
FileSystemEventArgs
¢¢8 K
e
¢¢L M
)
¢¢M N
{
££ 	
WriteChange
§§ 
(
§§ 
e
§§ 
,
§§ 
NotifyFilters
§§ (
.
§§( )
FileName
§§) 1
)
§§1 2
;
§§2 3
}
•• 	
private
ßß 
void
ßß #
WriteLastAccessChange
ßß *
(
ßß* +
object
ßß+ 1
source
ßß2 8
,
ßß8 9!
FileSystemEventArgs
ßß: M
e
ßßN O
)
ßßO P
{
®® 	
WriteChange
©© 
(
©© 
e
©© 
,
©© 
NotifyFilters
©© (
.
©©( )

LastAccess
©©) 3
)
©©3 4
;
©©4 5
}
™™ 	
private
¨¨ 
void
¨¨ "
WriteLastWriteChange
¨¨ )
(
¨¨) *
object
¨¨* 0
source
¨¨1 7
,
¨¨7 8!
FileSystemEventArgs
¨¨9 L
e
¨¨M N
)
¨¨N O
{
≠≠ 	
WriteChange
ÆÆ 
(
ÆÆ 
e
ÆÆ 
,
ÆÆ 
NotifyFilters
ÆÆ (
.
ÆÆ( )
	LastWrite
ÆÆ) 2
)
ÆÆ2 3
;
ÆÆ3 4
}
ØØ 	
private
±± 
void
±± !
WriteSecurityChange
±± (
(
±±( )
object
±±) /
source
±±0 6
,
±±6 7!
FileSystemEventArgs
±±8 K
e
±±L M
)
±±M N
{
≤≤ 	
WriteChange
≥≥ 
(
≥≥ 
e
≥≥ 
,
≥≥ 
NotifyFilters
≥≥ (
.
≥≥( )
Security
≥≥) 1
)
≥≥1 2
;
≥≥2 3
}
¥¥ 	
private
∂∂ 
void
∂∂ 
WriteSizeChange
∂∂ $
(
∂∂$ %
object
∂∂% +
source
∂∂, 2
,
∂∂2 3!
FileSystemEventArgs
∂∂4 G
e
∂∂H I
)
∂∂I J
{
∑∑ 	
WriteChange
∏∏ 
(
∏∏ 
e
∏∏ 
,
∏∏ 
NotifyFilters
∏∏ (
.
∏∏( )
Size
∏∏) -
)
∏∏- .
;
∏∏. /
}
ππ 	
private
ªª 
void
ªª #
WriteAttributesRename
ªª *
(
ªª* +
object
ªª+ 1
source
ªª2 8
,
ªª8 9
RenamedEventArgs
ªª: J
e
ªªK L
)
ªªL M
{
ºº 	
WriteRename
ΩΩ 
(
ΩΩ 
e
ΩΩ 
,
ΩΩ 
NotifyFilters
ΩΩ (
.
ΩΩ( )

Attributes
ΩΩ) 3
)
ΩΩ3 4
;
ΩΩ4 5
}
ææ 	
private
¿¿ 
void
¿¿ %
WriteCreationTimeRename
¿¿ ,
(
¿¿, -
object
¿¿- 3
source
¿¿4 :
,
¿¿: ;
RenamedEventArgs
¿¿< L
e
¿¿M N
)
¿¿N O
{
¡¡ 	
WriteRename
¬¬ 
(
¬¬ 
e
¬¬ 
,
¬¬ 
NotifyFilters
¬¬ (
.
¬¬( )
CreationTime
¬¬) 5
)
¬¬5 6
;
¬¬6 7
}
√√ 	
private
≈≈ 
void
≈≈ &
WriteDirectoryNameRename
≈≈ -
(
≈≈- .
object
≈≈. 4
source
≈≈5 ;
,
≈≈; <
RenamedEventArgs
≈≈= M
e
≈≈N O
)
≈≈O P
{
∆∆ 	
WriteRename
«« 
(
«« 
e
«« 
,
«« 
NotifyFilters
«« (
.
««( )
DirectoryName
««) 6
)
««6 7
;
««7 8
}
»» 	
private
   
void
   !
WriteFileNameRename
   (
(
  ( )
object
  ) /
source
  0 6
,
  6 7
RenamedEventArgs
  8 H
e
  I J
)
  J K
{
ÀÀ 	
WriteRename
ÃÃ 
(
ÃÃ 
e
ÃÃ 
,
ÃÃ 
NotifyFilters
ÃÃ (
.
ÃÃ( )
FileName
ÃÃ) 1
)
ÃÃ1 2
;
ÃÃ2 3
}
ÕÕ 	
private
œœ 
void
œœ #
WriteLastAccessRename
œœ *
(
œœ* +
object
œœ+ 1
source
œœ2 8
,
œœ8 9
RenamedEventArgs
œœ: J
e
œœK L
)
œœL M
{
–– 	
WriteRename
—— 
(
—— 
e
—— 
,
—— 
NotifyFilters
—— (
.
——( )

LastAccess
——) 3
)
——3 4
;
——4 5
}
““ 	
private
‘‘ 
void
‘‘ "
WriteLastWriteRename
‘‘ )
(
‘‘) *
object
‘‘* 0
source
‘‘1 7
,
‘‘7 8
RenamedEventArgs
‘‘9 I
e
‘‘J K
)
‘‘K L
{
’’ 	
WriteRename
÷÷ 
(
÷÷ 
e
÷÷ 
,
÷÷ 
NotifyFilters
÷÷ (
.
÷÷( )
	LastWrite
÷÷) 2
)
÷÷2 3
;
÷÷3 4
}
◊◊ 	
private
ŸŸ 
void
ŸŸ !
WriteSecurityRename
ŸŸ (
(
ŸŸ( )
object
ŸŸ) /
source
ŸŸ0 6
,
ŸŸ6 7
RenamedEventArgs
ŸŸ8 H
e
ŸŸI J
)
ŸŸJ K
{
⁄⁄ 	
WriteRename
€€ 
(
€€ 
e
€€ 
,
€€ 
NotifyFilters
€€ (
.
€€( )
Security
€€) 1
)
€€1 2
;
€€2 3
}
‹‹ 	
private
ﬁﬁ 
void
ﬁﬁ 
WriteSizeRename
ﬁﬁ $
(
ﬁﬁ$ %
object
ﬁﬁ% +
source
ﬁﬁ, 2
,
ﬁﬁ2 3
RenamedEventArgs
ﬁﬁ4 D
e
ﬁﬁE F
)
ﬁﬁF G
{
ﬂﬂ 	
WriteRename
‡‡ 
(
‡‡ 
e
‡‡ 
,
‡‡ 
NotifyFilters
‡‡ (
.
‡‡( )
Size
‡‡) -
)
‡‡- .
;
‡‡. /
}
·· 	
private
„„ 
void
„„ 
WriteChange
„„  
(
„„  !!
FileSystemEventArgs
„„! 4
objIn
„„5 :
,
„„: ;
NotifyFilters
„„< I
filters
„„J Q
)
„„Q R
{
‰‰ 	
if
ÂÂ 
(
ÂÂ 
objIn
ÂÂ 
!=
ÂÂ 
null
ÂÂ 
)
ÂÂ 
{
ÊÊ 
if
ÁÁ 
(
ÁÁ 
IsInvalidFile
ÁÁ !
(
ÁÁ! "
objIn
ÁÁ" '
.
ÁÁ' (
FullPath
ÁÁ( 0
)
ÁÁ0 1
)
ÁÁ1 2
{
ËË 
return
ÈÈ 
;
ÈÈ 
}
ÍÍ 
if
ÓÓ 
(
ÓÓ 
!
ÓÓ 
options
ÓÓ 
.
ÓÓ 
FileNamesOnly
ÓÓ *
&&
ÓÓ+ -
filters
ÓÓ. 5
.
ÓÓ5 6
HasFlag
ÓÓ6 =
(
ÓÓ= >
NotifyFilters
ÓÓ> K
.
ÓÓK L

LastAccess
ÓÓL V
)
ÓÓV W
)
ÓÓW X
{
ÔÔ 
filesAccessed
 !
.
! "
TryAdd
" (
(
( )
objIn
) .
.
. /
FullPath
/ 7
,
7 8
objIn
9 >
)
> ?
;
? @
}
ÒÒ 
else
ÚÚ 
{
ÛÛ 
var
ˆˆ 
fso
ˆˆ 
=
ˆˆ 
(
ˆˆ 
objIn
ˆˆ $
.
ˆˆ$ %

ChangeType
ˆˆ% /
==
ˆˆ0 2 
WatcherChangeTypes
ˆˆ3 E
.
ˆˆE F
Deleted
ˆˆF M
||
ˆˆN P
options
ˆˆQ X
.
ˆˆX Y
FileNamesOnly
ˆˆY f
)
ˆˆf g
?
ˆˆh i
null
ˆˆj n
:
ˆˆo p
fsc
ˆˆq t
.
ˆˆt u)
FilePathToFileSystemObjectˆˆu è
(ˆˆè ê
objInˆˆê ï
.ˆˆï ñ
FullPathˆˆñ û
)ˆˆû ü
;ˆˆü †
var
˜˜ 
ToWrite
˜˜ 
=
˜˜  !
new
˜˜" %
FileMonitorObject
˜˜& 7
(
˜˜7 8
objIn
˜˜8 =
.
˜˜= >
FullPath
˜˜> F
)
˜˜F G
{
¯¯ 

ResultType
˘˘ "
=
˘˘# $
RESULT_TYPE
˘˘% 0
.
˘˘0 1
FILEMONITOR
˘˘1 <
,
˘˘< =

ChangeType
˙˙ "
=
˙˙# $*
ChangeTypeStringToChangeType
˙˙% A
(
˙˙A B
objIn
˙˙B G
.
˙˙G H

ChangeType
˙˙H R
.
˙˙R S
ToString
˙˙S [
(
˙˙[ \
)
˙˙\ ]
)
˙˙] ^
,
˙˙^ _
Name
˚˚ 
=
˚˚ 
objIn
˚˚ $
.
˚˚$ %
Name
˚˚% )
,
˚˚) *
	Timestamp
¸¸ !
=
¸¸" #
DateTime
¸¸$ ,
.
¸¸, -
Now
¸¸- 0
.
¸¸0 1
ToString
¸¸1 9
(
¸¸9 :
$str
¸¸: =
,
¸¸= >
CultureInfo
¸¸? J
.
¸¸J K
InvariantCulture
¸¸K [
)
¸¸[ \
,
¸¸\ ]
FileSystemObject
˝˝ (
=
˝˝) *
fso
˝˝+ .
,
˝˝. /
NotifyFilters
˛˛ %
=
˛˛& '
filters
˛˛( /
}
ˇˇ 
;
ˇˇ 
changeHandler
ÅÅ !
(
ÅÅ! "
ToWrite
ÅÅ" )
)
ÅÅ) *
;
ÅÅ* +
}
ÇÇ 
}
ÉÉ 
}
ÑÑ 	
private
ÜÜ 
static
ÜÜ 
CHANGE_TYPE
ÜÜ "*
ChangeTypeStringToChangeType
ÜÜ# ?
(
ÜÜ? @
string
ÜÜ@ F
change_type
ÜÜG R
)
ÜÜR S
{
áá 	
if
àà 
(
àà 
change_type
àà 
.
àà 
Equals
àà "
(
àà" #
$str
àà# ,
)
àà, -
)
àà- .
{
ââ 
return
ää 
CHANGE_TYPE
ää "
.
ää" #
MODIFIED
ää# +
;
ää+ ,
}
ãã 
if
åå 
(
åå 
change_type
åå 
.
åå 
Equals
åå "
(
åå" #
$str
åå# ,
)
åå, -
)
åå- .
{
çç 
return
éé 
CHANGE_TYPE
éé "
.
éé" #
CREATED
éé# *
;
éé* +
}
èè 
if
êê 
(
êê 
change_type
êê 
.
êê 
Equals
êê "
(
êê" #
$str
êê# ,
)
êê, -
)
êê- .
{
ëë 
return
íí 
CHANGE_TYPE
íí "
.
íí" #
RENAMED
íí# *
;
íí* +
}
ìì 
if
îî 
(
îî 
change_type
îî 
.
îî 
Equals
îî "
(
îî" #
$str
îî# ,
)
îî, -
)
îî- .
{
ïï 
return
ññ 
CHANGE_TYPE
ññ "
.
ññ" #
DELETED
ññ# *
;
ññ* +
}
óó 
return
òò 
CHANGE_TYPE
òò 
.
òò 
INVALID
òò &
;
òò& '
}
ôô 	
public
õõ 
static
õõ 
CHANGE_TYPE
õõ !$
ChangeTypeToChangeType
õõ" 8
(
õõ8 9 
WatcherChangeTypes
õõ9 K

changeType
õõL V
)
õõV W
{
úú 	
switch
ùù 
(
ùù 

changeType
ùù 
)
ùù 
{
ûû 
case
üü  
WatcherChangeTypes
üü '
.
üü' (
Changed
üü( /
:
üü/ 0
return
†† 
CHANGE_TYPE
†† &
.
††& '
MODIFIED
††' /
;
††/ 0
case
¢¢  
WatcherChangeTypes
¢¢ '
.
¢¢' (
Created
¢¢( /
:
¢¢/ 0
return
££ 
CHANGE_TYPE
££ &
.
££& '
CREATED
££' .
;
££. /
case
••  
WatcherChangeTypes
•• '
.
••' (
Deleted
••( /
:
••/ 0
return
¶¶ 
CHANGE_TYPE
¶¶ &
.
¶¶& '
DELETED
¶¶' .
;
¶¶. /
case
®®  
WatcherChangeTypes
®® '
.
®®' (
Renamed
®®( /
:
®®/ 0
return
©© 
CHANGE_TYPE
©© &
.
©©& '
RENAMED
©©' .
;
©©. /
default
´´ 
:
´´ 
return
¨¨ 
CHANGE_TYPE
¨¨ &
.
¨¨& '
INVALID
¨¨' .
;
¨¨. /
}
≠≠ 
}
ÆÆ 	
public
∞∞ 
void
∞∞ 
WriteRename
∞∞ 
(
∞∞  
RenamedEventArgs
∞∞  0
objIn
∞∞1 6
,
∞∞6 7
NotifyFilters
∞∞8 E
filters
∞∞F M
)
∞∞M N
{
±± 	
if
≤≤ 
(
≤≤ 
objIn
≤≤ 
==
≤≤ 
null
≤≤ 
)
≤≤ 
{
≤≤  
return
≤≤! '
;
≤≤' (
}
≤≤) *
if
¥¥ 
(
¥¥ 
IsInvalidFile
¥¥ 
(
¥¥ 
objIn
¥¥ #
.
¥¥# $
FullPath
¥¥$ ,
)
¥¥, -
)
¥¥- .
{
µµ 
return
∂∂ 
;
∂∂ 
}
∑∑ 
var
ππ 
ToWrite
ππ 
=
ππ 
new
ππ 
FileMonitorObject
ππ /
(
ππ/ 0
objIn
ππ0 5
.
ππ5 6
FullPath
ππ6 >
)
ππ> ?
{
∫∫ 

ResultType
ªª 
=
ªª 
RESULT_TYPE
ªª (
.
ªª( )
FILEMONITOR
ªª) 4
,
ªª4 5

ChangeType
ºº 
=
ºº *
ChangeTypeStringToChangeType
ºº 9
(
ºº9 :
objIn
ºº: ?
.
ºº? @

ChangeType
ºº@ J
.
ººJ K
ToString
ººK S
(
ººS T
)
ººT U
)
ººU V
,
ººV W
OldPath
ΩΩ 
=
ΩΩ 
objIn
ΩΩ 
.
ΩΩ  
OldFullPath
ΩΩ  +
,
ΩΩ+ ,
Name
ææ 
=
ææ 
objIn
ææ 
.
ææ 
Name
ææ !
,
ææ! "
OldName
øø 
=
øø 
objIn
øø 
.
øø  
OldName
øø  '
,
øø' (
	Timestamp
¿¿ 
=
¿¿ 
DateTime
¿¿ $
.
¿¿$ %
Now
¿¿% (
.
¿¿( )
ToString
¿¿) 1
(
¿¿1 2
$str
¿¿2 5
,
¿¿5 6
CultureInfo
¿¿7 B
.
¿¿B C
InvariantCulture
¿¿C S
)
¿¿S T
,
¿¿T U
FileSystemObject
¡¡  
=
¡¡! "
fsc
¡¡# &
.
¡¡& '(
FilePathToFileSystemObject
¡¡' A
(
¡¡A B
objIn
¡¡B G
.
¡¡G H
FullPath
¡¡H P
)
¡¡P Q
,
¡¡Q R
NotifyFilters
¬¬ 
=
¬¬ 
filters
¬¬  '
}
√√ 
;
√√ 
changeHandler
≈≈ 
(
≈≈ 
ToWrite
≈≈ !
)
≈≈! "
;
≈≈" #
}
∆∆ 	
private
»» 
static
»» 
bool
»» 
IsInvalidFile
»» )
(
»») *
string
»»* 0
Path
»»1 5
)
»»5 6
{
…… 	
if
ÀÀ 
(
ÀÀ 
Path
ÀÀ 
.
ÀÀ 

StartsWith
ÀÀ 
(
ÀÀ  
$str
ÀÀ  :
)
ÀÀ: ;
)
ÀÀ; <
{
ÃÃ 
return
ÕÕ 
true
ÕÕ 
;
ÕÕ 
}
ŒŒ 
else
–– 
if
–– 
(
–– 
Path
–– 
.
–– 
EndsWith
–– "
(
––" #
$str
––# -
)
––- .
)
––. /
{
—— 
return
““ 
true
““ 
;
““ 
}
”” 
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 	
public
◊◊ 
void
◊◊ 
Dispose
◊◊ 
(
◊◊ 
)
◊◊ 
{
ÿÿ 	
Dispose
ŸŸ 
(
ŸŸ 
true
ŸŸ 
)
ŸŸ 
;
ŸŸ 
GC
⁄⁄ 
.
⁄⁄ 
SuppressFinalize
⁄⁄ 
(
⁄⁄  
this
⁄⁄  $
)
⁄⁄$ %
;
⁄⁄% &
}
€€ 	
	protected
›› 
virtual
›› 
void
›› 
Dispose
›› &
(
››& '
bool
››' +
	disposing
››, 5
)
››5 6
{
ﬁﬁ 	
if
ﬂﬂ 
(
ﬂﬂ 
	disposing
ﬂﬂ 
)
ﬂﬂ 
{
‡‡ 
watchers
·· 
.
·· 
ForEach
··  
(
··  !
x
··! "
=>
··# %
x
··& '
.
··' (
Dispose
··( /
(
··/ 0
)
··0 1
)
··1 2
;
··2 3
}
‚‚ 
}
„„ 	
}
‰‰ 
}ÂÂ ¸∫
MD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\FileSystemUtils.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

static 
class 
FileSystemUtils '
{ 
public 
static 
readonly 
byte #
[# $
]$ %
ElfMagicNumber& 4
=5 6

AsaHelpers7 A
.A B
HexStringToBytesB R
(R S
$strS ]
)] ^
;^ _
public 
static 
readonly 
byte #
[# $
]$ %
JavaMagicNumber& 5
=6 7

AsaHelpers8 B
.B C
HexStringToBytesC S
(S T
$strT ^
)^ _
;_ `
public 
static 
readonly 
List #
<# $
byte$ (
[( )
]) *
>* +
MacMagicNumbers, ;
=< =
new> A
ListB F
<F G
byteG K
[K L
]L M
>M N
(N O
)O P
{ 	

AsaHelpers 
. 
HexStringToBytes '
(' (
$str( 2
)2 3
,3 4

AsaHelpers 
. 
HexStringToBytes '
(' (
$str( 2
)2 3
,3 4

AsaHelpers 
. 
HexStringToBytes '
(' (
$str( 2
)2 3
,3 4

AsaHelpers!! 
.!! 
HexStringToBytes!! '
(!!' (
$str!!( 2
)!!2 3
,!!3 4

AsaHelpers## 
.## 
HexStringToBytes## '
(##' (
$str##( 2
)##2 3
}$$ 	
;$$	 

public'' 
static'' 
readonly'' 
byte'' #
[''# $
]''$ %
WindowsMagicNumber''& 8
=''9 :

AsaHelpers''; E
.''E F
HexStringToBytes''F V
(''V W
$str''W ]
)''] ^
;''^ _
public)) 
static)) 
EXECUTABLE_TYPE)) %
GetExecutableType))& 7
())7 8
string))8 >
Path))? C
)))C D
{** 	
using++ 
var++ 
fs++ 
=++ 
new++ 

FileStream++ )
(++) *
Path++* .
,++. /
FileMode++0 8
.++8 9
Open++9 =
,++= >

FileAccess++? I
.++I J
Read++J N
,++N O
	FileShare++P Y
.++Y Z
	ReadWrite++Z c
)++c d
;++d e
return,, 
GetExecutableType,, $
(,,$ %
Path,,% )
,,,) *
fs,,+ -
),,- .
;,,. /
}-- 	
public// 
static// 
EXECUTABLE_TYPE// %
GetExecutableType//& 7
(//7 8
string//8 >
?//> ?
Path//@ D
,//D E
Stream//F L
input//M R
)//R S
{00 	
if11 
(11 
input11 
==11 
null11 
)11 
{11  
return11! '
EXECUTABLE_TYPE11( 7
.117 8
UNKNOWN118 ?
;11? @
}11A B
if22 
(22 
input22 
.22 
Length22 
<22 
$num22  
)22  !
{22" #
return22$ *
EXECUTABLE_TYPE22+ :
.22: ;
NONE22; ?
;22? @
}22A B
var44 
	fourBytes44 
=44 
new44 
byte44  $
[44$ %
$num44% &
]44& '
;44' (
var55 
initialPosition55 
=55  !
input55" '
.55' (
Position55( 0
;550 1
try77 
{88 
input99 
.99 
Read99 
(99 
	fourBytes99 $
)99$ %
;99% &
input:: 
.:: 
Position:: 
=::  
initialPosition::! 0
;::0 1
};; 
catch<< 
(<< 
	Exception<< 
e<< 
)<< 
{== 
Log>> 
.>> 
Verbose>> 
(>> 
$str>> E
,>>E F
Path>>G K
,>>K L
e>>M N
.>>N O
GetType>>O V
(>>V W
)>>W X
.>>X Y
ToString>>Y a
(>>a b
)>>b c
,>>c d
e>>e f
.>>f g
Message>>g n
)>>n o
;>>o p
return?? 
EXECUTABLE_TYPE?? &
.??& '
UNKNOWN??' .
;??. /
}@@ 
switchBB 
(BB 
	fourBytesBB 
)BB 
{CC 
caseDD 
varDD 
spanDD 
whenDD "
spanDD# '
.DD' (
SequenceEqualDD( 5
(DD5 6
ElfMagicNumberDD6 D
)DDD E
:DDE F
returnEE 
EXECUTABLE_TYPEEE *
.EE* +
LINUXEE+ 0
;EE0 1
caseGG 
varGG 
spanGG 
whenGG "
spanGG# '
.GG' (
SequenceEqualGG( 5
(GG5 6
JavaMagicNumberGG6 E
)GGE F
:GGF G
returnHH 
EXECUTABLE_TYPEHH *
.HH* +
JAVAHH+ /
;HH/ 0
caseJJ 
varJJ 
spanJJ 
whenJJ "
MacMagicNumbersJJ# 2
.JJ2 3
ContainsJJ3 ;
(JJ; <
spanJJ< @
)JJ@ A
:JJA B
returnKK 
EXECUTABLE_TYPEKK *
.KK* +
MACOSKK+ 0
;KK0 1
caseMM 
varMM 
spanMM 
whenMM "
spanMM# '
[MM' (
$numMM( )
..MM) +
$numMM+ ,
]MM, -
.MM- .
SequenceEqualMM. ;
(MM; <
WindowsMagicNumberMM< N
)MMN O
:MMO P
returnNN 
EXECUTABLE_TYPENN *
.NN* +
WINDOWSNN+ 2
;NN2 3
defaultPP 
:PP 
returnQQ 
EXECUTABLE_TYPEQQ *
.QQ* +
NONEQQ+ /
;QQ/ 0
}RR 
}SS 	
publicUU 
staticUU 
stringUU 
GetFileHashUU (
(UU( )
stringUU) /
pathUU0 4
)UU4 5
{VV 	
tryWW 
{XX 
returnYY 
GetFileHashYY "
(YY" #
newYY# &
FileInfoYY' /
(YY/ 0
pathYY0 4
)YY4 5
)YY5 6
??YY7 9
stringYY: @
.YY@ A
EmptyYYA F
;YYF G
}ZZ 
catch[[ 
([[ 
	Exception[[ 
)[[ 
{\\ 
return]] 
string]] 
.]] 
Empty]] #
;]]# $
}^^ 
}__ 	
publicaa 
staticaa 
stringaa 
?aa 
GetFileHashaa )
(aa) *
FileSystemInfoaa* 8
fileInfoaa9 A
)aaA B
{bb 	
ifcc 
(cc 
fileInfocc 
!=cc 
nullcc  
)cc  !
{dd 
Logee 
.ee 
Debugee 
(ee 
$stree #
,ee# $
Stringsee% ,
.ee, -
Getee- 0
(ee0 1
$stree1 ;
)ee; <
,ee< =
fileInfoee> F
.eeF G
FullNameeeG O
)eeO P
;eeP Q
stringgg 
?gg 
	hashValuegg !
=gg" #
nullgg$ (
;gg( )
tryhh 
{ii 
usingjj 
(jj 
varjj 
streamjj %
=jj& '
Filejj( ,
.jj, -
OpenReadjj- 5
(jj5 6
fileInfojj6 >
.jj> ?
FullNamejj? G
)jjG H
)jjH I
{kk 
	hashValuell !
=ll" #
CryptoHelpersll$ 1
.ll1 2

CreateHashll2 <
(ll< =
streamll= C
)llC D
;llD E
}mm 
}nn 
catchoo 
(oo 
	Exceptionoo  
eoo! "
)oo" #
whenoo$ (
(oo) *
epp 
ispp !
ArgumentNullExceptionpp .
||qq 
eqq 
isqq 
ArgumentExceptionqq -
||rr 
err 
isrr !
NotSupportedExceptionrr 1
||ss 
ess 
isss !
FileNotFoundExceptionss 1
||tt 
ett 
istt 
IOExceptiontt '
||uu 
euu 
isuu 
Systemuu "
.uu" #
Securityuu# +
.uu+ ,
SecurityExceptionuu, =
||vv 
evv 
isvv &
DirectoryNotFoundExceptionvv 6
||ww 
eww 
isww '
UnauthorizedAccessExceptionww 7
||xx 
exx 
isxx  
PathTooLongExceptionxx 0
||yy 
eyy 
isyy '
ArgumentOutOfRangeExceptionyy 7
)yy7 8
{zz 
Log{{ 
.{{ 
Verbose{{ 
({{  
$str{{  .
,{{. /
Strings{{0 7
.{{7 8
Get{{8 ;
({{; <
$str{{< N
){{N O
,{{O P
fileInfo{{Q Y
.{{Y Z
FullName{{Z b
,{{b c
e{{d e
.{{e f
GetType{{f m
({{m n
){{n o
.{{o p
ToString{{p x
({{x y
){{y z
){{z {
;{{{ |
}|| 
return}} 
	hashValue}}  
;}}  !
}~~ 
return 
null 
; 
}
ÄÄ 	
public
ÇÇ 
static
ÇÇ 
string
ÇÇ  
GetFilePermissions
ÇÇ /
(
ÇÇ/ 0
FileSystemInfo
ÇÇ0 >
fileInfo
ÇÇ? G
)
ÇÇG H
{
ÉÉ 	
if
ÑÑ 
(
ÑÑ 
fileInfo
ÑÑ 
!=
ÑÑ 
null
ÑÑ  
)
ÑÑ  !
{
ÖÖ 
if
ÜÜ 
(
ÜÜ  
RuntimeInformation
ÜÜ &
.
ÜÜ& '
IsOSPlatform
ÜÜ' 3
(
ÜÜ3 4

OSPlatform
ÜÜ4 >
.
ÜÜ> ?
Linux
ÜÜ? D
)
ÜÜD E
||
ÜÜF H 
RuntimeInformation
ÜÜI [
.
ÜÜ[ \
IsOSPlatform
ÜÜ\ h
(
ÜÜh i

OSPlatform
ÜÜi s
.
ÜÜs t
OSX
ÜÜt w
)
ÜÜw x
)
ÜÜx y
{
áá 
var
àà 
filename
àà  
=
àà! "
fileInfo
àà# +
.
àà+ ,
FullName
àà, 4
;
àà4 5#
FileAccessPermissions
ää )
permissions
ää* 5
=
ää6 7
default
ää8 ?
(
ää? @#
FileAccessPermissions
ää@ U
)
ääU V
;
ääV W
try
åå 
{
çç 
if
éé 
(
éé 
fileInfo
éé $
is
éé% '
FileInfo
éé( 0
)
éé0 1
{
èè 
permissions
êê '
=
êê( )
new
êê* -
UnixFileInfo
êê. :
(
êê: ;
filename
êê; C
)
êêC D
.
êêD E#
FileAccessPermissions
êêE Z
;
êêZ [
}
ëë 
else
íí 
if
íí 
(
íí  !
fileInfo
íí! )
is
íí* ,
DirectoryInfo
íí- :
)
íí: ;
{
ìì 
permissions
îî '
=
îî( )
new
îî* -
UnixDirectoryInfo
îî. ?
(
îî? @
filename
îî@ H
)
îîH I
.
îîI J#
FileAccessPermissions
îîJ _
;
îî_ `
}
ïï 
}
ññ 
catch
óó 
(
óó 
	Exception
óó $
e
óó% &
)
óó& '
when
óó( ,
(
óó- .
e
òò 
is
òò 
IOException
òò (
||
ôô 
e
ôô 
is
ôô '
InvalidOperationException
ôô  9
)
öö 
{
õõ 
Log
úú 
.
úú 
Verbose
úú #
(
úú# $
$str
úú$ O
,
úúO P
fileInfo
úúQ Y
.
úúY Z
FullName
úúZ b
,
úúb c
e
úúd e
.
úúe f
GetType
úúf m
(
úúm n
)
úún o
.
úúo p
ToString
úúp x
(
úúx y
)
úúy z
)
úúz {
;
úú{ |
}
ùù 
catch
ûû 
(
ûû 
	Exception
ûû $
e
ûû% &
)
ûû& '
{
üü 
Log
†† 
.
†† 
Debug
†† !
(
††! "
$"
††" $
$str
††$ C
{
††C D
e
††D E
.
††E F
GetType
††F M
(
††M N
)
††N O
.
††O P
ToString
††P X
(
††X Y
)
††Y Z
}
††Z [
"
††[ \
)
††\ ]
;
††] ^
}
°° 
return
££ 
permissions
££ &
.
££& '
ToString
££' /
(
££/ 0
)
££0 1
;
££1 2
}
§§ 
else
•• 
if
•• 
(
••  
RuntimeInformation
•• +
.
••+ ,
IsOSPlatform
••, 8
(
••8 9

OSPlatform
••9 C
.
••C D
Windows
••D K
)
••K L
)
••L M
{
¶¶ 
var
ßß 
filename
ßß  
=
ßß! "
fileInfo
ßß# +
.
ßß+ ,
FullName
ßß, 4
;
ßß4 5
if
®® 
(
®® 
filename
®®  
.
®®  !
Length
®®! '
>=
®®( *
$num
®®+ .
&&
®®/ 1
!
®®2 3
filename
®®3 ;
.
®®; <

StartsWith
®®< F
(
®®F G
$str
®®G N
)
®®N O
)
®®O P
{
©© 
filename
™™  
=
™™! "
$"
™™# %
$str
™™% (
{
™™( )
filename
™™) 1
}
™™1 2
"
™™2 3
;
™™3 4
}
´´ 
try
≠≠ 
{
ÆÆ 
if
ØØ 
(
ØØ 
fileInfo
ØØ $
is
ØØ% '
FileInfo
ØØ( 0
)
ØØ0 1
{
∞∞ 
return
±± "
new
±±# &
FileSecurity
±±' 3
(
±±3 4
filename
±±4 <
,
±±< =#
AccessControlSections
±±> S
.
±±S T
All
±±T W
)
±±W X
.
±±X Y+
GetSecurityDescriptorSddlForm
±±Y v
(
±±v w$
AccessControlSections±±w å
.±±å ç
All±±ç ê
)±±ê ë
;±±ë í
}
≤≤ 
else
≥≥ 
if
≥≥ 
(
≥≥  !
fileInfo
≥≥! )
is
≥≥* ,
DirectoryInfo
≥≥- :
)
≥≥: ;
{
¥¥ 
return
µµ "
new
µµ# &
DirectorySecurity
µµ' 8
(
µµ8 9
filename
µµ9 A
,
µµA B#
AccessControlSections
µµC X
.
µµX Y
All
µµY \
)
µµ\ ]
.
µµ] ^+
GetSecurityDescriptorSddlForm
µµ^ {
(
µµ{ |$
AccessControlSectionsµµ| ë
.µµë í
Allµµí ï
)µµï ñ
;µµñ ó
}
∂∂ 
}
∑∑ 
catch
∏∏ 
(
∏∏ 
	Exception
∏∏ $
e
∏∏% &
)
∏∏& '
when
∏∏( ,
(
∏∏- .
e
ππ 
is
ππ 
ArgumentException
ππ .
||
∫∫ 
e
∫∫ 
is
∫∫ #
ArgumentNullException
∫∫  5
||
ªª 
e
ªª 
is
ªª (
DirectoryNotFoundException
ªª  :
||
ºº 
e
ºº 
is
ºº #
FileNotFoundException
ºº  5
||
ΩΩ 
e
ΩΩ 
is
ΩΩ 
IOException
ΩΩ  +
||
ææ 
e
ææ 
is
ææ #
NotSupportedException
ææ  5
||
øø 
e
øø 
is
øø +
PlatformNotSupportedException
øø  =
||
¿¿ 
e
¿¿ 
is
¿¿ "
PathTooLongException
¿¿  4
||
¡¡ 
e
¡¡ 
is
¡¡ '
PrivilegeNotHeldException
¡¡  9
||
¬¬ 
e
¬¬ 
is
¬¬ 
SystemException
¬¬  /
||
√√ 
e
√√ 
is
√√ )
UnauthorizedAccessException
√√  ;
)
√√; <
{
ƒƒ 
var
≈≈ 
InfoType
≈≈ $
=
≈≈% &
fileInfo
≈≈' /
is
≈≈0 2
FileInfo
≈≈3 ;
?
≈≈< =
$str
≈≈> L
:
≈≈M N
$str
≈≈O b
;
≈≈b c
Log
∆∆ 
.
∆∆ 
Verbose
∆∆ #
(
∆∆# $
$"
∆∆$ &
$str
∆∆& 4
{
∆∆4 5
InfoType
∆∆5 =
}
∆∆= >
$str
∆∆> C
{
∆∆C D
fileInfo
∆∆D L
.
∆∆L M
FullName
∆∆M U
}
∆∆U V
$str
∆∆V W
{
∆∆W X
e
∆∆X Y
.
∆∆Y Z
GetType
∆∆Z a
(
∆∆a b
)
∆∆b c
.
∆∆c d
ToString
∆∆d l
(
∆∆l m
)
∆∆m n
}
∆∆n o
"
∆∆o p
)
∆∆p q
;
∆∆q r
}
«« 
catch
»» 
(
»» 
	Exception
»» $
e
»»% &
)
»»& '
{
…… 
Log
   
.
   
Debug
   !
(
  ! "
$"
  " $
$str
  $ C
{
  C D
e
  D E
.
  E F
GetType
  F M
(
  M N
)
  N O
.
  O P
ToString
  P X
(
  X Y
)
  Y Z
}
  Z [
"
  [ \
)
  \ ]
;
  ] ^
}
ÀÀ 
return
ÕÕ 
string
ÕÕ !
.
ÕÕ! "
Empty
ÕÕ" '
;
ÕÕ' (
}
ŒŒ 
}
œœ 
return
–– 
string
–– 
.
–– 
Empty
–– 
;
––  
}
—— 	
public
”” 
static
”” 
MacSignature
”” "
?
””" #
GetMacSignature
””$ 3
(
””3 4
string
””4 :
?
””: ;
Path
””< @
)
””@ A
{
‘‘ 	
try
’’ 
{
÷÷ 
if
◊◊ 
(
◊◊ #
ExternalCommandRunner
◊◊ )
.
◊◊) * 
RunExternalCommand
◊◊* <
(
◊◊< =
$str
◊◊= G
,
◊◊G H
$"
◊◊I K
$str
◊◊K ]
{
◊◊] ^
Path
◊◊^ b
}
◊◊b c
$str
◊◊c e
"
◊◊e f
,
◊◊f g
out
◊◊h k
string
◊◊l r
stdOut
◊◊s y
,
◊◊y z
out
◊◊{ ~
string◊◊ Ö
stdErr◊◊Ü å
)◊◊å ç
==◊◊é ê
$num◊◊ë í
)◊◊í ì
{
ÿÿ 
var
⁄⁄ 
splits
⁄⁄ 
=
⁄⁄  
stdErr
⁄⁄! '
.
⁄⁄' (
Split
⁄⁄( -
(
⁄⁄- .
$char
⁄⁄. 2
)
⁄⁄2 3
;
⁄⁄3 4
if
‹‹ 
(
‹‹ 
splits
‹‹ 
[
‹‹ 
$num
‹‹  
]
‹‹  !
.
‹‹! "
EndsWith
‹‹" *
(
‹‹* +
$str
‹‹+ M
)
‹‹M N
)
‹‹N O
{
›› 
return
ﬁﬁ 
null
ﬁﬁ #
;
ﬁﬁ# $
}
ﬂﬂ 
var
·· 
	signature
·· !
=
··" #
new
··$ '
MacSignature
··( 4
(
··4 5
)
··5 6
;
··6 7
foreach
„„ 
(
„„ 
var
„„  
split
„„! &
in
„„' )
splits
„„* 0
)
„„0 1
{
‰‰ 
var
ÂÂ 

innerSplit
ÂÂ &
=
ÂÂ' (
split
ÂÂ) .
.
ÂÂ. /
Split
ÂÂ/ 4
(
ÂÂ4 5
$char
ÂÂ5 8
)
ÂÂ8 9
;
ÂÂ9 :
switch
ÁÁ 
(
ÁÁ  

innerSplit
ÁÁ  *
[
ÁÁ* +
$num
ÁÁ+ ,
]
ÁÁ, -
)
ÁÁ- .
{
ËË 
case
ÈÈ  
$str
ÈÈ! ,
:
ÈÈ, -
	signature
ÍÍ  )
.
ÍÍ) *
HashType
ÍÍ* 2
=
ÍÍ3 4

innerSplit
ÍÍ5 ?
[
ÍÍ? @
$num
ÍÍ@ A
]
ÍÍA B
.
ÍÍB C
Split
ÍÍC H
(
ÍÍH I
$char
ÍÍI L
)
ÍÍL M
[
ÍÍM N
$num
ÍÍN O
]
ÍÍO P
;
ÍÍP Q
break
ÎÎ  %
;
ÎÎ% &
case
ÌÌ  
$str
ÌÌ! /
:
ÌÌ/ 0
	signature
ÓÓ  )
.
ÓÓ) *
HashChoices
ÓÓ* 5
=
ÓÓ6 7

innerSplit
ÓÓ8 B
[
ÓÓB C
$num
ÓÓC D
]
ÓÓD E
;
ÓÓE F
break
ÔÔ  %
;
ÔÔ% &
case
ÒÒ  
$str
ÒÒ! ,
:
ÒÒ, -
	signature
ÚÚ  )
.
ÚÚ) *
	CMSDigest
ÚÚ* 3
=
ÚÚ4 5

innerSplit
ÚÚ6 @
[
ÚÚ@ A
$num
ÚÚA B
]
ÚÚB C
;
ÚÚC D
break
ÛÛ  %
;
ÛÛ% &
case
ıı  
$str
ıı! ,
:
ıı, -
if
ˆˆ  "
(
ˆˆ# $
	signature
ˆˆ$ -
.
ˆˆ- .
Authorities
ˆˆ. 9
is
ˆˆ: <
null
ˆˆ= A
)
ˆˆA B
{
˜˜  !
	signature
¯¯$ -
.
¯¯- .
Authorities
¯¯. 9
=
¯¯: ;
new
¯¯< ?
List
¯¯@ D
<
¯¯D E
string
¯¯E K
>
¯¯K L
(
¯¯L M
)
¯¯M N
;
¯¯N O
}
˘˘  !
	signature
˙˙  )
.
˙˙) *
Authorities
˙˙* 5
.
˙˙5 6
Add
˙˙6 9
(
˙˙9 :

innerSplit
˙˙: D
[
˙˙D E
$num
˙˙E F
]
˙˙F G
)
˙˙G H
;
˙˙H I
break
˚˚  %
;
˚˚% &
case
˝˝  
$str
˝˝! ,
:
˝˝, -
if
˛˛  "
(
˛˛# $
DateTime
˛˛$ ,
.
˛˛, -
TryParse
˛˛- 5
(
˛˛5 6

innerSplit
˛˛6 @
[
˛˛@ A
$num
˛˛A B
]
˛˛B C
,
˛˛C D
out
˛˛E H
DateTime
˛˛I Q
result
˛˛R X
)
˛˛X Y
)
˛˛Y Z
{
ˇˇ  !
	signature
ÄÄ$ -
.
ÄÄ- .
	Timestamp
ÄÄ. 7
=
ÄÄ8 9
result
ÄÄ: @
;
ÄÄ@ A
}
ÅÅ  !
break
ÇÇ  %
;
ÇÇ% &
case
ÑÑ  
$str
ÑÑ! 1
:
ÑÑ1 2
	signature
ÖÖ  )
.
ÖÖ) *
TeamIdentifier
ÖÖ* 8
=
ÖÖ9 :

innerSplit
ÖÖ; E
[
ÖÖE F
$num
ÖÖF G
]
ÖÖG H
;
ÖÖH I
break
ÜÜ  %
;
ÜÜ% &
default
àà #
:
àà# $
if
ââ  "
(
ââ# $

innerSplit
ââ$ .
[
ââ. /
$num
ââ/ 0
]
ââ0 1
.
ââ1 2

StartsWith
ââ2 <
(
ââ< =
$str
ââ= R
)
ââR S
)
ââS T
{
ää  !
	signature
ãã$ -
.
ãã- .!
CandidateCDHashFull
ãã. A
=
ããB C

innerSplit
ããD N
[
ããN O
$num
ããO P
]
ããP Q
;
ããQ R
}
åå  !
break
çç  %
;
çç% &
}
éé 
}
èè 
return
ëë 
	signature
ëë $
;
ëë$ %
}
íí 
}
ìì 
catch
îî 
(
îî 
	Exception
îî 
e
îî 
)
îî 
{
ïï 
Log
ññ 
.
ññ 
Verbose
ññ 
(
ññ 
$str
ññ V
,
ññV W
Path
ññX \
,
ññ\ ]
e
ññ^ _
.
ññ_ `
GetType
ññ` g
(
ññg h
)
ññh i
,
ññi j
e
ññk l
.
ññl m
Message
ññm t
)
ññt u
;
ññu v
}
óó 
return
òò 
null
òò 
;
òò 
}
ôô 	
}
öö 
}õõ ˚ 
OD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\FirewallCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
FirewallCollector "
:# $
BaseCollector% 2
{ 
public 
FirewallCollector  
(  !
CollectorOptions! 1
?1 2
opts3 7
=8 9
null: >
,> ?
Action@ F
<F G
CollectObjectG T
>T U
?U V
changeHandlerW d
=e f
nullg k
)k l
:m n
baseo s
(s t
optst x
,x y
changeHandler	z á
)
á à
{ 	
} 	
public 
override 
bool 
CanRunOnPlatform -
(- .
). /
{ 	
return 
RuntimeInformation %
.% &
IsOSPlatform& 2
(2 3

OSPlatform3 =
.= >
Windows> E
)E F
||G I
RuntimeInformationJ \
.\ ]
IsOSPlatform] i
(i j

OSPlatformj t
.t u
OSXu x
)x y
||z |
RuntimeInformation	} è
.
è ê
IsOSPlatform
ê ú
(
ú ù

OSPlatform
ù ß
.
ß ®
Linux
® ≠
)
≠ Æ
;
Æ Ø
} 	
internal 
override 
void 
ExecuteInternal .
(. /
CancellationToken/ @
cancellationTokenA R
)R S
{ 	
if   
(   
RuntimeInformation   "
.  " #
IsOSPlatform  # /
(  / 0

OSPlatform  0 :
.  : ;
Windows  ; B
)  B C
)  C D
{!! 
ExecuteWindows"" 
("" 
cancellationToken"" 0
)""0 1
;""1 2
}## 
else$$ 
if$$ 
($$ 
RuntimeInformation$$ '
.$$' (
IsOSPlatform$$( 4
($$4 5

OSPlatform$$5 ?
.$$? @
OSX$$@ C
)$$C D
)$$D E
{%% 
ExecuteMacOs&& 
(&& 
cancellationToken&& .
)&&. /
;&&/ 0
}'' 
else(( 
if(( 
((( 
RuntimeInformation(( '
.((' (
IsOSPlatform((( 4
(((4 5

OSPlatform((5 ?
.((? @
Linux((@ E
)((E F
)((F G
{)) 
ExecuteLinux** 
(** 
cancellationToken** .
)**. /
;**/ 0
}++ 
},, 	
internal11 
void11 
ExecuteLinux11 "
(11" #
CancellationToken11# 4
cancellationToken115 F
)11F G
{22 	
if33 
(33 !
ExternalCommandRunner33 %
.33% &
RunExternalCommand33& 8
(338 9
$str339 C
,33C D
$str33E I
,33I J
out33K N
string33O U
result33V \
,33\ ]
out33^ a
string33b h
_33i j
)33j k
==33l n
$num33o p
)33p q
{44 
var55 
lines55 
=55 
new55 
List55  $
<55$ %
string55% +
>55+ ,
(55, -
result55- 3
.553 4
Split554 9
(559 :
$char55: >
)55> ?
)55? @
;55@ A

Dictionary77 
<77 
string77 !
,77! "
FirewallAction77# 1
>771 2
defaultPolicies773 B
=77C D
new77E H

Dictionary77I S
<77S T
string77T Z
,77Z [
FirewallAction77\ j
>77j k
(77k l
)77l m
;77m n
foreach99 
(99 
var99 
line99 !
in99" $
lines99% *
)99* +
{:: 
if;; 
(;; 
cancellationToken;; )
.;;) *#
IsCancellationRequested;;* A
);;A B
{;;C D
return;;E K
;;;K L
};;M N
if== 
(== 
line== 
.== 

StartsWith== '
(==' (
$str==( ,
)==, -
)==- .
{>> 
var?? 
	chainName?? %
=??& '
line??( ,
.??, -
Split??- 2
(??2 3
$char??3 6
)??6 7
[??7 8
$num??8 9
]??9 :
;??: ;
defaultPolicies@@ '
.@@' (
Add@@( +
(@@+ ,
	chainName@@, 5
,@@5 6
line@@7 ;
.@@; <
Contains@@< D
(@@D E
$str@@E M
)@@M N
?@@O P
FirewallAction@@Q _
.@@_ `
Allow@@` e
:@@f g
FirewallAction@@h v
.@@v w
Block@@w |
)@@| }
;@@} ~
varAA 
objAA 
=AA  !
newAA" %
FirewallObjectAA& 4
(AA4 5
$"AA5 7
$strAA7 ?
{AA? @
	chainNameAA@ I
}AAI J
$strAAJ Q
"AAQ R
)AAR S
{BB 
ActionCC "
=CC# $
defaultPoliciesCC% 4
[CC4 5
	chainNameCC5 >
]CC> ?
,CC? @
FriendlyNameDD (
=DD) *
$"DD+ -
$strDD- 5
{DD5 6
	chainNameDD6 ?
}DD? @
$strDD@ G
"DDG H
,DDH I
ScopeEE !
=EE" #
FirewallScopeEE$ 1
.EE1 2
AllEE2 5
}FF 
;FF 
ifGG 
(GG 
!GG 
	chainNameGG &
.GG& '
EqualsGG' -
(GG- .
$strGG. 7
)GG7 8
)GG8 9
{HH 
objII 
.II  
	DirectionII  )
=II* +
	chainNameII, 5
.II5 6
EqualsII6 <
(II< =
$strII= D
)IID E
?IIF G
FirewallDirectionIIH Y
.IIY Z
InboundIIZ a
:IIb c
FirewallDirectionIId u
.IIu v
OutboundIIv ~
;II~ 
}JJ 
HandleChangeLL $
(LL$ %
objLL% (
)LL( )
;LL) *
}MM 
elseNN 
ifNN 
(NN 
lineNN !
.NN! "

StartsWithNN" ,
(NN, -
$strNN- 1
)NN1 2
)NN2 3
{OO 
varPP 
splitsPP "
=PP# $
linePP% )
.PP) *
SplitPP* /
(PP/ 0
$charPP0 3
)PP3 4
;PP4 5
varQQ 
	chainNameQQ %
=QQ& '
splitsQQ( .
[QQ. /
$numQQ/ 0
]QQ0 1
;QQ1 2
varSS 
objSS 
=SS  !
newSS" %
FirewallObjectSS& 4
(SS4 5
lineSS5 9
)SS9 :
{TT 
ActionUU "
=UU# $
(UU% &
splitsUU& ,
[UU, -
ArrayUU- 2
.UU2 3
IndexOfUU3 :
(UU: ;
splitsUU; A
,UUA B
$strUUC G
)UUG H
+UUI J
$numUUK L
]UUL M
==UUN P
$strUUQ Y
)UUY Z
?UU[ \
FirewallActionUU] k
.UUk l
AllowUUl q
:UUr s
FirewallAction	UUt Ç
.
UUÇ É
Block
UUÉ à
,
UUà â
FriendlyNameVV (
=VV) *
lineVV+ /
,VV/ 0
ScopeWW !
=WW" #
FirewallScopeWW$ 1
.WW1 2
AllWW2 5
,WW5 6
ProtocolXX $
=XX% &
splitsXX' -
[XX- .
ArrayXX. 3
.XX3 4
IndexOfXX4 ;
(XX; <
splitsXX< B
,XXB C
$strXXD H
)XXH I
+XXJ K
$numXXL M
]XXM N
}YY 
;YY 
if[[ 
([[ 
Array[[ !
.[[! "
IndexOf[[" )
([[) *
splits[[* 0
,[[0 1
$str[[2 ;
)[[; <
>[[= >
$num[[? @
)[[@ A
{\\ 
obj]] 
.]]  
RemotePorts]]  +
=]], -
splits]]. 4
[]]4 5
Array]]5 :
.]]: ;
IndexOf]]; B
(]]B C
splits]]C I
,]]I J
$str]]K T
)]]T U
+]]V W
$num]]X Y
]]]Y Z
.]]Z [
OfType]][ a
<]]a b
string]]b h
>]]h i
(]]i j
)]]j k
.]]k l
ToList]]l r
(]]r s
)]]s t
;]]t u
}^^ 
if`` 
(`` 
Array`` !
.``! "
IndexOf``" )
(``) *
splits``* 0
,``0 1
$str``2 6
)``6 7
>``8 9
$num``: ;
)``; <
{aa 
objbb 
.bb  
RemoteAddressesbb  /
=bb0 1
splitsbb2 8
[bb8 9
Arraybb9 >
.bb> ?
IndexOfbb? F
(bbF G
splitsbbG M
,bbM N
$strbbO S
)bbS T
+bbU V
$numbbW X
]bbX Y
.bbY Z
OfTypebbZ `
<bb` a
stringbba g
>bbg h
(bbh i
)bbi j
.bbj k
ToListbbk q
(bbq r
)bbr s
;bbs t
}cc 
ifee 
(ee 
Arrayee !
.ee! "
IndexOfee" )
(ee) *
splitsee* 0
,ee0 1
$stree2 6
)ee6 7
>ee8 9
$numee: ;
)ee; <
{ff 
objgg 
.gg  
LocalAddressesgg  .
=gg/ 0
splitsgg1 7
[gg7 8
Arraygg8 =
.gg= >
IndexOfgg> E
(ggE F
splitsggF L
,ggL M
$strggN R
)ggR S
+ggT U
$numggV W
]ggW X
.ggX Y
OfTypeggY _
<gg_ `
stringgg` f
>ggf g
(ggg h
)ggh i
.ggi j
ToListggj p
(ggp q
)ggq r
;ggr s
}hh 
ifjj 
(jj 
Arrayjj !
.jj! "
IndexOfjj" )
(jj) *
splitsjj* 0
,jj0 1
$strjj2 ;
)jj; <
>jj= >
$numjj? @
)jj@ A
{kk 
objll 
.ll  

LocalPortsll  *
=ll+ ,
splitsll- 3
[ll3 4
Arrayll4 9
.ll9 :
IndexOfll: A
(llA B
splitsllB H
,llH I
$strllJ S
)llS T
+llU V
$numllW X
]llX Y
.llY Z
OfTypellZ `
<ll` a
stringlla g
>llg h
(llh i
)lli j
.llj k
ToListllk q
(llq r
)llr s
;lls t
}mm 
ifoo 
(oo 
!oo 
	chainNameoo &
.oo& '
Equalsoo' -
(oo- .
$stroo. 7
)oo7 8
)oo8 9
{pp 
objqq 
.qq  
	Directionqq  )
=qq* +
	chainNameqq, 5
.qq5 6
Equalsqq6 <
(qq< =
$strqq= D
)qqD E
?qqF G
FirewallDirectionqqH Y
.qqY Z
InboundqqZ a
:qqb c
FirewallDirectionqqd u
.qqu v
Outboundqqv ~
;qq~ 
}rr 
HandleChangett $
(tt$ %
objtt% (
)tt( )
;tt) *
}uu 
}vv 
}ww 
}xx 	
internal}} 
void}} 
ExecuteMacOs}} "
(}}" #
CancellationToken}}# 4
cancellationToken}}5 F
)}}F G
{~~ 	
var
ÄÄ 
result
ÄÄ 
=
ÄÄ #
ExternalCommandRunner
ÄÄ .
.
ÄÄ. / 
RunExternalCommand
ÄÄ/ A
(
ÄÄA B
$str
ÄÄB s
,
ÄÄs t
$strÄÄu á
)ÄÄá à
;ÄÄà â
var
ÅÅ 
enabled
ÅÅ 
=
ÅÅ 
result
ÅÅ  
.
ÅÅ  !
Contains
ÅÅ! )
(
ÅÅ) *
$str
ÅÅ* -
)
ÅÅ- .
;
ÅÅ. /
var
ÇÇ 
obj
ÇÇ 
=
ÇÇ 
new
ÇÇ 
FirewallObject
ÇÇ (
(
ÇÇ( )
$str
ÇÇ) ;
)
ÇÇ; <
{
ÉÉ 
Action
ÑÑ 
=
ÑÑ 
FirewallAction
ÑÑ '
.
ÑÑ' (
Block
ÑÑ( -
,
ÑÑ- .
	Direction
ÖÖ 
=
ÖÖ 
FirewallDirection
ÖÖ -
.
ÖÖ- .
Inbound
ÖÖ. 5
,
ÖÖ5 6
IsEnable
ÜÜ 
=
ÜÜ 
enabled
ÜÜ "
,
ÜÜ" #
FriendlyName
áá 
=
áá 
$str
áá 1
,
áá1 2
Scope
àà 
=
àà 
FirewallScope
àà %
.
àà% &
All
àà& )
}
ââ 
;
ââ 
HandleChange
ää 
(
ää 
obj
ää 
)
ää 
;
ää 
result
çç 
=
çç #
ExternalCommandRunner
çç *
.
çç* + 
RunExternalCommand
çç+ =
(
çç= >
$str
çç> o
,
çço p
$strççq É
)ççÉ Ñ
;ççÑ Ö
obj
éé 
=
éé 
new
éé 
FirewallObject
éé $
(
éé$ %
$str
éé% 3
)
éé3 4
{
èè 
Action
êê 
=
êê 
FirewallAction
êê '
.
êê' (
Block
êê( -
,
êê- .
	Direction
ëë 
=
ëë 
FirewallDirection
ëë -
.
ëë- .
Inbound
ëë. 5
,
ëë5 6
IsEnable
íí 
=
íí 
result
íí !
.
íí! "
Contains
íí" *
(
íí* +
$str
íí+ 4
)
íí4 5
,
íí5 6
FriendlyName
ìì 
=
ìì 
$str
ìì -
,
ìì- .
Scope
îî 
=
îî 
FirewallScope
îî %
.
îî% &
All
îî& )
}
ïï 
;
ïï 
HandleChange
ññ 
(
ññ 
obj
ññ 
)
ññ 
;
ññ 
result
õõ 
=
õõ #
ExternalCommandRunner
õõ *
.
õõ* + 
RunExternalCommand
õõ+ =
(
õõ= >
$str
õõ> o
,
õõo p
$strõõq É
)õõÉ Ñ
;õõÑ Ö
obj
úú 
=
úú 
new
úú 
FirewallObject
úú $
(
úú$ %
$str
úú% E
)
úúE F
{
ùù 
Action
ûû 
=
ûû 
FirewallAction
ûû '
.
ûû' (
Allow
ûû( -
,
ûû- .
	Direction
üü 
=
üü 
FirewallDirection
üü -
.
üü- .
Inbound
üü. 5
,
üü5 6
IsEnable
†† 
=
†† 
result
†† !
.
††! "
Split
††" '
(
††' (
$char
††( ,
)
††, -
[
††- .
$num
††. /
]
††/ 0
.
††0 1
Contains
††1 9
(
††9 :
$str
††: C
)
††C D
,
††D E
FriendlyName
°° 
=
°° 
$str
°° ?
,
°°? @
Scope
¢¢ 
=
¢¢ 
FirewallScope
¢¢ %
.
¢¢% &
All
¢¢& )
}
££ 
;
££ 
HandleChange
§§ 
(
§§ 
obj
§§ 
)
§§ 
;
§§ 
obj
¶¶ 
=
¶¶ 
new
¶¶ 
FirewallObject
¶¶ $
(
¶¶$ %
$str
¶¶% G
)
¶¶G H
{
ßß 
Action
®® 
=
®® 
FirewallAction
®® '
.
®®' (
Allow
®®( -
,
®®- .
	Direction
©© 
=
©© 
FirewallDirection
©© -
.
©©- .
Inbound
©©. 5
,
©©5 6
IsEnable
™™ 
=
™™ 
result
™™ !
.
™™! "
Split
™™" '
(
™™' (
$char
™™( ,
)
™™, -
[
™™- .
$num
™™. /
]
™™/ 0
.
™™0 1
Contains
™™1 9
(
™™9 :
$str
™™: C
)
™™C D
,
™™D E
FriendlyName
´´ 
=
´´ 
$str
´´ A
,
´´A B
Scope
¨¨ 
=
¨¨ 
FirewallScope
¨¨ %
.
¨¨% &
All
¨¨& )
}
≠≠ 
;
≠≠ 
HandleChange
ÆÆ 
(
ÆÆ 
obj
ÆÆ 
)
ÆÆ 
;
ÆÆ 
result
∏∏ 
=
∏∏ #
ExternalCommandRunner
∏∏ *
.
∏∏* + 
RunExternalCommand
∏∏+ =
(
∏∏= >
$str
∏∏> o
,
∏∏o p
$str
∏∏q }
)
∏∏} ~
;
∏∏~ 
string
ππ 
appName
ππ 
=
ππ 
$str
ππ 
;
ππ  
Regex
∫∫ 
startsWithNumber
∫∫ "
=
∫∫# $
new
∫∫% (
Regex
∫∫) .
(
∫∫. /
$str
∫∫/ 7
)
∫∫7 8
;
∫∫8 9
var
ªª 
lines
ªª 
=
ªª 
new
ªª 
List
ªª  
<
ªª  !
string
ªª! '
>
ªª' (
(
ªª( )
result
ªª) /
.
ªª/ 0
Split
ªª0 5
(
ªª5 6
$char
ªª6 :
)
ªª: ;
)
ªª; <
;
ªª< =
if
ºº 
(
ºº 
lines
ºº 
.
ºº 
Any
ºº 
(
ºº 
)
ºº 
)
ºº 
{
ΩΩ 
lines
ææ 
=
ææ 
lines
ææ 
.
ææ 
Skip
ææ "
(
ææ" #
$num
ææ# $
)
ææ$ %
.
ææ% &
ToList
ææ& ,
(
ææ, -
)
ææ- .
;
ææ. /
foreach
øø 
(
øø 
var
øø 
line
øø !
in
øø" $
lines
øø% *
)
øø* +
{
¿¿ 
if
¡¡ 
(
¡¡ 
cancellationToken
¡¡ )
.
¡¡) *%
IsCancellationRequested
¡¡* A
)
¡¡A B
{
¡¡C D
return
¡¡E K
;
¡¡K L
}
¡¡M N
if
√√ 
(
√√ 
startsWithNumber
√√ (
.
√√( )
IsMatch
√√) 0
(
√√0 1
line
√√1 5
)
√√5 6
)
√√6 7
{
ƒƒ 
appName
≈≈ 
=
≈≈  !
line
≈≈" &
.
≈≈& '
	Substring
≈≈' 0
(
≈≈0 1
line
≈≈1 5
.
≈≈5 6
IndexOf
≈≈6 =
(
≈≈= >
$char
≈≈> A
)
≈≈A B
)
≈≈B C
;
≈≈C D
}
∆∆ 
else
«« 
if
«« 
(
«« 
line
«« !
.
««! "
Contains
««" *
(
««* +
$str
««+ A
)
««A B
)
««B C
{
»» 
obj
…… 
=
…… 
new
…… !
FirewallObject
……" 0
(
……0 1
appName
……1 8
)
……8 9
{
   
Action
ÀÀ "
=
ÀÀ# $
(
ÀÀ% &
line
ÀÀ& *
.
ÀÀ* +
Contains
ÀÀ+ 3
(
ÀÀ3 4
$str
ÀÀ4 ;
)
ÀÀ; <
)
ÀÀ< =
?
ÀÀ> ?
FirewallAction
ÀÀ@ N
.
ÀÀN O
Allow
ÀÀO T
:
ÀÀU V
FirewallAction
ÀÀW e
.
ÀÀe f
Block
ÀÀf k
,
ÀÀk l
	Direction
ÃÃ %
=
ÃÃ& '
FirewallDirection
ÃÃ( 9
.
ÃÃ9 :
Inbound
ÃÃ: A
,
ÃÃA B
FriendlyName
ÕÕ (
=
ÕÕ) *
appName
ÕÕ+ 2
,
ÕÕ2 3
Scope
ŒŒ !
=
ŒŒ" #
FirewallScope
ŒŒ$ 1
.
ŒŒ1 2
All
ŒŒ2 5
}
œœ 
;
œœ 
HandleChange
–– $
(
––$ %
obj
––% (
)
––( )
;
––) *
}
—— 
}
““ 
}
”” 
}
‘‘ 	
[
ŸŸ 	
System
ŸŸ	 
.
ŸŸ 
Diagnostics
ŸŸ 
.
ŸŸ 
CodeAnalysis
ŸŸ (
.
ŸŸ( )
SuppressMessage
ŸŸ) 8
(
ŸŸ8 9
$str
ŸŸ9 A
,
ŸŸA B
$str
ŸŸC p
,
ŸŸp q
Justification
ŸŸr 
=ŸŸÄ Å
$strŸŸÇ ∆
)ŸŸ∆ «
]ŸŸ« »
internal
⁄⁄ 
void
⁄⁄ 
ExecuteWindows
⁄⁄ $
(
⁄⁄$ %
CancellationToken
⁄⁄% 6
cancellationToken
⁄⁄7 H
)
⁄⁄H I
{
€€ 	
try
‹‹ 
{
›› 
foreach
ﬁﬁ 
(
ﬁﬁ 
IFirewallRule
ﬁﬁ &
rule
ﬁﬁ' +
in
ﬁﬁ, .
FirewallManager
ﬁﬁ/ >
.
ﬁﬁ> ?
Instance
ﬁﬁ? G
.
ﬁﬁG H
Rules
ﬁﬁH M
)
ﬁﬁM N
{
ﬂﬂ 
if
‡‡ 
(
‡‡ 
cancellationToken
‡‡ )
.
‡‡) *%
IsCancellationRequested
‡‡* A
)
‡‡A B
{
‡‡C D
return
‡‡E K
;
‡‡K L
}
‡‡M N
try
‚‚ 
{
„„ 
var
‰‰ 
obj
‰‰ 
=
‰‰  !
new
‰‰" %
FirewallObject
‰‰& 4
(
‰‰4 5
rule
‰‰5 9
.
‰‰9 :
Name
‰‰: >
)
‰‰> ?
{
ÂÂ 
Action
ÊÊ "
=
ÊÊ# $
rule
ÊÊ% )
.
ÊÊ) *
Action
ÊÊ* 0
,
ÊÊ0 1
ApplicationName
ÁÁ +
=
ÁÁ, -
rule
ÁÁ. 2
.
ÁÁ2 3
ApplicationName
ÁÁ3 B
,
ÁÁB C
	Direction
ËË %
=
ËË& '
rule
ËË( ,
.
ËË, -
	Direction
ËË- 6
,
ËË6 7
FriendlyName
ÈÈ (
=
ÈÈ) *
rule
ÈÈ+ /
.
ÈÈ/ 0
FriendlyName
ÈÈ0 <
,
ÈÈ< =
IsEnable
ÍÍ $
=
ÍÍ% &
rule
ÍÍ' +
.
ÍÍ+ ,
IsEnable
ÍÍ, 4
,
ÍÍ4 5
LocalPortType
ÎÎ )
=
ÎÎ* +
rule
ÎÎ, 0
.
ÎÎ0 1
LocalPortType
ÎÎ1 >
,
ÎÎ> ?
Profiles
ÏÏ $
=
ÏÏ% &
rule
ÏÏ' +
.
ÏÏ+ ,
Profiles
ÏÏ, 4
,
ÏÏ4 5
Protocol
ÌÌ $
=
ÌÌ% &
rule
ÌÌ' +
.
ÌÌ+ ,
Protocol
ÌÌ, 4
.
ÌÌ4 5
ProtocolNumber
ÌÌ5 C
.
ÌÌC D
ToString
ÌÌD L
(
ÌÌL M
CultureInfo
ÌÌM X
.
ÌÌX Y
InvariantCulture
ÌÌY i
)
ÌÌi j
,
ÌÌj k
Scope
ÓÓ !
=
ÓÓ" #
rule
ÓÓ$ (
.
ÓÓ( )
Scope
ÓÓ) .
,
ÓÓ. /
ServiceName
ÔÔ '
=
ÔÔ( )
rule
ÔÔ* .
.
ÔÔ. /
ServiceName
ÔÔ/ :
}
 
;
 
obj
ÒÒ 
.
ÒÒ 
LocalAddresses
ÒÒ *
=
ÒÒ+ ,
rule
ÒÒ- 1
.
ÒÒ1 2
LocalAddresses
ÒÒ2 @
.
ÒÒ@ A
ToList
ÒÒA G
(
ÒÒG H
)
ÒÒH I
.
ÒÒI J

ConvertAll
ÒÒJ T
(
ÒÒT U
address
ÒÒU \
=>
ÒÒ] _
address
ÒÒ` g
.
ÒÒg h
ToString
ÒÒh p
(
ÒÒp q
)
ÒÒq r
)
ÒÒr s
;
ÒÒs t
obj
ÚÚ 
.
ÚÚ 

LocalPorts
ÚÚ &
=
ÚÚ' (
rule
ÚÚ) -
.
ÚÚ- .

LocalPorts
ÚÚ. 8
.
ÚÚ8 9
ToList
ÚÚ9 ?
(
ÚÚ? @
)
ÚÚ@ A
.
ÚÚA B

ConvertAll
ÚÚB L
(
ÚÚL M
port
ÚÚM Q
=>
ÚÚR T
port
ÚÚU Y
.
ÚÚY Z
ToString
ÚÚZ b
(
ÚÚb c
CultureInfo
ÚÚc n
.
ÚÚn o
InvariantCulture
ÚÚo 
)ÚÚ Ä
)ÚÚÄ Å
;ÚÚÅ Ç
obj
ÛÛ 
.
ÛÛ 
RemoteAddresses
ÛÛ +
=
ÛÛ, -
rule
ÛÛ. 2
.
ÛÛ2 3
RemoteAddresses
ÛÛ3 B
.
ÛÛB C
ToList
ÛÛC I
(
ÛÛI J
)
ÛÛJ K
.
ÛÛK L

ConvertAll
ÛÛL V
(
ÛÛV W
address
ÛÛW ^
=>
ÛÛ_ a
address
ÛÛb i
.
ÛÛi j
ToString
ÛÛj r
(
ÛÛr s
)
ÛÛs t
)
ÛÛt u
;
ÛÛu v
obj
ÙÙ 
.
ÙÙ 
RemotePorts
ÙÙ '
=
ÙÙ( )
rule
ÙÙ* .
.
ÙÙ. /
RemotePorts
ÙÙ/ :
.
ÙÙ: ;
ToList
ÙÙ; A
(
ÙÙA B
)
ÙÙB C
.
ÙÙC D

ConvertAll
ÙÙD N
(
ÙÙN O
port
ÙÙO S
=>
ÙÙT V
port
ÙÙW [
.
ÙÙ[ \
ToString
ÙÙ\ d
(
ÙÙd e
CultureInfo
ÙÙe p
.
ÙÙp q
InvariantCultureÙÙq Å
)ÙÙÅ Ç
)ÙÙÇ É
;ÙÙÉ Ñ
HandleChange
ıı $
(
ıı$ %
obj
ıı% (
)
ıı( )
;
ıı) *
}
ˆˆ 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ $
e
˜˜% &
)
˜˜& '
{
¯¯ 
Log
˘˘ 
.
˘˘ 
Debug
˘˘ !
(
˘˘! "
e
˘˘" #
,
˘˘# $
$str
˘˘% T
)
˘˘T U
;
˘˘U V
}
˙˙ 
}
˚˚ 
}
¸¸ 
catch
˝˝ 
(
˝˝ 
	Exception
˝˝ 
e
˝˝ 
)
˝˝ 
when
˝˝  $
(
˝˝% &
e
˛˛ 
is
˛˛ 
COMException
˛˛ !
||
˛˛" $
e
ˇˇ 
is
ˇˇ #
NotSupportedException
ˇˇ *
)
ˇˇ* +
{
ÄÄ 
Log
ÅÅ 
.
ÅÅ 
Warning
ÅÅ 
(
ÅÅ 
Strings
ÅÅ #
.
ÅÅ# $
Get
ÅÅ$ '
(
ÅÅ' (
$str
ÅÅ( I
)
ÅÅI J
,
ÅÅJ K
GetType
ÅÅL S
(
ÅÅS T
)
ÅÅT U
.
ÅÅU V
ToString
ÅÅV ^
(
ÅÅ^ _
)
ÅÅ_ `
)
ÅÅ` a
;
ÅÅa b
}
ÇÇ 
}
ÉÉ 	
}
ÑÑ 
}ÖÖ ’
OD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\IPlatformRunnable.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

	interface 
IPlatformRunnable &
{ 
bool 
CanRunOnPlatform 
( 
) 
;  
} 
} ‘ç
OD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\OpenPortCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
OpenPortCollector "
:# $
BaseCollector% 2
{ 
public 
OpenPortCollector  
(  !
CollectorOptions! 1
?1 2
opts3 7
=8 9
null: >
,> ?
Action@ F
<F G
CollectObjectG T
>T U
?U V
changeHandlerW d
=e f
nullg k
)k l
:m n
baseo s
(s t
optst x
,x y
changeHandler	z á
)
á à
{ 	
} 	
public 
override 
bool 
CanRunOnPlatform -
(- .
). /
{ 	
try 
{ 
var 
	osRelease 
= 
File  $
.$ %
ReadAllText% 0
(0 1
$str1 M
)M N
??O Q
$strR T
;T U
	osRelease 
= 
	osRelease %
.% &
ToUpperInvariant& 6
(6 7
)7 8
;8 9
if 
( 
	osRelease 
. 
Contains &
(& '
$str' 2
)2 3
||4 6
	osRelease7 @
.@ A
ContainsA I
(I J
$strJ O
)O P
)P Q
{ 
Log   
.   
Error   
(   
$str	   Ä
)
  Ä Å
;
  Å Ç
return!! 
false!!  
;!!  !
}"" 
}## 
catch$$ 
($$ 
	Exception$$ 
)$$ 
{%% 
}'' 
;'' 
return)) 
RuntimeInformation)) %
.))% &
IsOSPlatform))& 2
())2 3

OSPlatform))3 =
.))= >
Windows))> E
)))E F
||))G I
RuntimeInformation))J \
.))\ ]
IsOSPlatform))] i
())i j

OSPlatform))j t
.))t u
Linux))u z
)))z {
||))| ~
RuntimeInformation	)) ë
.
))ë í
IsOSPlatform
))í û
(
))û ü

OSPlatform
))ü ©
.
))© ™
OSX
))™ ≠
)
))≠ Æ
;
))Æ Ø
}** 	
internal,, 
override,, 
void,, 
ExecuteInternal,, .
(,,. /
CancellationToken,,/ @
cancellationToken,,A R
),,R S
{-- 	
if.. 
(.. 
RuntimeInformation.. "
..." #
IsOSPlatform..# /
(../ 0

OSPlatform..0 :
...: ;
Windows..; B
)..B C
)..C D
{// 
ExecuteWindows00 
(00 
cancellationToken00 0
)000 1
;001 2
}11 
else22 
if22 
(22 
RuntimeInformation22 '
.22' (
IsOSPlatform22( 4
(224 5

OSPlatform225 ?
.22? @
Linux22@ E
)22E F
)22F G
{33 
ExecuteLinux44 
(44 
cancellationToken44 .
)44. /
;44/ 0
}55 
else66 
if66 
(66 
RuntimeInformation66 '
.66' (
IsOSPlatform66( 4
(664 5

OSPlatform665 ?
.66? @
OSX66@ C
)66C D
)66D E
{77 

ExecuteOsX88 
(88 
cancellationToken88 ,
)88, -
;88- .
}99 
}:: 	
internal@@ 
void@@ 
ExecuteLinux@@ "
(@@" #
CancellationToken@@# 4
cancellationToken@@5 F
)@@F G
{AA 	
tryBB 
{CC 
varDD 
resultDD 
=DD !
ExternalCommandRunnerDD 2
.DD2 3
RunExternalCommandDD3 E
(DDE F
$strDDF J
,DDJ K
$strDDL Q
)DDQ R
;DDR S
foreachFF 
(FF 
varFF 
_lineFF "
inFF# %
resultFF& ,
.FF, -
SplitFF- 2
(FF2 3
$charFF3 7
)FF7 8
)FF8 9
{GG 
ifHH 
(HH 
cancellationTokenHH )
.HH) *#
IsCancellationRequestedHH* A
)HHA B
{HHC D
returnHHE K
;HHK L
}HHM N
varJJ 
lineJJ 
=JJ 
_lineJJ $
;JJ$ %
lineKK 
=KK 
lineKK 
.KK  
ToUpperInvariantKK  0
(KK0 1
)KK1 2
;KK2 3
ifLL 
(LL 
!LL 
lineLL 
.LL 
ContainsLL &
(LL& '
$strLL' /
)LL/ 0
)LL0 1
{MM 
continueNN  
;NN  !
}OO 
varPP 
partsPP 
=PP 
RegexPP  %
.PP% &
SplitPP& +
(PP+ ,
linePP, 0
,PP0 1
$strPP2 8
)PP8 9
;PP9 :
ifQQ 
(QQ 
partsQQ 
.QQ 
LengthQQ $
<QQ% &
$numQQ' (
)QQ( )
{RR 
continueSS  
;SS  !
}TT 
varVV 
addressMatchesVV &
=VV' (
RegexVV) .
.VV. /
MatchVV/ 4
(VV4 5
partsVV5 :
[VV: ;
$numVV; <
]VV< =
,VV= >
$strVV? N
)VVN O
;VVO P
ifWW 
(WW 
addressMatchesWW &
.WW& '
SuccessWW' .
)WW. /
{XX 
varYY 
addressYY #
=YY$ %
addressMatchesYY& 4
.YY4 5
GroupsYY5 ;
[YY; <
$numYY< =
]YY= >
.YY> ?
ToStringYY? G
(YYG H
)YYH I
;YYI J
varZZ 
portZZ  
=ZZ! "
addressMatchesZZ# 1
.ZZ1 2
GroupsZZ2 8
[ZZ8 9
$numZZ9 :
]ZZ: ;
.ZZ; <
ToStringZZ< D
(ZZD E
)ZZE F
;ZZF G
if[[ 
([[ 
int[[ 
.[[  
TryParse[[  (
([[( )
port[[) -
,[[- .
out[[/ 2
int[[3 6
portInt[[7 >
)[[> ?
)[[? @
{\\ 
var]] 
	transport]]  )
=]]* +
parts]], 1
[]]1 2
$num]]2 3
]]]3 4
.]]4 5
ToUpperInvariant]]5 E
(]]E F
)]]F G
.]]G H
Equals]]H N
(]]N O
$str]]O T
)]]T U
?]]V W
	TRANSPORT]]X a
.]]a b
TCP]]b e
:]]f g
	TRANSPORT]]h q
.]]q r
UDP]]r u
;]]u v
var^^ 
family^^  &
=^^' (
address^^) 0
.^^0 1
Contains^^1 9
(^^9 :
$char^^: =
)^^= >
?^^? @
ADDRESS_FAMILY^^A O
.^^O P
InterNetwork^^P \
:^^] ^
address^^_ f
.^^f g
Contains^^g o
(^^o p
$char^^p s
)^^s t
?^^u v
ADDRESS_FAMILY	^^w Ö
.
^^Ö Ü
InterNetworkV6
^^Ü î
:
^^ï ñ
ADDRESS_FAMILY
^^ó •
.
^^• ¶
Unknown
^^¶ ≠
;
^^≠ Æ
var__ 
obj__  #
=__$ %
new__& )
OpenPortObject__* 8
(__8 9
portInt__9 @
,__@ A
	transport__B K
,__K L
family__M S
)__S T
{`` 
Addressaa  '
=aa( )
addressaa* 1
}bb 
;bb 
HandleChangecc (
(cc( )
objcc) ,
)cc, -
;cc- .
}dd 
}ee 
}ff 
}gg 
catchhh 
(hh 
	Exceptionhh 
ehh 
)hh 
{ii 
Logjj 
.jj 
Warningjj 
(jj 
Stringsjj #
.jj# $
Getjj$ '
(jj' (
$strjj( 6
)jj6 7
)jj7 8
;jj8 9
Logkk 
.kk 
Debugkk 
(kk 
ekk 
,kk 
$strkk 
)kk  
;kk  !
}ll 
}mm 	
internalss 
voidss 

ExecuteOsXss  
(ss  !
CancellationTokenss! 2
cancellationTokenss3 D
)ssD E
{tt 	
tryuu 
{vv 
stringww 
resultww 
=ww !
ExternalCommandRunnerww  5
.ww5 6
RunExternalCommandww6 H
(wwH I
$strwwI O
,wwO P
$strwwQ ^
)ww^ _
;ww_ `
foreachyy 
(yy 
varyy 
_lineyy "
inyy# %
resultyy& ,
.yy, -
Splityy- 2
(yy2 3
$charyy3 7
)yy7 8
)yy8 9
{zz 
if{{ 
({{ 
cancellationToken{{ )
.{{) *#
IsCancellationRequested{{* A
){{A B
{{{C D
return{{E K
;{{K L
}{{M N
var}} 
line}} 
=}} 
_line}} $
.}}$ %
ToUpperInvariant}}% 5
(}}5 6
)}}6 7
;}}7 8
if~~ 
(~~ 
!~~ 
line~~ 
.~~ 
Contains~~ &
(~~& '
$str~~' /
)~~/ 0
)~~0 1
{ 
continue
ÄÄ  
;
ÄÄ  !
}
ÅÅ 
var
ÇÇ 
parts
ÇÇ 
=
ÇÇ 
Regex
ÇÇ  %
.
ÇÇ% &
Split
ÇÇ& +
(
ÇÇ+ ,
line
ÇÇ, 0
,
ÇÇ0 1
$str
ÇÇ2 8
)
ÇÇ8 9
;
ÇÇ9 :
if
ÉÉ 
(
ÉÉ 
parts
ÉÉ 
.
ÉÉ 
Length
ÉÉ $
<=
ÉÉ% '
$num
ÉÉ( )
)
ÉÉ) *
{
ÑÑ 
continue
ÖÖ  
;
ÖÖ  !
}
ÜÜ 
var
àà 
addressMatches
àà &
=
àà' (
Regex
àà) .
.
àà. /
Match
àà/ 4
(
àà4 5
parts
àà5 :
[
àà: ;
$num
àà; <
]
àà< =
,
àà= >
$str
àà? N
)
ààN O
;
ààO P
if
ââ 
(
ââ 
addressMatches
ââ &
.
ââ& '
Success
ââ' .
)
ââ. /
{
ää 
var
ãã 
address
ãã #
=
ãã$ %
addressMatches
ãã& 4
.
ãã4 5
Groups
ãã5 ;
[
ãã; <
$num
ãã< =
]
ãã= >
.
ãã> ?
ToString
ãã? G
(
ããG H
)
ããH I
;
ããI J
var
åå 
port
åå  
=
åå! "
addressMatches
åå# 1
.
åå1 2
Groups
åå2 8
[
åå8 9
$num
åå9 :
]
åå: ;
.
åå; <
ToString
åå< D
(
ååD E
)
ååE F
;
ååF G
if
çç 
(
çç 
int
çç 
.
çç  
TryParse
çç  (
(
çç( )
port
çç) -
,
çç- .
out
çç/ 2
int
çç3 6
portInt
çç7 >
)
çç> ?
)
çç? @
{
éé 
var
èè 
	transport
èè  )
=
èè* +
parts
èè, 1
[
èè1 2
$num
èè2 3
]
èè3 4
.
èè4 5
ToUpperInvariant
èè5 E
(
èèE F
)
èèF G
.
èèG H
Equals
èèH N
(
èèN O
$str
èèO T
)
èèT U
?
èèV W
	TRANSPORT
èèX a
.
èèa b
TCP
èèb e
:
èèf g
parts
èèh m
[
èèm n
$num
èèn o
]
èèo p
.
èèp q
ToUpperInvariantèèq Å
(èèÅ Ç
)èèÇ É
.èèÉ Ñ
EqualsèèÑ ä
(èèä ã
$strèèã ê
)èèê ë
?èèí ì
	TRANSPORTèèî ù
.èèù û
UDPèèû °
:èè¢ £
	TRANSPORTèè§ ≠
.èè≠ Æ
UNKNOWNèèÆ µ
;èèµ ∂
var
êê 
family
êê  &
=
êê' (
ADDRESS_FAMILY
êê) 7
.
êê7 8
Unknown
êê8 ?
;
êê? @
switch
íí "
(
íí# $
parts
íí$ )
[
íí) *
$num
íí* +
]
íí+ ,
)
íí, -
{
ìì 
case
îî  $
$str
îî% +
:
îî+ ,
family
ïï$ *
=
ïï+ ,
ADDRESS_FAMILY
ïï- ;
.
ïï; <
InterNetwork
ïï< H
;
ïïH I
break
ññ$ )
;
ññ) *
case
òò  $
$str
òò% +
:
òò+ ,
family
ôô$ *
=
ôô+ ,
ADDRESS_FAMILY
ôô- ;
.
ôô; <
InterNetworkV6
ôô< J
;
ôôJ K
break
öö$ )
;
öö) *
default
úú  '
:
úú' (
family
ùù$ *
=
ùù+ ,
ADDRESS_FAMILY
ùù- ;
.
ùù; <
Unknown
ùù< C
;
ùùC D
break
ûû$ )
;
ûû) *
}
üü 
var
°° 
obj
°°  #
=
°°$ %
new
°°& )
OpenPortObject
°°* 8
(
°°8 9
portInt
°°9 @
,
°°@ A
	transport
°°B K
,
°°K L
family
°°M S
)
°°S T
{
¢¢ 
Address
££  '
=
££( )
address
££* 1
,
££1 2
ProcessName
§§  +
=
§§, -
parts
§§. 3
[
§§3 4
$num
§§4 5
]
§§5 6
}
•• 
;
•• 
HandleChange
ßß (
(
ßß( )
obj
ßß) ,
)
ßß, -
;
ßß- .
}
®® 
}
©© 
}
™™ 
}
´´ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
e
¨¨ 
)
¨¨ 
{
≠≠ 
Log
ÆÆ 
.
ÆÆ 
Error
ÆÆ 
(
ÆÆ 
e
ÆÆ 
,
ÆÆ 
Strings
ÆÆ $
.
ÆÆ$ %
Get
ÆÆ% (
(
ÆÆ( )
$str
ÆÆ) 3
)
ÆÆ3 4
)
ÆÆ4 5
;
ÆÆ5 6
}
ØØ 
}
∞∞ 	
internal
∂∂ 
void
∂∂ 
ExecuteWindows
∂∂ $
(
∂∂$ %
CancellationToken
∂∂% 6
cancellationToken
∂∂7 H
)
∂∂H I
{
∑∑ 	
var
∏∏ 

properties
∏∏ 
=
∏∏  
IPGlobalProperties
∏∏ /
.
∏∏/ 0#
GetIPGlobalProperties
∏∏0 E
(
∏∏E F
)
∏∏F G
;
∏∏G H
foreach
∫∫ 
(
∫∫ 
var
∫∫ 
endpoint
∫∫ !
in
∫∫" $

properties
∫∫% /
.
∫∫/ 0#
GetActiveTcpListeners
∫∫0 E
(
∫∫E F
)
∫∫F G
)
∫∫G H
{
ªª 
if
ºº 
(
ºº 
cancellationToken
ºº %
.
ºº% &%
IsCancellationRequested
ºº& =
)
ºº= >
{
ºº? @
return
ººA G
;
ººG H
}
ººI J
var
ææ 
obj
ææ 
=
ææ 
new
ææ 
OpenPortObject
ææ ,
(
ææ, -
endpoint
ææ- 5
.
ææ5 6
Port
ææ6 :
,
ææ: ;
	TRANSPORT
ææ< E
.
ææE F
TCP
ææF I
,
ææI J
(
ææK L
ADDRESS_FAMILY
ææL Z
)
ææZ [
endpoint
ææ[ c
.
ææc d
AddressFamily
ææd q
)
ææq r
{
øø 
Address
¿¿ 
=
¿¿ 
endpoint
¿¿ &
.
¿¿& '
Address
¿¿' .
.
¿¿. /
ToString
¿¿/ 7
(
¿¿7 8
)
¿¿8 9
,
¿¿9 :
}
¡¡ 
;
¡¡ 
obj
√√ 
.
√√ 
ProcessName
√√ 
=
√√  !
Win32ProcessPorts
√√" 3
.
√√3 4
ProcessPortMap
√√4 B
.
√√B C
Find
√√C G
(
√√G H
x
√√H I
=>
√√J L
x
√√M N
.
√√N O

PortNumber
√√O Y
==
√√Z \
endpoint
√√] e
.
√√e f
Port
√√f j
)
√√j k
?
√√k l
.
√√l m
ProcessName
√√m x
;
√√x y
HandleChange
≈≈ 
(
≈≈ 
obj
≈≈  
)
≈≈  !
;
≈≈! "
}
∆∆ 
foreach
»» 
(
»» 
var
»» 
endpoint
»» !
in
»»" $

properties
»»% /
.
»»/ 0#
GetActiveUdpListeners
»»0 E
(
»»E F
)
»»F G
)
»»G H
{
…… 
var
   
obj
   
=
   
new
   
OpenPortObject
   ,
(
  , -
endpoint
  - 5
.
  5 6
Port
  6 :
,
  : ;
	TRANSPORT
  < E
.
  E F
UDP
  F I
,
  I J
(
  K L
ADDRESS_FAMILY
  L Z
)
  Z [
endpoint
  [ c
.
  c d
AddressFamily
  d q
)
  q r
{
ÀÀ 
Address
ÃÃ 
=
ÃÃ 
endpoint
ÃÃ &
.
ÃÃ& '
Address
ÃÃ' .
.
ÃÃ. /
ToString
ÃÃ/ 7
(
ÃÃ7 8
)
ÃÃ8 9
}
ÕÕ 
;
ÕÕ 
obj
œœ 
.
œœ 
ProcessName
œœ 
=
œœ  !
Win32ProcessPorts
œœ" 3
.
œœ3 4
ProcessPortMap
œœ4 B
.
œœB C
Find
œœC G
(
œœG H
x
œœH I
=>
œœJ L
x
œœM N
.
œœN O

PortNumber
œœO Y
==
œœZ \
endpoint
œœ] e
.
œœe f
Port
œœf j
)
œœj k
?
œœk l
.
œœl m
ProcessName
œœm x
;
œœx y
HandleChange
—— 
(
—— 
obj
——  
)
——  !
;
——! "
}
““ 
}
”” 	
}
‘‘ 
}’’ «
ND:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\ProcessCollector.cs
	namespace		 	
	Microsoft		
 
.		 
CST		 
.		 !
AttackSurfaceAnalyzer		 -
.		- .

Collectors		. 8
{

 
public 

class 
ProcessCollector !
:" #
BaseCollector$ 1
{ 
public 
ProcessCollector 
(  
CollectorOptions  0
?0 1
opts2 6
=7 8
null9 =
,= >
Action? E
<E F
CollectObjectF S
>S T
?T U
changeHandlerV c
=d e
nullf j
)j k
:l m
basen r
(r s
optss w
,w x
changeHandler	y Ü
)
Ü á
{
à â
}
ä ã
public 
override 
bool 
CanRunOnPlatform -
(- .
). /
{ 	
return 
RuntimeInformation %
.% &
IsOSPlatform& 2
(2 3

OSPlatform3 =
.= >
Windows> E
)E F
||G I
RuntimeInformationJ \
.\ ]
IsOSPlatform] i
(i j

OSPlatformj t
.t u
Linuxu z
)z {
||| ~
RuntimeInformation	 ë
.
ë í
IsOSPlatform
í û
(
û ü

OSPlatform
ü ©
.
© ™
OSX
™ ≠
)
≠ Æ
;
Æ Ø
} 	
internal 
override 
void 
ExecuteInternal .
(. /
CancellationToken/ @
cancellationTokenA R
)R S
{ 	
Parallel   
.   
ForEach   
(   
Process   $
.  $ %
GetProcesses  % 1
(  1 2
)  2 3
,  3 4
new  5 8
ParallelOptions  9 H
(  H I
)  I J
{  K L
CancellationToken  M ^
=  _ `
cancellationToken  a r
}  s t
,  t u
process  v }
=>	  ~ Ä
{!! 
if"" 
("" 
ProcessObject"" !
.""! "
FromProcess""" -
(""- .
process"". 5
)""5 6
is""7 9
ProcessObject"": G
po""H J
)""J K
HandleChange##  
(##  !
po##! #
)### $
;##$ %
}$$ 
)$$ 
;$$ 
}%% 	
}&& 
}'' ãb
OD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\RegistryCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
RegistryCollector "
:# $
BaseCollector% 2
{ 
public 
RegistryCollector  
(  !
CollectorOptions! 1
?1 2
opts3 7
=8 9
null: >
,> ?
Action@ F
<F G
CollectObjectG T
>T U
?U V
changeHandlerW d
=e f
nullg k
)k l
:m n
baseo s
(s t
optst x
,x y
changeHandler	z á
)
á à
{ 	
this 
. 
opts 
= 
opts 
?? 
this  $
.$ %
opts% )
;) *
Hives 
= 
DefaultHives  
;  !
if 
( 
opts 
!= 
null 
) 
{ 
Parallelize 
= 
! 
opts #
.# $
SingleThread$ 0
;0 1
if 
( 
opts 
. 
SelectedHives &
.& '
Any' *
(* +
)+ ,
), -
{ 
Hives 
= 
new 
List  $
<$ %
(% &
RegistryHive& 2
,2 3
string4 :
): ;
>; <
(< =
)= >
;> ?
foreach 
( 
var  
hive! %
in& (
opts) -
.- .
SelectedHives. ;
); <
{ 
var   

innerSplit   &
=  ' (
hive  ) -
.  - .
Split  . 3
(  3 4
$char  4 8
)  8 9
;  9 :
if!! 
(!! 
Enum!!  
.!!  !
TryParse!!! )
(!!) *
typeof!!* 0
(!!0 1
RegistryHive!!1 =
)!!= >
,!!> ?

innerSplit!!@ J
[!!J K
$num!!K L
]!!L M
,!!M N
out!!O R
object!!S Y
?!!Y Z
result!![ a
)!!a b
)!!b c
{"" 
if## 
(##  
result##  &
is##' )
RegistryHive##* 6
selectedHive##7 C
)##C D
{$$ 
Hives%%  %
.%%% &
Add%%& )
(%%) *
(%%* +
selectedHive%%+ 7
,%%7 8

innerSplit%%9 C
.%%C D
Length%%D J
>%%K L
$num%%M N
?%%O P
string%%Q W
.%%W X
Join%%X \
(%%\ ]
$char%%] a
,%%a b

innerSplit%%c m
[%%m n
$num%%n o
..%%o q
]%%q r
)%%r s
:%%t u
string%%v |
.%%| }
Empty	%%} Ç
)
%%Ç É
)
%%É Ñ
;
%%Ñ Ö
}&& 
}'' 
}(( 
})) 
}** 
}++ 	
public-- 
override-- 
bool-- 
CanRunOnPlatform-- -
(--- .
)--. /
{.. 	
return// 
RuntimeInformation// %
.//% &
IsOSPlatform//& 2
(//2 3

OSPlatform//3 =
.//= >
Windows//> E
)//E F
;//F G
}00 	
internal22 
override22 
void22 
ExecuteInternal22 .
(22. /
CancellationToken22/ @
cancellationToken22A R
)22R S
{33 	
foreach44 
(44 
var44 
hive44 
in44  
Hives44! &
)44& '
{55 
Log66 
.66 
Debug66 
(66 
$str66 -
,66- .
hive66/ 3
.663 4
Item1664 9
,669 :
hive66; ?
.66? @
Item266@ E
)66E F
;66F G
using77 
var77 
	BaseKey3277 #
=77$ %
RegistryKey77& 1
.771 2
OpenBaseKey772 =
(77= >
hive77> B
.77B C
Item177C H
,77H I
RegistryView77J V
.77V W

Registry3277W a
)77a b
;77b c
using88 
var88 
	BaseKey6488 #
=88$ %
RegistryKey88& 1
.881 2
OpenBaseKey882 =
(88= >
hive88> B
.88B C
Item188C H
,88H I
RegistryView88J V
.88V W

Registry6488W a
)88a b
;88b c
Action:: 
<:: 
RegistryHive:: #
,::# $
string::% +
,::+ ,
RegistryView::- 9
>::9 :
	IterateOn::; D
=::E F
(::G H
registryHive::H T
,::T U
keyPath::V ]
,::] ^
registryView::_ k
)::k l
=>::m o
{;; 
Log<< 
.<< 
Verbose<< 
(<<  
$str<<  D
,<<D E
registryHive<<F R
,<<R S
keyPath<<T [
,<<[ \
registryView<<] i
)<<i j
;<<j k
RegistryObject== "
?==" #
regObj==$ *
===+ ,
null==- 1
;==1 2
try>> 
{?? 
var@@ 
ourKey@@ "
=@@# $
registryView@@% 1
==@@2 4
RegistryView@@5 A
.@@A B

Registry32@@B L
?@@M N
	BaseKey32@@O X
.@@X Y

OpenSubKey@@Y c
(@@c d
keyPath@@d k
)@@k l
:@@m n
	BaseKey64@@o x
.@@x y

OpenSubKey	@@y É
(
@@É Ñ
keyPath
@@Ñ ã
)
@@ã å
;
@@å ç
regObjAA 
=AA  
RegistryWalkerAA! /
.AA/ 0'
RegistryKeyToRegistryObjectAA0 K
(AAK L
ourKeyAAL R
,AAR S
registryViewAAT `
)AA` a
;AAa b
}BB 
catchCC 
(CC 
	ExceptionCC $
eCC% &
)CC& '
{DD 
LogEE 
.EE 
DebugEE !
(EE! "
$"EE" $
$strEE$ 7
{EE7 8
registryHiveEE8 D
}EED E
$strEEE G
{EEG H
keyPathEEH O
}EEO P
$strEEP ^
{EE^ _
eEE_ `
.EE` a
GetTypeEEa h
(EEh i
)EEi j
}EEj k
"EEk l
)EEl m
;EEm n
}FF 
ifHH 
(HH 
regObjHH 
!=HH !
nullHH" &
)HH& '
{II 
HandleChangeJJ $
(JJ$ %
regObjJJ% +
)JJ+ ,
;JJ, -
}KK 
LogLL 
.LL 
VerboseLL 
(LL  
$strLL  B
,LLB C
registryHiveLLD P
,LLP Q
keyPathLLR Y
,LLY Z
registryViewLL[ g
)LLg h
;LLh i
}MM 
;MM 
varOO 
x86_EnumerableOO "
=OO# $
RegistryWalkerOO% 3
.OO3 4
WalkHiveOO4 <
(OO< =
hiveOO= A
.OOA B
Item1OOB G
,OOG H
RegistryViewOOI U
.OOU V

Registry32OOV `
,OO` a
hiveOOb f
.OOf g
Item2OOg l
)OOl m
;OOm n
varPP 
x64_EnumerablePP "
=PP# $
RegistryWalkerPP% 3
.PP3 4
WalkHivePP4 <
(PP< =
hivePP= A
.PPA B
Item1PPB G
,PPG H
RegistryViewPPI U
.PPU V

Registry64PPV `
,PP` a
hivePPb f
.PPf g
Item2PPg l
)PPl m
;PPm n
ifRR 
(RR 
ParallelizeRR 
)RR  
{SS 
ParallelOptionsTT #
poTT$ &
=TT' (
newTT) ,
ParallelOptionsTT- <
(TT< =
)TT= >
{TT? @
CancellationTokenTTA R
=TTS T
cancellationTokenTTU f
}TTg h
;TTh i
ParallelUU 
.UU 
ForEachUU $
(UU$ %
x86_EnumerableUU% 3
,UU3 4
poUU5 7
,UU7 8
registryKeyUU9 D
=>UUE G
	IterateOnUUH Q
(UUQ R
hiveUUR V
.UUV W
Item1UUW \
,UU\ ]
registryKeyUU^ i
,UUi j
RegistryViewUUk w
.UUw x

Registry32	UUx Ç
)
UUÇ É
)
UUÉ Ñ
;
UUÑ Ö
ParallelVV 
.VV 
ForEachVV $
(VV$ %
x64_EnumerableVV% 3
,VV3 4
poVV5 7
,VV7 8
registryKeyVV9 D
=>VVE G
	IterateOnVVH Q
(VVQ R
hiveVVR V
.VVV W
Item1VVW \
,VV\ ]
registryKeyVV^ i
,VVi j
RegistryViewVVk w
.VVw x

Registry64	VVx Ç
)
VVÇ É
)
VVÉ Ñ
;
VVÑ Ö
}WW 
elseXX 
{YY 
foreachZZ 
(ZZ 
varZZ  
registryKeyZZ! ,
inZZ- /
x86_EnumerableZZ0 >
)ZZ> ?
{[[ 
if\\ 
(\\ 
cancellationToken\\ -
.\\- .#
IsCancellationRequested\\. E
)\\E F
{]] 
break^^ !
;^^! "
}__ 
	IterateOn`` !
(``! "
hive``" &
.``& '
Item1``' ,
,``, -
registryKey``. 9
,``9 :
RegistryView``; G
.``G H

Registry32``H R
)``R S
;``S T
}aa 
foreachbb 
(bb 
varbb  
registryKeybb! ,
inbb- /
x64_Enumerablebb0 >
)bb> ?
{cc 
ifdd 
(dd 
cancellationTokendd -
.dd- .#
IsCancellationRequesteddd. E
)ddE F
{ee 
breakff !
;ff! "
}gg 
	IterateOnhh !
(hh! "
hivehh" &
.hh& '
Item1hh' ,
,hh, -
registryKeyhh. 9
,hh9 :
RegistryViewhh; G
.hhG H

Registry64hhH R
)hhR S
;hhS T
}ii 
}jj 
Logkk 
.kk 
Debugkk 
(kk 
$strkk -
,kk- .
hivekk/ 3
.kk3 4
Item1kk4 9
,kk9 :
hivekk; ?
.kk? @
Item2kk@ E
)kkE F
;kkF G
}ll 
}mm 	
privateoo 
staticoo 
readonlyoo 
Listoo  $
<oo$ %
(oo% &
RegistryHiveoo& 2
,oo2 3
stringoo4 :
)oo: ;
>oo; <
DefaultHivesoo= I
=ooJ K
newooL O
ListooP T
<ooT U
(ooU V
RegistryHiveooV b
,oob c
stringood j
)ooj k
>ook l
(ool m
)oom n
{pp 	
(qq 
RegistryHiveqq 
.qq 
ClassesRootqq %
,qq% &
stringqq& ,
.qq, -
Emptyqq- 2
)qq2 3
,qq3 4
(qq5 6
RegistryHiveqq6 B
.qqB C
CurrentConfigqqC P
,qqP Q
stringqqQ W
.qqW X
EmptyqqX ]
)qq] ^
,qq^ _
(qq` a
RegistryHiveqqa m
.qqm n
CurrentUserqqn y
,qqy z
string	qqz Ä
.
qqÄ Å
Empty
qqÅ Ü
)
qqÜ á
,
qqá à
(
qqâ ä
RegistryHive
qqä ñ
.
qqñ ó
LocalMachine
qqó £
,
qq£ §
string
qq§ ™
.
qq™ ´
Empty
qq´ ∞
)
qq∞ ±
,
qq± ≤
(
qq≥ ¥
RegistryHive
qq¥ ¿
.
qq¿ ¡
Users
qq¡ ∆
,
qq∆ «
string
qq« Õ
.
qqÕ Œ
Empty
qqŒ ”
)
qq” ‘
}rr 	
;rr	 

privatett 
readonlytt 
Listtt 
<tt 
(tt 
RegistryHivett +
,tt+ ,
stringtt- 3
)tt3 4
>tt4 5
Hivestt6 ;
;tt; <
privatevv 
readonlyvv 
boolvv 
Parallelizevv )
;vv) *
}ww 
}xx “ 
MD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\RegistryMonitor.cs
	namespace		 	
	Microsoft		
 
.		 
CST		 
.		 !
AttackSurfaceAnalyzer		 -
.		- .

Collectors		. 8
{

 
public 

class 
RegistryMonitor  
:! "
BaseMonitor# .
,. /
IDisposable0 ;
{ 
public 
RegistryMonitor 
( 
)  
{ 	
} 	
public 
override 
bool 
CanRunOnPlatform -
(- .
). /
{ 	
return 
RuntimeInformation %
.% &
IsOSPlatform& 2
(2 3

OSPlatform3 =
.= >
Windows> E
)E F
;F G
} 	
public 
void 
Dispose 
( 
) 
{ 	
Dispose 
( 
true 
) 
; 
GC 
. 
SuppressFinalize 
(  
this  $
)$ %
;% &
} 	
public 
void 
MyOnEntryWritten $
($ %
object% +
source, 2
,2 3!
EntryWrittenEventArgs4 I
eJ K
)K L
{ 	
if 
( 
e 
!= 
null 
) 
{ 
Log   
.   
Information   
(    
e    !
.  ! "
Entry  " '
.  ' (
Source  ( .
)  . /
;  / 0
}!! 
}"" 	
public$$ 
override$$ 
void$$ 
StartRun$$ %
($$% &
)$$& '
{%% 	!
ExternalCommandRunner'' !
.''! "
RunExternalCommand''" 4
(''4 5
$str''5 ?
,''? @
$"''A C
$str''C Q
{''Q R
tmpFileName''R ]
}''] ^
"''^ _
)''_ `
;''` a
log** 
.** 
EntryWritten** 
+=** 
new**  #$
EntryWrittenEventHandler**$ <
(**< =
MyOnEntryWritten**= M
)**M N
;**N O
log++ 
.++ 
EnableRaisingEvents++ #
=++$ %
true++& *
;++* +!
ExternalCommandRunner.. !
...! "
RunExternalCommand.." 4
(..4 5
$str..5 ?
,..? @
$str	..A õ
)
..õ ú
;
..ú ù
}// 	
public11 
override11 
void11 
StopRun11 $
(11$ %
)11% &
{22 	!
ExternalCommandRunner44 !
.44! "
RunExternalCommand44" 4
(444 5
$str445 ?
,44? @
$"44A C
$str44C R
{44R S
tmpFileName44S ^
}44^ _
"44_ `
)44` a
;44a b!
ExternalCommandRunner77 !
.77! "
RunExternalCommand77" 4
(774 5
$str775 :
,77: ;
tmpFileName77< G
)77G H
;77H I
log99 
.99 
EnableRaisingEvents99 #
=99$ %
false99& +
;99+ ,
}:: 	
	protected<< 
virtual<< 
void<< 
Dispose<< &
(<<& '
bool<<' +
	disposing<<, 5
)<<5 6
{== 	
if>> 
(>> 
	disposing>> 
)>> 
{?? 
log@@ 
.@@ 
Dispose@@ 
(@@ 
)@@ 
;@@ 
}AA 
}BB 	
privateEE 
readonlyEE 
EventLogEE !
logEE" %
=EE& '
newEE( +
EventLogEE, 4
(EE4 5
$strEE5 =
)EE= >
;EE> ?
privateGG 
readonlyGG 
stringGG 
tmpFileNameGG  +
=GG, -
PathGG. 2
.GG2 3
GetRandomFileNameGG3 D
(GGD E
)GGE F
;GGF G
}HH 
}II À÷
ND:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\ServiceCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
ServiceCollector !
:" #
BaseCollector$ 1
{ 
public 
ServiceCollector 
(  
CollectorOptions  0
?0 1
opts2 6
=7 8
null9 =
,= >
Action? E
<E F
CollectObjectF S
>S T
?T U
changeHandlerV c
=d e
nullf j
)j k
:l m
basen r
(r s
optss w
,w x
changeHandler	y Ü
)
Ü á
{ 	
} 	
public 
override 
bool 
CanRunOnPlatform -
(- .
). /
{ 	
return   
RuntimeInformation   %
.  % &
IsOSPlatform  & 2
(  2 3

OSPlatform  3 =
.  = >
Windows  > E
)  E F
||  G I
RuntimeInformation  J \
.  \ ]
IsOSPlatform  ] i
(  i j

OSPlatform  j t
.  t u
OSX  u x
)  x y
||  z |
RuntimeInformation	  } è
.
  è ê
IsOSPlatform
  ê ú
(
  ú ù

OSPlatform
  ù ß
.
  ß ®
Linux
  ® ≠
)
  ≠ Æ
;
  Æ Ø
}!! 	
internal&& 
override&& 
void&& 
ExecuteInternal&& .
(&&. /
CancellationToken&&/ @
cancellationToken&&A R
)&&R S
{'' 	
if(( 
((( 
RuntimeInformation(( "
.((" #
IsOSPlatform((# /
(((/ 0

OSPlatform((0 :
.((: ;
Windows((; B
)((B C
)((C D
{)) 
ExecuteWindows** 
(** 
cancellationToken** 0
)**0 1
;**1 2
}++ 
else,, 
if,, 
(,, 
RuntimeInformation,, '
.,,' (
IsOSPlatform,,( 4
(,,4 5

OSPlatform,,5 ?
.,,? @
OSX,,@ C
),,C D
),,D E
{-- 
ExecuteMacOs.. 
(.. 
cancellationToken.. .
)... /
;../ 0
}// 
else00 
if00 
(00 
RuntimeInformation00 '
.00' (
IsOSPlatform00( 4
(004 5

OSPlatform005 ?
.00? @
Linux00@ E
)00E F
)00F G
{11 
ExecuteLinux22 
(22 
cancellationToken22 .
)22. /
;22/ 0
}33 
}44 	
internal99 
void99 
ExecuteLinux99 "
(99" #
CancellationToken99# 4
cancellationToken995 F
)99F G
{:: 	
try;; 
{<< 
var== 
result== 
=== !
ExternalCommandRunner== 2
.==2 3
RunExternalCommand==3 E
(==E F
$str==F Q
,==Q R
$str==S n
)==n o
;==o p
var@@ 
lines@@ 
=@@ 
result@@ "
.@@" #
Split@@# (
(@@( )
$char@@) -
)@@- .
.@@. /
Skip@@/ 3
(@@3 4
$num@@4 5
)@@5 6
;@@6 7
foreachBB 
(BB 
varBB 
_lineBB "
inBB# %
linesBB& +
)BB+ ,
{CC 
ifDD 
(DD 
cancellationTokenDD )
.DD) *#
IsCancellationRequestedDD* A
)DDA B
{DDC D
returnDDE K
;DDK L
}DDM N
varFF 
_fieldsFF 
=FF  !
_lineFF" '
.FF' (
SplitFF( -
(FF- .
$charFF. 2
)FF2 3
;FF3 4
ifHH 
(HH 
_fieldsHH 
.HH  
LengthHH  &
==HH' )
$numHH* +
)HH+ ,
{II 
varJJ 
objJJ 
=JJ  !
newJJ" %
ServiceObjectJJ& 3
(JJ3 4
_fieldsJJ4 ;
[JJ; <
$numJJ< =
]JJ= >
)JJ> ?
{KK 
DisplayNameLL '
=LL( )
_fieldsLL* 1
[LL1 2
$numLL2 3
]LL3 4
,LL4 5
StateMM !
=MM" #
_fieldsMM$ +
[MM+ ,
$numMM, -
]MM- .
,MM. /
}NN 
;NN 
HandleChangePP $
(PP$ %
objPP% (
)PP( )
;PP) *
}QQ 
}RR 
}SS 
catchTT 
(TT 
ExternalExceptionTT $
)TT$ %
{UU 
LogVV 
.VV 
ErrorVV 
(VV 
$strVV /
,VV/ 0
$strVV1 V
)VVV W
;VVW X
}WW 
tryYY 
{ZZ 
var[[ 
result[[ 
=[[ !
ExternalCommandRunner[[ 2
.[[2 3
RunExternalCommand[[3 E
([[E F
$str[[F J
,[[J K
$str[[L ]
)[[] ^
;[[^ _
var]] 
lines]] 
=]] 
result]] "
.]]" #
Split]]# (
(]]( )
$char]]) -
)]]- .
.]]. /
Skip]]/ 3
(]]3 4
$num]]4 5
)]]5 6
;]]6 7
String^^ 
pattern^^ 
=^^  
$str^^! ,
;^^, -
foreach`` 
(`` 
var`` 
_line`` "
in``# %
lines``& +
)``+ ,
{aa 
Matchbb 
matchbb 
=bb  !
Regexbb" '
.bb' (
Matchbb( -
(bb- .
_linebb. 3
,bb3 4
patternbb5 <
)bb< =
;bb= >
GroupCollectioncc #
groupscc$ *
=cc+ ,
matchcc- 2
.cc2 3
Groupscc3 9
;cc9 :
vardd 
serviceNamedd #
=dd$ %
groupsdd& ,
[dd, -
$numdd- .
]dd. /
.dd/ 0
ToStringdd0 8
(dd8 9
)dd9 :
;dd: ;
varff 
objff 
=ff 
newff !
ServiceObjectff" /
(ff/ 0
serviceNameff0 ;
)ff; <
{gg 
DisplayNamehh #
=hh$ %
serviceNamehh& 1
,hh1 2
}ii 
;ii 
HandleChangekk  
(kk  !
objkk! $
)kk$ %
;kk% &
}ll 
}mm 
catchnn 
(nn 
ExternalExceptionnn $
)nn$ %
{oo 
Logpp 
.pp 
Errorpp 
(pp 
$strpp /
,pp/ 0
$strpp1 E
)ppE F
;ppF G
}qq 
}uu 	
internalzz 
voidzz 
ExecuteMacOszz "
(zz" #
CancellationTokenzz# 4
cancellationTokenzz5 F
)zzF G
{{{ 	

Dictionary~~ 
<~~ 
string~~ 
,~~ 
ServiceObject~~ ,
>~~, -
outDict~~. 5
=~~6 7
new~~8 ;

Dictionary~~< F
<~~F G
string~~G M
,~~M N
ServiceObject~~O \
>~~\ ]
(~~] ^
)~~^ _
;~~_ `
try 
{
ÄÄ 
var
ÅÅ 
result
ÅÅ 
=
ÅÅ #
ExternalCommandRunner
ÅÅ 2
.
ÅÅ2 3 
RunExternalCommand
ÅÅ3 E
(
ÅÅE F
$str
ÅÅF Q
,
ÅÅQ R
$str
ÅÅS Y
)
ÅÅY Z
;
ÅÅZ [
foreach
ÇÇ 
(
ÇÇ 
var
ÇÇ 
_line
ÇÇ "
in
ÇÇ# %
result
ÇÇ& ,
.
ÇÇ, -
Split
ÇÇ- 2
(
ÇÇ2 3
$char
ÇÇ3 7
)
ÇÇ7 8
)
ÇÇ8 9
{
ÉÉ 
if
ÑÑ 
(
ÑÑ 
cancellationToken
ÑÑ )
.
ÑÑ) *%
IsCancellationRequested
ÑÑ* A
)
ÑÑA B
{
ÑÑC D
return
ÑÑE K
;
ÑÑK L
}
ÑÑM N
var
ââ 
_fields
ââ 
=
ââ  !
_line
ââ" '
.
ââ' (
Split
ââ( -
(
ââ- .
$char
ââ. 2
)
ââ2 3
;
ââ3 4
if
ää 
(
ää 
_fields
ää 
.
ää  
Length
ää  &
<
ää' (
$num
ää) *
||
ää+ -
_fields
ää. 5
[
ää5 6
$num
ää6 7
]
ää7 8
.
ää8 9
Contains
ää9 A
(
ääA B
$str
ääB G
)
ääG H
)
ääH I
{
ãã 
continue
åå  
;
åå  !
}
çç 
var
éé 
obj
éé 
=
éé 
new
éé !
ServiceObject
éé" /
(
éé/ 0
_fields
éé0 7
[
éé7 8
$num
éé8 9
]
éé9 :
)
éé: ;
{
èè 
DisplayName
êê #
=
êê$ %
_fields
êê& -
[
êê- .
$num
êê. /
]
êê/ 0
,
êê0 1
State
íí 
=
íí 
(
íí  !
_fields
íí! (
[
íí( )
$num
íí) *
]
íí* +
.
íí+ ,
Equals
íí, 2
(
íí2 3
$str
íí3 6
)
íí6 7
)
íí7 8
?
íí9 :
$str
íí; D
:
ííE F
$str
ííG P
}
ìì 
;
ìì 
if
îî 
(
îî 
!
îî 
outDict
îî  
.
îî  !
ContainsKey
îî! ,
(
îî, -
obj
îî- 0
.
îî0 1
Identity
îî1 9
)
îî9 :
)
îî: ;
{
ïï 
HandleChange
ññ $
(
ññ$ %
obj
ññ% (
)
ññ( )
;
ññ) *
outDict
óó 
.
óó  
Add
óó  #
(
óó# $
obj
óó$ '
.
óó' (
Identity
óó( 0
,
óó0 1
obj
óó2 5
)
óó5 6
;
óó6 7
}
òò 
}
ôô 
}
öö 
catch
õõ 
(
õõ 
ExternalException
õõ $
)
õõ$ %
{
úú 
Log
ùù 
.
ùù 
Error
ùù 
(
ùù 
$str
ùù /
,
ùù/ 0
$str
ùù1 A
)
ùùA B
;
ùùB C
}
ûû 
}
üü 	
internal
§§ 
void
§§ 
ExecuteWindows
§§ $
(
§§$ %
CancellationToken
§§% 6
cancellationToken
§§7 H
)
§§H I
{
•• 	
try
¶¶ 
{
ßß 
SelectQuery
®® 
sQuery
®® "
=
®®# $
new
®®% (
SelectQuery
®®) 4
(
®®4 5
$str
®®5 R
)
®®R S
;
®®S T
using
©© &
ManagementObjectSearcher
©© .
mgmtSearcher
©©/ ;
=
©©< =
new
©©> A&
ManagementObjectSearcher
©©B Z
(
©©Z [
sQuery
©©[ a
)
©©a b
;
©©b c
if
´´ 
(
´´ 
opts
´´ 
.
´´ 
SingleThread
´´ %
)
´´% &
{
¨¨ 
foreach
≠≠ 
(
≠≠ 
ManagementObject
≠≠ -
service
≠≠. 5
in
≠≠6 8
mgmtSearcher
≠≠9 E
.
≠≠E F
Get
≠≠F I
(
≠≠I J
)
≠≠J K
)
≠≠K L
{
ÆÆ 
if
ØØ 
(
ØØ 
cancellationToken
ØØ -
.
ØØ- .%
IsCancellationRequested
ØØ. E
)
ØØE F
{
ØØG H
return
ØØI O
;
ØØO P
}
ØØQ R%
ProcessManagementObject
±± /
(
±±/ 0
service
±±0 7
)
±±7 8
;
±±8 9
}
≤≤ 
}
≥≥ 
else
¥¥ 
{
µµ 
var
∂∂ 
list
∂∂ 
=
∂∂ 
new
∂∂ "
List
∂∂# '
<
∂∂' (
ManagementObject
∂∂( 8
>
∂∂8 9
(
∂∂9 :
)
∂∂: ;
;
∂∂; <
foreach
∏∏ 
(
∏∏ 
ManagementObject
∏∏ -
service
∏∏. 5
in
∏∏6 8
mgmtSearcher
∏∏9 E
.
∏∏E F
Get
∏∏F I
(
∏∏I J
)
∏∏J K
)
∏∏K L
{
ππ 
list
∫∫ 
.
∫∫ 
Add
∫∫  
(
∫∫  !
service
∫∫! (
)
∫∫( )
;
∫∫) *
}
ªª 
ParallelOptions
ºº #
po
ºº$ &
=
ºº' (
new
ºº) ,
ParallelOptions
ºº- <
(
ºº< =
)
ºº= >
{
ºº? @
CancellationToken
ººA R
=
ººS T
cancellationToken
ººU f
}
ººg h
;
ººh i
Parallel
ΩΩ 
.
ΩΩ 
ForEach
ΩΩ $
(
ΩΩ$ %
list
ΩΩ% )
,
ΩΩ) *
po
ΩΩ+ -
,
ΩΩ- .
x
ΩΩ/ 0
=>
ΩΩ1 3%
ProcessManagementObject
ΩΩ4 K
(
ΩΩK L
x
ΩΩL M
)
ΩΩM N
)
ΩΩN O
;
ΩΩO P
}
ææ 
}
øø 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
e
¿¿ 
)
¿¿ 
{
¡¡ 
Log
¬¬ 
.
¬¬ 
Warning
¬¬ 
(
¬¬ 
e
¬¬ 
,
¬¬ 
$str
¬¬ A
)
¬¬A B
;
¬¬B C
}
√√ 
var
≈≈ 
fsc
≈≈ 
=
≈≈ 
new
≈≈ !
FileSystemCollector
≈≈ -
(
≈≈- .
new
≈≈. 1
CollectorOptions
≈≈2 B
(
≈≈B C
)
≈≈C D
{
≈≈E F
SingleThread
≈≈G S
=
≈≈T U
opts
≈≈V Z
.
≈≈Z [
SingleThread
≈≈[ g
}
≈≈h i
)
≈≈i j
;
≈≈j k
foreach
«« 
(
«« 
var
«« 
file
«« 
in
««  
	Directory
««! *
.
««* +
EnumerateFiles
««+ 9
(
««9 :
$str
««: ~
)
««~ 
)«« Ä
{
»» 
var
…… 
name
…… 
=
…… 
file
…… 
.
……  
Split
……  %
(
……% &
Path
……& *
.
……* +$
DirectorySeparatorChar
……+ A
)
……A B
[
……B C
^
……C D
$num
……D E
]
……E F
;
……F G
var
   
fso
   
=
   
fsc
   
.
   (
FilePathToFileSystemObject
   8
(
  8 9
file
  9 =
)
  = >
;
  > ?
var
ÀÀ 
obj
ÀÀ 
=
ÀÀ 
new
ÀÀ 
ServiceObject
ÀÀ +
(
ÀÀ+ ,
file
ÀÀ, 0
)
ÀÀ0 1
{
ÃÃ 
DisplayName
ÕÕ 
=
ÕÕ  !
name
ÕÕ" &
,
ÕÕ& '
Name
ŒŒ 
=
ŒŒ 
name
ŒŒ 
,
ŒŒ  
PathName
œœ 
=
œœ 
file
œœ #
,
œœ# $
InstallDate
–– 
=
––  !
fso
––" %
.
––% &
Created
––& -
}
—— 
;
—— 
HandleChange
”” 
(
”” 
obj
””  
)
””  !
;
””! "
}
‘‘ 
}
’’ 	
private
◊◊ 
static
◊◊ 
string
◊◊ 
?
◊◊ !
TryGetPropertyValue
◊◊ 2
(
◊◊2 3
ManagementObject
◊◊3 C
mo
◊◊D F
,
◊◊F G
string
◊◊H N
propertyName
◊◊O [
)
◊◊[ \
{
ÿÿ 	
string
ŸŸ 
?
ŸŸ 
val
ŸŸ 
=
ŸŸ 
null
ŸŸ 
;
ŸŸ 
try
⁄⁄ 
{
€€ 
val
‹‹ 
=
‹‹ 
mo
‹‹ 
.
‹‹ 
GetPropertyValue
‹‹ )
(
‹‹) *
propertyName
‹‹* 6
)
‹‹6 7
?
‹‹7 8
.
‹‹8 9
ToString
‹‹9 A
(
‹‹A B
)
‹‹B C
;
‹‹C D
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
	Exception
ﬁﬁ 
e
ﬁﬁ 
)
ﬁﬁ 
{
ﬁﬁ  !
Log
ﬁﬁ" %
.
ﬁﬁ% &
Verbose
ﬁﬁ& -
(
ﬁﬁ- .
$str
ﬁﬁ. V
,
ﬁﬁV W
propertyName
ﬁﬁX d
,
ﬁﬁd e
mo
ﬁﬁf h
.
ﬁﬁh i
Path
ﬁﬁi m
,
ﬁﬁm n
e
ﬁﬁo p
.
ﬁﬁp q
GetType
ﬁﬁq x
(
ﬁﬁx y
)
ﬁﬁy z
,
ﬁﬁz {
e
ﬁﬁ| }
.
ﬁﬁ} ~
Messageﬁﬁ~ Ö
)ﬁﬁÖ Ü
;ﬁﬁÜ á
}ﬁﬁà â
return
ﬂﬂ 
val
ﬂﬂ 
;
ﬂﬂ 
}
‡‡ 	
private
‚‚ 
void
‚‚ %
ProcessManagementObject
‚‚ ,
(
‚‚, -
ManagementObject
‚‚- =
service
‚‚> E
)
‚‚E F
{
„„ 	
try
‰‰ 
{
ÂÂ 
if
ÊÊ 
(
ÊÊ !
TryGetPropertyValue
ÊÊ '
(
ÊÊ' (
service
ÊÊ( /
,
ÊÊ/ 0
$str
ÊÊ1 7
)
ÊÊ7 8
is
ÊÊ9 ;
string
ÊÊ< B
name
ÊÊC G
)
ÊÊG H
{
ÁÁ 
var
ËË 
obj
ËË 
=
ËË 
new
ËË !
ServiceObject
ËË" /
(
ËË/ 0
name
ËË0 4
)
ËË4 5
;
ËË5 6
if
ÍÍ 
(
ÍÍ 
bool
ÍÍ 
.
ÍÍ 
TryParse
ÍÍ %
(
ÍÍ% &!
TryGetPropertyValue
ÍÍ& 9
(
ÍÍ9 :
service
ÍÍ: A
,
ÍÍA B
$str
ÍÍC P
)
ÍÍP Q
,
ÍÍQ R
out
ÍÍS V
bool
ÍÍW [
acceptPause
ÍÍ\ g
)
ÍÍg h
)
ÍÍh i
obj
ÎÎ 
.
ÎÎ 
AcceptPause
ÎÎ '
=
ÎÎ( )
acceptPause
ÎÎ* 5
;
ÎÎ5 6
if
ÌÌ 
(
ÌÌ 
bool
ÌÌ 
.
ÌÌ 
TryParse
ÌÌ %
(
ÌÌ% &!
TryGetPropertyValue
ÌÌ& 9
(
ÌÌ9 :
service
ÌÌ: A
,
ÌÌA B
$str
ÌÌC O
)
ÌÌO P
,
ÌÌP Q
out
ÌÌR U
bool
ÌÌV Z

acceptStop
ÌÌ[ e
)
ÌÌe f
)
ÌÌf g
obj
ÓÓ 
.
ÓÓ 

AcceptStop
ÓÓ &
=
ÓÓ' (

acceptStop
ÓÓ) 3
;
ÓÓ3 4
obj
 
.
 
Caption
 
=
  !!
TryGetPropertyValue
" 5
(
5 6
service
6 =
,
= >
$str
? H
)
H I
;
I J
if
ÚÚ 
(
ÚÚ 
uint
ÚÚ 
.
ÚÚ 
TryParse
ÚÚ %
(
ÚÚ% &!
TryGetPropertyValue
ÚÚ& 9
(
ÚÚ9 :
service
ÚÚ: A
,
ÚÚA B
$str
ÚÚC O
)
ÚÚO P
,
ÚÚP Q
out
ÚÚR U
uint
ÚÚV Z

checkpoint
ÚÚ[ e
)
ÚÚe f
)
ÚÚf g
obj
ÛÛ 
.
ÛÛ 

CheckPoint
ÛÛ &
=
ÛÛ' (

checkpoint
ÛÛ) 3
;
ÛÛ3 4
obj
ıı 
.
ıı 
CreationClassName
ıı )
=
ıı* +!
TryGetPropertyValue
ıı, ?
(
ıı? @
service
ıı@ G
,
ııG H
$str
ııI \
)
ıı\ ]
;
ıı] ^
if
˜˜ 
(
˜˜ 
bool
˜˜ 
.
˜˜ 
TryParse
˜˜ %
(
˜˜% &!
TryGetPropertyValue
˜˜& 9
(
˜˜9 :
service
˜˜: A
,
˜˜A B
$str
˜˜C U
)
˜˜U V
,
˜˜V W
out
˜˜X [
bool
˜˜\ `
delayedAutoStart
˜˜a q
)
˜˜q r
)
˜˜r s
obj
¯¯ 
.
¯¯ 
DelayedAutoStart
¯¯ ,
=
¯¯- .
delayedAutoStart
¯¯/ ?
;
¯¯? @
obj
˙˙ 
.
˙˙ 
Description
˙˙ #
=
˙˙$ %!
TryGetPropertyValue
˙˙& 9
(
˙˙9 :
service
˙˙: A
,
˙˙A B
$str
˙˙C P
)
˙˙P Q
;
˙˙Q R
if
¸¸ 
(
¸¸ 
bool
¸¸ 
.
¸¸ 
TryParse
¸¸ %
(
¸¸% &!
TryGetPropertyValue
¸¸& 9
(
¸¸9 :
service
¸¸: A
,
¸¸A B
$str
¸¸C T
)
¸¸T U
,
¸¸U V
out
¸¸W Z
bool
¸¸[ _
desktopInteract
¸¸` o
)
¸¸o p
)
¸¸p q
obj
˝˝ 
.
˝˝ 
DesktopInteract
˝˝ +
=
˝˝, -
desktopInteract
˝˝. =
;
˝˝= >
obj
ˇˇ 
.
ˇˇ 
DisplayName
ˇˇ #
=
ˇˇ$ %!
TryGetPropertyValue
ˇˇ& 9
(
ˇˇ9 :
service
ˇˇ: A
,
ˇˇA B
$str
ˇˇC P
)
ˇˇP Q
;
ˇˇQ R
obj
ÅÅ 
.
ÅÅ 
ErrorControl
ÅÅ $
=
ÅÅ% &!
TryGetPropertyValue
ÅÅ' :
(
ÅÅ: ;
service
ÅÅ; B
,
ÅÅB C
$str
ÅÅD R
)
ÅÅR S
;
ÅÅS T
if
ÉÉ 
(
ÉÉ 
uint
ÉÉ 
.
ÉÉ 
TryParse
ÉÉ %
(
ÉÉ% &!
TryGetPropertyValue
ÉÉ& 9
(
ÉÉ9 :
service
ÉÉ: A
,
ÉÉA B
$str
ÉÉC M
)
ÉÉM N
,
ÉÉN O
out
ÉÉP S
uint
ÉÉT X
exitCode
ÉÉY a
)
ÉÉa b
)
ÉÉb c
obj
ÑÑ 
.
ÑÑ 
ExitCode
ÑÑ $
=
ÑÑ% &
exitCode
ÑÑ' /
;
ÑÑ/ 0
if
ÜÜ 
(
ÜÜ 
DateTime
ÜÜ  
.
ÜÜ  !
TryParse
ÜÜ! )
(
ÜÜ) *
service
ÜÜ* 1
.
ÜÜ1 2
GetPropertyValue
ÜÜ2 B
(
ÜÜB C
$str
ÜÜC P
)
ÜÜP Q
?
ÜÜQ R
.
ÜÜR S
ToString
ÜÜS [
(
ÜÜ[ \
)
ÜÜ\ ]
,
ÜÜ] ^
out
ÜÜ_ b
DateTime
ÜÜc k
dateTime
ÜÜl t
)
ÜÜt u
)
ÜÜu v
{
áá 
obj
àà 
.
àà 
InstallDate
àà '
=
àà( )
dateTime
àà* 2
;
àà2 3
}
ââ 
obj
ãã 
.
ãã 
PathName
ãã  
=
ãã! "!
TryGetPropertyValue
ãã# 6
(
ãã6 7
service
ãã7 >
,
ãã> ?
$str
ãã@ J
)
ããJ K
;
ããK L
if
çç 
(
çç 
uint
çç 
.
çç 
TryParse
çç %
(
çç% &!
TryGetPropertyValue
çç& 9
(
çç9 :
service
çç: A
,
ççA B
$str
ççC N
)
ççN O
,
ççO P
out
ççQ T
uint
ççU Y
	processId
ççZ c
)
ççc d
)
ççd e
obj
éé 
.
éé 
	ProcessId
éé %
=
éé& '
	processId
éé( 1
;
éé1 2
if
êê 
(
êê 
uint
êê 
.
êê 
TryParse
êê %
(
êê% &!
TryGetPropertyValue
êê& 9
(
êê9 :
service
êê: A
,
êêA B
$str
êêC \
)
êê\ ]
,
êê] ^
out
êê_ b
uint
êêc g%
serviceSpecificExitCode
êêh 
)êê Ä
)êêÄ Å
obj
ëë 
.
ëë %
ServiceSpecificExitCode
ëë 3
=
ëë4 5%
serviceSpecificExitCode
ëë6 M
;
ëëM N
obj
ìì 
.
ìì 
ServiceType
ìì #
=
ìì$ %!
TryGetPropertyValue
ìì& 9
(
ìì9 :
service
ìì: A
,
ììA B
$str
ììC P
)
ììP Q
;
ììQ R
if
ïï 
(
ïï 
bool
ïï 
.
ïï 
TryParse
ïï %
(
ïï% &!
TryGetPropertyValue
ïï& 9
(
ïï9 :
service
ïï: A
,
ïïA B
$str
ïïC L
)
ïïL M
,
ïïM N
out
ïïO R
bool
ïïS W
started
ïïX _
)
ïï_ `
)
ïï` a
obj
ññ 
.
ññ 
Started
ññ #
=
ññ$ %
started
ññ& -
;
ññ- .
obj
òò 
.
òò 
	StartMode
òò !
=
òò" #!
TryGetPropertyValue
òò$ 7
(
òò7 8
service
òò8 ?
,
òò? @
$str
òòA L
)
òòL M
;
òòM N
obj
ôô 
.
ôô 
	StartName
ôô !
=
ôô" #!
TryGetPropertyValue
ôô$ 7
(
ôô7 8
service
ôô8 ?
,
ôô? @
$str
ôôA L
)
ôôL M
;
ôôM N
obj
öö 
.
öö 
State
öö 
=
öö !
TryGetPropertyValue
öö  3
(
öö3 4
service
öö4 ;
,
öö; <
$str
öö= D
)
ööD E
;
ööE F
obj
õõ 
.
õõ 
Status
õõ 
=
õõ  !
TryGetPropertyValue
õõ! 4
(
õõ4 5
service
õõ5 <
,
õõ< =
$str
õõ> F
)
õõF G
;
õõG H
obj
úú 
.
úú %
SystemCreationClassName
úú /
=
úú0 1!
TryGetPropertyValue
úú2 E
(
úúE F
service
úúF M
,
úúM N
$str
úúO h
)
úúh i
;
úúi j
obj
ùù 
.
ùù 

SystemName
ùù "
=
ùù# $!
TryGetPropertyValue
ùù% 8
(
ùù8 9
service
ùù9 @
,
ùù@ A
$str
ùùB N
)
ùùN O
;
ùùO P
if
üü 
(
üü 
uint
üü 
.
üü 
TryParse
üü %
(
üü% &!
TryGetPropertyValue
üü& 9
(
üü9 :
service
üü: A
,
üüA B
$str
üüC J
)
üüJ K
,
üüK L
out
üüM P
uint
üüQ U
tagId
üüV [
)
üü[ \
)
üü\ ]
obj
†† 
.
†† 
TagId
†† !
=
††" #
tagId
††$ )
;
††) *
if
¢¢ 
(
¢¢ 
uint
¢¢ 
.
¢¢ 
TryParse
¢¢ %
(
¢¢% &!
TryGetPropertyValue
¢¢& 9
(
¢¢9 :
service
¢¢: A
,
¢¢A B
$str
¢¢C M
)
¢¢M N
,
¢¢N O
out
¢¢P S
uint
¢¢T X
waitHint
¢¢Y a
)
¢¢a b
)
¢¢b c
obj
££ 
.
££ 
WaitHint
££ $
=
££% &
waitHint
££' /
;
££/ 0
HandleChange
••  
(
••  !
obj
••! $
)
••$ %
;
••% &
}
¶¶ 
}
ßß 
catch
®® 
(
®® 
	Exception
®® 
e
®® 
)
®® 
when
®®  $
(
®®% &
e
©© 
is
©© )
TypeInitializationException
©© 0
||
©©1 3
e
™™ 
is
™™ +
PlatformNotSupportedException
™™ 2
)
™™2 3
{
´´ 
Log
¨¨ 
.
¨¨ 
Warning
¨¨ 
(
¨¨ 
Strings
¨¨ #
.
¨¨# $
Get
¨¨$ '
(
¨¨' (
$str
¨¨( I
)
¨¨I J
,
¨¨J K
GetType
¨¨L S
(
¨¨S T
)
¨¨T U
.
¨¨U V
ToString
¨¨V ^
(
¨¨^ _
)
¨¨_ `
)
¨¨` a
;
¨¨a b
}
≠≠ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
e
ÆÆ 
)
ÆÆ 
{
ØØ 
Log
∞∞ 
.
∞∞ 
Warning
∞∞ 
(
∞∞ 
e
∞∞ 
,
∞∞ 
$str
∞∞ P
,
∞∞P Q
service
∞∞R Y
.
∞∞Y Z
Path
∞∞Z ^
)
∞∞^ _
;
∞∞_ `
}
±± 
}
≤≤ 	
}
≥≥ 
}¥¥ È
JD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\TpmCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
TpmCollector 
: 
BaseCollector  -
{ 
public 
TpmCollector 
( 
CollectorOptions ,
?, -
opts. 2
,2 3
Action4 :
<: ;
CollectObject; H
>H I
?I J
changeHandlerK X
,X Y
boolZ ^
TestMode_ g
=h i
falsej o
)o p
:q r
bases w
(w x
optsx |
,| }
changeHandler	~ ã
)
ã å
{ 	
this 
. 
TestMode 
= 
TestMode $
;$ %
} 	
public 
bool 
TestMode 
{ 
get "
;" #
}$ %
public 
static 
List 
< 

AsaNvIndex %
>% &
DumpNV' -
(- .
Tpm2. 2
tpm3 6
)6 7
{ 	
var 
output 
= 
new 
List !
<! "

AsaNvIndex" ,
>, -
(- .
). /
;/ 0
if 
( 
tpm 
== 
null 
) 
{ 
return 
output 
; 
} 
byte!! 
moreData!! 
;!! 
do"" 
{## 
uint$$ 

maxHandles$$ 
=$$  !
ushort$$" (
.$$( )
MaxValue$$) 1
;$$1 2
moreData%% 
=%% 
tpm%% 
.%% 
GetCapability%% ,
(%%, -
Cap%%- 0
.%%0 1
Handles%%1 8
,%%8 9
(%%: ;
(%%; <
uint%%< @
)%%@ A
Ht%%A C
.%%C D
NvIndex%%D K
)%%K L
<<%%M O
$num%%P R
,%%R S

maxHandles&&- 7
,&&7 8
out&&9 <
ICapabilitiesUnion&&= O
cap&&P S
)&&S T
;&&T U
HandleArray'' 
handles'' #
=''$ %
(''& '
HandleArray''' 2
)''2 3
cap''3 6
;''6 7
foreach(( 
((( 
	TpmHandle(( "
hh((# %
in((& (
handles(() 0
.((0 1
handle((1 7
)((7 8
{)) 
NvPublic** 
nvPub** "
=**# $
tpm**% (
.**( )
NvReadPublic**) 5
(**5 6
hh**6 8
,**8 9
out**: =
byte**> B
[**B C
]**C D
nvName**E K
)**K L
;**L M
var,, 
index,, 
=,, 
new,,  #

AsaNvIndex,,$ .
(,,. /
),,/ 0
{,,1 2
Index,,3 8
=,,9 :
hh,,; =
.,,= >
handle,,> D
&,,E F
$num,,G Q
,,,Q R

Attributes,,S ]
=,,^ _
nvPub,,` e
.,,e f

attributes,,f p
},,q r
;,,r s
if// 
(// 
nvPub// 
.// 

attributes// (
.//( )
HasFlag//) 0
(//0 1
NvAttr//1 7
.//7 8
	Ownerread//8 A
)//A B
)//B C
{00 
try11 
{22 
index33 !
.33! "
value33" '
=33( )
tpm33* -
.33- .
NvRead33. 4
(334 5
TpmRh335 :
.33: ;
Owner33; @
,33@ A
hh33B D
,33D E
nvPub33F K
.33K L
dataSize33L T
,33T U
$num33V W
)33W X
.33X Y
ToList33Y _
(33_ `
)33` a
;33a b
}44 
catch55 
(55 
TpmException55 +
e55, -
)55- .
{66 
Log77 
.77  
Verbose77  '
(77' (
$str77( I
,77I J
hh77K M
.77M N
handle77N T
&77U V
$num77W a
,77a b
e77c d
.77d e
GetType77e l
(77l m
)77m n
,77n o
e77p q
.77q r
Message77r y
)77y z
;77z {
}88 
}99 
output== 
.== 
Add== 
(== 
index== $
)==$ %
;==% &
}>> 
}?? 
while?? 
(?? 
moreData?? 
==??  
$num??! "
)??" #
;??# $
returnAA 
outputAA 
;AA 
}BB 	
publicDD 
staticDD 

DictionaryDD  
<DD  !
(DD! "
TpmAlgIdDD" *
,DD* +
uintDD, 0
)DD0 1
,DD1 2
byteDD3 7
[DD7 8
]DD8 9
>DD9 :
DumpPCRsDD; C
(DDC D
Tpm2DDD H
tpmDDI L
)DDL M
{EE 	
varFF 
outputFF 
=FF 
newFF 

DictionaryFF '
<FF' (
(FF( )
TpmAlgIdFF) 1
,FF1 2
uintFF3 7
)FF7 8
,FF8 9
byteFF: >
[FF> ?
]FF? @
>FF@ A
(FFA B
)FFB C
;FFC D
ifGG 
(GG 
tpmGG 
==GG 
nullGG 
)GG 
{HH 
returnII 
outputII 
;II 
}JJ 
tpmMM 
.MM 
GetCapabilityMM 
(MM 
CapMM !
.MM! "
PcrsMM" &
,MM& '
$numMM( )
,MM) *
$numMM+ .
,MM. /
outMM0 3
ICapabilitiesUnionMM4 F
capsMMG K
)MMK L
;MML M
PcrSelectionNN 
[NN 
]NN 
pcrsNN 
=NN  !
(NN" #
(NN# $
PcrSelectionArrayNN$ 5
)NN5 6
capsNN6 :
)NN: ;
.NN; <
pcrSelectionsNN< I
;NNI J
foreachPP 
(PP 
varPP 
	selectionPP "
inPP# %
pcrsPP& *
)PP* +
{QQ 
foreachSS 
(SS 
varSS 
pcrValSS #
inSS$ &
DumpPCRsSS' /
(SS/ 0
tpmSS0 3
,SS3 4
	selectionSS5 >
.SS> ?
hashSS? C
,SSC D
newSSE H
PcrSelectionSSI U
[SSU V
]SSV W
{SSX Y
newSSZ ]
PcrSelectionSS^ j
(SSj k
	selectionSSk t
.SSt u
hashSSu y
,SSy z
	selection	SS{ Ñ
.
SSÑ Ö
GetSelectedPcrs
SSÖ î
(
SSî ï
)
SSï ñ
)
SSñ ó
}
SSò ô
)
SSô ö
)
SSö õ
{TT 
outputUU 
.UU 
AddUU 
(UU 
pcrValUU %
.UU% &
KeyUU& )
,UU) *
pcrValUU+ 1
.UU1 2
ValueUU2 7
)UU7 8
;UU8 9
}VV 
}WW 
returnYY 
outputYY 
;YY 
}ZZ 	
public\\ 
static\\ 

Dictionary\\  
<\\  !
(\\! "
TpmAlgId\\" *
,\\* +
uint\\, 0
)\\0 1
,\\1 2
byte\\3 7
[\\7 8
]\\8 9
>\\9 :
DumpPCRs\\; C
(\\C D
Tpm2\\D H
tpm\\I L
,\\L M
TpmAlgId\\N V
tpmAlgId\\W _
,\\_ `
PcrSelection\\a m
[\\m n
]\\n o
pcrs\\p t
)\\t u
{]] 	
var^^ 
output^^ 
=^^ 
new^^ 

Dictionary^^ '
<^^' (
(^^( )
TpmAlgId^^) 1
,^^1 2
uint^^3 7
)^^7 8
,^^8 9
byte^^: >
[^^> ?
]^^? @
>^^@ A
(^^A B
)^^B C
;^^C D
if__ 
(__ 
tpm__ 
==__ 
null__ 
||__ 
pcrs__ #
==__$ &
null__' +
)__+ ,
{`` 
returnaa 
outputaa 
;aa 
}bb 
trydd 
{ee 
doff 
{gg 
tpmhh 
.hh 
PcrReadhh 
(hh  
pcrshh  $
,hh$ %
outhh& )
PcrSelectionhh* 6
[hh6 7
]hh7 8
valsReadhh9 A
,hhA B
outhhC F
Tpm2bDigesthhG R
[hhR S
]hhS T
valueshhU [
)hh[ \
;hh\ ]
varjj 
pcrjj 
=jj 
pcrsjj "
[jj" #
$numjj# $
]jj$ %
;jj% &
varkk 
valReadkk 
=kk  !
valsReadkk" *
[kk* +
$numkk+ ,
]kk, -
;kk- .
ifmm 
(mm 
valuesmm 
.mm 
Lengthmm %
==mm& (
$nummm) *
)mm* +
{nn 
breakoo 
;oo 
}pp 
varqq 
pcrsReadqq  
=qq! "
valReadqq# *
.qq* +
GetSelectedPcrsqq+ :
(qq: ;
)qq; <
;qq< =
varss 
newPcrsss 
=ss  !
pcrss" %
.ss% &
GetSelectedPcrsss& 5
(ss5 6
)ss6 7
.ss7 8
Exceptss8 >
(ss> ?
pcrsReadss? G
)ssG H
;ssH I
foruu 
(uu 
intuu 
iuu 
=uu  
$numuu! "
;uu" #
iuu$ %
<uu& '
valuesuu( .
.uu. /
Lengthuu/ 5
;uu5 6
iuu7 8
++uu8 :
)uu: ;
{vv 
outputww 
.ww 
Addww "
(ww" #
(ww# $
tpmAlgIdww$ ,
,ww, -
pcrsReadww. 6
[ww6 7
iww7 8
]ww8 9
)ww9 :
,ww: ;
valuesww< B
[wwB C
iwwC D
]wwD E
.wwE F
bufferwwF L
)wwL M
;wwM N
}xx 
pcrszz 
[zz 
$numzz 
]zz 
=zz 
newzz !
PcrSelectionzz" .
(zz. /
tpmAlgIdzz/ 7
,zz7 8
$numzz9 ;
)zz; <
;zz< =
foreach|| 
(|| 
var||  
newPcr||! '
in||( *
newPcrs||+ 2
)||2 3
{}} 
pcrs~~ 
[~~ 
$num~~ 
]~~ 
.~~  
	SelectPcr~~  )
(~~) *
newPcr~~* 0
)~~0 1
;~~1 2
} 
}
ÄÄ 
while
ÄÄ 
(
ÄÄ 
pcrs
ÄÄ 
[
ÄÄ 
$num
ÄÄ 
]
ÄÄ  
.
ÄÄ  !
GetSelectedPcrs
ÄÄ! 0
(
ÄÄ0 1
)
ÄÄ1 2
.
ÄÄ2 3
Length
ÄÄ3 9
>
ÄÄ: ;
$num
ÄÄ< =
)
ÄÄ= >
;
ÄÄ> ?
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
e
ÇÇ 
)
ÇÇ 
{
ÉÉ 
Log
ÑÑ 
.
ÑÑ 
Verbose
ÑÑ 
(
ÑÑ 
e
ÑÑ 
,
ÑÑ 
$str
ÑÑ G
,
ÑÑG H
tpmAlgId
ÑÑI Q
)
ÑÑQ R
;
ÑÑR S
}
ÖÖ 
return
áá 
output
áá 
;
áá 
}
àà 	
public
ää 
static
ää 
List
ää 
<
ää $
CryptographicKeyObject
ää 1
>
ää1 2 
DumpPersistentKeys
ää3 E
(
ääE F
Tpm2
ääF J
tpm
ääK N
)
ääN O
{
ãã 	
var
åå 
listOut
åå 
=
åå 
new
åå 
List
åå "
<
åå" #$
CryptographicKeyObject
åå# 9
>
åå9 :
(
åå: ;
)
åå; <
;
åå< =
if
çç 
(
çç 
tpm
çç 
is
çç 
null
çç 
)
çç 
{
éé 
return
èè 
listOut
èè 
;
èè 
}
êê 
	TpmHandle
ëë 
[
ëë 
]
ëë 
handles
ëë 
=
ëë  !
GetLoadedEntities
ëë" 3
(
ëë3 4
tpm
ëë4 7
,
ëë7 8
Ht
ëë9 ;
.
ëë; <

Persistent
ëë< F
)
ëëF G
;
ëëG H
foreach
íí 
(
íí 
	TpmHandle
íí 
h
íí  
in
íí! #
handles
íí$ +
)
íí+ ,
{
ìì 
var
îî 
	tpmPublic
îî 
=
îî 
tpm
îî  #
.
îî# $

ReadPublic
îî$ .
(
îî. /
h
îî/ 0
,
îî0 1
out
îî2 5
byte
îî6 :
[
îî: ;
]
îî; <
name
îî= A
,
îîA B
out
îîC F
byte
îîG K
[
îîK L
]
îîL M
qualifiedName
îîN [
)
îî[ \
;
îî\ ]
}
ññ 
return
óó 
listOut
óó 
;
óó 
}
òò 	
public
öö 
static
öö 
List
öö 
<
öö 
AlgProperty
öö &
>
öö& '$
GetSupportedAlgorithms
öö( >
(
öö> ?
Tpm2
öö? C
tpm
ööD G
)
ööG H
{
õõ 	
if
úú 
(
úú 
tpm
úú 
!=
úú 
null
úú 
)
úú 
{
ùù 
try
ûû 
{
üü  
ICapabilitiesUnion
†† &
caps
††' +
;
††+ ,
tpm
°° 
.
°° 
GetCapability
°° %
(
°°% &
Cap
°°& )
.
°°) *
Algs
°°* .
,
°°. /
$num
°°0 1
,
°°1 2
$num
°°3 7
,
°°7 8
out
°°9 <
caps
°°= A
)
°°A B
;
°°B C
var
¢¢ 
algsx
¢¢ 
=
¢¢ 
(
¢¢  !
AlgPropertyArray
¢¢! 1
)
¢¢1 2
caps
¢¢2 6
;
¢¢6 7
return
§§ 
algsx
§§  
.
§§  !
algProperties
§§! .
.
§§. /
ToList
§§/ 5
(
§§5 6
)
§§6 7
;
§§7 8
}
•• 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶  
e
¶¶! "
)
¶¶" #
{
ßß 
Log
®® 
.
®® 
Verbose
®® 
(
®®  
$str
®®  O
,
®®O P
e
®®Q R
.
®®R S
GetType
®®S Z
(
®®Z [
)
®®[ \
,
®®\ ]
e
®®^ _
.
®®_ `
Message
®®` g
)
®®g h
;
®®h i
}
©© 
}
™™ 
return
´´ 
new
´´ 
List
´´ 
<
´´ 
AlgProperty
´´ '
>
´´' (
(
´´( )
)
´´) *
;
´´* +
}
¨¨ 	
public
ÆÆ 
static
ÆÆ 
List
ÆÆ 
<
ÆÆ 
TpmCc
ÆÆ  
>
ÆÆ  !"
GetSupportedCommands
ÆÆ" 6
(
ÆÆ6 7
Tpm2
ÆÆ7 ;
tpm
ÆÆ< ?
)
ÆÆ? @
{
ØØ 	
if
∞∞ 
(
∞∞ 
tpm
∞∞ 
!=
∞∞ 
null
∞∞ 
)
∞∞ 
{
±± 
try
≤≤ 
{
≥≥ 
tpm
¥¥ 
.
¥¥ 
GetCapability
¥¥ %
(
¥¥% &
Cap
¥¥& )
.
¥¥) *
TpmProperties
¥¥* 7
,
¥¥7 8
(
¥¥9 :
uint
¥¥: >
)
¥¥> ?
Pt
¥¥? A
.
¥¥A B
TotalCommands
¥¥B O
,
¥¥O P
$num
¥¥Q R
,
¥¥R S
out
¥¥T W 
ICapabilitiesUnion
¥¥X j
caps
¥¥k o
)
¥¥o p
;
¥¥p q
tpm
µµ 
.
µµ 
GetCapability
µµ %
(
µµ% &
Cap
µµ& )
.
µµ) *
Commands
µµ* 2
,
µµ2 3
(
µµ4 5
uint
µµ5 9
)
µµ9 :
TpmCc
µµ: ?
.
µµ? @
First
µµ@ E
,
µµE F
TpmCc
µµG L
.
µµL M
Last
µµM Q
-
µµR S
TpmCc
µµT Y
.
µµY Z
First
µµZ _
+
µµ` a
$num
µµb c
,
µµc d
out
µµe h
caps
µµi m
)
µµm n
;
µµn o
return
∑∑ 
(
∑∑ 
(
∑∑ 
CcaArray
∑∑ %
)
∑∑% &
caps
∑∑& *
)
∑∑* +
.
∑∑+ ,
commandAttributes
∑∑, =
.
∑∑= >
Select
∑∑> D
(
∑∑D E
attr
∑∑E I
=>
∑∑J L
(
∑∑M N
TpmCc
∑∑N S
)
∑∑S T
(
∑∑T U
(
∑∑U V
uint
∑∑V Z
)
∑∑Z [
attr
∑∑[ _
&
∑∑` a
$num
∑∑b m
)
∑∑m n
)
∑∑n o
.
∑∑o p
ToList
∑∑p v
(
∑∑v w
)
∑∑w x
;
∑∑x y
}
∏∏ 
catch
ππ 
(
ππ 
	Exception
ππ  
e
ππ! "
)
ππ" #
{
∫∫ 
Log
ªª 
.
ªª 
Verbose
ªª 
(
ªª  
$str
ªª  M
,
ªªM N
e
ªªO P
.
ªªP Q
GetType
ªªQ X
(
ªªX Y
)
ªªY Z
,
ªªZ [
e
ªª\ ]
.
ªª] ^
Message
ªª^ e
)
ªªe f
;
ªªf g
}
ºº 
}
ΩΩ 
return
ææ 
new
ææ 
List
ææ 
<
ææ 
TpmCc
ææ !
>
ææ! "
(
ææ" #
)
ææ# $
;
ææ$ %
}
øø 	
public
¡¡ 
static
¡¡ 
string
¡¡ 
GetVersionString
¡¡ -
(
¡¡- .
Tpm2
¡¡. 2
tpm
¡¡3 6
,
¡¡6 7
string
¡¡8 >
manufacturer
¡¡? K
)
¡¡K L
{
¬¬ 	
var
√√ 
sb
√√ 
=
√√ 
new
√√ 
StringBuilder
√√ &
(
√√& '
)
√√' (
;
√√( )
if
≈≈ 
(
≈≈ 
tpm
≈≈ 
!=
≈≈ 
null
≈≈ 
)
≈≈ 
{
∆∆ 
uint
«« 
[
«« 
]
«« 
version
«« 
=
««  
tpm
««! $
.
««$ %"
GetFirmwareVersionEx
««% 9
(
««9 :
)
««: ;
;
««; <
if
»» 
(
»» 
version
»» 
.
»» 
Length
»» "
>
»»# $
$num
»»% &
)
»»& '
{
…… 
sb
   
.
   
Append
   
(
   
version
   %
[
  % &
$num
  & '
]
  ' (
>>
  ) +
$num
  , .
)
  . /
;
  / 0
sb
ÀÀ 
.
ÀÀ 
Append
ÀÀ 
(
ÀÀ 
$char
ÀÀ !
)
ÀÀ! "
;
ÀÀ" #
sb
ÃÃ 
.
ÃÃ 
Append
ÃÃ 
(
ÃÃ 
version
ÃÃ %
[
ÃÃ% &
$num
ÃÃ& '
]
ÃÃ' (
&
ÃÃ) *
$num
ÃÃ+ 5
)
ÃÃ5 6
;
ÃÃ6 7
sb
ÕÕ 
.
ÕÕ 
Append
ÕÕ 
(
ÕÕ 
$char
ÕÕ !
)
ÕÕ! "
;
ÕÕ" #
if
œœ 
(
œœ 
version
œœ 
.
œœ  
Length
œœ  &
>
œœ' (
$num
œœ) *
)
œœ* +
{
–– 
if
—— 
(
—— 
manufacturer
—— (
is
——) +
string
——, 2
&&
——3 5
manufacturer
——6 B
.
——B C
Equals
——C I
(
——I J
$str
——J O
)
——O P
)
——P Q
{
““ 
sb
”” 
.
”” 
Append
”” %
(
””% &
(
””& '
version
””' .
[
””. /
$num
””/ 0
]
””0 1
>>
””2 4
$num
””5 6
)
””6 7
&
””8 9
$num
””: D
)
””D E
;
””E F
sb
‘‘ 
.
‘‘ 
Append
‘‘ %
(
‘‘% &
$char
‘‘& )
)
‘‘) *
;
‘‘* +
sb
’’ 
.
’’ 
Append
’’ %
(
’’% &
version
’’& -
[
’’- .
$num
’’. /
]
’’/ 0
&
’’1 2
$num
’’3 =
)
’’= >
;
’’> ?
}
÷÷ 
else
◊◊ 
{
ÿÿ 
sb
ŸŸ 
.
ŸŸ 
Append
ŸŸ %
(
ŸŸ% &
version
ŸŸ& -
[
ŸŸ- .
$num
ŸŸ. /
]
ŸŸ/ 0
>>
ŸŸ1 3
$num
ŸŸ4 6
)
ŸŸ6 7
;
ŸŸ7 8
sb
⁄⁄ 
.
⁄⁄ 
Append
⁄⁄ %
(
⁄⁄% &
$char
⁄⁄& )
)
⁄⁄) *
;
⁄⁄* +
sb
€€ 
.
€€ 
Append
€€ %
(
€€% &
version
€€& -
[
€€- .
$num
€€. /
]
€€/ 0
&
€€1 2
$num
€€3 =
)
€€= >
;
€€> ?
}
‹‹ 
}
›› 
}
ﬁﬁ 
}
ﬂﬂ 
return
‡‡ 
sb
‡‡ 
.
‡‡ 
ToString
‡‡ 
(
‡‡ 
)
‡‡  
;
‡‡  !
}
·· 	
public
„„ 
override
„„ 
bool
„„ 
CanRunOnPlatform
„„ -
(
„„- .
)
„„. /
{
‰‰ 	
return
ÂÂ  
RuntimeInformation
ÂÂ %
.
ÂÂ% &
IsOSPlatform
ÂÂ& 2
(
ÂÂ2 3

OSPlatform
ÂÂ3 =
.
ÂÂ= >
Windows
ÂÂ> E
)
ÂÂE F
||
ÂÂG I 
RuntimeInformation
ÂÂJ \
.
ÂÂ\ ]
IsOSPlatform
ÂÂ] i
(
ÂÂi j

OSPlatform
ÂÂj t
.
ÂÂt u
Linux
ÂÂu z
)
ÂÂz {
;
ÂÂ{ |
}
ÊÊ 	
internal
ËË 
override
ËË 
void
ËË 
ExecuteInternal
ËË .
(
ËË. /
CancellationToken
ËË/ @
cancellationToken
ËËA R
)
ËËR S
{
ÈÈ 	

Tpm2Device
ÍÍ 
?
ÍÍ 
	tpmDevice
ÍÍ !
=
ÍÍ" #
null
ÍÍ$ (
;
ÍÍ( )
if
ÏÏ 
(
ÏÏ 
TestMode
ÏÏ 
)
ÏÏ 
{
ÌÌ 
	tpmDevice
ÓÓ 
=
ÓÓ 
new
ÓÓ 
TcpTpmDevice
ÓÓ  ,
(
ÓÓ, -"
DefaultSimulatorName
ÓÓ- A
,
ÓÓA B"
DefaultSimulatorPort
ÓÓC W
,
ÓÓW X
stopTpm
ÓÓY `
:
ÓÓ` a
false
ÓÓb g
)
ÓÓg h
;
ÓÓh i
}
ÔÔ 
else
 
{
ÒÒ 
if
ÚÚ 
(
ÚÚ  
RuntimeInformation
ÚÚ &
.
ÚÚ& '
IsOSPlatform
ÚÚ' 3
(
ÚÚ3 4

OSPlatform
ÚÚ4 >
.
ÚÚ> ?
Windows
ÚÚ? F
)
ÚÚF G
)
ÚÚG H
{
ÛÛ 
	tpmDevice
ÙÙ 
=
ÙÙ 
new
ÙÙ  #
	TbsDevice
ÙÙ$ -
(
ÙÙ- .
)
ÙÙ. /
;
ÙÙ/ 0
}
ıı 
else
ˆˆ 
if
ˆˆ 
(
ˆˆ  
RuntimeInformation
ˆˆ +
.
ˆˆ+ ,
IsOSPlatform
ˆˆ, 8
(
ˆˆ8 9

OSPlatform
ˆˆ9 C
.
ˆˆC D
Linux
ˆˆD I
)
ˆˆI J
)
ˆˆJ K
{
˜˜ 
	tpmDevice
¯¯ 
=
¯¯ 
new
¯¯  #
LinuxTpmDevice
¯¯$ 2
(
¯¯2 3
)
¯¯3 4
;
¯¯4 5
}
˘˘ 
else
˙˙ 
{
˚˚ 
throw
¸¸ 
new
¸¸ +
PlatformNotSupportedException
¸¸ ;
(
¸¸; <
)
¸¸< =
;
¸¸= >
}
˝˝ 
}
˛˛ 
if
ÄÄ 
(
ÄÄ 
	tpmDevice
ÄÄ 
is
ÄÄ 

Tpm2Device
ÄÄ '
)
ÄÄ' (
{
ÅÅ 
	tpmDevice
ÇÇ 
.
ÇÇ 
Connect
ÇÇ !
(
ÇÇ! "
)
ÇÇ" #
;
ÇÇ# $
using
ÑÑ 
var
ÑÑ 
tpm
ÑÑ 
=
ÑÑ 
new
ÑÑ  #
Tpm2
ÑÑ$ (
(
ÑÑ( )
	tpmDevice
ÑÑ) 2
)
ÑÑ2 3
;
ÑÑ3 4
if
ÜÜ 
(
ÜÜ 
	tpmDevice
ÜÜ 
is
ÜÜ  
TcpTpmDevice
ÜÜ! -
tcpTpmDevice
ÜÜ. :
)
ÜÜ: ;
{
áá 
tcpTpmDevice
àà  
.
àà  !

PowerCycle
àà! +
(
àà+ ,
)
àà, -
;
àà- .
tpm
ââ 
.
ââ 
Startup
ââ 
(
ââ  
Su
ââ  "
.
ââ" #
Clear
ââ# (
)
ââ( )
;
ââ) *
}
ää 
var
çç 
obj
çç 
=
çç 
new
çç 
	TpmObject
çç '
(
çç' (

AsaHelpers
çç( 2
.
çç2 3
GetPlatformString
çç3 D
(
ççD E
)
ççE F
)
ççF G
;
ççG H
Tpm2
èè 
.
èè 

GetTpmInfo
èè 
(
èè  
tpm
èè  #
,
èè# $
out
èè% (
string
èè) /
manufacturer
èè0 <
,
èè< =
out
èè> A
uint
èèB F
specYear
èèG O
,
èèO P
out
èèQ T
uint
èèU Y
specDay
èèZ a
)
èèa b
;
èèb c
obj
ëë 
.
ëë 
TpmSpecDate
ëë 
=
ëë  !
new
ëë" %
DateTime
ëë& .
(
ëë. /
(
ëë/ 0
int
ëë0 3
)
ëë3 4
specYear
ëë4 <
,
ëë< =
$num
ëë> ?
,
ëë? @
$num
ëëA B
)
ëëB C
.
ëëC D
AddDays
ëëD K
(
ëëK L
specDay
ëëL S
-
ëëT U
$num
ëëV W
)
ëëW X
;
ëëX Y
obj
ìì 
.
ìì 
Manufacturer
ìì  
=
ìì! "
manufacturer
ìì# /
;
ìì/ 0
obj
ïï 
.
ïï 
Version
ïï 
=
ïï 
GetVersionString
ïï .
(
ïï. /
tpm
ïï/ 2
,
ïï2 3
manufacturer
ïï4 @
)
ïï@ A
;
ïïA B
obj
óó 
.
óó 
NV
óó 
=
óó 
DumpNV
óó 
(
óó  
tpm
óó  #
)
óó# $
;
óó$ %
obj
ôô 
.
ôô 
PCRs
ôô 
=
ôô 
DumpPCRs
ôô #
(
ôô# $
tpm
ôô$ '
)
ôô' (
;
ôô( )
obj
õõ 
.
õõ 
PersistentKeys
õõ "
=
õõ# $ 
DumpPersistentKeys
õõ% 7
(
õõ7 8
tpm
õõ8 ;
)
õõ; <
;
õõ< =
obj
ùù 
.
ùù 

Algorithms
ùù 
=
ùù  $
GetSupportedAlgorithms
ùù! 7
(
ùù7 8
tpm
ùù8 ;
)
ùù; <
.
ùù< =
ToList
ùù= C
(
ùùC D
)
ùùD E
;
ùùE F
obj
üü 
.
üü 
Commands
üü 
=
üü "
GetSupportedCommands
üü 3
(
üü3 4
tpm
üü4 7
)
üü7 8
.
üü8 9
ToList
üü9 ?
(
üü? @
)
üü@ A
;
üüA B
HandleChange
•• 
(
•• 
obj
••  
)
••  !
;
••! "
	tpmDevice
ßß 
.
ßß 
Close
ßß 
(
ßß  
)
ßß  !
;
ßß! "
}
®® 
	tpmDevice
™™ 
?
™™ 
.
™™ 
Dispose
™™ 
(
™™ 
)
™™  
;
™™  !
}
´´ 	
private
≠≠ 
const
≠≠ 
string
≠≠ "
DefaultSimulatorName
≠≠ 1
=
≠≠2 3
$str
≠≠4 ?
;
≠≠? @
private
ÆÆ 
const
ÆÆ 
int
ÆÆ "
DefaultSimulatorPort
ÆÆ .
=
ÆÆ/ 0
$num
ÆÆ1 5
;
ÆÆ5 6
private
∞∞ 
static
∞∞ 
	TpmHandle
∞∞  
[
∞∞  !
]
∞∞! "
GetLoadedEntities
∞∞# 4
(
∞∞4 5
Tpm2
∞∞5 9
tpm
∞∞: =
,
∞∞= >
Ht
∞∞? A
rangeToQuery
∞∞B N
)
∞∞N O
{
±± 	
uint
≤≤ 

maxHandles
≤≤ 
=
≤≤ 
uint
≤≤ "
.
≤≤" #
MaxValue
≤≤# +
;
≤≤+ ,
byte
≥≥ 
moreData
≥≥ 
=
≥≥ 
tpm
≥≥ 
.
≥≥  
GetCapability
≥≥  -
(
≥≥- .
Cap
≥≥. 1
.
≥≥1 2
Handles
≥≥2 9
,
≥≥9 :
(
≥≥; <
(
≥≥< =
uint
≥≥= A
)
≥≥A B
rangeToQuery
≥≥B N
)
≥≥N O
<<
≥≥P R
$num
≥≥S U
,
≥≥U V

maxHandles
¥¥. 8
,
¥¥8 9
out
¥¥: = 
ICapabilitiesUnion
¥¥> P
h
¥¥Q R
)
¥¥R S
;
¥¥S T
if
∑∑ 
(
∑∑ 
moreData
∑∑ 
!=
∑∑ 
$num
∑∑ 
)
∑∑ 
{
∏∏ 
throw
ππ 
new
ππ %
NotImplementedException
ππ 1
(
ππ1 2
$str
ππ2 ]
)
ππ] ^
;
ππ^ _
}
∫∫ 
if
ªª 
(
ªª 
h
ªª 
.
ªª 
GetType
ªª 
(
ªª 
)
ªª 
!=
ªª 
typeof
ªª %
(
ªª% &
HandleArray
ªª& 1
)
ªª1 2
)
ªª2 3
{
ºº 
throw
ΩΩ 
new
ΩΩ 
	Exception
ΩΩ #
(
ΩΩ# $
$str
ΩΩ$ \
)
ΩΩ\ ]
;
ΩΩ] ^
}
ææ 
return
øø 
(
øø 
h
øø 
as
øø 
HandleArray
øø $
)
øø$ %
?
øø% &
.
øø& '
handle
øø' -
??
øø. 0
Array
øø1 6
.
øø6 7
Empty
øø7 <
<
øø< =
	TpmHandle
øø= F
>
øøF G
(
øøG H
)
øøH I
;
øøI J
}
¿¿ 	
}
¡¡ 
}¬¬ Ê‹
RD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\UserAccountCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class  
UserAccountCollector %
:& '
BaseCollector( 5
{ 
public  
UserAccountCollector #
(# $
CollectorOptions$ 4
?4 5
opts6 :
=; <
null= A
,A B
ActionC I
<I J
CollectObjectJ W
>W X
?X Y
changeHandlerZ g
=h i
nullj n
)n o
:p q
baser v
(v w
optsw {
,{ |
changeHandler	} ä
)
ä ã
{ 	
} 	
public 
override 
bool 
CanRunOnPlatform -
(- .
). /
{ 	
return 
RuntimeInformation %
.% &
IsOSPlatform& 2
(2 3

OSPlatform3 =
.= >
Windows> E
)E F
||G I
RuntimeInformationJ \
.\ ]
IsOSPlatform] i
(i j

OSPlatformj t
.t u
Linuxu z
)z {
||| ~
RuntimeInformation	 ë
.
ë í
IsOSPlatform
í û
(
û ü

OSPlatform
ü ©
.
© ™
OSX
™ ≠
)
≠ Æ
;
Æ Ø
} 	
internal   
static   
bool   
IsHiddenWindowsUser   0
(  0 1
string  1 7
username  8 @
)  @ A
{!! 	
try"" 
{## 
using$$ 
var$$ 
BaseKey$$ !
=$$" #
RegistryKey$$$ /
.$$/ 0
OpenBaseKey$$0 ;
($$; <
RegistryHive$$< H
.$$H I
LocalMachine$$I U
,$$U V
RegistryView$$W c
.$$c d
Default$$d k
)$$k l
;$$l m
var%% 
SpecialAccounts%% #
=%%$ %
BaseKey%%& -
.%%- .

OpenSubKey%%. 8
(%%8 9
$str	%%9 è
)
%%è ê
;
%%ê ë
var&& 
	ValueName&& 
=&& 
SpecialAccounts&&  /
?&&/ 0
.&&0 1
GetValueNames&&1 >
(&&> ?
)&&? @
.&&@ A
Where&&A F
(&&F G
x&&G H
=>&&I K
x&&L M
.&&M N
ToUpperInvariant&&N ^
(&&^ _
)&&_ `
.&&` a
Equals&&a g
(&&g h
username&&h p
.&&p q
ToUpperInvariant	&&q Å
(
&&Å Ç
)
&&Ç É
)
&&É Ñ
)
&&Ñ Ö
.
&&Ö Ü
FirstOrDefault
&&Ü î
(
&&î ï
)
&&ï ñ
;
&&ñ ó
if'' 
('' 
	ValueName'' 
!=''  
null''! %
&&''& (
SpecialAccounts'') 8
!=''9 ;
null''< @
)''@ A
{(( 
if)) 
()) 
SpecialAccounts)) '
.))' (
GetValue))( 0
())0 1
	ValueName))1 :
))): ;
.)); <
Equals))< B
())B C
$num))C F
)))F G
)))G H
{** 
return++ 
true++ #
;++# $
},, 
}-- 
}.. 
catch// 
(// 
	Exception// 
e// 
)// 
when//  $
(//% &
e00 
is00 
IOException00  
||00! #
e11 
is11 
ArgumentException11 &
||11' )
e22 
is22 '
UnauthorizedAccessException22 0
||221 3
e33 
is33 
System33 
.33 
Security33 $
.33$ %
SecurityException33% 6
||337 9
e44 
is44 !
ArgumentNullException44 *
||44+ -
e55 
is55 "
NullReferenceException55 +
)55+ ,
{66 
}77 
return88 
false88 
;88 
}99 	
internal;; 
override;; 
void;; 
ExecuteInternal;; .
(;;. /
CancellationToken;;/ @
cancellationToken;;A R
);;R S
{<< 	
if== 
(== 
RuntimeInformation== "
.==" #
IsOSPlatform==# /
(==/ 0

OSPlatform==0 :
.==: ;
Windows==; B
)==B C
)==C D
{>> 
ExecuteWindows?? 
(?? 
cancellationToken?? 0
)??0 1
;??1 2
}@@ 
elseAA 
ifAA 
(AA 
RuntimeInformationAA '
.AA' (
IsOSPlatformAA( 4
(AA4 5

OSPlatformAA5 ?
.AA? @
LinuxAA@ E
)AAE F
)AAF G
{BB 
ExecuteLinuxCC 
(CC 
cancellationTokenCC .
)CC. /
;CC/ 0
}DD 
elseEE 
ifEE 
(EE 
RuntimeInformationEE '
.EE' (
IsOSPlatformEE( 4
(EE4 5

OSPlatformEE5 ?
.EE? @
OSXEE@ C
)EEC D
)EED E
{FF 

ExecuteOsXGG 
(GG 
cancellationTokenGG ,
)GG, -
;GG- .
}HH 
}II 	
internalNN 
voidNN 
ExecuteLinuxNN "
(NN" #
CancellationTokenNN# 4
cancellationTokenNN5 F
)NNF G
{OO 	
varPP 
etc_passwd_linesPP  
=PP! "
FilePP# '
.PP' (
ReadAllLinesPP( 4
(PP4 5
$strPP5 B
)PPB C
;PPC D
varQQ 
etc_shadow_linesQQ  
=QQ! "
FileQQ# '
.QQ' (
ReadAllLinesQQ( 4
(QQ4 5
$strQQ5 B
)QQB C
;QQC D

DictionarySS 
<SS 
stringSS 
,SS 
GroupAccountObjectSS 1
>SS1 2
GroupsSS3 9
=SS: ;
newSS< ?

DictionarySS@ J
<SSJ K
stringSSK Q
,SSQ R
GroupAccountObjectSSS e
>SSe f
(SSf g
)SSg h
;SSh i
varUU 
accountDetailsUU 
=UU  
newUU! $

DictionaryUU% /
<UU/ 0
stringUU0 6
,UU6 7
UserAccountObjectUU8 I
>UUI J
(UUJ K
)UUK L
;UUL M
foreachWW 
(WW 
varWW 
_lineWW 
inWW !
etc_passwd_linesWW" 2
)WW2 3
{XX 
ifYY 
(YY 
cancellationTokenYY %
.YY% &#
IsCancellationRequestedYY& =
)YY= >
{YY? @
breakYYA F
;YYF G
}YYH I
var[[ 
parts[[ 
=[[ 
_line[[ !
.[[! "
Split[[" '
([[' (
$char[[( +
)[[+ ,
;[[, -
if]] 
(]] 
!]] 
accountDetails]] #
.]]# $
ContainsKey]]$ /
(]]/ 0
parts]]0 5
[]]5 6
$num]]6 7
]]]7 8
)]]8 9
)]]9 :
{^^ 
accountDetails__ "
[__" #
parts__# (
[__( )
$num__) *
]__* +
]__+ ,
=__- .
new__/ 2
UserAccountObject__3 D
(__D E
parts__E J
[__J K
$num__K L
]__L M
)__M N
{`` 
UIDaa 
=aa 
partsaa #
[aa# $
$numaa$ %
]aa% &
,aa& '
GIDbb 
=bb 
partsbb #
[bb# $
$numbb$ %
]bb% &
,bb& '
FullNamecc  
=cc! "
partscc# (
[cc( )
$numcc) *
]cc* +
,cc+ ,
HomeDirectorydd %
=dd& '
partsdd( -
[dd- .
$numdd. /
]dd/ 0
,dd0 1
Shellee 
=ee 
partsee  %
[ee% &
$numee& '
]ee' (
}ff 
;ff 
}gg 
}hh 
foreachjj 
(jj 
varjj 
_linejj 
injj !
etc_shadow_linesjj" 2
)jj2 3
{kk 
ifll 
(ll 
cancellationTokenll %
.ll% &#
IsCancellationRequestedll& =
)ll= >
{ll? @
breakllA F
;llF G
}llH I
varnn 
partsnn 
=nn 
_linenn !
.nn! "
Splitnn" '
(nn' (
$charnn( +
)nn+ ,
;nn, -
varoo 
usernameoo 
=oo 
partsoo $
[oo$ %
$numoo% &
]oo& '
;oo' (
ifqq 
(qq 
!qq 
accountDetailsqq #
.qq# $
ContainsKeyqq$ /
(qq/ 0
usernameqq0 8
)qq8 9
)qq9 :
{rr 
accountDetailsss "
[ss" #
usernamess# +
]ss+ ,
=ss- .
newss/ 2
UserAccountObjectss3 D
(ssD E
usernamessE M
)ssM N
{tt 
}uu 
;uu 
}vv 
varww 
tempDictww 
=ww 
accountDetailsww -
[ww- .
usernameww. 6
]ww6 7
;ww7 8
ifyy 
(yy 
partsyy 
[yy 
$numyy 
]yy 
.yy 
Containsyy %
(yy% &
$stryy& )
)yy) *
)yy* +
{zz 
tempDict{{ 
.{{ $
PasswordStorageAlgorithm{{ 5
={{6 7
parts{{8 =
[{{= >
$num{{> ?
]{{? @
.{{@ A
Split{{A F
({{F G
$char{{G J
){{J K
[{{K L
$num{{L M
]{{M N
;{{N O
}|| 
tempDict}} 
.}} 
PasswordExpires}} (
=}}) *
parts}}+ 0
[}}0 1
$num}}1 2
]}}2 3
;}}3 4
tempDict~~ 
.~~ 
Inactive~~ !
=~~" #
parts~~$ )
[~~) *
$num~~* +
]~~+ ,
;~~, -
tempDict 
. 
Disabled !
=" #
parts$ )
[) *
$num* +
]+ ,
;, -
accountDetails
ÅÅ 
[
ÅÅ 
username
ÅÅ '
]
ÅÅ' (
=
ÅÅ) *
tempDict
ÅÅ+ 3
;
ÅÅ3 4
}
ÇÇ 
foreach
ÑÑ 
(
ÑÑ 
var
ÑÑ 
username
ÑÑ !
in
ÑÑ" $
accountDetails
ÑÑ% 3
.
ÑÑ3 4
Keys
ÑÑ4 8
)
ÑÑ8 9
{
ÖÖ 
if
ÜÜ 
(
ÜÜ 
cancellationToken
ÜÜ %
.
ÜÜ% &%
IsCancellationRequested
ÜÜ& =
)
ÜÜ= >
{
ÜÜ? @
break
ÜÜA F
;
ÜÜF G
}
ÜÜH I
var
ââ 
	groupsRaw
ââ 
=
ââ #
ExternalCommandRunner
ââ  5
.
ââ5 6 
RunExternalCommand
ââ6 H
(
ââH I
$str
ââI Q
,
ââQ R
username
ââS [
)
ââ[ \
;
ââ\ ]
var
ãã 
groups
ãã 
=
ãã 
	groupsRaw
ãã &
.
ãã& '
Split
ãã' ,
(
ãã, -
$char
ãã- 0
)
ãã0 1
;
ãã1 2
foreach
åå 
(
åå 
var
åå 
group
åå "
in
åå# %
groups
åå& ,
)
åå, -
{
çç 
if
éé 
(
éé 
group
éé 
.
éé 
Equals
éé $
(
éé$ %
$str
éé% +
)
éé+ ,
)
éé, -
{
èè 
accountDetails
êê &
[
êê& '
username
êê' /
]
êê/ 0
.
êê0 1

Privileged
êê1 ;
=
êê< =
true
êê> B
;
êêB C
}
ëë 
accountDetails
íí "
[
íí" #
username
íí# +
]
íí+ ,
.
íí, -
Groups
íí- 3
.
íí3 4
Add
íí4 7
(
íí7 8
group
íí8 =
)
íí= >
;
íí> ?
if
ìì 
(
ìì 
Groups
ìì 
.
ìì 
ContainsKey
ìì *
(
ìì* +
group
ìì+ 0
)
ìì0 1
)
ìì1 2
{
îî 
Groups
ïï 
[
ïï 
group
ïï $
]
ïï$ %
.
ïï% &
Users
ïï& +
.
ïï+ ,
Add
ïï, /
(
ïï/ 0
username
ïï0 8
)
ïï8 9
;
ïï9 :
}
ññ 
else
óó 
{
òò 
Groups
ôô 
[
ôô 
group
ôô $
]
ôô$ %
=
ôô& '
new
ôô( + 
GroupAccountObject
ôô, >
(
ôô> ?
group
ôô? D
)
ôôD E
;
ôôE F
Groups
öö 
[
öö 
group
öö $
]
öö$ %
.
öö% &
Users
öö& +
.
öö+ ,
Add
öö, /
(
öö/ 0
username
öö0 8
)
öö8 9
;
öö9 :
}
õõ 
}
úú 
HandleChange
ùù 
(
ùù 
accountDetails
ùù +
[
ùù+ ,
username
ùù, 4
]
ùù4 5
)
ùù5 6
;
ùù6 7
}
ûû 
foreach
üü 
(
üü 
var
üü 
group
üü 
in
üü !
Groups
üü" (
)
üü( )
{
†† 
if
°° 
(
°° 
cancellationToken
°° %
.
°°% &%
IsCancellationRequested
°°& =
)
°°= >
{
°°? @
break
°°A F
;
°°F G
}
°°H I
HandleChange
££ 
(
££ 
group
££ "
.
££" #
Value
££# (
)
££( )
;
££) *
}
§§ 
}
•• 	
internal
™™ 
void
™™ 

ExecuteOsX
™™  
(
™™  !
CancellationToken
™™! 2
cancellationToken
™™3 D
)
™™D E
{
´´ 	

Dictionary
¨¨ 
<
¨¨ 
string
¨¨ 
,
¨¨  
GroupAccountObject
¨¨ 1
>
¨¨1 2
Groups
¨¨3 9
=
¨¨: ;
new
¨¨< ?

Dictionary
¨¨@ J
<
¨¨J K
string
¨¨K Q
,
¨¨Q R 
GroupAccountObject
¨¨S e
>
¨¨e f
(
¨¨f g
)
¨¨g h
;
¨¨h i
var
ØØ 
result
ØØ 
=
ØØ #
ExternalCommandRunner
ØØ .
.
ØØ. / 
RunExternalCommand
ØØ/ A
(
ØØA B
$str
ØØB O
,
ØØO P
$str
ØØQ i
)
ØØi j
;
ØØj k
var
±± 
lines
±± 
=
±± 
result
±± 
.
±± 
Split
±± $
(
±±$ %
$char
±±% )
)
±±) *
;
±±* +
var
¥¥ 
admins
¥¥ 
=
¥¥ 
(
¥¥ 
lines
¥¥ 
[
¥¥  
$num
¥¥  !
]
¥¥! "
.
¥¥" #
Split
¥¥# (
(
¥¥( )
$char
¥¥) ,
)
¥¥, -
[
¥¥- .
$num
¥¥. /
]
¥¥/ 0
)
¥¥0 1
.
¥¥1 2
Split
¥¥2 7
(
¥¥7 8
$char
¥¥8 ;
)
¥¥; <
;
¥¥< =
result
∑∑ 
=
∑∑ #
ExternalCommandRunner
∑∑ *
.
∑∑* + 
RunExternalCommand
∑∑+ =
(
∑∑= >
$str
∑∑> K
,
∑∑K L
$str
∑∑M V
)
∑∑V W
;
∑∑W X
var
ππ 
accountDetails
ππ 
=
ππ  
new
ππ! $

Dictionary
ππ% /
<
ππ/ 0
string
ππ0 6
,
ππ6 7
UserAccountObject
ππ8 I
>
ππI J
(
ππJ K
)
ππK L
;
ππL M
var
ΩΩ 
newUser
ΩΩ 
=
ΩΩ 
new
ΩΩ 
UserAccountObject
ΩΩ /
(
ΩΩ/ 0
$str
ΩΩ0 2
)
ΩΩ2 3
;
ΩΩ3 4
foreach
ææ 
(
ææ 
var
ææ 
_line
ææ 
in
ææ !
result
ææ" (
.
ææ( )
Split
ææ) .
(
ææ. /
$char
ææ/ 3
)
ææ3 4
)
ææ4 5
{
øø 
if
¿¿ 
(
¿¿ 
cancellationToken
¿¿ %
.
¿¿% &%
IsCancellationRequested
¿¿& =
)
¿¿= >
{
¿¿? @
break
¿¿A F
;
¿¿F G
}
¿¿H I
var
¬¬ 
parts
¬¬ 
=
¬¬ 
_line
¬¬ !
.
¬¬! "
Split
¬¬" '
(
¬¬' (
$char
¬¬( +
)
¬¬+ ,
;
¬¬, -
if
√√ 
(
√√ 
parts
√√ 
.
√√ 
Length
√√  
<
√√! "
$num
√√# $
)
√√$ %
{
ƒƒ 
continue
∆∆ 
;
∆∆ 
}
«« 
var
…… 
value
…… 
=
…… 
parts
…… !
[
……! "
$num
……" #
]
……# $
.
……$ %
	Substring
……% .
(
……. /
$num
……/ 0
)
……0 1
;
……1 2
switch
ÃÃ 
(
ÃÃ 
parts
ÃÃ 
[
ÃÃ 
$num
ÃÃ 
]
ÃÃ  
)
ÃÃ  !
{
ÕÕ 
case
ŒŒ 
$str
ŒŒ 
:
ŒŒ  
accountDetails
œœ &
[
œœ& '
value
œœ' ,
]
œœ, -
=
œœ. /
new
œœ0 3
UserAccountObject
œœ4 E
(
œœE F
value
œœF K
)
œœK L
{
–– 
AccountType
—— '
=
——( )
(
——* +
admins
——+ 1
.
——1 2
Contains
——2 :
(
——: ;
value
——; @
)
——@ A
)
——A B
?
——C D
$str
——E T
:
——U V
$str
——W a
,
——a b

Privileged
““ &
=
““' (
(
““) *
admins
““* 0
.
““0 1
Contains
““1 9
(
““9 :
value
““: ?
)
““? @
)
““@ A
}
”” 
;
”” 
newUser
‘‘ 
=
‘‘  !
accountDetails
‘‘" 0
[
‘‘0 1
value
‘‘1 6
]
‘‘6 7
;
‘‘7 8
break
÷÷ 
;
÷÷ 
case
ÿÿ 
$str
ÿÿ #
:
ÿÿ# $
break
ŸŸ 
;
ŸŸ 
case
€€ 
$str
€€ 
:
€€ 
newUser
‹‹ 
.
‹‹  
UID
‹‹  #
=
‹‹$ %
value
‹‹& +
;
‹‹+ ,
break
›› 
;
›› 
case
ﬂﬂ 
$str
ﬂﬂ 
:
ﬂﬂ 
newUser
‡‡ 
.
‡‡  
GID
‡‡  #
=
‡‡$ %
value
‡‡& +
;
‡‡+ ,
break
·· 
;
·· 
case
„„ 
$str
„„ 
:
„„ 
newUser
‰‰ 
.
‰‰  
HomeDirectory
‰‰  -
=
‰‰. /
value
‰‰0 5
;
‰‰5 6
break
ÂÂ 
;
ÂÂ 
case
ÁÁ 
$str
ÁÁ  
:
ÁÁ  !
newUser
ËË 
.
ËË  
Shell
ËË  %
=
ËË& '
value
ËË( -
;
ËË- .
break
ÈÈ 
;
ÈÈ 
case
ÎÎ 
$str
ÎÎ  
:
ÎÎ  !
newUser
ÏÏ 
.
ÏÏ  
FullName
ÏÏ  (
=
ÏÏ) *
value
ÏÏ+ 0
;
ÏÏ0 1
break
ÌÌ 
;
ÌÌ 
default
ÔÔ 
:
ÔÔ 
break
 
;
 
}
ÒÒ 
}
ÚÚ 
foreach
ÛÛ 
(
ÛÛ 
var
ÛÛ 
username
ÛÛ !
in
ÛÛ" $
accountDetails
ÛÛ% 3
.
ÛÛ3 4
Keys
ÛÛ4 8
)
ÛÛ8 9
{
ÙÙ 
if
ıı 
(
ıı 
cancellationToken
ıı %
.
ıı% &%
IsCancellationRequested
ıı& =
)
ıı= >
{
ıı? @
break
ııA F
;
ııF G
}
ııH I
string
¯¯ 
	groupsRaw
¯¯  
=
¯¯! "
string
¯¯# )
.
¯¯) *
Empty
¯¯* /
;
¯¯/ 0
	groupsRaw
˙˙ 
=
˙˙ #
ExternalCommandRunner
˙˙ 1
.
˙˙1 2 
RunExternalCommand
˙˙2 D
(
˙˙D E
$str
˙˙E M
,
˙˙M N
username
˙˙O W
)
˙˙W X
;
˙˙X Y
var
¸¸ 
groups
¸¸ 
=
¸¸ 
	groupsRaw
¸¸ &
.
¸¸& '
Split
¸¸' ,
(
¸¸, -
$char
¸¸- 0
)
¸¸0 1
;
¸¸1 2
foreach
˝˝ 
(
˝˝ 
var
˝˝ 
group
˝˝ "
in
˝˝# %
groups
˝˝& ,
)
˝˝, -
{
˛˛ 
accountDetails
ˇˇ "
[
ˇˇ" #
username
ˇˇ# +
]
ˇˇ+ ,
.
ˇˇ, -
Groups
ˇˇ- 3
.
ˇˇ3 4
Add
ˇˇ4 7
(
ˇˇ7 8
group
ˇˇ8 =
)
ˇˇ= >
;
ˇˇ> ?
if
ÄÄ 
(
ÄÄ 
Groups
ÄÄ 
.
ÄÄ 
ContainsKey
ÄÄ *
(
ÄÄ* +
group
ÄÄ+ 0
)
ÄÄ0 1
)
ÄÄ1 2
{
ÅÅ 
Groups
ÇÇ 
[
ÇÇ 
group
ÇÇ $
]
ÇÇ$ %
.
ÇÇ% &
Users
ÇÇ& +
.
ÇÇ+ ,
Add
ÇÇ, /
(
ÇÇ/ 0
username
ÇÇ0 8
)
ÇÇ8 9
;
ÇÇ9 :
}
ÉÉ 
else
ÑÑ 
{
ÖÖ 
Groups
ÜÜ 
[
ÜÜ 
group
ÜÜ $
]
ÜÜ$ %
=
ÜÜ& '
new
ÜÜ( + 
GroupAccountObject
ÜÜ, >
(
ÜÜ> ?
group
ÜÜ? D
)
ÜÜD E
;
ÜÜE F
Groups
áá 
[
áá 
group
áá $
]
áá$ %
.
áá% &
Users
áá& +
.
áá+ ,
Add
áá, /
(
áá/ 0
username
áá0 8
)
áá8 9
;
áá9 :
}
àà 
}
ââ 
accountDetails
ää 
[
ää 
username
ää '
]
ää' (
.
ää( )
Groups
ää) /
.
ää/ 0
AddRange
ää0 8
(
ää8 9
groups
ää9 ?
)
ää? @
;
ää@ A
HandleChange
ãã 
(
ãã 
accountDetails
ãã +
[
ãã+ ,
username
ãã, 4
]
ãã4 5
)
ãã5 6
;
ãã6 7
}
åå 
foreach
çç 
(
çç 
var
çç 
group
çç 
in
çç !
Groups
çç" (
)
çç( )
{
éé 
if
èè 
(
èè 
cancellationToken
èè %
.
èè% &%
IsCancellationRequested
èè& =
)
èè= >
{
èè? @
break
èèA F
;
èèF G
}
èèH I
HandleChange
ëë 
(
ëë 
group
ëë "
.
ëë" #
Value
ëë# (
)
ëë( )
;
ëë) *
}
íí 
}
ìì 	
internal
òò 
void
òò 
ExecuteWindows
òò $
(
òò$ %
CancellationToken
òò% 6
cancellationToken
òò7 H
)
òòH I
{
ôô 	

Dictionary
öö 
<
öö 
string
öö 
,
öö 
UserAccountObject
öö 0
>
öö0 1
users
öö2 7
=
öö8 9
new
öö: =

Dictionary
öö> H
<
ööH I
string
ööI O
,
ööO P
UserAccountObject
ööQ b
>
ööb c
(
ööc d
)
ööd e
;
ööe f

Dictionary
õõ 
<
õõ 
string
õõ 
,
õõ  
GroupAccountObject
õõ 1
>
õõ1 2
groups
õõ3 9
=
õõ: ;
new
õõ< ?

Dictionary
õõ@ J
<
õõJ K
string
õõK Q
,
õõQ R 
GroupAccountObject
õõS e
>
õõe f
(
õõf g
)
õõg h
;
õõh i 
GroupAccountObject
ùù 
?
ùù 
GetGroup
ùù  (
(
ùù( )
string
ùù) /
	groupName
ùù0 9
)
ùù9 :
{
ûû 
if
†† 
(
†† 
!
†† 
groups
†† 
.
†† 
ContainsKey
†† '
(
††' (
$"
††( *
{
††* +
Environment
††+ 6
.
††6 7
MachineName
††7 B
}
††B C
$str
††C E
{
††E F
	groupName
††F O
}
††O P
"
††P Q
)
††Q R
)
††R S
{
°° 
SelectQuery
¢¢ 
query
¢¢  %
=
¢¢& '
new
¢¢( +
SelectQuery
¢¢, 7
(
¢¢7 8
$str
¢¢8 `
+
¢¢a b
	groupName
¢¢c l
+
¢¢m n
$str
¢¢o 
+¢¢Ä Å
Environment¢¢Ç ç
.¢¢ç é
MachineName¢¢é ô
+¢¢ö õ
$str¢¢ú ü
)¢¢ü †
;¢¢† °
using
££ &
ManagementObjectSearcher
££ 2
searcher
££3 ;
=
££< =
new
££> A&
ManagementObjectSearcher
££B Z
(
££Z [
query
££[ `
)
££` a
;
££a b
foreach
¶¶ 
(
¶¶ 
ManagementObject
¶¶ -
gmo
¶¶. 1
in
¶¶2 4
searcher
¶¶5 =
.
¶¶= >
Get
¶¶> A
(
¶¶A B
)
¶¶B C
)
¶¶C D
{
ßß 
return
®® 
new
®® " 
GroupAccountObject
®®# 5
(
®®5 6
	groupName
®®6 ?
)
®®? @
{
©© 
Caption
™™ #
=
™™$ %
Convert
™™& -
.
™™- .
ToString
™™. 6
(
™™6 7
gmo
™™7 :
[
™™: ;
$str
™™; D
]
™™D E
,
™™E F
CultureInfo
™™G R
.
™™R S
InvariantCulture
™™S c
)
™™c d
,
™™d e
Description
´´ '
=
´´( )
Convert
´´* 1
.
´´1 2
ToString
´´2 :
(
´´: ;
gmo
´´; >
[
´´> ?
$str
´´? L
]
´´L M
,
´´M N
CultureInfo
´´O Z
.
´´Z [
InvariantCulture
´´[ k
)
´´k l
,
´´l m
InstallDate
¨¨ '
=
¨¨( )
Convert
¨¨* 1
.
¨¨1 2
ToString
¨¨2 :
(
¨¨: ;
gmo
¨¨; >
[
¨¨> ?
$str
¨¨? L
]
¨¨L M
,
¨¨M N
CultureInfo
¨¨O Z
.
¨¨Z [
InvariantCulture
¨¨[ k
)
¨¨k l
,
¨¨l m
Status
≠≠ "
=
≠≠# $
Convert
≠≠% ,
.
≠≠, -
ToString
≠≠- 5
(
≠≠5 6
gmo
≠≠6 9
[
≠≠9 :
$str
≠≠: B
]
≠≠B C
,
≠≠C D
CultureInfo
≠≠E P
.
≠≠P Q
InvariantCulture
≠≠Q a
)
≠≠a b
,
≠≠b c
LocalAccount
ÆÆ (
=
ÆÆ) *
Convert
ÆÆ+ 2
.
ÆÆ2 3
	ToBoolean
ÆÆ3 <
(
ÆÆ< =
gmo
ÆÆ= @
[
ÆÆ@ A
$str
ÆÆA O
]
ÆÆO P
,
ÆÆP Q
CultureInfo
ÆÆR ]
.
ÆÆ] ^
InvariantCulture
ÆÆ^ n
)
ÆÆn o
,
ÆÆo p
SID
ØØ 
=
ØØ  !
Convert
ØØ" )
.
ØØ) *
ToString
ØØ* 2
(
ØØ2 3
gmo
ØØ3 6
[
ØØ6 7
$str
ØØ7 <
]
ØØ< =
,
ØØ= >
CultureInfo
ØØ? J
.
ØØJ K
InvariantCulture
ØØK [
)
ØØ[ \
,
ØØ\ ]
SIDType
∞∞ #
=
∞∞$ %
Convert
∞∞& -
.
∞∞- .
ToInt32
∞∞. 5
(
∞∞5 6
gmo
∞∞6 9
[
∞∞9 :
$str
∞∞: C
]
∞∞C D
,
∞∞D E
CultureInfo
∞∞F Q
.
∞∞Q R
InvariantCulture
∞∞R b
)
∞∞b c
,
∞∞c d
Domain
±± "
=
±±# $
Convert
±±% ,
.
±±, -
ToString
±±- 5
(
±±5 6
gmo
±±6 9
[
±±9 :
$str
±±: B
]
±±B C
,
±±C D
CultureInfo
±±E P
.
±±P Q
InvariantCulture
±±Q a
)
±±a b
,
±±b c
}
≤≤ 
;
≤≤ 
}
≥≥ 
}
¥¥ 
else
µµ 
{
∂∂ 
return
∑∑ 
groups
∑∑ !
[
∑∑! "
$"
∑∑" $
{
∑∑$ %
Environment
∑∑% 0
.
∑∑0 1
MachineName
∑∑1 <
}
∑∑< =
$str
∑∑= ?
{
∑∑? @
	groupName
∑∑@ I
}
∑∑I J
"
∑∑J K
]
∑∑K L
;
∑∑L M
}
∏∏ 
return
ππ 
null
ππ 
;
ππ 
}
∫∫ 
try
ªª 
{
ºº 
List
ΩΩ 
<
ΩΩ 
string
ΩΩ 
>
ΩΩ 
lines
ΩΩ "
=
ΩΩ# $
new
ΩΩ% (
List
ΩΩ) -
<
ΩΩ- .
string
ΩΩ. 4
>
ΩΩ4 5
(
ΩΩ5 6#
ExternalCommandRunner
ΩΩ6 K
.
ΩΩK L 
RunExternalCommand
ΩΩL ^
(
ΩΩ^ _
$str
ΩΩ_ d
,
ΩΩd e
$str
ΩΩf r
)
ΩΩr s
.
ΩΩs t
Split
ΩΩt y
(
ΩΩy z
$char
ΩΩz ~
)
ΩΩ~ 
)ΩΩ Ä
;ΩΩÄ Å
lines
øø 
.
øø 
RemoveRange
øø !
(
øø! "
$num
øø" #
,
øø# $
$num
øø% &
)
øø& '
;
øø' (
foreach
¡¡ 
(
¡¡ 
string
¡¡ 
line
¡¡  $
in
¡¡% '
lines
¡¡( -
)
¡¡- .
{
¬¬ 
if
√√ 
(
√√ 
cancellationToken
√√ )
.
√√) *%
IsCancellationRequested
√√* A
)
√√A B
{
√√C D
break
√√E J
;
√√J K
}
√√L M
if
≈≈ 
(
≈≈ 
line
≈≈ 
.
≈≈ 
Contains
≈≈ %
(
≈≈% &
$char
≈≈& )
)
≈≈) *
)
≈≈* +
{
∆∆ 
var
«« 
	groupName
«« %
=
««& '
line
««( ,
.
««, -
	Substring
««- 6
(
««6 7
$num
««7 8
)
««8 9
.
««9 :
Trim
««: >
(
««> ?
)
««? @
;
««@ A
var
»» 
group
»» !
=
»»" #
GetGroup
»»$ ,
(
»», -
	groupName
»»- 6
)
»»6 7
;
»»7 8
if
   
(
   
group
   !
!=
  " $
null
  % )
)
  ) *
{
ÀÀ 
group
ÃÃ !
.
ÃÃ! "
Users
ÃÃ" '
=
ÃÃ( )
new
ÃÃ* -
List
ÃÃ. 2
<
ÃÃ2 3
string
ÃÃ3 9
>
ÃÃ9 :
(
ÃÃ: ;
)
ÃÃ; <
;
ÃÃ< =
var
œœ 
args
œœ  $
=
œœ% &
$"
œœ' )
$str
œœ) 1
{
œœ1 2
Environment
œœ2 =
.
œœ= >
MachineName
œœ> I
}
œœI J
$strœœJ è
{œœè ê
	groupNameœœê ô
}œœô ö
$strœœö ™
{œœ™ ´
Environmentœœ´ ∂
.œœ∂ ∑
MachineNameœœ∑ ¬
}œœ¬ √
$strœœ√  
"œœ  À
;œœÀ Ã
List
––  
<
––  !
string
––! '
>
––' (
	lines_int
––) 2
=
––3 4
new
––5 8
List
––9 =
<
––= >
string
––> D
>
––D E
(
––E F#
ExternalCommandRunner
––F [
.
––[ \ 
RunExternalCommand
––\ n
(
––n o
$str
––o u
,
––u v
args
––w {
)
––{ |
.
––| }
Split––} Ç
(––Ç É
$char––É á
)––á à
)––à â
;––â ä
	lines_int
—— %
.
——% &
RemoveRange
——& 1
(
——1 2
$num
——2 3
,
——3 4
$num
——5 6
)
——6 7
;
——7 8
foreach
”” #
(
””$ %
string
””% +
line_int
””, 4
in
””5 7
	lines_int
””8 A
)
””A B
{
‘‘ 
var
’’  #
userName
’’$ ,
=
’’- .
line_int
’’/ 7
.
’’7 8
Trim
’’8 <
(
’’< =
)
’’= >
;
’’> ?
if
÷÷  "
(
÷÷# $
string
÷÷$ *
.
÷÷* +
IsNullOrEmpty
÷÷+ 8
(
÷÷8 9
userName
÷÷9 A
)
÷÷A B
||
÷÷C E
!
÷÷F G
userName
÷÷G O
.
÷÷O P
Contains
÷÷P X
(
÷÷X Y
$str
÷÷Y a
)
÷÷a b
)
÷÷b c
{
◊◊  !
continue
ÿÿ$ ,
;
ÿÿ, -
}
ŸŸ  !
else
⁄⁄  $
{
€€  !
Regex
‹‹$ )
r
‹‹* +
=
‹‹, -
new
‹‹. 1
Regex
‹‹2 7
(
‹‹7 8
$str
‹‹8 n
)
‹‹n o
;
‹‹o p
var
ﬁﬁ$ '
domain
ﬁﬁ( .
=
ﬁﬁ/ 0
r
ﬁﬁ1 2
.
ﬁﬁ2 3
Match
ﬁﬁ3 8
(
ﬁﬁ8 9
userName
ﬁﬁ9 A
)
ﬁﬁA B
.
ﬁﬁB C
Groups
ﬁﬁC I
[
ﬁﬁI J
$num
ﬁﬁJ K
]
ﬁﬁK L
.
ﬁﬁL M
Value
ﬁﬁM R
;
ﬁﬁR S
userName
ﬂﬂ$ ,
=
ﬂﬂ- .
r
ﬂﬂ/ 0
.
ﬂﬂ0 1
Match
ﬂﬂ1 6
(
ﬂﬂ6 7
userName
ﬂﬂ7 ?
)
ﬂﬂ? @
.
ﬂﬂ@ A
Groups
ﬂﬂA G
[
ﬂﬂG H
$num
ﬂﬂH I
]
ﬂﬂI J
.
ﬂﬂJ K
Value
ﬂﬂK P
;
ﬂﬂP Q
if
··$ &
(
··' (
string
··( .
.
··. /
IsNullOrEmpty
··/ <
(
··< =
userName
··= E
)
··E F
)
··F G
{
‚‚$ %
continue
„„( 0
;
„„0 1
}
‰‰$ %
Log
ÊÊ$ '
.
ÊÊ' (
Verbose
ÊÊ( /
(
ÊÊ/ 0
$str
ÊÊ0 Q
,
ÊÊQ R
domain
ÊÊS Y
,
ÊÊY Z
userName
ÊÊ[ c
,
ÊÊc d
	groupName
ÊÊe n
)
ÊÊn o
;
ÊÊo p
if
ÁÁ$ &
(
ÁÁ' (
!
ÁÁ( )
group
ÁÁ) .
.
ÁÁ. /
Users
ÁÁ/ 4
.
ÁÁ4 5
Contains
ÁÁ5 =
(
ÁÁ= >
$"
ÁÁ> @
{
ÁÁ@ A
domain
ÁÁA G
}
ÁÁG H
$str
ÁÁH J
{
ÁÁJ K
userName
ÁÁK S
}
ÁÁS T
"
ÁÁT U
)
ÁÁU V
)
ÁÁV W
{
ËË$ %
group
ÈÈ( -
.
ÈÈ- .
Users
ÈÈ. 3
.
ÈÈ3 4
Add
ÈÈ4 7
(
ÈÈ7 8
$"
ÈÈ8 :
{
ÈÈ: ;
domain
ÈÈ; A
}
ÈÈA B
$str
ÈÈB D
{
ÈÈD E
userName
ÈÈE M
}
ÈÈM N
"
ÈÈN O
)
ÈÈO P
;
ÈÈP Q
}
ÍÍ$ %
var
ÏÏ$ '
query
ÏÏ( -
=
ÏÏ. /
new
ÏÏ0 3
SelectQuery
ÏÏ4 ?
(
ÏÏ? @
$"
ÏÏ@ B
$str
ÏÏB p
{
ÏÏp q
domain
ÏÏq w
}
ÏÏw x
$strÏÏx Ñ
{ÏÏÑ Ö
userNameÏÏÖ ç
}ÏÏç é
$strÏÏé è
"ÏÏè ê
)ÏÏê ë
;ÏÏë í
using
ÌÌ$ )
var
ÌÌ* -
searcher
ÌÌ. 6
=
ÌÌ7 8
new
ÌÌ9 <&
ManagementObjectSearcher
ÌÌ= U
(
ÌÌU V
query
ÌÌV [
)
ÌÌ[ \
;
ÌÌ\ ]
foreach
ÓÓ$ +
(
ÓÓ, -
ManagementObject
ÓÓ- =
user
ÓÓ> B
in
ÓÓC E
searcher
ÓÓF N
.
ÓÓN O
Get
ÓÓO R
(
ÓÓR S
)
ÓÓS T
)
ÓÓT U
{
ÔÔ$ %
if
( *
(
+ ,
users
, 1
.
1 2
ContainsKey
2 =
(
= >
userName
> F
)
F G
)
G H
{
ÒÒ( )
if
ÚÚ, .
(
ÚÚ/ 0
!
ÚÚ0 1
users
ÚÚ1 6
[
ÚÚ6 7
userName
ÚÚ7 ?
]
ÚÚ? @
.
ÚÚ@ A
Groups
ÚÚA G
.
ÚÚG H
Contains
ÚÚH P
(
ÚÚP Q
$"
ÚÚQ S
{
ÚÚS T
domain
ÚÚT Z
}
ÚÚZ [
$str
ÚÚ[ ]
{
ÚÚ] ^
	groupName
ÚÚ^ g
}
ÚÚg h
"
ÚÚh i
)
ÚÚi j
)
ÚÚj k
{
ÛÛ, -
users
ÙÙ0 5
[
ÙÙ5 6
userName
ÙÙ6 >
]
ÙÙ> ?
.
ÙÙ? @
Groups
ÙÙ@ F
.
ÙÙF G
Add
ÙÙG J
(
ÙÙJ K
	groupName
ÙÙK T
)
ÙÙT U
;
ÙÙU V
}
ıı, -
if
˜˜, .
(
˜˜/ 0
	groupName
˜˜0 9
.
˜˜9 :
Equals
˜˜: @
(
˜˜@ A
$str
˜˜A Q
)
˜˜Q R
)
˜˜R S
{
¯¯, -
users
˘˘0 5
[
˘˘5 6
userName
˘˘6 >
]
˘˘> ?
.
˘˘? @

Privileged
˘˘@ J
=
˘˘K L
true
˘˘M Q
;
˘˘Q R
}
˙˙, -
}
˚˚( )
else
¸¸( ,
{
˝˝( )
var
˛˛, /
name
˛˛0 4
=
˛˛5 6
Convert
˛˛7 >
.
˛˛> ?
ToString
˛˛? G
(
˛˛G H
user
˛˛H L
[
˛˛L M
$str
˛˛M S
]
˛˛S T
,
˛˛T U
CultureInfo
˛˛V a
.
˛˛a b
InvariantCulture
˛˛b r
)
˛˛r s
;
˛˛s t
if
ˇˇ, .
(
ˇˇ/ 0
name
ˇˇ0 4
is
ˇˇ5 7
string
ˇˇ8 >
UserName
ˇˇ? G
)
ˇˇG H
{
ÄÄ, -
var
ÅÅ0 3
obj
ÅÅ4 7
=
ÅÅ8 9
new
ÅÅ: =
UserAccountObject
ÅÅ> O
(
ÅÅO P
UserName
ÅÅP X
)
ÅÅX Y
{
ÇÇ0 1
AccountType
ÉÉ4 ?
=
ÉÉ@ A
Convert
ÉÉB I
.
ÉÉI J
ToString
ÉÉJ R
(
ÉÉR S
user
ÉÉS W
[
ÉÉW X
$str
ÉÉX e
]
ÉÉe f
,
ÉÉf g
CultureInfo
ÉÉh s
.
ÉÉs t
InvariantCultureÉÉt Ñ
)ÉÉÑ Ö
,ÉÉÖ Ü
Caption
ÑÑ4 ;
=
ÑÑ< =
Convert
ÑÑ> E
.
ÑÑE F
ToString
ÑÑF N
(
ÑÑN O
user
ÑÑO S
[
ÑÑS T
$str
ÑÑT ]
]
ÑÑ] ^
,
ÑÑ^ _
CultureInfo
ÑÑ` k
.
ÑÑk l
InvariantCulture
ÑÑl |
)
ÑÑ| }
,
ÑÑ} ~
Description
ÖÖ4 ?
=
ÖÖ@ A
Convert
ÖÖB I
.
ÖÖI J
ToString
ÖÖJ R
(
ÖÖR S
user
ÖÖS W
[
ÖÖW X
$str
ÖÖX e
]
ÖÖe f
,
ÖÖf g
CultureInfo
ÖÖh s
.
ÖÖs t
InvariantCultureÖÖt Ñ
)ÖÖÑ Ö
,ÖÖÖ Ü
Disabled
ÜÜ4 <
=
ÜÜ= >
Convert
ÜÜ? F
.
ÜÜF G
ToString
ÜÜG O
(
ÜÜO P
user
ÜÜP T
[
ÜÜT U
$str
ÜÜU _
]
ÜÜ_ `
,
ÜÜ` a
CultureInfo
ÜÜb m
.
ÜÜm n
InvariantCulture
ÜÜn ~
)
ÜÜ~ 
,ÜÜ Ä
Domain
áá4 :
=
áá; <
Convert
áá= D
.
ááD E
ToString
ááE M
(
ááM N
user
ááN R
[
ááR S
$str
ááS [
]
áá[ \
,
áá\ ]
CultureInfo
áá^ i
.
áái j
InvariantCulture
ááj z
)
ááz {
,
áá{ |
InstallDate
àà4 ?
=
àà@ A
Convert
ààB I
.
ààI J
ToString
ààJ R
(
ààR S
user
ààS W
[
ààW X
$str
ààX e
]
ààe f
,
ààf g
CultureInfo
ààh s
.
ààs t
InvariantCultureààt Ñ
)ààÑ Ö
,ààÖ Ü
LocalAccount
ââ4 @
=
ââA B
Convert
ââC J
.
ââJ K
ToString
ââK S
(
ââS T
user
ââT X
[
ââX Y
$str
ââY g
]
ââg h
,
ââh i
CultureInfo
ââj u
.
ââu v
InvariantCultureââv Ü
)ââÜ á
,ââá à
Lockout
ää4 ;
=
ää< =
Convert
ää> E
.
ääE F
ToString
ääF N
(
ääN O
user
ääO S
[
ääS T
$str
ääT ]
]
ää] ^
,
ää^ _
CultureInfo
ää` k
.
ääk l
InvariantCulture
ääl |
)
ää| }
,
ää} ~
FullName
ãã4 <
=
ãã= >
Convert
ãã? F
.
ããF G
ToString
ããG O
(
ããO P
user
ããP T
[
ããT U
$str
ããU _
]
ãã_ `
,
ãã` a
CultureInfo
ããb m
.
ããm n
InvariantCulture
ããn ~
)
ãã~ 
,ãã Ä 
PasswordChangeable
åå4 F
=
ååG H
Convert
ååI P
.
ååP Q
ToString
ååQ Y
(
ååY Z
user
ååZ ^
[
åå^ _
$str
åå_ s
]
åås t
,
ååt u
CultureInfoååv Å
.ååÅ Ç 
InvariantCultureååÇ í
)ååí ì
,ååì î
PasswordExpires
çç4 C
=
ççD E
Convert
ççF M
.
ççM N
ToString
ççN V
(
ççV W
user
ççW [
[
çç[ \
$str
çç\ m
]
ççm n
,
ççn o
CultureInfo
ççp {
.
çç{ |
InvariantCultureçç| å
)ççå ç
,ççç é
PasswordRequired
éé4 D
=
ééE F
Convert
ééG N
.
ééN O
ToString
ééO W
(
ééW X
user
ééX \
[
éé\ ]
$str
éé] o
]
ééo p
,
éép q
CultureInfo
éér }
.
éé} ~
InvariantCultureéé~ é
)ééé è
,ééè ê
SID
èè4 7
=
èè8 9
Convert
èè: A
.
èèA B
ToString
èèB J
(
èèJ K
user
èèK O
[
èèO P
$str
èèP U
]
èèU V
,
èèV W
CultureInfo
èèX c
.
èèc d
InvariantCulture
èèd t
)
èèt u
,
èèu v

Privileged
êê4 >
=
êê? @
	groupName
êêA J
.
êêJ K
Equals
êêK Q
(
êêQ R
$str
êêR b
)
êêb c
,
êêc d
Hidden
ëë4 :
=
ëë; <!
IsHiddenWindowsUser
ëë= P
(
ëëP Q
UserName
ëëQ Y
)
ëëY Z
}
íí0 1
;
íí1 2
obj
ìì0 3
.
ìì3 4
Groups
ìì4 :
.
ìì: ;
Add
ìì; >
(
ìì> ?
	groupName
ìì? H
)
ììH I
;
ììI J
users
îî0 5
.
îî5 6
Add
îî6 9
(
îî9 :
userName
îî: B
,
îîB C
obj
îîD G
)
îîG H
;
îîH I
}
ïï, -
}
ññ( )
}
óó$ %
}
òò  !
groups
ôô  &
[
ôô& '
$"
ôô' )
{
ôô) *
Environment
ôô* 5
.
ôô5 6
MachineName
ôô6 A
}
ôôA B
$str
ôôB D
{
ôôD E
	groupName
ôôE N
}
ôôN O
"
ôôO P
]
ôôP Q
=
ôôR S
group
ôôT Y
;
ôôY Z
}
öö 
}
õõ 
}
úú 
}
ùù 
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
e
üü 
)
üü 
when
üü  $
(
üü% &
e
†† 
is
†† )
TypeInitializationException
†† 0
||
††1 3
e
°° 
is
°° +
PlatformNotSupportedException
°° 2
)
°°2 3
{
¢¢ 
Log
££ 
.
££ 
Warning
££ 
(
££ 
Strings
££ #
.
££# $
Get
££$ '
(
££' (
$str
££( I
)
££I J
,
££J K
GetType
££L S
(
££S T
)
££T U
.
££U V
ToString
££V ^
(
££^ _
)
££_ `
)
££` a
;
££a b
}
§§ 
catch
•• 
(
•• 
ExternalException
•• $
)
••$ %
{
¶¶ 
Log
ßß 
.
ßß 
Error
ßß 
(
ßß 
$str
ßß -
,
ßß- .
$str
ßß/ ?
)
ßß? @
;
ßß@ A
}
®® 
foreach
™™ 
(
™™ 
var
™™ 
user
™™ 
in
™™  
users
™™! &
)
™™& '
{
´´ 
HandleChange
¨¨ 
(
¨¨ 
user
¨¨ !
.
¨¨! "
Value
¨¨" '
)
¨¨' (
;
¨¨( )
}
≠≠ 
foreach
ØØ 
(
ØØ 
var
ØØ 
group
ØØ 
in
ØØ !
groups
ØØ" (
)
ØØ( )
{
∞∞ 
HandleChange
±± 
(
±± 
group
±± "
.
±±" #
Value
±±# (
)
±±( )
;
±±) *
}
≤≤ 
}
≥≥ 	
}
¥¥ 
}µµ œ|
KD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\WifiCollector.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

class 
WifiCollector 
:  
BaseCollector! .
{ 
public 
WifiCollector 
( 
CollectorOptions -
?- .
options/ 6
=7 8
null9 =
,= >
Action? E
<E F
CollectObjectF S
>S T
?T U
actionV \
=] ^
null_ c
)c d
:e f
baseg k
(k l
optionsl s
,s t
actionu {
){ |
{ 	
} 	
public 
override 
bool 
CanRunOnPlatform -
(- .
). /
{ 	
return 
RuntimeInformation %
.% &
IsOSPlatform& 2
(2 3

OSPlatform3 =
.= >
OSX> A
)A B
||C E
RuntimeInformationF X
.X Y
IsOSPlatformY e
(e f

OSPlatformf p
.p q
Windowsq x
)x y
;y z
} 	
internal 
override 
void 
ExecuteInternal .
(. /
CancellationToken/ @
tokenA F
)F G
{ 	
if 
( 
RuntimeInformation "
." #
IsOSPlatform# /
(/ 0

OSPlatform0 :
.: ;
OSX; >
)> ?
)? @
{ 
ExecuteMacOs 
( 
token "
)" #
;# $
}   
else!! 
if!! 
(!! 
RuntimeInformation!! '
.!!' (
IsOSPlatform!!( 4
(!!4 5

OSPlatform!!5 ?
.!!? @
Windows!!@ G
)!!G H
)!!H I
{"" 
ExecuteWindows## 
(## 
token## $
)##$ %
;##% &
}$$ 
}%% 	
internal'' 
void'' 
ExecuteMacOs'' "
(''" #
CancellationToken''# 4
token''5 :
)'': ;
{(( 	
var)) 
result)) 
=)) 
Command))  
.))  !
Run))! $
())$ %
$str))% 3
,))3 4
new))5 8
string))9 ?
[))? @
]))@ A
{))B C
$str))D d
,))d e
$str))f k
}))l m
)))m n
;))n o
result** 
.** 
Wait** 
(** 
)** 
;** 
if,, 
(,, 
result,, 
.,, 
Result,, 
.,, 
Success,, %
),,% &
{-- 
var.. 
trimmedResults.. "
=..# $
result..% +
...+ ,
Result.., 2
...2 3
StandardOutput..3 A
...A B
Split..B G
(..G H
Environment..H S
...S T
NewLine..T [
)..[ \
[..\ ]
$num..] ^
....^ `
]..` a
...a b
Select..b h
(..h i
x..i j
=>..k m
x..n o
...o p
Trim..p t
(..t u
)..u v
)..v w
;..w x
if// 
(// 
opts// 
.// 
SingleThread// %
)//% &
{00 
foreach11 
(11 
var11  
line11! %
in11& (
trimmedResults11) 7
)117 8
{22 
if33 
(33 
token33 !
.33! "#
IsCancellationRequested33" 9
)339 :
{44 
return55 "
;55" #
}66 
HandleChange77 $
(77$ %
MacSSIDToWifiObject77% 8
(778 9
line779 =
)77= >
)77> ?
;77? @
}88 
}99 
else:: 
{;; 
Parallel<< 
.<< 
ForEach<< $
(<<$ %
trimmedResults<<% 3
,<<3 4
new<<5 8
ParallelOptions<<9 H
(<<H I
)<<I J
{<<K L
CancellationToken<<M ^
=<<_ `
token<<a f
}<<g h
,<<h i
line<<j n
=><<o q
{== 
HandleChange>> $
(>>$ %
MacSSIDToWifiObject>>% 8
(>>8 9
line>>9 =
)>>= >
)>>> ?
;>>? @
}?? 
)?? 
;?? 
}@@ 
}AA 
}BB 	
internalDD 
voidDD 
ExecuteWindowsDD $
(DD$ %
CancellationTokenDD% 6
tokenDD7 <
)DD< =
{EE 	
stringFF 
tempDirectoryFF  
=FF! "
PathFF# '
.FF' (
CombineFF( /
(FF/ 0
PathFF0 4
.FF4 5
GetTempPathFF5 @
(FF@ A
)FFA B
,FFB C
PathFFD H
.FFH I
GetRandomFileNameFFI Z
(FFZ [
)FF[ \
)FF\ ]
;FF] ^
	DirectoryGG 
.GG 
CreateDirectoryGG %
(GG% &
tempDirectoryGG& 3
)GG3 4
;GG4 5
varII 
monitoredFilesII 
=II  
newII! $
ListII% )
<II) *
stringII* 0
>II0 1
(II1 2
)II2 3
;II3 4
usingKK 
varKK 
fsmKK 
=KK 
newKK 
FileSystemMonitorKK  1
(KK1 2
newKK2 5!
MonitorCommandOptionsKK6 K
(KKK L
)KKL M
{LL 
FileNamesOnlyMM 
=MM 
trueMM  $
,MM$ % 
MonitoredDirectoriesNN $
=NN% &
newNN' *
ListNN+ /
<NN/ 0
stringNN0 6
>NN6 7
(NN7 8
)NN8 9
{NN9 :
tempDirectoryNN; H
}NNI J
}OO 
,OO 
xPP 
=>PP 
{QQ 
ifRR 
(RR 
xRR 
!=RR 
nullRR 
)RR 
{RR  
monitoredFilesRR! /
.RR/ 0
AddRR0 3
(RR3 4
xRR4 5
.RR5 6
PathRR6 :
)RR: ;
;RR; <
}RR= >
}SS 
)SS 
;SS 
fsmUU 
.UU 
StartRunUU 
(UU 
)UU 
;UU 
ifWW 
(WW 
optsWW 
.WW 
GatherWifiPasswordsWW (
)WW( )
{XX 
varYY 
resultYY 
=YY 
CommandYY $
.YY$ %
RunYY% (
(YY( )
$strYY) 0
,YY0 1
newYY2 5
stringYY6 <
[YY< =
]YY= >
{YY? @
$strYYA G
,YYG H
$strYYI Q
,YYQ R
$strYYS \
,YY\ ]
$"YY^ `
$strYY` i
{YYi j
tempDirectoryYYj w
}YYw x
$strYYx z
"YYz {
,YY{ |
$str	YY} à
}
YYâ ä
)
YYä ã
;
YYã å
resultZZ 
.ZZ 
WaitZZ 
(ZZ 
)ZZ 
;ZZ 
}[[ 
else\\ 
{]] 
var^^ 
result^^ 
=^^ 
Command^^ $
.^^$ %
Run^^% (
(^^( )
$str^^) 0
,^^0 1
new^^2 5
string^^6 <
[^^< =
]^^= >
{^^? @
$str^^A G
,^^G H
$str^^I Q
,^^Q R
$str^^S \
,^^\ ]
$"^^^ `
$str^^` i
{^^i j
tempDirectory^^j w
}^^w x
$str^^x z
"^^z {
}^^| }
)^^} ~
;^^~ 
result__ 
.__ 
Wait__ 
(__ 
)__ 
;__ 
}`` 
fsmbb 
.bb 
StopRunbb 
(bb 
)bb 
;bb 
vardd 
distinctXmlFilesdd  
=dd! "
monitoredFilesdd# 1
.dd1 2
Distinctdd2 :
(dd: ;
)dd; <
.dd< =
Wheredd= B
(ddB C
xddC D
=>ddE G
PathddH L
.ddL M
GetExtensionddM Y
(ddY Z
xddZ [
)dd[ \
==dd] _
$strdd` f
)ddf g
;ddg h
ifff 
(ff 
optsff 
.ff 
SingleThreadff !
)ff! "
{gg 
foreachhh 
(hh 
varhh 
xmlFilehh $
inhh% '
distinctXmlFileshh( 8
)hh8 9
{ii 
ifjj 
(jj 
tokenjj 
.jj #
IsCancellationRequestedjj 5
)jj5 6
{kk 
returnll 
;ll 
}mm !
ParseNetShXmlFromFilenn )
(nn) *
xmlFilenn* 1
)nn1 2
;nn2 3
}oo 
}pp 
elseqq 
{rr 
Parallelss 
.ss 
ForEachss  
(ss  !
distinctXmlFilesss! 1
,ss1 2
newss3 6
ParallelOptionsss7 F
(ssF G
)ssG H
{ssI J
CancellationTokenssK \
=ss] ^
tokenss_ d
}sse f
,ssf g
xmlFilessh o
=>ssp r
{tt !
ParseNetShXmlFromFileuu )
(uu) *
xmlFileuu* 1
)uu1 2
;uu2 3
}vv 
)vv 
;vv 
}ww 
}xx 	
internalzz 

WifiObjectzz 
MacSSIDToWifiObjectzz /
(zz/ 0
stringzz0 6
SSIDzz7 ;
)zz; <
{{{ 	
var|| 
obj|| 
=|| 
new|| 

WifiObject|| $
(||$ %
SSID||% )
)||) *
;||* +
if~~ 
(~~ 
opts~~ 
.~~ 
GatherWifiPasswords~~ (
&&~~) +

AsaHelpers~~, 6
.~~6 7
IsAdmin~~7 >
(~~> ?
)~~? @
)~~@ A
{ 
var
ÄÄ 
result
ÄÄ 
=
ÄÄ 
Command
ÄÄ $
.
ÄÄ$ %
Run
ÄÄ% (
(
ÄÄ( )
$str
ÄÄ) 3
,
ÄÄ3 4
new
ÄÄ5 8
string
ÄÄ9 ?
[
ÄÄ? @
]
ÄÄ@ A
{
ÄÄB C
$str
ÄÄD [
,
ÄÄ[ \
$str
ÄÄ] b
,
ÄÄb c
$str
ÄÄd p
}
ÄÄq r
)
ÄÄr s
;
ÄÄs t
if
ÅÅ 
(
ÅÅ 
result
ÅÅ 
.
ÅÅ 
Result
ÅÅ !
.
ÅÅ! "
Success
ÅÅ" )
)
ÅÅ) *
{
ÇÇ 
var
ÉÉ 
passwordLine
ÉÉ $
=
ÉÉ% &
result
ÉÉ' -
.
ÉÉ- .
Result
ÉÉ. 4
.
ÉÉ4 5
StandardOutput
ÉÉ5 C
.
ÉÉC D
Split
ÉÉD I
(
ÉÉI J
Environment
ÉÉJ U
.
ÉÉU V
NewLine
ÉÉV ]
)
ÉÉ] ^
.
ÉÉ^ _
Where
ÉÉ_ d
(
ÉÉd e
x
ÉÉe f
=>
ÉÉg i
x
ÉÉj k
.
ÉÉk l

StartsWith
ÉÉl v
(
ÉÉv w
$strÉÉw Ç
)ÉÉÇ É
)ÉÉÉ Ñ
;ÉÉÑ Ö
if
ÑÑ 
(
ÑÑ 
passwordLine
ÑÑ $
.
ÑÑ$ %
Any
ÑÑ% (
(
ÑÑ( )
)
ÑÑ) *
)
ÑÑ* +
{
ÖÖ 
obj
ÜÜ 
.
ÜÜ 
Password
ÜÜ $
=
ÜÜ% &
passwordLine
ÜÜ' 3
.
ÜÜ3 4
First
ÜÜ4 9
(
ÜÜ9 :
)
ÜÜ: ;
.
ÜÜ; <
Split
ÜÜ< A
(
ÜÜA B
$char
ÜÜB E
)
ÜÜE F
[
ÜÜF G
$num
ÜÜG H
]
ÜÜH I
;
ÜÜI J
}
áá 
}
àà 
else
ââ 
{
ää 
Log
ãã 
.
ãã 
Debug
ãã 
(
ãã 
$str
ãã ?
,
ãã? @
SSID
ããA E
)
ããE F
;
ããF G
}
åå 
}
çç 
return
èè 
obj
èè 
;
èè 
}
êê 	
private
íí 
void
íí #
ParseNetShXmlFromFile
íí *
(
íí* +
string
íí+ 1
path
íí2 6
)
íí6 7
{
ìì 	
if
îî 
(
îî 
Path
îî 
.
îî 
GetExtension
îî !
(
îî! "
path
îî" &
)
îî& '
==
îî( *
$str
îî+ 1
)
îî1 2
{
ïï 
try
ññ 
{
óó 
XElement
òò 
wifiDump
òò %
=
òò& '
XElement
òò( 0
.
òò0 1
Load
òò1 5
(
òò5 6
path
òò6 :
)
òò: ;
;
òò; <
var
ôô 
name
ôô 
=
ôô 
wifiDump
ôô '
.
ôô' (
Descendants
ôô( 3
(
ôô3 4
)
ôô4 5
.
ôô5 6
Where
ôô6 ;
(
ôô; <
x
ôô< =
=>
ôô> @
x
ôôA B
.
ôôB C
Name
ôôC G
.
ôôG H
	LocalName
ôôH Q
==
ôôR T
$str
ôôU [
)
ôô[ \
.
ôô\ ]
FirstOrDefault
ôô] k
(
ôôk l
)
ôôl m
.
ôôm n
Value
ôôn s
;
ôôs t
if
õõ 
(
õõ 
name
õõ 
!=
õõ 
null
õõ  $
)
õõ$ %
{
úú 
HandleChange
ùù $
(
ùù$ %
new
ùù% (

WifiObject
ùù) 3
(
ùù3 4
name
ùù4 8
)
ùù8 9
{
ûû 
Password
üü $
=
üü% &
wifiDump
üü' /
.
üü/ 0
Descendants
üü0 ;
(
üü; <
)
üü< =
.
üü= >
Where
üü> C
(
üüC D
x
üüD E
=>
üüF H
x
üüI J
.
üüJ K
Name
üüK O
.
üüO P
	LocalName
üüP Y
==
üüZ \
$str
üü] j
)
üüj k
.
üük l
FirstOrDefault
üül z
(
üüz {
)
üü{ |
?
üü| }
.
üü} ~
Valueüü~ É
,üüÉ Ñ
Authentication
†† *
=
††+ ,
wifiDump
††- 5
.
††5 6
Descendants
††6 A
(
††A B
)
††B C
.
††C D
Where
††D I
(
††I J
x
††J K
=>
††L N
x
††O P
.
††P Q
Name
††Q U
.
††U V
	LocalName
††V _
==
††` b
$str
††c s
)
††s t
.
††t u
FirstOrDefault††u É
(††É Ñ
)††Ñ Ö
.††Ö Ü
Value††Ü ã
,††ã å

Encryption
°° &
=
°°' (
wifiDump
°°) 1
.
°°1 2
Descendants
°°2 =
(
°°= >
)
°°> ?
.
°°? @
Where
°°@ E
(
°°E F
x
°°F G
=>
°°H J
x
°°K L
.
°°L M
Name
°°M Q
.
°°Q R
	LocalName
°°R [
==
°°\ ^
$str
°°_ k
)
°°k l
.
°°l m
FirstOrDefault
°°m {
(
°°{ |
)
°°| }
.
°°} ~
Value°°~ É
}
¢¢ 
)
¢¢ 
;
¢¢ 
}
££ 
}
§§ 
catch
•• 
(
•• 
	Exception
••  
e
••! "
)
••" #
{
¶¶ 
Log
ßß 
.
ßß 
Debug
ßß 
(
ßß 
$str
ßß Z
,
ßßZ [
path
ßß\ `
,
ßß` a
e
ßßb c
.
ßßc d
GetType
ßßd k
(
ßßk l
)
ßßl m
,
ßßm n
e
ßßo p
.
ßßp q
Message
ßßq x
)
ßßx y
;
ßßy z
}
®® 
}
©© 
}
™™ 	
}
´´ 
}¨¨ ‡{
TD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Collectors\WindowsFileSystemUtils.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .

Collectors. 8
{ 
public 

static 
class "
WindowsFileSystemUtils .
{ 
public 
static 
List 
< 
DLLCHARACTERISTICS -
>- .!
GetDllCharacteristics/ D
(D E
stringE K
PathL P
,P Q
StreamR X
inputY ^
)^ _
{ 	
List 
< 
DLLCHARACTERISTICS #
># $
output% +
=, -
new. 1
List2 6
<6 7
DLLCHARACTERISTICS7 I
>I J
(J K
)K L
;L M
try 
{ 
if 
( 
PeFile 
. 
IsPeFile #
(# $
input$ )
)) *
)* +
{ 
var 
peHeader  
=! "
new# &
PeFile' -
(- .
input. 3
)3 4
;4 5
var 
dllCharacteristics *
=+ ,
peHeader- 5
.5 6
ImageNtHeaders6 D
?D E
.E F
OptionalHeaderF T
.T U
DllCharacteristicsU g
;g h
if 
( 
dllCharacteristics *
is+ -"
DllCharacteristicsType. D
charsE J
)J K
{ 
ushort 
characteristics .
=/ 0
(1 2
ushort2 8
)8 9
chars9 >
;> ?
foreach 
(  !
DLLCHARACTERISTICS! 3
?3 4
characteristic5 C
inD F
EnumG K
.K L
	GetValuesL U
(U V
typeofV \
(\ ]
DLLCHARACTERISTICS] o
)o p
)p q
)q r
{   
if!! 
(!!  
characteristic!!  .
is!!/ 1
DLLCHARACTERISTICS!!2 D
c!!E F
)!!F G
{"" 
if##  "
(### $
(##$ %
(##% &
ushort##& ,
)##, -
c##- .
&##/ 0
characteristics##1 @
)##@ A
==##B D
(##E F
ushort##F L
)##L M
c##M N
)##N O
{$$  !
output%%$ *
.%%* +
Add%%+ .
(%%. /
c%%/ 0
)%%0 1
;%%1 2
}&&  !
}'' 
}(( 
})) 
}** 
}++ 
catch,, 
(,, 
	Exception,, 
e,, 
),, 
when,,  $
(,,% &
e-- 
is-- $
IndexOutOfRangeException-- -
||.. 
e.. 
is.. !
ArgumentNullException.. -
||// 
e// 
is// 
System// 
.// 
IO// !
.//! "
IOException//" -
||00 
e00 
is00 
ArgumentException00 )
||11 
e11 
is11 '
UnauthorizedAccessException11 3
||22 
e22 
is22 "
NullReferenceException22 .
)22. /
{33 
Log44 
.44 
Verbose44 
(44 
$str44 H
,44H I
Path44J N
,44N O
e44P Q
.44Q R
GetType44R Y
(44Y Z
)44Z [
,44[ \
e44] ^
.44^ _
Message44_ f
)44f g
;44g h
}55 
catch66 
(66 
	Exception66 
e66 
)66 
{77 
Log88 
.88 
Debug88 
(88 
e88 
,88 
$str88 I
,88I J
Path88K O
,88O P
e88Q R
.88R S
GetType88S Z
(88Z [
)88[ \
,88\ ]
e88^ _
.88_ `
Message88` g
)88g h
;88h i
}99 
return;; 
output;; 
;;; 
}<< 	
public>> 
static>> 
List>> 
<>> 
DLLCHARACTERISTICS>> -
>>>- .!
GetDllCharacteristics>>/ D
(>>D E
string>>E K
Path>>L P
)>>P Q
{?? 	
List@@ 
<@@ 
DLLCHARACTERISTICS@@ #
>@@# $
output@@% +
=@@, -
new@@. 1
List@@2 6
<@@6 7
DLLCHARACTERISTICS@@7 I
>@@I J
(@@J K
)@@K L
;@@L M
ifBB 
(BB 
NeedsSignatureBB 
(BB 
PathBB #
)BB# $
)BB$ %
{CC 
tryDD 
{EE 
ifFF 
(FF 
PeFileFF 
.FF 
IsPeFileFF '
(FF' (
PathFF( ,
)FF, -
)FF- .
{GG 
usingHH 
varHH !
mmfHH" %
=HH& '
newHH( +
PeNetHH, 1
.HH1 2

FileParserHH2 <
.HH< =
MMFileHH= C
(HHC D
PathHHD H
)HHH I
;HHI J
varII 
peHeaderII $
=II% &
newII' *
PeFileII+ 1
(II1 2
mmfII2 5
)II5 6
;II6 7
varJJ 
dllCharacteristicsJJ .
=JJ/ 0
peHeaderJJ1 9
.JJ9 :
ImageNtHeadersJJ: H
?JJH I
.JJI J
OptionalHeaderJJJ X
.JJX Y
DllCharacteristicsJJY k
;JJk l
ifKK 
(KK 
dllCharacteristicsKK .
isKK/ 1"
DllCharacteristicsTypeKK2 H
charsKKI N
)KKN O
{LL 
ushortMM "
characteristicsMM# 2
=MM3 4
(MM5 6
ushortMM6 <
)MM< =
charsMM= B
;MMB C
foreachNN #
(NN$ %
DLLCHARACTERISTICSNN% 7
?NN7 8
characteristicNN9 G
inNNH J
EnumNNK O
.NNO P
	GetValuesNNP Y
(NNY Z
typeofNNZ `
(NN` a
DLLCHARACTERISTICSNNa s
)NNs t
)NNt u
)NNu v
{OO 
ifPP  "
(PP# $
characteristicPP$ 2
isPP3 5
DLLCHARACTERISTICSPP6 H
cPPI J
)PPJ K
{QQ  !
ifRR$ &
(RR' (
(RR( )
(RR) *
ushortRR* 0
)RR0 1
cRR1 2
&RR3 4
characteristicsRR5 D
)RRD E
==RRF H
(RRI J
ushortRRJ P
)RRP Q
cRRQ R
)RRR S
{SS$ %
outputTT( .
.TT. /
AddTT/ 2
(TT2 3
cTT3 4
)TT4 5
;TT5 6
}UU$ %
}VV  !
}WW 
}XX 
}YY 
}ZZ 
catch[[ 
([[ 
	Exception[[  
e[[! "
)[[" #
when[[$ (
([[) *
e\\ 
is\\ $
IndexOutOfRangeException\\ 1
||]] 
e]] 
is]] !
ArgumentNullException]] 1
||^^ 
e^^ 
is^^ 
System^^ "
.^^" #
IO^^# %
.^^% &
IOException^^& 1
||__ 
e__ 
is__ 
ArgumentException__ -
||`` 
e`` 
is`` '
UnauthorizedAccessException`` 7
||aa 
eaa 
isaa "
NullReferenceExceptionaa 2
)aa2 3
{bb 
Logcc 
.cc 
Verbosecc 
(cc  
$strcc  L
,ccL M
PathccN R
,ccR S
eccT U
.ccU V
GetTypeccV ]
(cc] ^
)cc^ _
,cc_ `
ecca b
.ccb c
Messageccc j
)ccj k
;cck l
}dd 
catchee 
(ee 
	Exceptionee  
eee! "
)ee" #
{ff 
Loggg 
.gg 
Debuggg 
(gg 
egg 
,gg  
$strgg! M
,ggM N
PathggO S
,ggS T
eggU V
.ggV W
GetTypeggW ^
(gg^ _
)gg_ `
,gg` a
eggb c
.ggc d
Messageggd k
)ggk l
;ggl m
}hh 
}ii 
returnkk 
outputkk 
;kk 
}ll 	
publicnn 
staticnn 
	Signaturenn 
?nn  
GetSignatureStatusnn! 3
(nn3 4
stringnn4 :
Pathnn; ?
,nn? @
StreamnnA G
streamnnH N
)nnN O
{oo 	
ifpp 
(pp 
streampp 
ispp 
nullpp 
)pp 
{qq 
returnrr 
nullrr 
;rr 
}ss 
trytt 
{uu 
ifvv 
(vv 
PeFilevv 
.vv 
IsPeFilevv #
(vv# $
streamvv$ *
)vv* +
)vv+ ,
{ww 
varxx 
peHeaderxx  
=xx! "
newxx# &
PeFilexx' -
(xx- .
streamxx. 4
)xx4 5
;xx5 6
ifyy 
(yy 
peHeaderyy  
.yy  !
Authenticodeyy! -
isyy. 0
AuthenticodeInfoyy1 A
aiyyB D
)yyD E
{zz 
var{{ 
sig{{ 
={{  !
new{{" %
	Signature{{& /
({{/ 0
ai{{0 2
){{2 3
;{{3 4
return|| 
sig|| "
;||" #
}}} 
}~~ 
} 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
e
ÄÄ 
)
ÄÄ 
{
ÅÅ 
Log
ÇÇ 
.
ÇÇ 
Verbose
ÇÇ 
(
ÇÇ 
$str
ÇÇ G
,
ÇÇG H
Path
ÇÇI M
,
ÇÇM N
e
ÇÇO P
.
ÇÇP Q
GetType
ÇÇQ X
(
ÇÇX Y
)
ÇÇY Z
,
ÇÇZ [
e
ÇÇ\ ]
.
ÇÇ] ^
Message
ÇÇ^ e
)
ÇÇe f
;
ÇÇf g
}
ÉÉ 
return
ÑÑ 
null
ÑÑ 
;
ÑÑ 
}
ÖÖ 	
public
áá 
static
áá 
	Signature
áá 
?
áá   
GetSignatureStatus
áá! 3
(
áá3 4
string
áá4 :
Path
áá; ?
)
áá? @
{
àà 	
if
ââ 
(
ââ 
Path
ââ 
is
ââ 
null
ââ 
)
ââ 
{
ää 
return
ãã 
null
ãã 
;
ãã 
}
åå 
try
çç 
{
éé 
if
èè 
(
èè 
PeFile
èè 
.
èè 
IsPeFile
èè #
(
èè# $
Path
èè$ (
)
èè( )
)
èè) *
{
êê 
using
ëë 
var
ëë 
mmf
ëë !
=
ëë" #
new
ëë$ '
PeNet
ëë( -
.
ëë- .

FileParser
ëë. 8
.
ëë8 9
MMFile
ëë9 ?
(
ëë? @
Path
ëë@ D
)
ëëD E
;
ëëE F
var
íí 
peHeader
íí  
=
íí! "
new
íí# &
PeFile
íí' -
(
íí- .
mmf
íí. 1
)
íí1 2
;
íí2 3
if
ìì 
(
ìì 
peHeader
ìì  
.
ìì  !
Authenticode
ìì! -
is
ìì. 0
AuthenticodeInfo
ìì1 A
ai
ììB D
)
ììD E
{
îî 
var
ïï 
sig
ïï 
=
ïï  !
new
ïï" %
	Signature
ïï& /
(
ïï/ 0
ai
ïï0 2
)
ïï2 3
;
ïï3 4
return
ññ 
sig
ññ "
;
ññ" #
}
óó 
}
òò 
}
ôô 
catch
öö 
(
öö 
	Exception
öö 
e
öö 
)
öö 
{
õõ 
Log
úú 
.
úú 
Verbose
úú 
(
úú 
$str
úú G
,
úúG H
Path
úúI M
,
úúM N
e
úúO P
.
úúP Q
GetType
úúQ X
(
úúX Y
)
úúY Z
,
úúZ [
e
úú\ ]
.
úú] ^
Message
úú^ e
)
úúe f
;
úúf g
}
ùù 
return
ûû 
null
ûû 
;
ûû 
}
üü 	
public
°° 
static
°° 
bool
°° 
IsLocal
°° "
(
°°" #
string
°°# )
path
°°* .
)
°°. /
{
¢¢ 	
NativeMethods
££ 
.
££ '
WIN32_FILE_ATTRIBUTE_DATA
££ 3
fileData
££4 <
;
££< =
NativeMethods
§§ 
.
§§ !
GetFileAttributesEx
§§ -
(
§§- .
path
§§. 2
,
§§2 3
NativeMethods
§§4 A
.
§§A B$
GET_FILEEX_INFO_LEVELS
§§B X
.
§§X Y#
GetFileExInfoStandard
§§Y n
,
§§n o
out
§§p s
fileData
§§t |
)
§§| }
;
§§} ~
if
¶¶ 
(
¶¶ 
(
¶¶ 
fileData
¶¶ 
.
¶¶ 
dwFileAttributes
¶¶ *
&
¶¶+ ,
(
¶¶- .
$num
¶¶. 8
+
¶¶9 :
$num
¶¶; E
)
¶¶E F
)
¶¶F G
==
¶¶H J
$num
¶¶K L
)
¶¶L M
{
ßß 
return
®® 
true
®® 
;
®® 
}
©© 
return
´´ 
false
´´ 
;
´´ 
}
¨¨ 	
public
ÆÆ 
static
ÆÆ 
bool
ÆÆ 
NeedsSignature
ÆÆ )
(
ÆÆ) *
string
ÆÆ* 0
Path
ÆÆ1 5
)
ÆÆ5 6
{
ØØ 	
if
∞∞ 
(
∞∞ 
Path
∞∞ 
is
∞∞ 
null
∞∞ 
||
∞∞ 
!
∞∞  ! 
RuntimeInformation
∞∞! 3
.
∞∞3 4
IsOSPlatform
∞∞4 @
(
∞∞@ A

OSPlatform
∞∞A K
.
∞∞K L
Windows
∞∞L S
)
∞∞S T
)
∞∞T U
{
±± 
return
≤≤ 
false
≤≤ 
;
≤≤ 
}
≥≥ 
try
¥¥ 
{
µµ 
FileInfo
∂∂ 
file
∂∂ 
=
∂∂ 
new
∂∂  #
FileInfo
∂∂$ ,
(
∂∂, -
Path
∂∂- 1
)
∂∂1 2
;
∂∂2 3
return
∑∑ 
FileSystemUtils
∑∑ &
.
∑∑& '
GetExecutableType
∑∑' 8
(
∑∑8 9
Path
∑∑9 =
)
∑∑= >
==
∑∑? A
EXECUTABLE_TYPE
∑∑B Q
.
∑∑Q R
WINDOWS
∑∑R Y
;
∑∑Y Z
}
∏∏ 
catch
ππ 
(
ππ 
	Exception
ππ 
e
ππ 
)
ππ 
when
ππ  $
(
ππ% &
e
∫∫ 
is
∫∫ #
FileNotFoundException
∫∫ *
||
∫∫+ -
e
ªª 
is
ªª 
IOException
ªª  
||
ªª! #
e
ºº 
is
ºº #
ArgumentNullException
ºº *
||
ºº+ -
e
ΩΩ 
is
ΩΩ 
System
ΩΩ 
.
ΩΩ 
Security
ΩΩ $
.
ΩΩ$ %
SecurityException
ΩΩ% 6
||
ΩΩ7 9
e
ææ 
is
ææ 
ArgumentException
ææ &
||
ææ' )
e
øø 
is
øø )
UnauthorizedAccessException
øø 0
||
øø1 3
e
¿¿ 
is
¿¿ "
PathTooLongException
¿¿ )
||
¿¿* ,
e
¡¡ 
is
¡¡ #
NotSupportedException
¡¡ *
)
¡¡* +
{
¬¬ 
return
√√ 
false
√√ 
;
√√ 
}
ƒƒ 
}
≈≈ 	
}
∆∆ 
}«« Ï
ED:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\GlobalSuppressions.cs
[		 
assembly		 	
:			 

SuppressMessage		 
(		 
$str		 #
,		# $
$str		% X
,		X Y
Justification		Z g
=		h i
$str		j }
,		} ~
Scope			 Ñ
=
		Ö Ü
$str
		á í
,
		í ì
Target
		î ö
=
		õ ú
$str
		ù ¥
)
		¥ µ
]
		µ ∂
[

 
assembly

 	
:

	 

SuppressMessage

 
(

 
$str

 *
,

* +
$str

, a
,

a b
Justification

c p
=

q r
$str

s ~
,

~ 
Scope


Ä Ö
=


Ü á
$str


à ê
,


ê ë
Target


í ò
=


ô ö
$str


õ å
)


å ç
]


ç é≥õ
ED:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\AsaNvIndex.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 

AsaNvIndex 
{ 
public 
NvAttr 

Attributes  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
AuthRead 
{ 
get "
{# $
return% +

Attributes, 6
.6 7
HasFlag7 >
(> ?
NvAttr? E
.E F
AuthreadF N
)N O
;O P
}Q R
}S T
public 
bool 
	AuthWrite 
{ 
get  #
{$ %
return& ,

Attributes- 7
.7 8
HasFlag8 ?
(? @
NvAttr@ F
.F G
	AuthwriteG P
)P Q
;Q R
}S T
}U V
public 
bool 
Bits 
{ 
get 
{  
return! '

Attributes( 2
.2 3
HasFlag3 :
(: ;
NvAttr; A
.A B
BitsB F
)F G
;G H
}I J
}K L
public 
bool 
ClearStClear  
{! "
get# &
{' (
return) /

Attributes0 :
.: ;
HasFlag; B
(B C
NvAttrC I
.I J
ClearStclearJ V
)V W
;W X
}Y Z
}[ \
public 
bool 
Counter 
{ 
get !
{" #
return$ *

Attributes+ 5
.5 6
HasFlag6 =
(= >
NvAttr> D
.D E
CounterE L
)L M
;M N
}O P
}Q R
public 
bool 
Extend 
{ 
get  
{! "
return# )

Attributes* 4
.4 5
HasFlag5 <
(< =
NvAttr= C
.C D
ExtendD J
)J K
;K L
}M N
}O P
public 
bool 

GlobalLock 
{  
get! $
{% &
return' -

Attributes. 8
.8 9
HasFlag9 @
(@ A
NvAttrA G
.G H

GloballockH R
)R S
;S T
}U V
}W X
public 
uint 
Index 
{ 
get 
;  
set! $
;$ %
}& '
public 
bool 
NoDa 
{ 
get 
{  
return! '

Attributes( 2
.2 3
HasFlag3 :
(: ;
NvAttr; A
.A B
NoDaB F
)F G
;G H
}I J
}K L
public 
bool 
None 
{ 
get 
{  
return! '

Attributes( 2
.2 3
HasFlag3 :
(: ;
NvAttr; A
.A B
NoneB F
)F G
;G H
}I J
}K L
public 
bool 
Orderly 
{ 
get !
{" #
return$ *

Attributes+ 5
.5 6
HasFlag6 =
(= >
NvAttr> D
.D E
OrderlyE L
)L M
;M N
}O P
}Q R
public 
bool 
Ordinary 
{ 
get "
{# $
return% +

Attributes, 6
.6 7
HasFlag7 >
(> ?
NvAttr? E
.E F
OrdinaryF N
)N O
;O P
}Q R
}S T
public 
bool 
	OwnerRead 
{ 
get  #
{$ %
return& ,

Attributes- 7
.7 8
HasFlag8 ?
(? @
NvAttr@ F
.F G
	OwnerreadG P
)P Q
;Q R
}S T
}U V
public 
bool 

OwnerWrite 
{  
get! $
{% &
return' -

Attributes. 8
.8 9
HasFlag9 @
(@ A
NvAttrA G
.G H

OwnerwriteH R
)R S
;S T
}U V
}W X
public 
bool 
PinFail 
{ 
get !
{" #
return$ *

Attributes+ 5
.5 6
HasFlag6 =
(= >
NvAttr> D
.D E
PinFailE L
)L M
;M N
}O P
}Q R
public 
bool 
PinPass 
{ 
get !
{" #
return$ *

Attributes+ 5
.5 6
HasFlag6 =
(= >
NvAttr> D
.D E
PinPassE L
)L M
;M N
}O P
}Q R
public 
bool 
PlatformCreate "
{# $
get% (
{) *
return+ 1

Attributes2 <
.< =
HasFlag= D
(D E
NvAttrE K
.K L
PlatformcreateL Z
)Z [
;[ \
}] ^
}_ `
public 
bool 
PolicyDelete  
{! "
get# &
{' (
return) /

Attributes0 :
.: ;
HasFlag; B
(B C
NvAttrC I
.I J
PolicyDeleteJ V
)V W
;W X
}Y Z
}[ \
public 
bool 

PolicyRead 
{  
get! $
{% &
return' -

Attributes. 8
.8 9
HasFlag9 @
(@ A
NvAttrA G
.G H

PolicyreadH R
)R S
;S T
}U V
}W X
public   
bool   
PolicyWrite   
{    !
get  " %
{  & '
return  ( .

Attributes  / 9
.  9 :
HasFlag  : A
(  A B
NvAttr  B H
.  H I
Policywrite  I T
)  T U
;  U V
}  W X
}  Y Z
public!! 
bool!! 
Ppread!! 
{!! 
get!!  
{!!! "
return!!# )

Attributes!!* 4
.!!4 5
HasFlag!!5 <
(!!< =
NvAttr!!= C
.!!C D
Ppread!!D J
)!!J K
;!!K L
}!!M N
}!!O P
public"" 
bool"" 
Ppwrite"" 
{"" 
get"" !
{""" #
return""$ *

Attributes""+ 5
.""5 6
HasFlag""6 =
(""= >
NvAttr""> D
.""D E
Ppwrite""E L
)""L M
;""M N
}""O P
}""Q R
public## 
bool## 

ReadLocked## 
{##  
get##! $
{##% &
return##' -

Attributes##. 8
.##8 9
HasFlag##9 @
(##@ A
NvAttr##A G
.##G H

Readlocked##H R
)##R S
;##S T
}##U V
}##W X
public$$ 
bool$$ 
ReadStClear$$ 
{$$  !
get$$" %
{$$& '
return$$( .

Attributes$$/ 9
.$$9 :
HasFlag$$: A
($$A B
NvAttr$$B H
.$$H I
ReadStclear$$I T
)$$T U
;$$U V
}$$W X
}$$Y Z
public%% 
bool%% 
	TpmNtBit0%% 
{%% 
get%%  #
{%%$ %
return%%& ,

Attributes%%- 7
.%%7 8
HasFlag%%8 ?
(%%? @
NvAttr%%@ F
.%%F G
	TpmNtBit0%%G P
)%%P Q
;%%Q R
}%%S T
}%%U V
public&& 
bool&& 
	TpmNtBit1&& 
{&& 
get&&  #
{&&$ %
return&&& ,

Attributes&&- 7
.&&7 8
HasFlag&&8 ?
(&&? @
NvAttr&&@ F
.&&F G
	TpmNtBit1&&G P
)&&P Q
;&&Q R
}&&S T
}&&U V
public'' 
bool'' 
	TpmNtBit2'' 
{'' 
get''  #
{''$ %
return''& ,

Attributes''- 7
.''7 8
HasFlag''8 ?
(''? @
NvAttr''@ F
.''F G
	TpmNtBit2''G P
)''P Q
;''Q R
}''S T
}''U V
public(( 
bool(( 
	TpmNtBit3(( 
{(( 
get((  #
{(($ %
return((& ,

Attributes((- 7
.((7 8
HasFlag((8 ?
(((? @
NvAttr((@ F
.((F G
	TpmNtBit3((G P
)((P Q
;((Q R
}((S T
}((U V
public)) 
bool)) 
TpmNtBitLength)) "
{))# $
get))% (
{))) *
return))+ 1

Attributes))2 <
.))< =
HasFlag))= D
())D E
NvAttr))E K
.))K L
TpmNtBitLength))L Z
)))Z [
;))[ \
}))] ^
}))_ `
public** 
bool** 
TpmNtBitMask**  
{**! "
get**# &
{**' (
return**) /

Attributes**0 :
.**: ;
HasFlag**; B
(**B C
NvAttr**C I
.**I J
TpmNtBitMask**J V
)**V W
;**W X
}**Y Z
}**[ \
public++ 
bool++ 
TpmNtBitOffset++ "
{++# $
get++% (
{++) *
return+++ 1

Attributes++2 <
.++< =
HasFlag++= D
(++D E
NvAttr++E K
.++K L
TpmNtBitOffset++L Z
)++Z [
;++[ \
}++] ^
}++_ `
public,, 
List,, 
<,, 
byte,, 
>,, 
?,, 
value,,  
{,,! "
get,,# &
;,,& '
set,,( +
;,,+ ,
},,- .
public-- 
bool-- 
Writeall-- 
{-- 
get-- "
{--# $
return--% +

Attributes--, 6
.--6 7
HasFlag--7 >
(--> ?
NvAttr--? E
.--E F
Writeall--F N
)--N O
;--O P
}--Q R
}--S T
public.. 
bool.. 
Writedefine.. 
{..  !
get.." %
{..& '
return..( .

Attributes../ 9
...9 :
HasFlag..: A
(..A B
NvAttr..B H
...H I
Writedefine..I T
)..T U
;..U V
}..W X
}..Y Z
public// 
bool// 
Writelocked// 
{//  !
get//" %
{//& '
return//( .

Attributes/// 9
.//9 :
HasFlag//: A
(//A B
NvAttr//B H
.//H I
Writelocked//I T
)//T U
;//U V
}//W X
}//Y Z
public00 
bool00 
WriteStclear00  
{00! "
get00# &
{00' (
return00) /

Attributes000 :
.00: ;
HasFlag00; B
(00B C
NvAttr00C I
.00I J
WriteStclear00J V
)00V W
;00W X
}00Y Z
}00[ \
public11 
bool11 
Written11 
{11 
get11 !
{11" #
return11$ *

Attributes11+ 5
.115 6
HasFlag116 =
(11= >
NvAttr11> D
.11D E
Written11E L
)11L M
;11M N
}11O P
}11Q R
public44 
static44 
bool44 #
ShouldSerializeAuthRead44 2
(442 3
)443 4
{445 6
return447 =
false44> C
;44C D
}44E F
public66 
static66 
bool66 $
ShouldSerializeAuthWrite66 3
(663 4
)664 5
{77 	
return88 
false88 
;88 
}99 	
public;; 
static;; 
bool;; 
ShouldSerializeBits;; .
(;;. /
);;/ 0
{<< 	
return== 
false== 
;== 
}>> 	
public@@ 
static@@ 
bool@@ '
ShouldSerializeClearStClear@@ 6
(@@6 7
)@@7 8
{AA 	
returnBB 
falseBB 
;BB 
}CC 	
publicEE 
staticEE 
boolEE "
ShouldSerializeCounterEE 1
(EE1 2
)EE2 3
{FF 	
returnGG 
falseGG 
;GG 
}HH 	
publicJJ 
staticJJ 
boolJJ !
ShouldSerializeExtendJJ 0
(JJ0 1
)JJ1 2
{KK 	
returnLL 
falseLL 
;LL 
}MM 	
publicOO 
staticOO 
boolOO %
ShouldSerializeGlobalLockOO 4
(OO4 5
)OO5 6
{PP 	
returnQQ 
falseQQ 
;QQ 
}RR 	
publicTT 
staticTT 
boolTT 
ShouldSerializeNoDaTT .
(TT. /
)TT/ 0
{UU 	
returnVV 
falseVV 
;VV 
}WW 	
publicYY 
staticYY 
boolYY 
ShouldSerializeNoneYY .
(YY. /
)YY/ 0
{ZZ 	
return[[ 
false[[ 
;[[ 
}\\ 	
public^^ 
static^^ 
bool^^ "
ShouldSerializeOrderly^^ 1
(^^1 2
)^^2 3
{__ 	
return`` 
false`` 
;`` 
}aa 	
publiccc 
staticcc 
boolcc #
ShouldSerializeOrdinarycc 2
(cc2 3
)cc3 4
{dd 	
returnee 
falseee 
;ee 
}ff 	
publichh 
statichh 
boolhh $
ShouldSerializeOwnerReadhh 3
(hh3 4
)hh4 5
{ii 	
returnjj 
falsejj 
;jj 
}kk 	
publicmm 
staticmm 
boolmm %
ShouldSerializeOwnerWritemm 4
(mm4 5
)mm5 6
{nn 	
returnoo 
falseoo 
;oo 
}pp 	
publicrr 
staticrr 
boolrr "
ShouldSerializePinFailrr 1
(rr1 2
)rr2 3
{ss 	
returntt 
falsett 
;tt 
}uu 	
publicww 
staticww 
boolww "
ShouldSerializePinPassww 1
(ww1 2
)ww2 3
{xx 	
returnyy 
falseyy 
;yy 
}zz 	
public|| 
static|| 
bool|| )
ShouldSerializePlatformCreate|| 8
(||8 9
)||9 :
{}} 	
return~~ 
false~~ 
;~~ 
} 	
public
ÅÅ 
static
ÅÅ 
bool
ÅÅ )
ShouldSerializePolicyDelete
ÅÅ 6
(
ÅÅ6 7
)
ÅÅ7 8
{
ÇÇ 	
return
ÉÉ 
false
ÉÉ 
;
ÉÉ 
}
ÑÑ 	
public
ÜÜ 
static
ÜÜ 
bool
ÜÜ '
ShouldSerializePolicyRead
ÜÜ 4
(
ÜÜ4 5
)
ÜÜ5 6
{
áá 	
return
àà 
false
àà 
;
àà 
}
ââ 	
public
ãã 
static
ãã 
bool
ãã (
ShouldSerializePolicyWrite
ãã 5
(
ãã5 6
)
ãã6 7
{
åå 	
return
çç 
false
çç 
;
çç 
}
éé 	
public
êê 
static
êê 
bool
êê #
ShouldSerializePpread
êê 0
(
êê0 1
)
êê1 2
{
ëë 	
return
íí 
false
íí 
;
íí 
}
ìì 	
public
ïï 
static
ïï 
bool
ïï $
ShouldSerializePpwrite
ïï 1
(
ïï1 2
)
ïï2 3
{
ññ 	
return
óó 
false
óó 
;
óó 
}
òò 	
public
öö 
static
öö 
bool
öö '
ShouldSerializeReadLocked
öö 4
(
öö4 5
)
öö5 6
{
õõ 	
return
úú 
false
úú 
;
úú 
}
ùù 	
public
üü 
static
üü 
bool
üü (
ShouldSerializeReadStClear
üü 5
(
üü5 6
)
üü6 7
{
†† 	
return
°° 
false
°° 
;
°° 
}
¢¢ 	
public
§§ 
static
§§ 
bool
§§ &
ShouldSerializeTpmNtBit0
§§ 3
(
§§3 4
)
§§4 5
{
•• 	
return
¶¶ 
false
¶¶ 
;
¶¶ 
}
ßß 	
public
©© 
static
©© 
bool
©© &
ShouldSerializeTpmNtBit1
©© 3
(
©©3 4
)
©©4 5
{
™™ 	
return
´´ 
false
´´ 
;
´´ 
}
¨¨ 	
public
ÆÆ 
static
ÆÆ 
bool
ÆÆ &
ShouldSerializeTpmNtBit2
ÆÆ 3
(
ÆÆ3 4
)
ÆÆ4 5
{
ØØ 	
return
∞∞ 
false
∞∞ 
;
∞∞ 
}
±± 	
public
≥≥ 
static
≥≥ 
bool
≥≥ &
ShouldSerializeTpmNtBit3
≥≥ 3
(
≥≥3 4
)
≥≥4 5
{
¥¥ 	
return
µµ 
false
µµ 
;
µµ 
}
∂∂ 	
public
∏∏ 
static
∏∏ 
bool
∏∏ +
ShouldSerializeTpmNtBitLength
∏∏ 8
(
∏∏8 9
)
∏∏9 :
{
ππ 	
return
∫∫ 
false
∫∫ 
;
∫∫ 
}
ªª 	
public
ΩΩ 
static
ΩΩ 
bool
ΩΩ )
ShouldSerializeTpmNtBitMask
ΩΩ 6
(
ΩΩ6 7
)
ΩΩ7 8
{
ææ 	
return
øø 
false
øø 
;
øø 
}
¿¿ 	
public
¬¬ 
static
¬¬ 
bool
¬¬ +
ShouldSerializeTpmNtBitOffset
¬¬ 8
(
¬¬8 9
)
¬¬9 :
{
√√ 	
return
ƒƒ 
false
ƒƒ 
;
ƒƒ 
}
≈≈ 	
public
«« 
static
«« 
bool
«« %
ShouldSerializeWriteall
«« 2
(
««2 3
)
««3 4
{
»» 	
return
…… 
false
…… 
;
…… 
}
   	
public
ÃÃ 
static
ÃÃ 
bool
ÃÃ (
ShouldSerializeWritedefine
ÃÃ 5
(
ÃÃ5 6
)
ÃÃ6 7
{
ÕÕ 	
return
ŒŒ 
false
ŒŒ 
;
ŒŒ 
}
œœ 	
public
—— 
static
—— 
bool
—— (
ShouldSerializeWritelocked
—— 5
(
——5 6
)
——6 7
{
““ 	
return
”” 
false
”” 
;
”” 
}
‘‘ 	
public
÷÷ 
static
÷÷ 
bool
÷÷ )
ShouldSerializeWriteStclear
÷÷ 6
(
÷÷6 7
)
÷÷7 8
{
◊◊ 	
return
ÿÿ 
false
ÿÿ 
;
ÿÿ 
}
ŸŸ 	
public
€€ 
static
€€ 
bool
€€ $
ShouldSerializeWritten
€€ 1
(
€€1 2
)
€€2 3
{
‹‹ 	
return
›› 
false
›› 
;
›› 
}
ﬁﬁ 	
}
ﬂﬂ 
}‡‡ ¡7
BD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\AsaRule.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
AsaRule 
: 
Rule 
{ 
public		 
AsaRule		 
(		 
string		 
Name		 "
)		" #
:		$ %
base		& *
(		* +
Name		+ /
)		/ 0
{

 	
} 	
public 
List 
< 
CHANGE_TYPE 
>  
ChangeTypes! ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
=; <
new= @
ListA E
<E F
CHANGE_TYPEF Q
>Q R
(R S
)S T
{U V
CHANGE_TYPEW b
.b c
CREATEDc j
,j k
CHANGE_TYPEl w
.w x
DELETEDx 
,	 Ä
CHANGE_TYPE
Å å
.
å ç
MODIFIED
ç ï
}
ñ ó
;
ó ò
public  
ANALYSIS_RESULT_TYPE #
Flag$ (
{ 	
get 
{ 
return 
_flag 
; 
} 
set 
{ 
_flag 
= 
value 
; 
Severity 
= 
( 
int 
)  
value  %
;% &
} 
} 	
public 
List 
< 
PLATFORM 
> 
	Platforms '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
=6 7
new8 ;
List< @
<@ A
PLATFORMA I
>I J
(J K
)K L
{M N
PLATFORMO W
.W X
LINUXX ]
,] ^
PLATFORM_ g
.g h
MACOSh m
,m n
PLATFORMo w
.w x
WINDOWSx 
}
Ä Å
;
Å Ç
public 
RESULT_TYPE 

ResultType %
{ 	
get   
{!! 
return"" 
_resultType"" "
;""" #
}## 
set$$ 
{%% 
_resultType&& 
=&& 
value&& #
;&&# $
Target'' 
='' "
ResultTypeToTargetName'' /
(''/ 0
value''0 5
)''5 6
;''6 7
}(( 
})) 	
private++  
ANALYSIS_RESULT_TYPE++ $
_flag++% *
;++* +
private-- 
RESULT_TYPE-- 
_resultType-- '
;--' (
private// 
static// 
string// 
?// "
ResultTypeToTargetName// 5
(//5 6
RESULT_TYPE//6 A
value//B G
)//G H
{00 	
switch11 
(11 
value11 
)11 
{22 
case33 
RESULT_TYPE33  
.33  !
CERTIFICATE33! ,
:33, -
return44 
typeof44 !
(44! "
CertificateObject44" 3
)443 4
.444 5
Name445 9
;449 :
case66 
RESULT_TYPE66  
.66  !
COM66! $
:66$ %
return77 
typeof77 !
(77! "
	ComObject77" +
)77+ ,
.77, -
Name77- 1
;771 2
case99 
RESULT_TYPE99  
.99  !
DRIVER99! '
:99' (
return:: 
typeof:: !
(::! "
DriverObject::" .
)::. /
.::/ 0
Name::0 4
;::4 5
case<< 
RESULT_TYPE<<  
.<<  !
FILE<<! %
:<<% &
return== 
typeof== !
(==! "
FileSystemObject==" 2
)==2 3
.==3 4
Name==4 8
;==8 9
case?? 
RESULT_TYPE??  
.??  !
FILEMONITOR??! ,
:??, -
return@@ 
typeof@@ !
(@@! "
FileMonitorObject@@" 3
)@@3 4
.@@4 5
Name@@5 9
;@@9 :
caseBB 
RESULT_TYPEBB  
.BB  !
FIREWALLBB! )
:BB) *
returnCC 
typeofCC !
(CC! "
FirewallObjectCC" 0
)CC0 1
.CC1 2
NameCC2 6
;CC6 7
caseEE 
RESULT_TYPEEE  
.EE  !
GROUPEE! &
:EE& '
returnFF 
typeofFF !
(FF! "
GroupAccountObjectFF" 4
)FF4 5
.FF5 6
NameFF6 :
;FF: ;
caseHH 
RESULT_TYPEHH  
.HH  !
KEYHH! $
:HH$ %
returnII 
typeofII !
(II! ""
CryptographicKeyObjectII" 8
)II8 9
.II9 :
NameII: >
;II> ?
caseKK 
RESULT_TYPEKK  
.KK  !
LOGKK! $
:KK$ %
returnLL 
typeofLL !
(LL! "
EventLogObjectLL" 0
)LL0 1
.LL1 2
NameLL2 6
;LL6 7
caseNN 
RESULT_TYPENN  
.NN  !
PORTNN! %
:NN% &
returnOO 
typeofOO !
(OO! "
OpenPortObjectOO" 0
)OO0 1
.OO1 2
NameOO2 6
;OO6 7
caseQQ 
RESULT_TYPEQQ  
.QQ  !
PROCESSQQ! (
:QQ( )
returnRR 
typeofRR !
(RR! "
ProcessObjectRR" /
)RR/ 0
.RR0 1
NameRR1 5
;RR5 6
caseTT 
RESULT_TYPETT  
.TT  !
REGISTRYTT! )
:TT) *
returnUU 
typeofUU !
(UU! "
RegistryObjectUU" 0
)UU0 1
.UU1 2
NameUU2 6
;UU6 7
caseWW 
RESULT_TYPEWW  
.WW  !
SERVICEWW! (
:WW( )
returnXX 
typeofXX !
(XX! "
ServiceObjectXX" /
)XX/ 0
.XX0 1
NameXX1 5
;XX5 6
caseZZ 
RESULT_TYPEZZ  
.ZZ  !
TPMZZ! $
:ZZ$ %
return[[ 
typeof[[ !
([[! "
	TpmObject[[" +
)[[+ ,
.[[, -
Name[[- 1
;[[1 2
case]] 
RESULT_TYPE]]  
.]]  !
USER]]! %
:]]% &
return^^ 
typeof^^ !
(^^! "
UserAccountObject^^" 3
)^^3 4
.^^4 5
Name^^5 9
;^^9 :
case`` 
RESULT_TYPE``  
.``  !
WIFI``! %
:``% &
returnaa 
typeofaa !
(aa! "

WifiObjectaa" ,
)aa, -
.aa- .
Nameaa. 2
;aa2 3
defaultcc 
:cc 
returndd 
nulldd 
;dd  
}ee 
}ff 	
}gg 
}hh ò
AD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\AsaRun.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
AsaRun 
{		 
public

 
AsaRun

 
(

 
string

 
RunId

 "
,

" #
DateTime

$ ,
	Timestamp

- 6
,

6 7
string

8 >
Version

? F
,

F G
PLATFORM

H P
Platform

Q Y
,

Y Z
List

[ _
<

_ `
RESULT_TYPE

` k
>

k l
ResultTypes

m x
,

x y
RUN_TYPE	

z Ç
Type


É á
)


á à
{ 	
this 
. 
RunId 
= 
RunId 
; 
this 
. 
	Timestamp 
= 
	Timestamp &
;& '
this 
. 
Version 
= 
Version "
;" #
this 
. 
Platform 
= 
Platform $
;$ %
this 
. 
ResultTypes 
= 
ResultTypes *
;* +
this 
. 
Type 
= 
Type 
; 
} 	
public 
PLATFORM 
Platform  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
List 
< 
RESULT_TYPE 
>  
ResultTypes! ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
string 
RunId 
{ 
get !
;! "
set# &
;& '
}( )
public 
DateTime 
	Timestamp !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
RUN_TYPE 
Type 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Version 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} Â
LD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\CertificateObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
CertificateObject "
:# $
CollectObject% 2
{ 
public 
CertificateObject  
(  !
string! '
StoreLocation( 5
,5 6
string7 =
	StoreName> G
,G H#
SerializableCertificateI `
Certificatea l
)l m
{		 	
this

 
.

 
StoreLocation

 
=

  
StoreLocation

! .
;

. /
this 
. 
	StoreName 
= 
	StoreName &
;& '
this 
. 
Certificate 
= 
Certificate *
;* +

ResultType 
= 
RESULT_TYPE $
.$ %
CERTIFICATE% 0
;0 1
} 	
public #
SerializableCertificate &
Certificate' 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
public 
string !
CertificateHashString +
{, -
get. 1
{2 3
return4 :
Certificate; F
.F G
CertHashStringG U
;U V
}W X
}Y Z
public 
override 
string 
Identity '
{ 	
get   
{!! 
return"" 
$""" 
{"" 
StoreLocation"" '
}""' (
{""( )
	StoreName"") 2
}""2 3
{""3 4!
CertificateHashString""4 I
}""I J
"""J K
;""K L
}## 
}$$ 	
public)) 
string)) 
?)) 
Pkcs7)) 
{)) 
get)) "
{))# $
return))% +
Certificate)), 7
.))7 8
Pkcs7))8 =
;))= >
}))? @
}))A B
public.. 
string.. 
StoreLocation.. #
{..$ %
get..& )
;..) *
set..+ .
;... /
}..0 1
public33 
string33 
	StoreName33 
{33  !
get33" %
;33% &
set33' *
;33* +
}33, -
public88 
string88 
Subject88 
{88 
get88  #
{88$ %
return88& ,
Certificate88- 8
.888 9
Subject889 @
;88@ A
}88B C
}88D E
}99 
}:: ì
HD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\CollectObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

abstract 
class 
CollectObject '
{ 
public 
abstract 
string 
Identity '
{( )
get* -
;- .
}/ 0
public 
RESULT_TYPE 

ResultType %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 	
SkipCompare	 
] 
[ 	

JsonIgnore	 
] 
public 
string 
RowKey 
{ 	
get 
{ 
return 

Serialized !
.! "
GetHashCode" -
(- .
). /
./ 0
ToString0 8
(8 9
CultureInfo9 D
.D E
InvariantCultureE U
)U V
;V W
} 
} 	
[ 	
SkipCompare	 
] 
[ 	

JsonIgnore	 
] 
public 
string 

Serialized  
{ 	
get 
{   
if!! 
(!! 
_serialized!! 
==!!  "
null!!# '
)!!' (
{"" 
_serialized## 
=##  !
	JsonUtils##" +
.##+ ,
	Dehydrate##, 5
(##5 6
this##6 :
)##: ;
;##; <
}$$ 
return&& 
_serialized&& "
;&&" #
}'' 
}(( 	
private** 
string** 
?** 
_serialized** #
=**$ %
null**& *
;*** +
}++ 
},, Á∑
ID:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\CommandOptions.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
{ 
[		 
Verb		 	
(			 

$str		
 
,		 
HelpText		 
=		 
$str		  B
)		B C
]		C D
public

 

class

 !
CollectCommandOptions

 &
:

' (
CollectorOptions

) 9
{ 
[ 	
Option	 
( 
$str 
, 
Required  (
=) *
false+ 0
,0 1
HelpText2 :
=; <
$str= j
)j k
]k l
public 
string 
? 
MatchedCollectorId )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
static !
CollectCommandOptions + 
FromCollectorOptions, @
(@ A
CollectorOptionsA Q
optsR V
)V W
{ 	
if 
( 
opts 
== 
null 
) 
throw #
new$ '!
ArgumentNullException( =
(= >
nameof> D
(D E
optsE I
)I J
)J K
;K L
return 
new !
CollectCommandOptions ,
(, -
)- .
{ 
CrawlArchives 
= 
opts  $
.$ %
CrawlArchives% 2
,2 3
DatabaseFilename  
=! "
opts# '
.' (
DatabaseFilename( 8
,8 9
Debug 
= 
opts 
. 
Debug "
," #
DownloadCloud 
= 
opts  $
.$ %
DownloadCloud% 2
,2 3
EnableAllCollectors #
=$ %
opts& *
.* +
EnableAllCollectors+ >
,> ?&
EnableCertificateCollector *
=+ ,
opts- 1
.1 2&
EnableCertificateCollector2 L
,L M$
EnableComObjectCollector (
=) *
opts+ /
./ 0$
EnableComObjectCollector0 H
,H I!
EnableDriverCollector %
=& '
opts( ,
., -!
EnableDriverCollector- B
,B C#
EnableEventLogCollector '
=( )
opts* .
.. /#
EnableEventLogCollector/ F
,F G%
EnableFileSystemCollector )
=* +
opts, 0
.0 1%
EnableFileSystemCollector1 J
,J K#
EnableFirewallCollector '
=( )
opts* .
.. /#
EnableFirewallCollector/ F
,F G
EnableKeyCollector "
=# $
opts% )
.) *
EnableKeyCollector* <
,< =&
EnableNetworkPortCollector   *
=  + ,
opts  - 1
.  1 2&
EnableNetworkPortCollector  2 L
,  L M"
EnableProcessCollector!! &
=!!' (
opts!!) -
.!!- ."
EnableProcessCollector!!. D
,!!D E#
EnableRegistryCollector"" '
=""( )
opts""* .
."". /#
EnableRegistryCollector""/ F
,""F G"
EnableServiceCollector## &
=##' (
opts##) -
.##- ."
EnableServiceCollector##. D
,##D E
EnableTpmCollector$$ "
=$$# $
opts$$% )
.$$) *
EnableTpmCollector$$* <
,$$< =
EnableUserCollector%% #
=%%$ %
opts%%& *
.%%* +
EnableUserCollector%%+ >
,%%> ?
EnableWifiCollector&& #
=&&$ %
opts&&& *
.&&* +
EnableWifiCollector&&+ >
,&&> ?
GatherHashes'' 
='' 
opts'' #
.''# $
GatherHashes''$ 0
,''0 1
GatherVerboseLogs(( !
=((" #
opts(($ (
.((( )
GatherVerboseLogs(() :
,((: ;
GatherWifiPasswords)) #
=))$ %
opts))& *
.))* +
GatherWifiPasswords))+ >
,))> ?
	Overwrite** 
=** 
opts**  
.**  !
	Overwrite**! *
,*** +
Quiet++ 
=++ 
opts++ 
.++ 
Quiet++ "
,++" #
RunId,, 
=,, 
opts,, 
.,, 
RunId,, "
,,," #
SelectedDirectories-- #
=--$ %
opts--& *
.--* +
SelectedDirectories--+ >
,--> ?
SelectedHives.. 
=.. 
opts..  $
...$ %
SelectedHives..% 2
,..2 3
SingleThread// 
=// 
opts// #
.//# $
SingleThread//$ 0
,//0 1
Verbose00 
=00 
opts00 
.00 
Verbose00 &
}11 
;11 
}22 	
}33 
public55 

class55 
CollectorOptions55 !
:55" #
CommandOptions55$ 2
{66 
[77 	
Option77	 
(77 
$str77  
,77  !
Required77" *
=77+ ,
false77- 2
,772 3
HelpText774 <
=77= >
$str	77? Ω
)
77Ω æ
]
77æ ø
public88 
bool88 
CrawlArchives88 !
{88" #
get88$ '
;88' (
set88) ,
;88, -
}88. /
[:: 	
Option::	 
(:: 
HelpText:: 
=:: 
$str:: b
)::b c
]::c d
public;; 
bool;; 
DownloadCloud;; !
{;;" #
get;;$ '
;;;' (
set;;) ,
;;;, -
};;. /
[== 	
Option==	 
(== 
$char== 
,== 
$str== 
,== 
Required== $
===% &
false==' ,
,==, -
HelpText==. 6
===7 8
$str==9 P
)==P Q
]==Q R
public>> 
bool>> 
EnableAllCollectors>> '
{>>( )
get>>* -
;>>- .
set>>/ 2
;>>2 3
}>>4 5
[@@ 	
Option@@	 
(@@ 
$char@@ 
,@@ 
$str@@ #
,@@# $
Required@@% -
=@@. /
false@@0 5
,@@5 6
HelpText@@7 ?
=@@@ A
$str@@B j
)@@j k
]@@k l
publicAA 
boolAA &
EnableCertificateCollectorAA .
{AA/ 0
getAA1 4
;AA4 5
setAA6 9
;AA9 :
}AA; <
[CC 	
OptionCC	 
(CC 
$charCC 
,CC 
$strCC 
,CC 
RequiredCC $
=CC% &
falseCC' ,
,CC, -
HelpTextCC. 6
=CC7 8
$strCC9 Z
)CCZ [
]CC[ \
publicDD 
boolDD $
EnableComObjectCollectorDD ,
{DD- .
getDD/ 2
;DD2 3
setDD4 7
;DD7 8
}DD9 :
[FF 	
OptionFF	 
(FF 
$charFF 
,FF 
$strFF 
,FF 
RequiredFF '
=FF( )
falseFF* /
,FF/ 0
HelpTextFF1 9
=FF: ;
$strFF< Y
)FFY Z
]FFZ [
publicGG 
boolGG !
EnableDriverCollectorGG )
{GG* +
getGG, /
;GG/ 0
setGG1 4
;GG4 5
}GG6 7
[II 	
OptionII	 
(II 
$charII 
,II 
$strII 
,II 
RequiredII %
=II& '
falseII( -
,II- .
HelpTextII/ 7
=II8 9
$strII: T
)IIT U
]IIU V
publicJJ 
boolJJ #
EnableEventLogCollectorJJ +
{JJ, -
getJJ. 1
;JJ1 2
setJJ3 6
;JJ6 7
}JJ8 9
[LL 	
OptionLL	 
(LL 
$charLL 
,LL 
$strLL "
,LL" #
RequiredLL$ ,
=LL- .
falseLL/ 4
,LL4 5
HelpTextLL6 >
=LL? @
$strLLA c
)LLc d
]LLd e
publicMM 
boolMM %
EnableFileSystemCollectorMM -
{MM. /
getMM0 3
;MM3 4
setMM5 8
;MM8 9
}MM: ;
[OO 	
OptionOO	 
(OO 
$charOO 
,OO 
$strOO 
,OO  
RequiredOO! )
=OO* +
falseOO, 1
,OO1 2
HelpTextOO3 ;
=OO< =
$strOO> ]
)OO] ^
]OO^ _
publicPP 
boolPP #
EnableFirewallCollectorPP +
{PP, -
getPP. 1
;PP1 2
setPP3 6
;PP6 7
}PP8 9
[RR 	
OptionRR	 
(RR 
$charRR 
,RR 
$strRR 
,RR 
RequiredRR %
=RR& '
falseRR( -
,RR- .
HelpTextRR/ 7
=RR8 9
$strRR: z
)RRz {
]RR{ |
publicSS 
boolSS 
EnableKeyCollectorSS &
{SS' (
getSS) ,
;SS, -
setSS. 1
;SS1 2
}SS3 4
[UU 	
OptionUU	 
(UU 
$charUU 
,UU 
$strUU #
,UU# $
RequiredUU% -
=UU. /
falseUU0 5
,UU5 6
HelpTextUU7 ?
=UU@ A
$strUUB e
)UUe f
]UUf g
publicVV 
boolVV &
EnableNetworkPortCollectorVV .
{VV/ 0
getVV1 4
;VV4 5
setVV6 9
;VV9 :
}VV; <
[XX 	
OptionXX	 
(XX 
$charXX 
,XX 
$strXX 
,XX 
RequiredXX  (
=XX) *
falseXX+ 0
,XX0 1
HelpTextXX2 :
=XX; <
$strXX= g
)XXg h
]XXh i
publicYY 
boolYY "
EnableProcessCollectorYY *
{YY+ ,
getYY- 0
;YY0 1
setYY2 5
;YY5 6
}YY7 8
[[[ 	
Option[[	 
([[ 
$char[[ 
,[[ 
$str[[ 
,[[  
Required[[! )
=[[* +
false[[, 1
,[[1 2
HelpText[[3 ;
=[[< =
$str[[> ]
)[[] ^
][[^ _
public\\ 
bool\\ #
EnableRegistryCollector\\ +
{\\, -
get\\. 1
;\\1 2
set\\3 6
;\\6 7
}\\8 9
[^^ 	
Option^^	 
(^^ 
$char^^ 
,^^ 
$str^^ 
,^^ 
Required^^  (
=^^) *
false^^+ 0
,^^0 1
HelpText^^2 :
=^^; <
$str^^= [
)^^[ \
]^^\ ]
public__ 
bool__ "
EnableServiceCollector__ *
{__+ ,
get__- 0
;__0 1
set__2 5
;__5 6
}__7 8
[aa 	
Optionaa	 
(aa 
$charaa 
,aa 
$straa 
,aa 
Requiredaa $
=aa% &
falseaa' ,
,aa, -
HelpTextaa. 6
=aa7 8
$straa9 [
)aa[ \
]aa\ ]
publicbb 
boolbb 
EnableTpmCollectorbb &
{bb' (
getbb) ,
;bb, -
setbb. 1
;bb1 2
}bb3 4
[dd 	
Optiondd	 
(dd 
$chardd 
,dd 
$strdd 
,dd 
Requireddd %
=dd& '
falsedd( -
,dd- .
HelpTextdd/ 7
=dd8 9
$strdd: g
)ddg h
]ddh i
publicee 
boolee 
EnableUserCollectoree '
{ee( )
getee* -
;ee- .
setee/ 2
;ee2 3
}ee4 5
[gg 	
Optiongg	 
(gg 
$chargg 
,gg 
$strgg 
,gg 
Requiredgg %
=gg& '
falsegg( -
,gg- .
HelpTextgg/ 7
=gg8 9
$strgg: g
)ggg h
]ggh i
publichh 
boolhh 
EnableWifiCollectorhh '
{hh( )
gethh* -
;hh- .
sethh/ 2
;hh2 3
}hh4 5
[jj 	
Optionjj	 
(jj 
$charjj 
,jj 
$strjj $
,jj$ %
Requiredjj& .
=jj/ 0
falsejj1 6
,jj6 7
HelpTextjj8 @
=jjA B
$str	jjC ¶
)
jj¶ ß
]
jjß ®
publickk 
boolkk 
GatherHasheskk  
{kk! "
getkk# &
;kk& '
setkk( +
;kk+ ,
}kk- .
[mm 	
Optionmm	 
(mm 
HelpTextmm 
=mm 
$strmm |
)mm| }
]mm} ~
publicnn 
boolnn 
GatherVerboseLogsnn %
{nn& '
getnn( +
;nn+ ,
setnn- 0
;nn0 1
}nn2 3
[pp 	
Optionpp	 
(pp 
HelpTextpp 
=pp 
$strpp K
)ppK L
]ppL M
publicqq 
boolqq 
GatherWifiPasswordsqq '
{qq( )
getqq* -
;qq- .
setqq/ 2
;qq2 3
}qq4 5
[ss 	
Optionss	 
(ss 
HelpTextss 
=ss 
$strss s
)sss t
]sst u
publictt 
booltt 
	Overwritett 
{tt 
gettt  #
;tt# $
settt% (
;tt( )
}tt* +
[vv 	
Optionvv	 
(vv 
HelpTextvv 
=vv 
$strvv :
)vv: ;
]vv; <
publicww 
stringww 
?ww 
RunIdww 
{ww 
getww "
;ww" #
setww$ '
;ww' (
}ww) *
[yy 	
Optionyy	 
(yy 
$stryy 
,yy 
Requiredyy '
=yy( )
falseyy* /
,yy/ 0
HelpTextyy1 9
=yy: ;
$stryy< |
,yy| }
	Separator	yy~ á
=
yyà â
$char
yyä ç
)
yyç é
]
yyé è
publiczz 
IEnumerablezz 
<zz 
stringzz !
>zz! "
SelectedDirectorieszz# 6
{zz7 8
getzz9 <
;zz< =
setzz> A
;zzA B
}zzC D
=zzE F
newzzG J
ListzzK O
<zzO P
stringzzP V
>zzV W
(zzW X
)zzX Y
;zzY Z
[|| 	
Option||	 
(|| 
$str|| "
,||" #
Required||$ ,
=||- .
false||/ 4
,||4 5
HelpText||6 >
=||? @
$str	||A Å
,
||Å Ç
	Separator
||É å
=
||ç é
$char
||è í
)
||í ì
]
||ì î
public}} 
IEnumerable}} 
<}} 
string}} !
>}}! "
SkipDirectories}}# 2
{}}3 4
get}}5 8
;}}8 9
set}}: =
;}}= >
}}}? @
=}}A B
new}}C F
List}}G K
<}}K L
string}}L R
>}}R S
(}}S T
)}}T U
;}}U V
[ 	
Option	 
( 
$str 
, 
Required !
=" #
false$ )
,) *
HelpText+ 3
=4 5
$str6 l
,l m
	Separatorn w
=x y
$charz }
)} ~
]~ 
public
ÄÄ 
IEnumerable
ÄÄ 
<
ÄÄ 
string
ÄÄ !
>
ÄÄ! "
SelectedHives
ÄÄ# 0
{
ÄÄ1 2
get
ÄÄ3 6
;
ÄÄ6 7
set
ÄÄ8 ;
;
ÄÄ; <
}
ÄÄ= >
=
ÄÄ? @
new
ÄÄA D
List
ÄÄE I
<
ÄÄI J
string
ÄÄJ P
>
ÄÄP Q
(
ÄÄQ R
)
ÄÄR S
;
ÄÄS T
[
ÇÇ 	
Option
ÇÇ	 
(
ÇÇ 
HelpText
ÇÇ 
=
ÇÇ 
$str
ÇÇ =
)
ÇÇ= >
]
ÇÇ> ?
public
ÉÉ 
bool
ÉÉ 
SingleThread
ÉÉ  
{
ÉÉ! "
get
ÉÉ# &
;
ÉÉ& '
set
ÉÉ( +
;
ÉÉ+ ,
}
ÉÉ- .
}
ÑÑ 
public
ÜÜ 

class
ÜÜ 
CommandOptions
ÜÜ 
{
áá 
[
àà 	
Option
àà	 
(
àà 
Required
àà 
=
àà 
false
àà  
,
àà  !
HelpText
àà" *
=
àà+ ,
$str
àà- \
,
àà\ ]
Default
àà^ e
=
ààf g
$str
ààh t
)
ààt u
]
ààu v
public
ââ 
string
ââ 
DatabaseFilename
ââ &
{
ââ' (
get
ââ) ,
;
ââ, -
set
ââ. 1
;
ââ1 2
}
ââ3 4
=
ââ5 6
$str
ââ7 C
;
ââC D
[
ãã 	
Option
ãã	 
(
ãã 
HelpText
ãã 
=
ãã 
$str
ãã ;
)
ãã; <
]
ãã< =
public
åå 
bool
åå 
Debug
åå 
{
åå 
get
åå 
;
åå  
set
åå! $
;
åå$ %
}
åå& '
[
éé 	
Option
éé	 
(
éé 
HelpText
éé 
=
éé 
$str
éé V
)
ééV W
]
ééW X
public
èè 
bool
èè 
LowMemoryUsage
èè "
{
èè# $
get
èè% (
;
èè( )
set
èè* -
;
èè- .
}
èè/ 0
[
ëë 	
Option
ëë	 
(
ëë 
Default
ëë 
=
ëë 
false
ëë 
,
ëë  
HelpText
ëë! )
=
ëë* +
$str
ëë, H
)
ëëH I
]
ëëI J
public
íí 
bool
íí 
Quiet
íí 
{
íí 
get
íí 
;
íí  
set
íí! $
;
íí$ %
}
íí& '
[
îî 	
Option
îî	 
(
îî 
HelpText
îî 
=
îî 
$str
îî >
)
îî> ?
]
îî? @
public
ïï 
int
ïï 
Shards
ïï 
{
ïï 
get
ïï 
;
ïï  
set
ïï! $
;
ïï$ %
}
ïï& '
=
ïï( )
$num
ïï* +
;
ïï+ ,
[
óó 	
Option
óó	 
(
óó 
Default
óó 
=
óó 
false
óó 
,
óó  
HelpText
óó! )
=
óó* +
$str
óó, H
)
óóH I
]
óóI J
public
òò 
bool
òò 
Verbose
òò 
{
òò 
get
òò !
;
òò! "
set
òò# &
;
òò& '
}
òò( )
}
ôô 
public
õõ 

class
õõ #
CompareCommandOptions
õõ &
:
õõ' (
CommandOptions
õõ) 7
{
úú 
public
ùù #
CompareCommandOptions
ùù $
(
ùù$ %
string
ùù% +
?
ùù+ ,

FirstRunId
ùù- 7
,
ùù7 8
string
ùù9 ?
SecondRunId
ùù@ K
)
ùùK L
{
ûû 	
this
üü 
.
üü 

FirstRunId
üü 
=
üü 

FirstRunId
üü (
;
üü( )
this
†† 
.
†† 
SecondRunId
†† 
=
†† 
SecondRunId
†† *
;
††* +
}
°° 	
[
££ 	
Option
££	 
(
££ 
HelpText
££ 
=
££ 
$str
££ 8
)
££8 9
]
££9 :
public
§§ 
RuleFile
§§ 
?
§§ 
AnalysesFile
§§ %
{
§§& '
get
§§( +
;
§§+ ,
set
§§- 0
;
§§0 1
}
§§2 3
[
¶¶ 	
Option
¶¶	 
(
¶¶ 
HelpText
¶¶ 
=
¶¶ 
$str
¶¶ j
)
¶¶j k
]
¶¶k l
public
ßß 
bool
ßß *
ApplySubObjectRulesToMonitor
ßß 0
{
ßß1 2
get
ßß3 6
;
ßß6 7
set
ßß8 ;
;
ßß; <
}
ßß= >
[
©© 	
Option
©©	 
(
©© 
HelpText
©© 
=
©© 
$str
©© 2
)
©©2 3
]
©©3 4
public
™™ 
bool
™™ 
DisableAnalysis
™™ #
{
™™$ %
get
™™& )
;
™™) *
set
™™+ .
;
™™. /
}
™™0 1
[
¨¨ 	
Option
¨¨	 
(
¨¨ 
HelpText
¨¨ 
=
¨¨ 
$str
¨¨ ?
)
¨¨? @
]
¨¨@ A
public
≠≠ 
string
≠≠ 
?
≠≠ 

FirstRunId
≠≠ !
{
≠≠" #
get
≠≠$ '
;
≠≠' (
set
≠≠) ,
;
≠≠, -
}
≠≠. /
[
ØØ 	
Option
ØØ	 
(
ØØ 
HelpText
ØØ 
=
ØØ 
$str
ØØ H
)
ØØH I
]
ØØI J
public
∞∞ 
bool
∞∞ 
SaveToDatabase
∞∞ "
{
∞∞# $
get
∞∞% (
;
∞∞( )
set
∞∞* -
;
∞∞- .
}
∞∞/ 0
[
≤≤ 	
Option
≤≤	 
(
≤≤ 
HelpText
≤≤ 
=
≤≤ 
$str
≤≤ A
)
≤≤A B
]
≤≤B C
public
≥≥ 
string
≥≥ 
SecondRunId
≥≥ !
{
≥≥" #
get
≥≥$ '
;
≥≥' (
set
≥≥) ,
;
≥≥, -
}
≥≥. /
[
µµ 	
Option
µµ	 
(
µµ 
HelpText
µµ 
=
µµ 
$str
µµ (
)
µµ( )
]
µµ) *
public
∂∂ 
bool
∂∂ 

RunScripts
∂∂ 
{
∂∂  
get
∂∂! $
;
∂∂$ %
set
∂∂& )
;
∂∂) *
}
∂∂+ ,
}
∑∑ 
[
ππ 
Verb
ππ 	
(
ππ	 

$str
ππ
 
,
ππ 
HelpText
ππ 
=
ππ 
$str
ππ A
)
ππA B
]
ππB C
public
∫∫ 

class
∫∫ "
ConfigCommandOptions
∫∫ %
:
∫∫& '
CommandOptions
∫∫( 6
{
ªª 
[
ºº 	
Option
ºº	 
(
ºº 
$str
ºº 
,
ºº 
Required
ºº &
=
ºº' (
false
ºº) .
,
ºº. /
HelpText
ºº0 8
=
ºº9 :
$str
ºº; d
)
ººd e
]
ººe f
public
ΩΩ 
string
ΩΩ 
?
ΩΩ 
DeleteRunId
ΩΩ "
{
ΩΩ# $
get
ΩΩ% (
;
ΩΩ( )
set
ΩΩ* -
;
ΩΩ- .
}
ΩΩ/ 0
[
øø 	
Option
øø	 
(
øø 
$str
øø 
,
øø 
Required
øø %
=
øø& '
false
øø( -
,
øø- .
HelpText
øø/ 7
=
øø8 9
$str
øø: U
)
øøU V
]
øøV W
public
¿¿ 
bool
¿¿ 
ListRuns
¿¿ 
{
¿¿ 
get
¿¿ "
;
¿¿" #
set
¿¿$ '
;
¿¿' (
}
¿¿) *
[
¬¬ 	
Option
¬¬	 
(
¬¬ 
$str
¬¬  
,
¬¬  !
Required
¬¬" *
=
¬¬+ ,
false
¬¬- 2
,
¬¬2 3
HelpText
¬¬4 <
=
¬¬= >
$str
¬¬? [
)
¬¬[ \
]
¬¬\ ]
public
√√ 
bool
√√ 
ResetDatabase
√√ !
{
√√" #
get
√√$ '
;
√√' (
set
√√) ,
;
√√, -
}
√√. /
[
≈≈ 	
Option
≈≈	 
(
≈≈ 
$str
≈≈  
,
≈≈  !
HelpText
≈≈" *
=
≈≈+ ,
$str
≈≈- Q
)
≈≈Q R
]
≈≈R S
public
∆∆ 
bool
∆∆ 
TrimToLatest
∆∆  
{
∆∆! "
get
∆∆# &
;
∆∆& '
set
∆∆( +
;
∆∆+ ,
}
∆∆- .
}
«« 
[
…… 
Verb
…… 	
(
……	 

$str
……
 
,
…… 
HelpText
…… $
=
……% &
$str
……' Y
)
……Y Z
]
……Z [
public
   

class
   )
ExportCollectCommandOptions
   ,
:
  - .
ExportOptions
  / <
{
ÀÀ 
[
ÃÃ 	
Option
ÃÃ	 
(
ÃÃ 
HelpText
ÃÃ 
=
ÃÃ 
$str
ÃÃ Q
)
ÃÃQ R
]
ÃÃR S
public
ÕÕ 
bool
ÕÕ 
ExportSingleRun
ÕÕ #
{
ÕÕ$ %
get
ÕÕ& )
;
ÕÕ) *
set
ÕÕ+ .
;
ÕÕ. /
}
ÕÕ0 1
[
œœ 	
Option
œœ	 
(
œœ 
HelpText
œœ 
=
œœ 
$str
œœ ?
)
œœ? @
]
œœ@ A
public
–– 
string
–– 
?
–– 

FirstRunId
–– !
{
––" #
get
––$ '
;
––' (
set
––) ,
;
––, -
}
––. /
[
““ 	
Option
““	 
(
““ 
HelpText
““ 
=
““ 
$str
““ A
)
““A B
]
““B C
public
”” 
string
”” 
SecondRunId
”” !
{
””" #
get
””$ '
;
””' (
set
””) ,
;
””, -
}
””. /
=
””0 1
string
””2 8
.
””8 9
Empty
””9 >
;
””> ?
}
‘‘ 
[
÷÷ 
Verb
÷÷ 	
(
÷÷	 

$str
÷÷
 
,
÷÷ 
HelpText
÷÷ $
=
÷÷% &
$str
÷÷' P
)
÷÷P Q
]
÷÷Q R
public
◊◊ 

class
◊◊ )
ExportMonitorCommandOptions
◊◊ ,
:
◊◊- .
ExportOptions
◊◊/ <
{
ÿÿ 
[
ŸŸ 	
Option
ŸŸ	 
(
ŸŸ 
HelpText
ŸŸ 
=
ŸŸ 
$strŸŸ ±
)ŸŸ± ≤
]ŸŸ≤ ≥
public
⁄⁄ 
bool
⁄⁄ *
ApplySubObjectRulesToMonitor
⁄⁄ 0
{
⁄⁄1 2
get
⁄⁄3 6
;
⁄⁄6 7
set
⁄⁄8 ;
;
⁄⁄; <
}
⁄⁄= >
[
‹‹ 	
Option
‹‹	 
(
‹‹ 
HelpText
‹‹ 
=
‹‹ 
$str
‹‹ 3
)
‹‹3 4
]
‹‹4 5
public
›› 
string
›› 
?
›› 
RunId
›› 
{
›› 
get
›› "
;
››" #
set
››$ '
;
››' (
}
››) *
}
ﬁﬁ 
public
‡‡ 

class
‡‡ 
ExportOptions
‡‡ 
:
‡‡  
CommandOptions
‡‡! /
{
·· 
[
‚‚ 	
Option
‚‚	 
(
‚‚ 
$str
‚‚ 
,
‚‚ 
HelpText
‚‚ $
=
‚‚% &
$str
‚‚' D
)
‚‚D E
]
‚‚E F
public
„„ 
string
„„ 
?
„„ 
AnalysesFile
„„ #
{
„„$ %
get
„„& )
;
„„) *
set
„„+ .
;
„„. /
}
„„0 1
[
ÂÂ 	
Option
ÂÂ	 
(
ÂÂ 
HelpText
ÂÂ 
=
ÂÂ 
$str
ÂÂ 5
)
ÂÂ5 6
]
ÂÂ6 7
public
ÊÊ 
bool
ÊÊ 
DisableAnalysis
ÊÊ #
{
ÊÊ$ %
get
ÊÊ& )
;
ÊÊ) *
set
ÊÊ+ .
;
ÊÊ. /
}
ÊÊ0 1
[
ËË 	
Option
ËË	 
(
ËË 
HelpText
ËË 
=
ËË 
$str
ËË ,
)
ËË, -
]
ËË- .
public
ÈÈ 
bool
ÈÈ 
ExplodedOutput
ÈÈ "
{
ÈÈ# $
get
ÈÈ% (
;
ÈÈ( )
set
ÈÈ* -
;
ÈÈ- .
}
ÈÈ/ 0
[
ÎÎ 	
Option
ÎÎ	 
(
ÎÎ 
HelpText
ÎÎ 
=
ÎÎ 
$str
ÎÎ 3
)
ÎÎ3 4
]
ÎÎ4 5
public
ÏÏ 
string
ÏÏ 
?
ÏÏ 

OutputPath
ÏÏ !
{
ÏÏ" #
get
ÏÏ$ '
;
ÏÏ' (
set
ÏÏ) ,
;
ÏÏ, -
}
ÏÏ. /
[
ÓÓ 	
Option
ÓÓ	 
(
ÓÓ 
HelpText
ÓÓ 
=
ÓÓ 
$str
ÓÓ H
)
ÓÓH I
]
ÓÓI J
public
ÔÔ 
bool
ÔÔ 
SaveToDatabase
ÔÔ "
{
ÔÔ# $
get
ÔÔ% (
;
ÔÔ( )
set
ÔÔ* -
;
ÔÔ- .
}
ÔÔ/ 0
[
ÒÒ 	
Option
ÒÒ	 
(
ÒÒ 
HelpText
ÒÒ 
=
ÒÒ 
$str
ÒÒ <
)
ÒÒ< =
]
ÒÒ= >
public
ÚÚ 
bool
ÚÚ 

RunScripts
ÚÚ 
{
ÚÚ  
get
ÚÚ! $
;
ÚÚ$ %
set
ÚÚ& )
;
ÚÚ) *
}
ÚÚ+ ,
[
ÙÙ 	
Option
ÙÙ	 
(
ÙÙ 
HelpText
ÙÙ 
=
ÙÙ 
$str
ÙÙ )
)
ÙÙ) *
]
ÙÙ* +
public
ıı 
bool
ıı 
OutputSarif
ıı 
{
ıı  !
get
ıı" %
;
ıı% &
set
ıı' *
;
ıı* +
}
ıı, -
}
ˆˆ 
[
¯¯ 
Verb
¯¯ 	
(
¯¯	 

$str
¯¯
 
,
¯¯ 
HelpText
¯¯ 
=
¯¯ 
$str
¯¯ :
)
¯¯: ;
]
¯¯; <
public
˘˘ 

class
˘˘ 
GuiCommandOptions
˘˘ "
:
˘˘# $
CommandOptions
˘˘% 3
{
˙˙ 
[
˚˚ 	
Option
˚˚	 
(
˚˚ 
HelpText
˚˚ 
=
˚˚ 
$str
˚˚ J
)
˚˚J K
]
˚˚K L
public
¸¸ 
bool
¸¸ 
NoLaunch
¸¸ 
{
¸¸ 
get
¸¸ "
;
¸¸" #
set
¸¸$ '
;
¸¸' (
}
¸¸) *
}
˝˝ 
[
ˇˇ 
Verb
ˇˇ 	
(
ˇˇ	 

$str
ˇˇ
 
,
ˇˇ 
HelpText
ˇˇ 
=
ˇˇ 
$str
ˇˇ j
)
ˇˇj k
]
ˇˇk l
public
ÄÄ 

class
ÄÄ &
GuidedModeCommandOptions
ÄÄ )
:
ÄÄ* +
CollectorOptions
ÄÄ, <
{
ÅÅ 
[
ÉÉ 	
Option
ÉÉ	 
(
ÉÉ 
HelpText
ÉÉ 
=
ÉÉ 
$str
ÉÉ 8
)
ÉÉ8 9
]
ÉÉ9 :
public
ÑÑ 
string
ÑÑ 
?
ÑÑ 
AnalysesFile
ÑÑ #
{
ÑÑ$ %
get
ÑÑ& )
;
ÑÑ) *
set
ÑÑ+ .
;
ÑÑ. /
}
ÑÑ0 1
[
ÜÜ 	
Option
ÜÜ	 
(
ÜÜ 
HelpText
ÜÜ 
=
ÜÜ 
$str
ÜÜ R
)
ÜÜR S
]
ÜÜS T
public
áá 
bool
áá *
ApplySubObjectRulesToMonitor
áá 0
{
áá1 2
get
áá3 6
;
áá6 7
set
áá8 ;
;
áá; <
}
áá= >
[
ââ 	
Option
ââ	 
(
ââ 
HelpText
ââ 
=
ââ 
$str
ââ 2
)
ââ2 3
]
ââ3 4
public
ää 
bool
ää 
DisableAnalysis
ää #
{
ää$ %
get
ää& )
;
ää) *
set
ää+ .
;
ää. /
}
ää0 1
[
çç 	
Option
çç	 
(
çç 
$str
çç 
,
çç 
Required
çç $
=
çç% &
false
çç' ,
,
çç, -
HelpText
çç. 6
=
çç7 8
$str
çç9 }
)
çç} ~
]
çç~ 
public
éé 
int
éé 
Duration
éé 
{
éé 
get
éé !
;
éé! "
set
éé# &
;
éé& '
}
éé( )
[
êê 	
Option
êê	 
(
êê 
$char
êê 
,
êê 
$str
êê *
,
êê* +
Required
êê, 4
=
êê5 6
false
êê7 <
,
êê< =
HelpText
êê> F
=
êêG H
$strêêI ¶
)êê¶ ß
]êêß ®
public
ëë 
bool
ëë %
EnableFileSystemMonitor
ëë +
{
ëë, -
get
ëë. 1
;
ëë1 2
set
ëë3 6
;
ëë6 7
}
ëë8 9
[
ìì 	
Option
ìì	 
(
ìì 
HelpText
ìì 
=
ìì 
$str
ìì F
)
ììF G
]
ììG H
public
îî 
bool
îî 
ExplodedOutput
îî "
{
îî# $
get
îî% (
;
îî( )
set
îî* -
;
îî- .
}
îî/ 0
[
ññ 	
Option
ññ	 
(
ññ 
HelpText
ññ 
=
ññ 
$str
ññ U
)
ññU V
]
ññV W
public
óó 
bool
óó 
FileNamesOnly
óó !
{
óó" #
get
óó$ '
;
óó' (
set
óó) ,
;
óó, -
}
óó. /
[
ôô 	
Option
ôô	 
(
ôô 
HelpText
ôô 
=
ôô 
$str
ôô L
,
ôôL M
	Separator
ôôN W
=
ôôX Y
$char
ôôZ ]
)
ôô] ^
]
ôô^ _
public
öö 
IEnumerable
öö 
<
öö 
string
öö !
>
öö! ""
MonitoredDirectories
öö# 7
{
öö8 9
get
öö: =
;
öö= >
set
öö? B
;
ööB C
}
ööD E
=
ööF G
new
ööH K
List
ööL P
<
ööP Q
string
ööQ W
>
ööW X
(
ööX Y
)
ööY Z
;
ööZ [
[
úú 	
Option
úú	 
(
úú 
HelpText
úú 
=
úú 
$str
úú 4
)
úú4 5
]
úú5 6
public
ùù 
string
ùù 
?
ùù 

OutputPath
ùù !
{
ùù" #
get
ùù$ '
;
ùù' (
set
ùù) ,
;
ùù, -
}
ùù. /
[
üü 	
Option
üü	 
(
üü 
HelpText
üü 
=
üü 
$str
üü H
)
üüH I
]
üüI J
public
†† 
bool
†† 
SaveToDatabase
†† "
{
††# $
get
††% (
;
††( )
set
††* -
;
††- .
}
††/ 0
[
¢¢ 	
Option
¢¢	 
(
¢¢ 
HelpText
¢¢ 
=
¢¢ 
$str
¢¢ (
)
¢¢( )
]
¢¢) *
public
££ 
bool
££ 

RunScripts
££ 
{
££  
get
££! $
;
££$ %
set
££& )
;
££) *
}
££+ ,
[
•• 	
Option
••	 
(
•• 
HelpText
•• 
=
•• 
$str
•• )
)
••) *
]
••* +
public
¶¶ 
bool
¶¶ 
ExportSarif
¶¶ 
{
¶¶  !
get
¶¶" %
;
¶¶% &
set
¶¶' *
;
¶¶* +
}
¶¶, -
}
ßß 
[
©© 
Verb
©© 	
(
©©	 

$str
©©
 
,
©© 
HelpText
©© 
=
©© 
$str
©©  G
)
©©G H
]
©©H I
public
™™ 

class
™™ #
MonitorCommandOptions
™™ &
:
™™' (
CommandOptions
™™) 7
{
´´ 
[
¨¨ 	
Option
¨¨	 
(
¨¨ 
$char
¨¨ 
,
¨¨ 
$str
¨¨ 
,
¨¨  
Required
¨¨! )
=
¨¨* +
false
¨¨, 1
,
¨¨1 2
HelpText
¨¨3 ;
=
¨¨< =
$str¨¨> Ç
)¨¨Ç É
]¨¨É Ñ
public
≠≠ 
int
≠≠ 
Duration
≠≠ 
{
≠≠ 
get
≠≠ !
;
≠≠! "
set
≠≠# &
;
≠≠& '
}
≠≠( )
[
ØØ 	
Option
ØØ	 
(
ØØ 
$char
ØØ 
,
ØØ 
$str
ØØ *
,
ØØ* +
Required
ØØ, 4
=
ØØ5 6
false
ØØ7 <
,
ØØ< =
HelpText
ØØ> F
=
ØØG H
$strØØI ¶
)ØØ¶ ß
]ØØß ®
public
∞∞ 
bool
∞∞ %
EnableFileSystemMonitor
∞∞ +
{
∞∞, -
get
∞∞. 1
;
∞∞1 2
set
∞∞3 6
;
∞∞6 7
}
∞∞8 9
[
≤≤ 	
Option
≤≤	 
(
≤≤ 
$char
≤≤ 
,
≤≤ 
$str
≤≤ &
,
≤≤& '
Required
≤≤( 0
=
≤≤1 2
false
≤≤3 8
,
≤≤8 9
HelpText
≤≤: B
=
≤≤C D
$str≤≤E ú
)≤≤ú ù
]≤≤ù û
public
≥≥ 
bool
≥≥ 
FileNamesOnly
≥≥ !
{
≥≥" #
get
≥≥$ '
;
≥≥' (
set
≥≥) ,
;
≥≥, -
}
≥≥. /
[
µµ 	
Option
µµ	 
(
µµ 
$char
µµ 
,
µµ 
$str
µµ $
,
µµ$ %
Required
µµ& .
=
µµ/ 0
false
µµ1 6
,
µµ6 7
HelpText
µµ8 @
=
µµA B
$str
µµC |
)
µµ| }
]
µµ} ~
public
∂∂ 
bool
∂∂ 
GatherHashes
∂∂  
{
∂∂! "
get
∂∂# &
;
∂∂& '
set
∂∂( +
;
∂∂+ ,
}
∂∂- .
[
∏∏ 	
Option
∏∏	 
(
∏∏ 
$char
∏∏ 
,
∏∏ 
$str
∏∏ "
,
∏∏" #
Required
∏∏$ ,
=
∏∏- .
false
∏∏/ 4
,
∏∏4 5
HelpText
∏∏6 >
=
∏∏? @
$str
∏∏A r
,
∏∏r s
	Separator
∏∏t }
=
∏∏~ 
$char∏∏Ä É
)∏∏É Ñ
]∏∏Ñ Ö
public
ππ 
IEnumerable
ππ 
<
ππ 
string
ππ !
>
ππ! ""
MonitoredDirectories
ππ# 7
{
ππ8 9
get
ππ: =
;
ππ= >
set
ππ? B
;
ππB C
}
ππD E
=
ππF G
new
ππH K
List
ππL P
<
ππP Q
string
ππQ W
>
ππW X
(
ππX Y
)
ππY Z
;
ππZ [
[
ΩΩ 	
Option
ΩΩ	 
(
ΩΩ 
Default
ΩΩ 
=
ΩΩ 
false
ΩΩ 
,
ΩΩ  
HelpText
ΩΩ! )
=
ΩΩ* +
$strΩΩ, Ñ
)ΩΩÑ Ö
]ΩΩÖ Ü
public
ææ 
bool
ææ 
	Overwrite
ææ 
{
ææ 
get
ææ  #
;
ææ# $
set
ææ% (
;
ææ( )
}
ææ* +
[
¿¿ 	
Option
¿¿	 
(
¿¿ 
HelpText
¿¿ 
=
¿¿ 
$str¿¿ è
,¿¿è ê
Default¿¿ë ò
=¿¿ô ö
$str¿¿õ ¶
)¿¿¶ ß
]¿¿ß ®
public
¡¡ 
string
¡¡ 
?
¡¡ 
RunId
¡¡ 
{
¡¡ 
get
¡¡ "
;
¡¡" #
set
¡¡$ '
;
¡¡' (
}
¡¡) *
}
¬¬ 
[
ƒƒ 
Verb
ƒƒ 	
(
ƒƒ	 

$str
ƒƒ
 
,
ƒƒ 
HelpText
ƒƒ 
=
ƒƒ 
$str
ƒƒ ;
)
ƒƒ; <
]
ƒƒ< =
public
≈≈ 

class
≈≈ 
VerifyOptions
≈≈ 
:
≈≈  
CommandOptions
≈≈! /
{
∆∆ 
[
«« 	
Option
««	 
(
«« 
$str
«« 
,
«« 
Required
«« $
=
««% &
false
««' ,
,
««, -
HelpText
««. 6
=
««7 8
$str
««9 z
)
««z {
]
««{ |
public
»» 
string
»» 
?
»» 
AnalysisFile
»» #
{
»»$ %
get
»»& )
;
»») *
set
»»+ .
;
»». /
}
»»0 1
[
   	
Option
  	 
(
   
HelpText
   
=
   
$str
   1
)
  1 2
]
  2 3
public
ÀÀ 
bool
ÀÀ 

RunScripts
ÀÀ 
{
ÀÀ  
get
ÀÀ! $
;
ÀÀ$ %
set
ÀÀ& )
;
ÀÀ) *
}
ÀÀ+ ,
}
ÃÃ 
}ÕÕ ≤
DD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\ComObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
	ComObject 
: 
CollectObject *
{ 
public 
	ComObject 
( 
RegistryObject '
Key( +
)+ ,
:- .
base/ 3
(3 4
)4 5
{ 	
this 
. 
Key 
= 
Key 
; 

ResultType 
= 
RESULT_TYPE $
.$ %
COM% (
;( )
} 	
public 
override 
string 
Identity '
{ 	
get 
{ 
return 
Key 
. 
Identity #
;# $
} 
} 	
public   
RegistryObject   
Key   !
{  " #
get  $ '
;  ' (
set  ) ,
;  , -
}  . /
public%% 
FileSystemObject%% 
?%%  

x64_Binary%%! +
{%%, -
get%%. 1
;%%1 2
set%%3 6
;%%6 7
}%%8 9
public** 
FileSystemObject** 
?**  

x86_Binary**! +
{**, -
get**. 1
;**1 2
set**3 6
;**6 7
}**8 9
}++ 
},, ‚*
HD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\CompareResult.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
CompareResult 
{		 
public

 
CompareResult

 
(

 
)

 
{ 	
} 	
public  
ANALYSIS_RESULT_TYPE #
Analysis$ ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
CollectObject 
? 
Base "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
	BaseRunId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
CHANGE_TYPE 

ChangeType %
{ 	
get 
{ 
if 
( 
Base 
!= 
null  
)  !
{ 
if 
( 
Compare 
!=  "
null# '
)' (
{ 
return 
CHANGE_TYPE *
.* +
MODIFIED+ 3
;3 4
} 
else 
{ 
return   
CHANGE_TYPE   *
.  * +
DELETED  + 2
;  2 3
}!! 
}"" 
else## 
{$$ 
if%% 
(%% 
Compare%% 
!=%%  "
null%%# '
)%%' (
{&& 
return'' 
CHANGE_TYPE'' *
.''* +
CREATED''+ 2
;''2 3
}(( 
else)) 
{** 
return++ 
CHANGE_TYPE++ *
.++* +
INVALID+++ 2
;++2 3
},, 
}-- 
}.. 
}// 	
public11 
CollectObject11 
?11 
Compare11 %
{11& '
get11( +
;11+ ,
set11- 0
;110 1
}112 3
public33 
string33 
?33 
CompareRunId33 #
{33$ %
get33& )
;33) *
set33+ .
;33. /
}330 1
public55 
List55 
<55 
Diff55 
>55 
Diffs55 
{55  !
get55" %
;55% &
set55' *
;55* +
}55, -
=55. /
new550 3
List554 8
<558 9
Diff559 =
>55= >
(55> ?
)55? @
;55@ A
public77 
string77 
Identity77 
{88 	
get99 
{:: 
if;; 
(;; 
Base;; 
is;; 
CollectObject;; )
colObj;;* 0
);;0 1
{<< 
return== 
colObj== !
.==! "
Identity==" *
;==* +
}>> 
else?? 
if?? 
(?? 
Compare??  
is??! #
CollectObject??$ 1
colObj2??2 9
)??9 :
{@@ 
returnAA 
colObj2AA "
.AA" #
IdentityAA# +
;AA+ ,
}BB 
elseCC 
{DD 
returnEE 
stringEE !
.EE! "
EmptyEE" '
;EE' (
}FF 
}GG 
}HH 	
publicJJ 
RESULT_TYPEJJ 

ResultTypeJJ %
{KK 	
getLL 
{MM 
ifNN 
(NN 
BaseNN 
isNN 
CollectObjectNN )
colObjNN* 0
)NN0 1
{OO 
returnPP 
colObjPP !
.PP! "

ResultTypePP" ,
;PP, -
}QQ 
elseRR 
ifRR 
(RR 
CompareRR  
isRR! #
CollectObjectRR$ 1
colObj2RR2 9
)RR9 :
{SS 
returnTT 
colObj2TT "
.TT" #

ResultTypeTT# -
;TT- .
}UU 
elseVV 
{WW 
returnXX 
RESULT_TYPEXX &
.XX& '
UNKNOWNXX' .
;XX. /
}YY 
}ZZ 
}[[ 	
public]] 
List]] 
<]] 
Rule]] 
>]] 
Rules]] 
{]]  !
get]]" %
;]]% &
set]]' *
;]]* +
}]], -
=]]. /
new]]0 3
List]]4 8
<]]8 9
Rule]]9 =
>]]= >
(]]> ?
)]]? @
;]]@ A
public^^ 
string^^ 
AnalysesHash^^ "
{^^# $
get^^% (
;^^( )
set^^* -
;^^- .
}^^/ 0
=^^1 2
string^^3 9
.^^9 :
Empty^^: ?
;^^? @
public`` 
bool``  
ShouldSerializeDiffs`` (
(``( )
)``) *
{aa 	
returnbb 
Diffsbb 
?bb 
.bb 
Countbb 
>bb  !
$numbb" #
;bb# $
}cc 	
publicee 
boolee  
ShouldSerializeRulesee (
(ee( )
)ee) *
{ff 	
returngg 
Rulesgg 
?gg 
.gg 
Countgg 
>gg  !
$numgg" #
;gg# $
}hh 	
}ii 
}jj ≠1
QD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\CryptographicKeyObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{		 
public

 

class

 "
CryptographicKeyObject

 '
:

( )
CollectObject

* 7
{ 
public "
CryptographicKeyObject %
(% &
string& ,
Source- 3
,3 4
TpmAlgId5 =
tpmAlgId> F
)F G
{ 	
this 
. 

ResultType 
= 
Types #
.# $
RESULT_TYPE$ /
./ 0
KEY0 3
;3 4
this 
. 
Source 
= 
Source  
;  !
this 
. 
tpmAlgId 
= 
tpmAlgId $
;$ %
} 	
public 
override 
string 
Identity '
{ 	
get 
{ 
return 
Source 
; 
} 
} 	
public 
RsaKeyDetails 
? 

RsaDetails (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
string 
Source 
{ 
get "
;" #
set$ '
;' (
}) *
public 
TpmAlgId 
tpmAlgId  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
TpmAlgId1 9
.9 :
Null: >
;> ?
} 
public!! 

class!! 
KeyDetailObject!!  
{"" 
}## 
public%% 

class%% 
RsaKeyDetails%% 
:%%  
KeyDetailObject%%! 0
{&& 
public'' 
RsaKeyDetails'' 
('' 
byte'' !
[''! "
]''" #
modulus''$ +
,''+ ,
byte''- 1
[''1 2
]''2 3
d''4 5
,''5 6
byte''7 ;
[''; <
]''< =
?''= >
p''? @
=''A B
null''C G
,''G H
byte''I M
[''M N
]''N O
?''O P
q''Q R
=''S T
null''U Y
)''Y Z
{(( 	
var)) 

parameters)) 
=)) 
new))  
RSAParameters))! .
()). /
)))/ 0
{** 
D++ 
=++ 
d++ 
,++ 
Modulus,, 
=,, 
modulus,, !
}-- 
;-- 
if// 
(// 
p// 
!=// 
null// 
&&// 
q// 
!=// !
null//" &
)//& '
{00 

parameters11 
.11 
P11 
=11 
p11  
;11  !

parameters22 
.22 
Q22 
=22 
q22  
;22  !
ContainsPrivate33 
=33  !
true33" &
;33& '
}44 
rsa;; 
=;; 
RSA;; 
.;; 
Create;; 
(;; 

parameters;; '
);;' (
;;;( )
}<< 	
[>> 	
JsonConstructor>>	 
]>> 
public?? 
RsaKeyDetails?? 
(?? 
string?? #
???# $
PublicString??% 1
=??2 3
null??4 8
,??8 9
string??: @
???@ A

FullString??B L
=??M N
null??O S
)??S T
{@@ 	
rsaAA 
=AA 
RSAAA 
.AA 
CreateAA 
(AA 
)AA 
;AA 
ifBB 
(BB 

FullStringBB 
!=BB 
nullBB "
)BB" #
{CC 
rsaDD 
.DD 
ImportRSAPrivateKeyDD '
(DD' (
ConvertDD( /
.DD/ 0
FromBase64StringDD0 @
(DD@ A

FullStringDDA K
)DDK L
,DDL M
outDDN Q
_DDR S
)DDS T
;DDT U
}EE 
elseFF 
ifFF 
(FF 
PublicStringFF !
!=FF" $
nullFF% )
)FF) *
{GG 
rsaHH 
.HH 
ImportRSAPublicKeyHH &
(HH& '
ConvertHH' .
.HH. /
FromBase64StringHH/ ?
(HH? @
PublicStringHH@ L
)HHL M
,HHM N
outHHO R
_HHS T
)HHT U
;HHU V
}II 
}JJ 	
publicLL 
stringLL 
?LL 

FullStringLL !
{MM 	
getNN 
{OO 
ifPP 
(PP 
ContainsPrivatePP #
)PP# $
{QQ 
returnRR 
ConvertRR "
.RR" #
ToBase64StringRR# 1
(RR1 2
rsaRR2 5
.RR5 6
ExportRSAPrivateKeyRR6 I
(RRI J
)RRJ K
)RRK L
;RRL M
}SS 
returnTT 
nullTT 
;TT 
}UU 
}VV 	
publicXX 
stringXX 
PublicStringXX "
{YY 	
getZZ 
{[[ 
return\\ 
Convert\\ 
.\\ 
ToBase64String\\ -
(\\- .
rsa\\. 1
.\\1 2
ExportRSAPublicKey\\2 D
(\\D E
)\\E F
)\\F G
;\\G H
}]] 
}^^ 	
public`` 
bool`` %
ShouldSerializeFullString`` -
(``- .
)``. /
{aa 	
returnbb 
ContainsPrivatebb "
;bb" #
}cc 	
publicee 
boolee '
ShouldSerializePublicStringee /
(ee/ 0
)ee0 1
{ff 	
returngg 
!gg 
ContainsPrivategg #
;gg# $
}hh 	
privatejj 
booljj 
ContainsPrivatejj $
=jj% &
falsejj' ,
;jj, -
privatekk 
RSAkk 
rsakk 
;kk 
}ll 
}mm 
BD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\DataRun.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
DataRunListModel !
{ 
public 
IEnumerable 
< 
DataRunModel '
>' (
?( )
MonitorRuns* 5
{6 7
get8 ;
;; <
set= @
;@ A
}B C
public		 
IEnumerable		 
<		 
DataRunModel		 '
>		' (
?		( )
Runs		* .
{		/ 0
get		1 4
;		4 5
set		6 9
;		9 :
}		; <
public

 
string

 
?

 
SelectedBaseRunId

 (
{

) *
get

+ .
;

. /
set

0 3
;

3 4
}

5 6
public 
string 
?  
SelectedCompareRunId +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
string 
?  
SelectedMonitorRunId +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
} 
public 

class 
DataRunModel 
{ 
public 
DataRunModel 
( 
string "
KeyIn# (
,( )
string* 0
TextIn1 7
)7 8
{ 	
Key 
= 
KeyIn 
; 
Text 
= 
TextIn 
; 
} 	
public 
string 
Key 
{ 
get 
;  
}! "
public 
string 
Text 
{ 
get  
;  !
}" #
} 
} é

?D:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\Diff.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
Diff 
{ 
public 
Diff 
( 
string 
FieldIn "
," #
object$ *
?* +
BeforeIn, 4
=5 6
null7 ;
,; <
object= C
?C D
AfterInE L
=M N
nullO S
)S T
{ 	
Field 
= 
FieldIn 
; 
Before		 
=		 
BeforeIn		 
;		 
After

 
=

 
AfterIn

 
;

 
} 	
public 
object 
? 
After 
{ 
get "
;" #
}$ %
public 
object 
? 
Before 
{ 
get  #
;# $
}% &
public 
string 
Field 
{ 
get !
;! "
}# $
} 
} Å+
GD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\DriverObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
DriverObject 
: 
CollectObject  -
{		 
public

 
DriverObject

 
(

 
string

 "
Name

# '
)

' (
{ 	
this 
. 
Name 
= 
Name 
; 

ResultType 
= 
RESULT_TYPE $
.$ %
DRIVER% +
;+ ,
} 	
public 
bool 
? 
AcceptPause  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
? 

AcceptStop 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Address 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Architecture #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
long 
? 
BSS 
{ 
get 
; 
set  #
;# $
}% &
public 
long 
? 
Code 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
? 
Description "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
DisplayName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 

DriverType !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
override 
string 
Identity '
{ 	
get 
{ 
return 
Name 
; 
} 
}   	
public"" 
int"" 
?"" 
Index"" 
{"" 
get"" 
;""  
set""! $
;""$ %
}""& '
public## 
long## 
?## 
Init## 
{## 
get## 
;##  
set##! $
;##$ %
}##& '
public$$ 
DateTime$$ 
?$$ 
LinkDate$$ !
{$$" #
get$$$ '
;$$' (
set$$) ,
;$$, -
}$$. /
public%% 
List%% 
<%% 
string%% 
>%% 
?%% 
LinkedAgainst%% *
{%%+ ,
get%%- 0
;%%0 1
set%%2 5
;%%5 6
}%%7 8
public&& 
string&& 
Name&& 
{&& 
get&&  
;&&  !
set&&" %
;&&% &
}&&' (
public'' 
long'' 
?'' 
	PagedPool'' 
{''  
get''! $
;''$ %
set''& )
;'') *
}''+ ,
public(( 
string(( 
?(( 
Path(( 
{(( 
get(( !
;((! "
set((# &
;((& '
}((( )
public)) 

Dictionary)) 
<)) 
string))  
,))  !
string))" (
>))( )
?))) *

Properties))+ 5
{))6 7
get))8 ;
;)); <
set))= @
;))@ A
}))B C
public** 
int** 
?** 
Refs** 
{** 
get** 
;** 
set**  #
;**# $
}**% &
public++ 
	Signature++ 
?++ 
	Signature++ #
{++$ %
get++& )
;++) *
set+++ .
;++. /
}++0 1
public,, 
string,, 
?,, 
Size,, 
{,, 
get,, !
;,,! "
set,,# &
;,,& '
},,( )
public.. 
string.. 
?.. 
	StartMode..  
{..! "
get..# &
;..& '
set..( +
;..+ ,
}..- .
public// 
string// 
?// 
State// 
{// 
get// "
;//" #
set//$ '
;//' (
}//) *
public00 
string00 
?00 
Status00 
{00 
get00  #
;00# $
set00% (
;00( )
}00* +
public11 
string11 
?11 
UUID11 
{11 
get11 !
;11! "
set11# &
;11& '
}11( )
public22 
string22 
?22 
Version22 
{22  
get22! $
;22$ %
set22& )
;22) *
}22+ ,
public33 
string33 
?33 
Wired33 
{33 
get33 "
;33" #
set33$ '
;33' (
}33) *
}44 
}55 ÿ
ID:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\EventLogObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
EventLogObject 
:  !
CollectObject" /
{ 
public		 
EventLogObject		 
(		 
string		 $
Event		% *
)		* +
{

 	
this 
. 
Event 
= 
Event 
; 

ResultType 
= 
Types 
. 
RESULT_TYPE *
.* +
LOG+ .
;. /
Data 
= 
new 
List 
< 
string "
>" #
(# $
)$ %
;% &
} 	
public 
List 
< 
string 
> 
? 
Data !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Event 
{ 
get !
;! "
set# &
;& '
}( )
public 
override 
string 
Identity '
{ 	
get 
{   
return!! 
Event!! 
;!! 
}"" 
}## 	
public(( 
string(( 
?(( 
Level(( 
{(( 
get(( "
;((" #
set(($ '
;((' (
}(() *
public-- 
string-- 
?-- 
Process-- 
{--  
get--! $
;--$ %
set--& )
;--) *
}--+ ,
public22 
string22 
?22 
Source22 
{22 
get22  #
;22# $
set22% (
;22( )
}22* +
public77 
string77 
?77 
Summary77 
{77  
get77! $
;77$ %
set77& )
;77) *
}77+ ,
public<< 
DateTime<< 
?<< 
	Timestamp<< "
{<<# $
get<<% (
;<<( )
set<<* -
;<<- .
}<</ 0
}== 
}>> ¸

KD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\FileMonitorEvent.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
FileMonitorEvent !
{ 
public 
FileMonitorEvent 
(  
string  &
PathIn' -
)- .
{		 	
Path

 
=

 
PathIn

 
;

 
} 	
public 
CHANGE_TYPE 

ChangeType %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
OldName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
OldPath 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Path 
{ 
get  
;  !
set" %
;% &
}' (
} 
} •
LD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\FileMonitorObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
FileMonitorObject "
:# $
MonitorObject% 2
{ 
public		 
FileMonitorObject		  
(		  !
string		! '
PathIn		( .
)		. /
{

 	
Path 
= 
PathIn 
; 

ResultType 
= 
RESULT_TYPE $
.$ %
FILEMONITOR% 0
;0 1
} 	
public 
string 
? 
ExtendedResults &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
FileSystemObject 
?  
FileSystemObject! 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
public 
override 
string 
Identity '
{ 	
get 
{ 
return 
Path 
; 
} 
} 	
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
public 
NotifyFilters 
? 
NotifyFilters +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
string 
? 
OldName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
OldPath 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Path 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
	Timestamp  
{! "
get# &
;& '
set( +
;+ ,
}- .
}   
}!! ™
RD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\FileSystemMonitorResult.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class #
FileSystemMonitorResult (
{ 
public #
FileSystemMonitorResult &
(& '
FileSystemEventArgs' :
evtIn; @
)@ A
{		 	
evt

 
=

 
evtIn

 
;

 
} 	
public 
FileSystemEventArgs "
evt# &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
NotifyFilters 
filter #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
} ô+
KD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\FileSystemObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
FileSystemObject !
:" #
CollectObject$ 1
{		 
public

 
FileSystemObject

 
(

  
string

  &
Path

' +
)

+ ,
{ 	
this 
. 
Path 
= 
Path 
; 

ResultType 
= 
RESULT_TYPE $
.$ %
FILE% )
;) *
} 	
public 
FileSystemObject 
(  
)  !
{ 	
Path 
= 
string 
. 
Empty 
;  

ResultType 
= 
RESULT_TYPE $
.$ %
FILE% )
;) *
} 	
public 
List 
< 
DLLCHARACTERISTICS &
>& '
?' (
Characteristics) 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
string 
? 
ContentHash "
{# $
get% (
;( )
set* -
;- .
}/ 0
public## 
DateTime## 
Created## 
{##  !
get##" %
;##% &
set##' *
;##* +
}##, -
public(( 
string(( 
?(( 
FileType(( 
{((  !
get((" %
;((% &
set((' *
;((* +
}((, -
public-- 
string-- 
?-- 
Group-- 
{-- 
get-- "
;--" #
set--$ '
;--' (
}--) *
public22 
override22 
string22 
Identity22 '
{33 	
get44 
{55 
return66 
Path66 
;66 
}77 
}88 	
public== 
bool== 
?== 
IsDirectory==  
{==! "
get==# &
;==& '
set==( +
;==+ ,
}==- .
publicBB 
boolBB 
?BB 
IsExecutableBB !
{BB" #
getBB$ '
;BB' (
setBB) ,
;BB, -
}BB. /
publicGG 
boolGG 
?GG 
IsLinkGG 
{GG 
getGG !
;GG! "
setGG# &
;GG& '
}GG( )
publicLL 
DateTimeLL 
LastModifiedLL $
{LL% &
getLL' *
;LL* +
setLL, /
;LL/ 0
}LL1 2
publicQQ 
MacSignatureQQ 
?QQ 
MacSignatureStatusQQ /
{QQ0 1
getQQ2 5
;QQ5 6
setQQ7 :
;QQ: ;
}QQ< =
publicVV 
stringVV 
?VV 
OwnerVV 
{VV 
getVV "
;VV" #
setVV$ '
;VV' (
}VV) *
public[[ 
string[[ 
Path[[ 
{[[ 
get[[  
;[[  !
set[[" %
;[[% &
}[[' (
public`` 

Dictionary`` 
<`` 
string``  
,``  !
string``" (
>``( )
?``) *
Permissions``+ 6
{``7 8
get``9 <
;``< =
set``> A
;``A B
}``C D
publicee 
stringee 
?ee 
PermissionsStringee (
{ee) *
getee+ .
;ee. /
setee0 3
;ee3 4
}ee5 6
publicjj 
booljj 
?jj 
SetGidjj 
{jj 
getjj !
;jj! "
setjj# &
;jj& '
}jj( )
publicoo 
booloo 
?oo 
SetUidoo 
{oo 
getoo !
;oo! "
setoo# &
;oo& '
}oo( )
publictt 
	Signaturett 
?tt 
SignatureStatustt )
{tt* +
gettt, /
;tt/ 0
settt1 4
;tt4 5
}tt6 7
publicyy 
longyy 
?yy 
Sizeyy 
{yy 
getyy 
;yy  
setyy! $
;yy$ %
}yy& '
public{{ 
long{{ 
?{{ 

SizeOnDisk{{ 
{{{  !
get{{" %
;{{% &
internal{{' /
set{{0 3
;{{3 4
}{{5 6
public
ÄÄ 
string
ÄÄ 
?
ÄÄ 
Target
ÄÄ 
{
ÄÄ 
get
ÄÄ  #
;
ÄÄ# $
set
ÄÄ% (
;
ÄÄ( )
}
ÄÄ* +
public
ÇÇ 
bool
ÇÇ ,
ShouldSerializeCharacteristics
ÇÇ 2
(
ÇÇ2 3
)
ÇÇ3 4
{
ÉÉ 	
return
ÑÑ 
Characteristics
ÑÑ "
?
ÑÑ" #
.
ÑÑ# $
Count
ÑÑ$ )
>
ÑÑ* +
$num
ÑÑ, -
;
ÑÑ- .
}
ÖÖ 	
public
áá 
bool
áá (
ShouldSerializePermissions
áá .
(
áá. /
)
áá/ 0
{
àà 	
return
ââ 
Permissions
ââ 
?
ââ 
.
ââ  
Count
ââ  %
>
ââ& '
$num
ââ( )
;
ââ) *
}
ää 	
}
ãã 
}åå ˜ 
ID:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\FirewallObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
FirewallObject 
:  !
CollectObject" /
{		 
public

 
FirewallObject

 
(

 
string

 $
Name

% )
)

) *
{ 	

ResultType 
= 
RESULT_TYPE $
.$ %
FIREWALL% -
;- .
this 
. 
Name 
= 
Name 
; 
} 	
public 
FirewallAction 
? 
Action %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
? 
ApplicationName &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
FirewallDirection  
?  !
	Direction" +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public"" 
string"" 
?"" 
FriendlyName"" #
{""$ %
get""& )
;"") *
set""+ .
;"". /
}""0 1
public'' 
override'' 
string'' 
Identity'' '
{(( 	
get)) 
{** 
return++ 
$"++ 
{++ 
FriendlyName++ &
}++& '
$str++' *
{++* +
	Direction+++ 4
}++4 5
$str++5 8
{++8 9
Protocol++9 A
}++A B
$str++B E
{++E F
ApplicationName++F U
}++U V
$str++V Y
{++Y Z
Profiles++Z b
}++b c
$str++c f
{++f g
Name++g k
}++k l
"++l m
;++m n
},, 
}-- 	
public22 
bool22 
?22 
IsEnable22 
{22 
get22  #
;22# $
set22% (
;22( )
}22* +
public77 
List77 
<77 
string77 
>77 
?77 
LocalAddresses77 +
{77, -
get77. 1
;771 2
set773 6
;776 7
}778 9
public<< 
List<< 
<<< 
string<< 
><< 
?<< 

LocalPorts<< '
{<<( )
get<<* -
;<<- .
set<</ 2
;<<2 3
}<<4 5
publicAA 
FirewallPortTypeAA 
?AA  
LocalPortTypeAA! .
{AA/ 0
getAA1 4
;AA4 5
setAA6 9
;AA9 :
}AA; <
publicFF 
stringFF 
NameFF 
{FF 
getFF  
;FF  !
setFF" %
;FF% &
}FF' (
publicKK 
FirewallProfilesKK 
?KK  
ProfilesKK! )
{KK* +
getKK, /
;KK/ 0
setKK1 4
;KK4 5
}KK6 7
publicPP 
stringPP 
?PP 
ProtocolPP 
{PP  !
getPP" %
;PP% &
setPP' *
;PP* +
}PP, -
publicUU 
ListUU 
<UU 
stringUU 
>UU 
?UU 
RemoteAddressesUU ,
{UU- .
getUU/ 2
;UU2 3
setUU4 7
;UU7 8
}UU9 :
publicZZ 
ListZZ 
<ZZ 
stringZZ 
>ZZ 
?ZZ 
RemotePortsZZ (
{ZZ) *
getZZ+ .
;ZZ. /
setZZ0 3
;ZZ3 4
}ZZ5 6
public__ 
FirewallScope__ 
?__ 
Scope__ #
{__$ %
get__& )
;__) *
set__+ .
;__. /
}__0 1
publicdd 
stringdd 
?dd 
ServiceNamedd "
{dd# $
getdd% (
;dd( )
setdd* -
;dd- .
}dd/ 0
}ee 
}ff Õ
GD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\MacSignature.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
MacSignature 
{ 
public## 
List## 
<## 
string## 
>## 
?## 
Authorities## (
{##) *
get##+ .
;##. /
set##0 3
;##3 4
}##5 6
public$$ 
string$$ 
?$$ 
CandidateCDHashFull$$ *
{$$+ ,
get$$- 0
;$$0 1
set$$2 5
;$$5 6
}$$7 8
public%% 
string%% 
?%% 
	CMSDigest%%  
{%%! "
get%%# &
;%%& '
set%%( +
;%%+ ,
}%%- .
public&& 
string&& 
?&& 
HashChoices&& "
{&&# $
get&&% (
;&&( )
set&&* -
;&&- .
}&&/ 0
public'' 
string'' 
?'' 
HashType'' 
{''  !
get''" %
;''% &
set''' *
;''* +
}'', -
public(( 
string(( 
?(( 
TeamIdentifier(( %
{((& '
get((( +
;((+ ,
set((- 0
;((0 1
}((2 3
public)) 
DateTime)) 
	Timestamp)) !
{))" #
get))$ '
;))' (
set))) ,
;)), -
})). /
}** 
}++ …
HD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\MonitorObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public		 

abstract		 
class		 
MonitorObject		 '
:		( )
CollectObject		* 7
{

 
public 
CHANGE_TYPE 

ChangeType %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
} 
ID:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\OpenPortObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
OpenPortObject 
:  !
CollectObject" /
{ 
[		 	
JsonConstructor			 
]		 
public

 
OpenPortObject

 
(

 
int

 !
Port

" &
,

& '
	TRANSPORT

( 1
Type

2 6
)

6 7
:

8 9
this

: >
(

> ?
Port

? C
,

C D
Type

E I
,

I J
ADDRESS_FAMILY

K Y
.

Y Z
Unspecified

Z e
)

e f
{

g h
}

i j
public 
OpenPortObject 
( 
int !
Port" &
,& '
	TRANSPORT( 1
Type2 6
,6 7
ADDRESS_FAMILY8 F
AddressFamilyG T
)T U
{ 	

ResultType 
= 
RESULT_TYPE $
.$ %
PORT% )
;) *
this 
. 
Port 
= 
Port 
; 
this 
. 
Type 
= 
Type 
; 
this 
. 
AddressFamily 
=  
AddressFamily! .
;. /
} 	
public 
string 
? 
Address 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
ADDRESS_FAMILY 
AddressFamily +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
override 
string 
Identity '
{ 	
get   
{!! 
return"" 
$""" 
{"" 
Address"" !
}""! "
$str""" #
{""# $
AddressFamily""$ 1
}""1 2
$str""2 3
{""3 4
Type""4 8
}""8 9
$str""9 :
{"": ;
Port""; ?
}""? @
$str""@ A
{""A B
ProcessName""B M
}""M N
"""N O
;""O P
}## 
}$$ 	
public)) 
int)) 
Port)) 
{)) 
get)) 
;)) 
set)) "
;))" #
}))$ %
public++ 
string++ 
?++ 
ProcessName++ "
{++# $
get++% (
;++( )
set++* -
;++- .
}++/ 0
public00 
	TRANSPORT00 
Type00 
{00 
get00  #
;00# $
set00% (
;00( )
}00* +
}11 
}22 Ê
RD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\OutputFileMonitorResult.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class #
OutputFileMonitorResult (
{ 
public #
OutputFileMonitorResult &
(& '
string' -
PathIn. 4
)4 5
{		 	
Path

 
=

 
PathIn

 
;

 
} 	
public 
CHANGE_TYPE 

ChangeType %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
OldName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
OldPath 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Path 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
RowKey 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
	Timestamp  
{! "
get# &
;& '
set( +
;+ ,
}- .
} 
} ≈
ND:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\ProcessModuleObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
ProcessModuleObject $
{ 
public		 
ProcessModuleObject		 "
(		" #
string		# )
?		) *
FileName		+ 3
,		3 4
string		5 ;
?		; <

ModuleName		= G
,		G H'
SerializableFileVersionInfo		I d
?		d e
FileVersionInfo		f u
)		u v
{

 	
this 
. 
FileName 
= 
FileName $
;$ %
this 
. 

ModuleName 
= 

ModuleName (
;( )
this 
. 
FileVersionInfo  
=! "
FileVersionInfo# 2
;2 3
} 	
public 
ProcessModuleObject "
(" #
)# $
{% &
}' (
public 
string 
? 
FileName 
{  !
get" %
;% &
set' *
;* +
}, -
public '
SerializableFileVersionInfo *
?* +
FileVersionInfo, ;
{< =
get> A
;A B
setC F
;F G
}H I
public 
string 
? 

ModuleName !
{" #
get$ '
;' (
set) ,
;, -
}. /
internal 
static 
ProcessModuleObject +
FromProcessModule, =
(= >
ProcessModule> K

mainModuleL V
)V W
{ 	
return 
new 
ProcessModuleObject *
(* +

mainModule+ 5
.5 6
FileName6 >
,> ?

mainModule@ J
.J K

ModuleNameK U
,U V'
SerializableFileVersionInfoW r
.r s 
FromFileVersionInfo	s Ü
(
Ü á

mainModule
á ë
.
ë í
FileVersionInfo
í °
)
° ¢
)
¢ £
;
£ §
} 	
internal 
static 
List 
< 
ProcessModuleObject 0
>0 1'
FromProcessModuleCollection2 M
(M N#
ProcessModuleCollectionN e
modulesf m
)m n
{ 	
var 
output 
= 
new 
List !
<! "
ProcessModuleObject" 5
>5 6
(6 7
)7 8
;8 9
foreach 
( 
var 
processModule &
in' )
modules* 1
)1 2
{ 
if   
(   
processModule   !
is  " $
ProcessModule  % 2
pm  3 5
)  5 6
output!! 
.!! 
Add!! 
(!! 
FromProcessModule!! 0
(!!0 1
pm!!1 3
)!!3 4
)!!4 5
;!!5 6
}"" 
return## 
output## 
;## 
}$$ 	
}%% 
}&& ¶C
HD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\ProcessObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public		 

class		 
ProcessObject		 
:		  
CollectObject		! .
{

 
public 
ProcessObject 
( 
int  
Id! #
,# $
string% +
ProcessName, 7
)7 8
{ 	
this 
. 
Id 
= 
Id 
; 
this 
. 
ProcessName 
= 
ProcessName *
;* +

ResultType 
= 
Types 
. 
RESULT_TYPE *
.* +
PROCESS+ 2
;2 3
} 	
public 
int 
BasePriority 
{  !
get" %
;% &
set' *
;* +
}, -
public 
bool 
	HasExited 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
Id 
{ 
get 
; 
} 
public 
override 
string 
Identity '
{ 	
get 
{ 
return 
$" 
{ 
Id 
} 
$str 
{ 
ProcessName *
}* +
"+ ,
;, -
}   
}!! 	
public## 
ProcessModuleObject## "
?##" #

MainModule##$ .
{##/ 0
get##1 4
;##4 5
set##6 9
;##9 :
}##; <
public%% 
List%% 
<%% 
ProcessModuleObject%% '
>%%' (
Modules%%) 0
{%%1 2
get%%3 6
;%%6 7
set%%8 ;
;%%; <
}%%= >
=%%? @
new%%A D
List%%E I
<%%I J
ProcessModuleObject%%J ]
>%%] ^
(%%^ _
)%%_ `
;%%` a
public''  
ProcessPriorityClass'' #
PriorityClass''$ 1
{''2 3
get''4 7
;''7 8
set''9 <
;''< =
}''> ?
public)) 
string)) 
ProcessName)) !
{))" #
get))$ '
;))' (
set))) ,
;)), -
})). /
public++ 
DateTime++ 
	StartTime++ !
{++" #
get++$ '
;++' (
set++) ,
;++, -
}++. /
public-- 
static-- 
ProcessObject-- #
?--# $
FromProcess--% 0
(--0 1
Process--1 8
process--9 @
)--@ A
{.. 	
if// 
(// 
process// 
==// 
null// 
)//  
return//! '
null//( ,
;//, -
var00 
obj00 
=00 
new00 
ProcessObject00 '
(00' (
process00( /
.00/ 0
Id000 2
,002 3
process004 ;
.00; <
ProcessName00< G
)00G H
;00H I
try22 
{33 
obj44 
.44 
BasePriority44  
=44! "
process44# *
.44* +
BasePriority44+ 7
;447 8
}55 
catch66 
(66 
	Exception66 
e66 
)66 
{77 
Log88 
.88 
Verbose88 
(88 
$"88 
$str88 @
{88@ A
obj88A D
.88D E
ProcessName88E P
}88P Q
$str88Q S
{88S T
e88T U
.88U V
GetType88V ]
(88] ^
)88^ _
}88_ `
$str88` a
{88a b
e88b c
.88c d
Message88d k
}88k l
$str88l m
"88m n
)88n o
;88o p
}99 
try;; 
{<< 
obj== 
.== 
PriorityClass== !
===" #
process==$ +
.==+ ,
PriorityClass==, 9
;==9 :
}>> 
catch?? 
(?? 
	Exception?? 
e?? 
)?? 
{@@ 
LogAA 
.AA 
VerboseAA 
(AA 
$"AA 
$strAA A
{AAA B
objAAB E
.AAE F
ProcessNameAAF Q
}AAQ R
$strAAR T
{AAT U
eAAU V
.AAV W
GetTypeAAW ^
(AA^ _
)AA_ `
}AA` a
$strAAa b
{AAb c
eAAc d
.AAd e
MessageAAe l
}AAl m
$strAAm n
"AAn o
)AAo p
;AAp q
}BB 
tryDD 
{EE 
objFF 
.FF 
	StartTimeFF 
=FF 
processFF  '
.FF' (
	StartTimeFF( 1
;FF1 2
}GG 
catchHH 
(HH 
	ExceptionHH 
eHH 
)HH 
{II 
LogJJ 
.JJ 
VerboseJJ 
(JJ 
$"JJ 
$strJJ =
{JJ= >
objJJ> A
.JJA B
ProcessNameJJB M
}JJM N
$strJJN P
{JJP Q
eJJQ R
.JJR S
GetTypeJJS Z
(JJZ [
)JJ[ \
}JJ\ ]
$strJJ] ^
{JJ^ _
eJJ_ `
.JJ` a
MessageJJa h
}JJh i
$strJJi j
"JJj k
)JJk l
;JJl m
}KK 
tryMM 
{NN 
objOO 
.OO 
	HasExitedOO 
=OO 
processOO  '
.OO' (
	HasExitedOO( 1
;OO1 2
}PP 
catchQQ 
(QQ 
	ExceptionQQ 
eQQ 
)QQ 
{RR 
LogSS 
.SS 
VerboseSS 
(SS 
$"SS 
$strSS =
{SS= >
objSS> A
.SSA B
ProcessNameSSB M
}SSM N
$strSSN P
{SSP Q
eSSQ R
.SSR S
GetTypeSSS Z
(SSZ [
)SS[ \
}SS\ ]
$strSS] ^
{SS^ _
eSS_ `
.SS` a
MessageSSa h
}SSh i
$strSSi j
"SSj k
)SSk l
;SSl m
}TT 
tryVV 
{WW 
objXX 
.XX 
ModulesXX 
=XX 
ProcessModuleObjectXX 1
.XX1 2'
FromProcessModuleCollectionXX2 M
(XXM N
processXXN U
.XXU V
ModulesXXV ]
)XX] ^
;XX^ _
}YY 
catchZZ 
(ZZ 
	ExceptionZZ 
eZZ 
)ZZ 
{[[ 
Log\\ 
.\\ 
Verbose\\ 
(\\ 
$"\\ 
$str\\ ;
{\\; <
obj\\< ?
.\\? @
ProcessName\\@ K
}\\K L
$str\\L N
{\\N O
e\\O P
.\\P Q
GetType\\Q X
(\\X Y
)\\Y Z
}\\Z [
$str\\[ \
{\\\ ]
e\\] ^
.\\^ _
Message\\_ f
}\\f g
$str\\g h
"\\h i
)\\i j
;\\j k
}]] 
try__ 
{`` 
ifaa 
(aa 
processaa 
.aa 

MainModuleaa &
isaa' )
{aa* +
}aa, -
)aa- .
{bb 
objcc 
.cc 

MainModulecc "
=cc# $
ProcessModuleObjectcc% 8
.cc8 9
FromProcessModulecc9 J
(ccJ K
processccK R
.ccR S

MainModuleccS ]
)cc] ^
;cc^ _
}dd 
}ee 
catchff 
(ff 
	Exceptionff 
eff 
)ff 
{gg 
Loghh 
.hh 
Verbosehh 
(hh 
$"hh 
$strhh >
{hh> ?
objhh? B
.hhB C
ProcessNamehhC N
}hhN O
$strhhO Q
{hhQ R
ehhR S
.hhS T
GetTypehhT [
(hh[ \
)hh\ ]
}hh] ^
$strhh^ _
{hh_ `
ehh` a
.hha b
Messagehhb i
}hhi j
$strhhj k
"hhk l
)hhl m
;hhm n
}ii 
returnkk 
objkk 
;kk 
}ll 	
}mm 
}nn ∞@
ID:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\RegistryObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{		 
public

 

class

 
RegistryObject

 
:

  !
CollectObject

" /
{ 
public 
RegistryObject 
( 
string $
Key% (
,( )
RegistryView* 6
View7 ;
); <
{ 	

ResultType 
= 
RESULT_TYPE $
.$ %
REGISTRY% -
;- .
this 
. 
View 
= 
View 
; 
this 
. 
Key 
= 
Key 
; 
} 	
public 
override 
string 
Identity '
{ 	
get 
{ 
return 
$" 
{ 
View 
} 
$str  
{  !
Key! $
}$ %
"% &
;& '
} 
} 	
public 
string 
Key 
{ 
get 
;  
set! $
;$ %
}& '
public   

Dictionary   
<   
string    
,    !
List  " &
<  & '
string  ' -
>  - .
>  . /
Permissions  0 ;
{  < =
get  > A
;  A B
set  C F
;  F G
}  H I
=  J K
new  L O

Dictionary  P Z
<  Z [
string  [ a
,  a b
List  c g
<  g h
string  h n
>  n o
>  o p
(  p q
)  q r
;  r s
public!! 
string!! 
?!! 
PermissionsString!! (
{!!) *
get!!+ .
;!!. /
set!!0 3
;!!3 4
}!!5 6
public## 
int## 
SubkeyCount## 
{$$ 	
get%% 
{%% 
return%% 
Subkeys%%  
?%%  !
.%%! "
Count%%" '
??%%( *
$num%%+ ,
;%%, -
}%%. /
}&& 	
public(( 
List(( 
<(( 
string(( 
>(( 
?(( 
Subkeys(( $
{((% &
get((' *
;((* +
set((, /
;((/ 0
}((1 2
public** 
int** 

ValueCount** 
{++ 	
get,, 
{,, 
return,, 
Values,, 
?,,  
.,,  !
Count,,! &
??,,' )
$num,,* +
;,,+ ,
},,- .
}-- 	
public// 

Dictionary// 
<// 
string//  
,//  !
string//" (
>//( )
?//) *
Values//+ 1
{//2 3
get//4 7
;//7 8
set//9 <
;//< =
}//> ?
public00 
RegistryView00 
View00  
{00! "
get00# &
;00& '
private00( /
set000 3
;003 4
}005 6
public22 
static22 

Dictionary22  
<22  !
string22! '
,22' (
string22) /
>22/ 0
	GetValues221 :
(22: ;
RegistryKey22; F
key22G J
)22J K
{33 	
if44 
(44 
key44 
is44 
null44 
)44 
{55 
throw66 
new66 !
ArgumentNullException66 /
(66/ 0
nameof660 6
(666 7
key667 :
)66: ;
)66; <
;66< =
}77 

Dictionary88 
<88 
string88 
,88 
string88 %
>88% &
values88' -
=88. /
new880 3

Dictionary884 >
<88> ?
string88? E
,88E F
string88G M
>88M N
(88N O
)88O P
;88P Q
if:: 
(:: 
!:: 
RuntimeInformation:: #
.::# $
IsOSPlatform::$ 0
(::0 1

OSPlatform::1 ;
.::; <
Windows::< C
)::C D
)::D E
{;; 
return<< 
values<< 
;<< 
}== 
foreach?? 
(?? 
var?? 
value?? 
in?? !
key??" %
.??% &
GetValueNames??& 3
(??3 4
)??4 5
)??5 6
{@@ 
RegistryValueKindAA !
rvkAA" %
=AA& '
keyAA( +
.AA+ ,
GetValueKindAA, 8
(AA8 9
valueAA9 >
)AA> ?
;AA? @
stringBB 
strBB 
;BB 
switchDD 
(DD 
rvkDD 
)DD 
{EE 
caseFF 
RegistryValueKindFF *
.FF* +
MultiStringFF+ 6
:FF6 7
strGG 
=GG 
stringGG $
.GG$ %
JoinGG% )
(GG) *
EnvironmentGG* 5
.GG5 6
NewLineGG6 =
,GG= >
(GG? @
stringGG@ F
[GGF G
]GGG H
?GGH I
)GGI J
keyGGJ M
.GGM N
GetValueGGN V
(GGV W
valueGGW \
)GG\ ]
??GG^ `
newGGa d
stringGGe k
[GGk l
]GGl m
{GGn o
}GGp q
)GGq r
;GGr s
breakHH 
;HH 
caseJJ 
RegistryValueKindJJ *
.JJ* +
BinaryJJ+ 1
:JJ1 2
strKK 
=KK 
ConvertKK %
.KK% &
ToBase64StringKK& 4
(KK4 5
(KK5 6
byteKK6 :
[KK: ;
]KK; <
?KK< =
)KK= >
keyKK> A
.KKA B
GetValueKKB J
(KKJ K
valueKKK P
)KKP Q
??KKR T
newKKU X
byteKKY ]
[KK] ^
]KK^ _
{KK` a
}KKb c
)KKc d
;KKd e
breakLL 
;LL 
caseNN 
RegistryValueKindNN *
.NN* +
ExpandStringNN+ 7
:NN7 8
caseOO 
RegistryValueKindOO *
.OO* +
StringOO+ 1
:OO1 2
strPP 
=PP 
(PP 
stringPP %
?PP% &
)PP& '
keyPP' *
.PP* +
GetValuePP+ 3
(PP3 4
valuePP4 9
)PP9 :
??PP; =
stringPP> D
.PPD E
EmptyPPE J
;PPJ K
breakQQ 
;QQ 
caseSS 
RegistryValueKindSS *
.SS* +
DWordSS+ 0
:SS0 1
caseTT 
RegistryValueKindTT *
.TT* +
QWordTT+ 0
:TT0 1
defaultUU 
:UU 
strVV 
=VV 
keyVV !
.VV! "
GetValueVV" *
(VV* +
valueVV+ 0
)VV0 1
?VV1 2
.VV2 3
ToStringVV3 ;
(VV; <
)VV< =
??VV> @
stringVVA G
.VVG H
EmptyVVH M
;VVM N
breakWW 
;WW 
}XX 
valuesYY 
.YY 
AddYY 
(YY 
valueYY  
,YY  !
strYY" %
)YY% &
;YY& '
}ZZ 
return[[ 
values[[ 
;[[ 
}\\ 	
public^^ 
void^^ 

AddSubKeys^^ 
(^^ 
string^^ %
[^^% &
]^^& '
	subkeysIn^^( 1
)^^1 2
{__ 	
if`` 
(`` 
Subkeys`` 
==`` 
null`` 
)``  
{aa 
Subkeysbb 
=bb 
newbb 
Listbb "
<bb" #
stringbb# )
>bb) *
(bb* +
)bb+ ,
;bb, -
}cc 
Subkeysdd 
.dd 
AddRangedd 
(dd 
	subkeysIndd &
)dd& '
;dd' (
}ee 	
}ff 
}gg ≠p
CD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\RuleFile.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
RuleFile 
{ 
[ 	
JsonConstructor	 
] 
public 
RuleFile 
( 

Dictionary "
<" #
RESULT_TYPE# .
,. / 
ANALYSIS_RESULT_TYPE0 D
>D E
?E F
DefaultLevelsG T
=U V
nullW [
,[ \
IEnumerable] h
<h i
AsaRulei p
>p q
?q r
Ruless x
=y z
null{ 
,	 Ä
string
Å á
?
á à
Source
â è
=
ê ë
null
í ñ
)
ñ ó
{ 	
this 
. 
DefaultLevels 
=  
DefaultLevels! .
??/ 1
this2 6
.6 7
DefaultLevels7 D
;D E
this 
. 
Rules 
= 
Rules 
?? !
new" %
List& *
<* +
AsaRule+ 2
>2 3
(3 4
)4 5
;5 6
this 
. 
Source 
= 
Source  
;  !
} 	
public"" 
RuleFile"" 
("" 
IEnumerable"" #
<""# $
AsaRule""$ +
>""+ ,
?"", -
Rules"". 3
=""4 5
null""6 :
)"": ;
:""< =
this""> B
(""B C
null""C G
,""G H
Rules""I N
,""N O
null""P T
)""T U
{## 	
}$$ 	
public)) 
RuleFile)) 
()) 
))) 
{** 	
}++ 	
public00 
string00 
?00 
Source00 
{00 
get00  #
;00# $
set00% (
;00( )
}00* +
public55 
IEnumerable55 
<55 
AsaRule55 "
>55" #
Rules55$ )
{55* +
get55, /
;55/ 0
set551 4
;554 5
}556 7
=558 9
new55: =
List55> B
<55B C
AsaRule55C J
>55J K
(55K L
)55L M
;55M N
public:: 

Dictionary:: 
<:: 
RESULT_TYPE:: %
,::% & 
ANALYSIS_RESULT_TYPE::' ;
>::; <
DefaultLevels::= J
{::K L
get::M P
;::P Q
set::R U
;::U V
}::W X
=::Y Z
new::[ ^

Dictionary::_ i
<::i j
RESULT_TYPE::j u
,::u v!
ANALYSIS_RESULT_TYPE	::w ã
>
::ã å
(
::å ç
)
::ç é
{;; 	
{<< 
RESULT_TYPE<< 
.<< 
CERTIFICATE<< %
,<<% & 
ANALYSIS_RESULT_TYPE<<' ;
.<<; <
INFORMATION<<< G
}<<H I
,<<I J
{== 
RESULT_TYPE== 
.== 
FILE== 
,==  
ANALYSIS_RESULT_TYPE==  4
.==4 5
INFORMATION==5 @
}==A B
,==B C
{>> 
RESULT_TYPE>> 
.>> 
PORT>> 
,>>  
ANALYSIS_RESULT_TYPE>>  4
.>>4 5
INFORMATION>>5 @
}>>A B
,>>B C
{?? 
RESULT_TYPE?? 
.?? 
REGISTRY?? "
,??" # 
ANALYSIS_RESULT_TYPE??$ 8
.??8 9
INFORMATION??9 D
}??E F
,??F G
{@@ 
RESULT_TYPE@@ 
.@@ 
SERVICE@@ !
,@@! " 
ANALYSIS_RESULT_TYPE@@# 7
.@@7 8
INFORMATION@@8 C
}@@D E
,@@E F
{AA 
RESULT_TYPEAA 
.AA 
USERAA 
,AA  
ANALYSIS_RESULT_TYPEAA  4
.AA4 5
INFORMATIONAA5 @
}AAA B
,AAB C
{BB 
RESULT_TYPEBB 
.BB 
UNKNOWNBB !
,BB! " 
ANALYSIS_RESULT_TYPEBB# 7
.BB7 8
INFORMATIONBB8 C
}BBD E
,BBE F
{CC 
RESULT_TYPECC 
.CC 
GROUPCC 
,CC   
ANALYSIS_RESULT_TYPECC! 5
.CC5 6
INFORMATIONCC6 A
}CCB C
,CCC D
{DD 
RESULT_TYPEDD 
.DD 
COMDD 
,DD  
ANALYSIS_RESULT_TYPEDD 3
.DD3 4
INFORMATIONDD4 ?
}DD@ A
,DDA B
{EE 
RESULT_TYPEEE 
.EE 
LOGEE 
,EE  
ANALYSIS_RESULT_TYPEEE 3
.EE3 4
INFORMATIONEE4 ?
}EE@ A
,EEA B
{FF 
RESULT_TYPEFF 
.FF 
KEYFF 
,FF  
ANALYSIS_RESULT_TYPEFF 3
.FF3 4
INFORMATIONFF4 ?
}FF@ A
,FFA B
{GG 
RESULT_TYPEGG 
.GG 
TPMGG 
,GG  
ANALYSIS_RESULT_TYPEGG 3
.GG3 4
INFORMATIONGG4 ?
}GG@ A
,GGA B
{HH 
RESULT_TYPEHH 
.HH 
PROCESSHH !
,HH! " 
ANALYSIS_RESULT_TYPEHH# 7
.HH7 8
INFORMATIONHH8 C
}HHD E
,HHE F
{II 
RESULT_TYPEII 
.II 
DRIVERII  
,II  ! 
ANALYSIS_RESULT_TYPEII" 6
.II6 7
INFORMATIONII7 B
}IIC D
,IID E
{JJ 
RESULT_TYPEJJ 
.JJ 
FILEMONITORJJ %
,JJ% & 
ANALYSIS_RESULT_TYPEJJ' ;
.JJ; <
INFORMATIONJJ< G
}JJH I
}KK 	
;KK	 

publicSS 
staticSS 
RuleFileSS 

FromStreamSS )
(SS) *
StreamSS* 0
?SS0 1
streamSS2 8
,SS8 9
stringSS: @
?SS@ A

streamNameSSB L
)SSL M
{TT 	
ifUU 
(UU 
streamUU 
isUU 
nullUU 
)UU 
throwVV 
newVV "
NullReferenceExceptionVV 0
(VV0 1
nameofVV1 7
(VV7 8
streamVV8 >
)VV> ?
)VV? @
;VV@ A
tryWW 
{XX 
usingYY 
(YY 
StreamReaderYY #
fileYY$ (
=YY) *
newYY+ .
StreamReaderYY/ ;
(YY; <
streamYY< B
)YYB C
)YYC D
{ZZ 
var[[ 
config[[ 
=[[  
JsonConvert[[! ,
.[[, -
DeserializeObject[[- >
<[[> ?
RuleFile[[? G
>[[G H
([[H I
file[[I M
.[[M N
	ReadToEnd[[N W
([[W X
)[[X Y
)[[Y Z
;[[Z [
config\\ 
.\\ 
Source\\ !
=\\" #

streamName\\$ .
??\\/ 1
(\\2 3
config\\3 9
.\\9 :
Source\\: @
??\\A C
$str\\D L
)\\L M
;\\M N
return]] 
config]] !
;]]! "
}^^ 
}__ 
catch`` 
(`` 
	Exception`` 
e`` 
)`` 
when``  $
(``% &
eaa 
isaa '
UnauthorizedAccessExceptionaa 0
||bb 
ebb 
isbb 
ArgumentExceptionbb )
||cc 
ecc 
iscc !
ArgumentNullExceptioncc -
||dd 
edd 
isdd  
PathTooLongExceptiondd ,
||ee 
eee 
isee &
DirectoryNotFoundExceptionee 2
||ff 
eff 
isff !
FileNotFoundExceptionff -
||gg 
egg 
isgg !
NotSupportedExceptiongg -
)gg- .
{hh 
Logjj 
.jj 
Warningjj 
(jj 
Stringsjj #
.jj# $
Getjj$ '
(jj' (
$strjj( A
)jjA B
,jjB C
$strjjD L
)jjL M
;jjM N
}kk 
returnll 
newll 
RuleFilell 
(ll  
)ll  !
;ll! "
}mm 	
publicss 
stringss 
GetHashss 
(ss 
)ss 
=>ss  "
CryptoHelpersss# 0
.ss0 1

CreateHashss1 ;
(ss; <
JsonConvertss< G
.ssG H
SerializeObjectssH W
(ssW X
thisssX \
)ss\ ]
)ss] ^
;ss^ _
publiczz 
staticzz 
RuleFilezz 
FromFilezz '
(zz' (
stringzz( .
?zz. /
	filterLoczz0 9
=zz: ;
$strzz< >
)zz> ?
{{{ 	
if|| 
(|| 
!|| 
string|| 
.|| 
IsNullOrEmpty|| %
(||% &
	filterLoc||& /
)||/ 0
)||0 1
{}} 
try~~ 
{ 
using
ÄÄ 
(
ÄÄ 
StreamReader
ÄÄ '
file
ÄÄ( ,
=
ÄÄ- .
System
ÄÄ/ 5
.
ÄÄ5 6
IO
ÄÄ6 8
.
ÄÄ8 9
File
ÄÄ9 =
.
ÄÄ= >
OpenText
ÄÄ> F
(
ÄÄF G
	filterLoc
ÄÄG P
)
ÄÄP Q
)
ÄÄQ R
{
ÅÅ 
var
ÇÇ 
config
ÇÇ "
=
ÇÇ# $
JsonConvert
ÇÇ% 0
.
ÇÇ0 1
DeserializeObject
ÇÇ1 B
<
ÇÇB C
RuleFile
ÇÇC K
>
ÇÇK L
(
ÇÇL M
file
ÇÇM Q
.
ÇÇQ R
	ReadToEnd
ÇÇR [
(
ÇÇ[ \
)
ÇÇ\ ]
)
ÇÇ] ^
;
ÇÇ^ _
config
ÉÉ 
.
ÉÉ 
Source
ÉÉ %
=
ÉÉ& '
	filterLoc
ÉÉ( 1
;
ÉÉ1 2
return
ÑÑ 
config
ÑÑ %
;
ÑÑ% &
}
ÖÖ 
}
ÜÜ 
catch
áá 
(
áá 
	Exception
áá  
e
áá! "
)
áá" #
when
áá$ (
(
áá) *
e
àà 
is
àà )
UnauthorizedAccessException
àà 4
||
ââ 
e
ââ 
is
ââ 
ArgumentException
ââ -
||
ää 
e
ää 
is
ää #
ArgumentNullException
ää 1
||
ãã 
e
ãã 
is
ãã "
PathTooLongException
ãã 0
||
åå 
e
åå 
is
åå (
DirectoryNotFoundException
åå 6
||
çç 
e
çç 
is
çç #
FileNotFoundException
çç 1
||
éé 
e
éé 
is
éé #
NotSupportedException
éé 1
)
éé1 2
{
èè 
Log
ëë 
.
ëë 
Warning
ëë 
(
ëë  
Strings
ëë  '
.
ëë' (
Get
ëë( +
(
ëë+ ,
$str
ëë, E
)
ëëE F
,
ëëF G
	filterLoc
ëëH Q
)
ëëQ R
;
ëëR S
}
íí 
}
ìì 
return
îî 
new
îî 
RuleFile
îî 
(
îî  
)
îî  !
;
îî! "
}
ïï 	
public
õõ 
static
õõ 
RuleFile
õõ !
LoadEmbeddedFilters
õõ 2
(
õõ2 3
)
õõ3 4
{
úú 	
try
ùù 
{
ûû 
var
üü 
assembly
üü 
=
üü 
typeof
üü %
(
üü% &
FileSystemObject
üü& 6
)
üü6 7
.
üü7 8
Assembly
üü8 @
;
üü@ A
var
†† 
resourceName
††  
=
††! "
$str
††# H
;
††H I
using
°° 
Stream
°° 
stream
°° #
=
°°$ %
assembly
°°& .
.
°°. /'
GetManifestResourceStream
°°/ H
(
°°H I
resourceName
°°I U
)
°°U V
??
°°W Y
throw
°°Z _
new
°°` c$
NullReferenceException
°°d z
(
°°z {
$"
°°{ }
$str°°} Æ
{°°Æ Ø
resourceName°°Ø ª
}°°ª º
"°°º Ω
)°°Ω æ
;°°æ ø
var
¢¢ 
file
¢¢ 
=
¢¢ 

FromStream
¢¢ %
(
¢¢% &
stream
¢¢& ,
,
¢¢, -
$str
¢¢. >
)
¢¢> ?
;
¢¢? @
return
££ 
file
££ 
;
££ 
}
§§ 
catch
•• 
(
•• 
	Exception
•• 
e
•• 
)
•• 
when
••  $
(
••% &
e
¶¶ 
is
¶¶ #
ArgumentNullException
¶¶ *
||
ßß 
e
ßß 
is
ßß 
ArgumentException
ßß )
||
®® 
e
®® 
is
®® 
FileLoadException
®® )
||
©© 
e
©© 
is
©© #
FileNotFoundException
©© -
||
™™ 
e
™™ 
is
™™ %
BadImageFormatException
™™ /
||
´´ 
e
´´ 
is
´´ %
NotImplementedException
´´ /
||
¨¨ 
e
¨¨ 
is
¨¨ $
NullReferenceException
¨¨ .
)
¨¨. /
{
≠≠ 
Log
ÆÆ 
.
ÆÆ 
Debug
ÆÆ 
(
ÆÆ 
$str
ÆÆ :
,
ÆÆ: ;
$str
ÆÆ< F
,
ÆÆF G
e
ÆÆH I
.
ÆÆI J
GetType
ÆÆJ Q
(
ÆÆQ R
)
ÆÆR S
.
ÆÆS T
ToString
ÆÆT \
(
ÆÆ\ ]
)
ÆÆ] ^
)
ÆÆ^ _
;
ÆÆ_ `
}
ØØ 
return
∞∞ 
new
∞∞ 
RuleFile
∞∞ 
(
∞∞  
)
∞∞  !
;
∞∞! "
}
±± 	
public
∂∂ 
void
∂∂ 
DumpFilters
∂∂ 
(
∂∂  
)
∂∂  !
{
∑∑ 	
Log
∏∏ 
.
∏∏ 
Verbose
∏∏ 
(
∏∏ 
$str
∏∏ &
)
∏∏& '
;
∏∏' (
Log
ππ 
.
ππ 
Verbose
ππ 
(
ππ 
JsonConvert
ππ #
.
ππ# $
SerializeObject
ππ$ 3
(
ππ3 4
this
ππ4 8
)
ππ8 9
)
ππ9 :
;
ππ: ;
}
∫∫ 	
}
ªª 
}ºº Ü)
RD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\SerializableCertificate.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class #
SerializableCertificate (
{		 
public

 #
SerializableCertificate

 &
(

& '
X509Certificate2

' 7
certificate

8 C
)

C D
{ 	

Thumbprint 
= 
certificate $
?$ %
.% &

Thumbprint& 0
??1 3
throw4 9
new: =!
ArgumentNullException> S
(S T
nameofT Z
(Z [
certificate[ f
)f g
)g h
;h i
Subject 
= 
certificate !
.! "
Subject" )
;) *
	PublicKey 
= 
certificate #
.# $
	PublicKey$ -
.- .
EncodedKeyValue. =
.= >
Format> D
(D E
trueE I
)I J
;J K
NotAfter 
= 
certificate "
." #
NotAfter# +
;+ ,
	NotBefore 
= 
certificate #
.# $
	NotBefore$ -
;- .
Issuer 
= 
certificate  
.  !
Issuer! '
;' (
SerialNumber 
= 
certificate &
.& '
SerialNumber' 3
;3 4
CertHashString 
= 
certificate (
.( )
GetCertHashString) :
(: ;
); <
;< =
Pkcs7 
= 
Convert 
. 
ToBase64String *
(* +
certificate+ 6
.6 7
Export7 =
(= >
X509ContentType> M
.M N
CertN R
)R S
)S T
;T U
} 	
[ 	
JsonConstructor	 
] 
public #
SerializableCertificate &
(& '
string' -

Thumbprint. 8
,8 9
string: @
SubjectA H
,H I
stringJ P
	PublicKeyQ Z
,Z [
DateTime\ d
NotAftere m
,m n
DateTimeo w
	NotBefore	x Å
,
Å Ç
string
É â
Issuer
ä ê
,
ê ë
string
í ò
SerialNumber
ô •
,
• ¶
string
ß ≠
CertHashString
Æ º
,
º Ω
string
æ ƒ
Pkcs7
≈  
)
  À
{ 	
this 
. 

Thumbprint 
= 

Thumbprint (
;( )
this 
. 
Subject 
= 
Subject "
;" #
this 
. 
	PublicKey 
= 
	PublicKey &
;& '
this 
. 
NotAfter 
= 
NotAfter $
;$ %
this 
. 
	NotBefore 
= 
	NotBefore &
;& '
this 
. 
Issuer 
= 
Issuer  
;  !
this   
.   
SerialNumber   
=   
SerialNumber    ,
;  , -
this!! 
.!! 
CertHashString!! 
=!!  !
CertHashString!!" 0
;!!0 1
this"" 
."" 
Pkcs7"" 
="" 
Pkcs7"" 
;"" 
}## 	
public%% 
string%% 
CertHashString%% $
{%%% &
get%%' *
;%%* +
set%%, /
;%%/ 0
}%%1 2
public&& 
string&& 
Issuer&& 
{&& 
get&& "
;&&" #
set&&$ '
;&&' (
}&&) *
public'' 
DateTime'' 
NotAfter''  
{''! "
get''# &
;''& '
set''( +
;''+ ,
}''- .
public(( 
DateTime(( 
	NotBefore(( !
{((" #
get(($ '
;((' (
set(() ,
;((, -
}((. /
public)) 
string)) 
Pkcs7)) 
{)) 
get)) !
;))! "
set))# &
;))& '
}))( )
public** 
string** 
	PublicKey** 
{**  !
get**" %
;**% &
set**' *
;*** +
}**, -
public++ 
string++ 
SerialNumber++ "
{++# $
get++% (
;++( )
set++* -
;++- .
}++/ 0
public,, 
string,, 
Subject,, 
{,, 
get,,  #
;,,# $
set,,% (
;,,( )
},,* +
public-- 
string-- 

Thumbprint--  
{--! "
get--# &
;--& '
set--( +
;--+ ,
}--- .
}.. 
}// ÁG
VD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\SerializableFileVersionInfo.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class '
SerializableFileVersionInfo ,
{ 
public '
SerializableFileVersionInfo *
(* +
)+ ,
{ 	
}		 	
public 
string 
? 
Comments 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
CompanyName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
FileBuildPart  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
? 
FileDescription &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public$$ 
int$$ 
FileMajorPart$$  
{$$! "
get$$# &
;$$& '
set$$( +
;$$+ ,
}$$- .
public** 
int** 
FileMinorPart**  
{**! "
get**# &
;**& '
set**( +
;**+ ,
}**- .
public// 
string// 
?// 
FileName// 
{//  !
get//" %
;//% &
set//' *
;//* +
}//, -
public55 
int55 
FilePrivatePart55 "
{55# $
get55% (
;55( )
set55* -
;55- .
}55/ 0
public:: 
string:: 
?:: 
FileVersion:: "
{::# $
get::% (
;::( )
set::* -
;::- .
}::/ 0
public@@ 
string@@ 
?@@ 
InternalName@@ #
{@@$ %
get@@& )
;@@) *
set@@+ .
;@@. /
}@@0 1
publicGG 
boolGG 
IsDebugGG 
{GG 
getGG !
;GG! "
setGG# &
;GG& '
}GG( )
publicMM 
boolMM 
	IsPatchedMM 
{MM 
getMM  #
;MM# $
setMM% (
;MM( )
}MM* +
publicOO 
boolOO 
IsPreReleaseOO  
{OO! "
getOO# &
;OO& '
setOO( +
;OO+ ,
}OO- .
publicUU 
boolUU 
IsPrivateBuildUU "
{UU# $
getUU% (
;UU( )
setUU* -
;UU- .
}UU/ 0
publicZZ 
boolZZ 
IsSpecialBuildZZ "
{ZZ# $
getZZ% (
;ZZ( )
setZZ* -
;ZZ- .
}ZZ/ 0
public`` 
string`` 
?`` 
Language`` 
{``  !
get``" %
;``% &
set``' *
;``* +
}``, -
publicee 
stringee 
?ee 
LegalCopyrightee %
{ee& '
getee( +
;ee+ ,
setee- 0
;ee0 1
}ee2 3
publickk 
stringkk 
?kk 
LegalTrademarkskk &
{kk' (
getkk) ,
;kk, -
setkk. 1
;kk1 2
}kk3 4
publicpp 
stringpp 
?pp 
OriginalFilenamepp '
{pp( )
getpp* -
;pp- .
setpp/ 2
;pp2 3
}pp4 5
publicvv 
stringvv 
?vv 
PrivateBuildvv #
{vv$ %
getvv& )
;vv) *
setvv+ .
;vv. /
}vv0 1
public|| 
int|| 
ProductBuildPart|| #
{||$ %
get||& )
;||) *
set||+ .
;||. /
}||0 1
public
ÇÇ 
int
ÇÇ 
ProductMajorPart
ÇÇ #
{
ÇÇ$ %
get
ÇÇ& )
;
ÇÇ) *
set
ÇÇ+ .
;
ÇÇ. /
}
ÇÇ0 1
public
àà 
int
àà 
ProductMinorPart
àà #
{
àà$ %
get
àà& )
;
àà) *
set
àà+ .
;
àà. /
}
àà0 1
public
éé 
string
éé 
?
éé 
ProductName
éé "
{
éé# $
get
éé% (
;
éé( )
set
éé* -
;
éé- .
}
éé/ 0
public
îî 
int
îî  
ProductPrivatePart
îî %
{
îî& '
get
îî( +
;
îî+ ,
set
îî- 0
;
îî0 1
}
îî2 3
public
öö 
string
öö 
?
öö 
ProductVersion
öö %
{
öö& '
get
öö( +
;
öö+ ,
set
öö- 0
;
öö0 1
}
öö2 3
public
üü 
string
üü 
?
üü 
SpecialBuild
üü #
{
üü$ %
get
üü& )
;
üü) *
set
üü+ .
;
üü. /
}
üü0 1
public
°° 
static
°° )
SerializableFileVersionInfo
°° 1
?
°°1 2!
FromFileVersionInfo
°°3 F
(
°°F G
FileVersionInfo
°°G V
fvi
°°W Z
)
°°Z [
{
¢¢ 	
if
££ 
(
££ 
fvi
££ 
==
££ 
null
££ 
)
££ 
{
££ 
return
££ %
null
££& *
;
££* +
}
££, -
return
§§ 
new
§§ )
SerializableFileVersionInfo
§§ 2
(
§§2 3
)
§§3 4
{
•• 
Comments
¶¶ 
=
¶¶ 
fvi
¶¶ 
.
¶¶ 
Comments
¶¶ '
,
¶¶' (
CompanyName
ßß 
=
ßß 
fvi
ßß !
.
ßß! "
CompanyName
ßß" -
,
ßß- .
FileBuildPart
®® 
=
®® 
fvi
®®  #
.
®®# $
FileBuildPart
®®$ 1
,
®®1 2
FileDescription
©© 
=
©©  !
fvi
©©" %
.
©©% &
FileDescription
©©& 5
,
©©5 6
FileMajorPart
™™ 
=
™™ 
fvi
™™  #
.
™™# $
FileMajorPart
™™$ 1
,
™™1 2
FileMinorPart
´´ 
=
´´ 
fvi
´´  #
.
´´# $
FileMinorPart
´´$ 1
,
´´1 2
FileName
¨¨ 
=
¨¨ 
fvi
¨¨ 
.
¨¨ 
FileName
¨¨ '
,
¨¨' (
FilePrivatePart
≠≠ 
=
≠≠  !
fvi
≠≠" %
.
≠≠% &
FilePrivatePart
≠≠& 5
,
≠≠5 6
FileVersion
ÆÆ 
=
ÆÆ 
fvi
ÆÆ !
.
ÆÆ! "
FileVersion
ÆÆ" -
,
ÆÆ- .
InternalName
ØØ 
=
ØØ 
fvi
ØØ "
.
ØØ" #
InternalName
ØØ# /
,
ØØ/ 0
IsDebug
∞∞ 
=
∞∞ 
fvi
∞∞ 
.
∞∞ 
IsDebug
∞∞ %
,
∞∞% &
	IsPatched
±± 
=
±± 
fvi
±± 
.
±±  
	IsPatched
±±  )
,
±±) *
IsPreRelease
≤≤ 
=
≤≤ 
fvi
≤≤ "
.
≤≤" #
IsPreRelease
≤≤# /
,
≤≤/ 0
IsPrivateBuild
≥≥ 
=
≥≥  
fvi
≥≥! $
.
≥≥$ %
IsPrivateBuild
≥≥% 3
,
≥≥3 4
IsSpecialBuild
¥¥ 
=
¥¥  
fvi
¥¥! $
.
¥¥$ %
IsSpecialBuild
¥¥% 3
,
¥¥3 4
Language
µµ 
=
µµ 
fvi
µµ 
.
µµ 
Language
µµ '
,
µµ' (
LegalCopyright
∂∂ 
=
∂∂  
fvi
∂∂! $
.
∂∂$ %
LegalCopyright
∂∂% 3
,
∂∂3 4
LegalTrademarks
∑∑ 
=
∑∑  !
fvi
∑∑" %
.
∑∑% &
LegalTrademarks
∑∑& 5
,
∑∑5 6
OriginalFilename
∏∏  
=
∏∏! "
fvi
∏∏# &
.
∏∏& '
OriginalFilename
∏∏' 7
,
∏∏7 8
PrivateBuild
ππ 
=
ππ 
fvi
ππ "
.
ππ" #
PrivateBuild
ππ# /
,
ππ/ 0
ProductBuildPart
∫∫  
=
∫∫! "
fvi
∫∫# &
.
∫∫& '
ProductBuildPart
∫∫' 7
,
∫∫7 8
ProductMajorPart
ªª  
=
ªª! "
fvi
ªª# &
.
ªª& '
ProductMajorPart
ªª' 7
,
ªª7 8
ProductMinorPart
ºº  
=
ºº! "
fvi
ºº# &
.
ºº& '
ProductMinorPart
ºº' 7
,
ºº7 8
ProductName
ΩΩ 
=
ΩΩ 
fvi
ΩΩ !
.
ΩΩ! "
ProductName
ΩΩ" -
,
ΩΩ- . 
ProductPrivatePart
ææ "
=
ææ# $
fvi
ææ% (
.
ææ( ) 
ProductPrivatePart
ææ) ;
,
ææ; <
ProductVersion
øø 
=
øø  
fvi
øø! $
.
øø$ %
ProductVersion
øø% 3
,
øø3 4
SpecialBuild
¿¿ 
=
¿¿ 
fvi
¿¿ "
.
¿¿" #
SpecialBuild
¿¿# /
}
¡¡ 
;
¡¡ 
}
¬¬ 	
}
√√ 
}ƒƒ ¯*
HD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\ServiceObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
ServiceObject 
:  
CollectObject! .
{		 
[

 	
JsonConstructor

	 
]

 
public 
ServiceObject 
( 
string #
Name$ (
)( )
{ 	
this 
. 
Name 
= 
Name 
; 

ResultType 
= 
RESULT_TYPE $
.$ %
SERVICE% ,
;, -
} 	
public 
bool 
? 
AcceptPause  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
? 

AcceptStop 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Caption 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
uint 
? 

CheckPoint 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
CreationClassName (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
bool 
? 
DelayedAutoStart %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
? 
Description "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
bool 
? 
DesktopInteract $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
? 
DisplayName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
ErrorControl #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
uint 
? 
ExitCode 
{ 
get  #
;# $
set% (
;( )
}* +
public 
override 
string 
Identity '
{ 	
get 
{   
return!! 
Name!! 
;!! 
}"" 
}## 	
public%% 
DateTime%% 
InstallDate%% #
{%%$ %
get%%& )
;%%) *
set%%+ .
;%%. /
}%%0 1
public&& 
string&& 
Name&& 
{&& 
get&&  
;&&  !
set&&" %
;&&% &
}&&' (
public'' 
string'' 
?'' 
PathName'' 
{''  !
get''" %
;''% &
set''' *
;''* +
}'', -
public(( 
uint(( 
?(( 
	ProcessId(( 
{((  
get((! $
;(($ %
set((& )
;(() *
}((+ ,
public)) 
uint)) 
?)) #
ServiceSpecificExitCode)) ,
{))- .
get))/ 2
;))2 3
set))4 7
;))7 8
}))9 :
public** 
string** 
?** 
ServiceType** "
{**# $
get**% (
;**( )
set*** -
;**- .
}**/ 0
public++ 
bool++ 
?++ 
Started++ 
{++ 
get++ "
;++" #
set++$ '
;++' (
}++) *
public,, 
string,, 
?,, 
	StartMode,,  
{,,! "
get,,# &
;,,& '
set,,( +
;,,+ ,
},,- .
public-- 
string-- 
?-- 
	StartName--  
{--! "
get--# &
;--& '
set--( +
;--+ ,
}--- .
public.. 
string.. 
?.. 
State.. 
{.. 
get.. "
;.." #
set..$ '
;..' (
}..) *
public// 
string// 
?// 
Status// 
{// 
get//  #
;//# $
set//% (
;//( )
}//* +
public00 
string00 
?00 #
SystemCreationClassName00 .
{00/ 0
get001 4
;004 5
set006 9
;009 :
}00; <
public11 
string11 
?11 

SystemName11 !
{11" #
get11$ '
;11' (
set11) ,
;11, -
}11. /
public22 
uint22 
?22 
TagId22 
{22 
get22  
;22  !
set22" %
;22% &
}22' (
public33 
uint33 
?33 
WaitHint33 
{33 
get33  #
;33# $
set33% (
;33( )
}33* +
}44 
}55 ô
CD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\Settings.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
Settings 
{ 
public		 
int		 
SchemaVersion		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public 
int 
ShardingFactor !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ¥
DD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\Signature.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public		 

class		 
	Signature		 
{

 
public 
	Signature 
( 
AuthenticodeInfo )
authenticodeInfo* :
): ;
{ 	
if 
( 
authenticodeInfo  
!=! #
null$ (
)( )
{ 
IsAuthenticodeValid #
=$ %
authenticodeInfo& 6
.6 7
IsAuthenticodeValid7 J
;J K
if 
( 
authenticodeInfo $
.$ %

SignedHash% /
is0 2
byte3 7
[7 8
]8 9
hash: >
)> ?
{ 

SignedHash 
=  
Convert! (
.( )
ToBase64String) 7
(7 8
hash8 <
)< =
;= >
} 
SignerSerialNumber "
=# $
authenticodeInfo% 5
.5 6
SignerSerialNumber6 H
;H I
if 
( 
authenticodeInfo $
.$ %
SigningCertificate% 7
is8 :
X509Certificate2; K
certL P
)P Q
{ 
SigningCertificate &
=' (
new) ,#
SerializableCertificate- D
(D E
certE I
)I J
;J K
} 
} 
else 
{ 
IsAuthenticodeValid #
=$ %
false& +
;+ ,
} 
} 	
[$$ 	
JsonConstructor$$	 
]$$ 
public%% 
	Signature%% 
(%% 
)%% 
{&& 	
}'' 	
public)) 
bool)) 
IsTimeValid)) 
{** 	
get++ 
{,, 
if-- 
(-- 
SigningCertificate-- &
!=--' )
null--* .
)--. /
{.. 
return// 
DateTime// #
.//# $
Now//$ '
>//( )
SigningCertificate//* <
.//< =
	NotBefore//= F
&&//G I
DateTime//J R
.//R S
Now//S V
<//W X
SigningCertificate//Y k
.//k l
NotAfter//l t
;//t u
}00 
return11 
false11 
;11 
}22 
}33 	
public55 
bool55 
IsAuthenticodeValid55 '
{55( )
get55* -
;55- .
set55/ 2
;552 3
}554 5
public66 
string66 
?66 

SignedHash66 !
{66" #
get66$ '
;66' (
set66) ,
;66, -
}66. /
public77 
string77 
?77 
SignerSerialNumber77 )
{77* +
get77, /
;77/ 0
set771 4
;774 5
}776 7
public88 #
SerializableCertificate88 &
?88& '
SigningCertificate88( :
{88; <
get88= @
;88@ A
set88B E
;88E F
}88G H
}99 
}:: †
OD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\SkipCompareAttribute.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
[ 
AttributeUsage 
( 
AttributeTargets $
.$ %
All% (
)( )
] 
public 

class  
SkipCompareAttribute %
:& '
	Attribute( 1
{ 
public		  
SkipCompareAttribute		 #
(		# $
)		$ %
{

 	
} 	
} 
} îj
ND:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\SqlConnectionHolder.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
SqlConnectionHolder $
{ 
public 
SqlConnectionHolder "
(" #
string# )
databaseFilename* :
,: ;

DBSettings< F
?F G

dBSettingsH R
=S T
nullU Y
)Y Z
{ 	
settings 
= 

dBSettings !
??" $
new% (

DBSettings) 3
(3 4
)4 5
;5 6
Source 
= 
databaseFilename %
;% &

Connection 
= 
new 
SqliteConnection -
(- .
$". 0
$str0 <
{< =
Source= C
}C D
"D E
)E F
;F G

Connection 
. 
Open 
( 
) 
; 
string 
command 
= 
string #
.# $
Format$ *
(* +
CultureInfo+ 6
.6 7
InvariantCulture7 G
,G H
PRAGMAS+ 2
,2 3
settings+ 3
.3 4
Synchronous4 ?
,? @
settings+ 3
.3 4
JournalMode4 ?
,? @
settings+ 3
.3 4
PageSize4 <
,< =
settings+ 3
.3 4
LockingMode4 ?
)? @
;@ A
using 
var 
cmd 
= 
new 
SqliteCommand  -
(- .
command. 5
,5 6

Connection7 A
)A B
;B C
cmd   
.   
ExecuteNonQuery   
(    
)    !
;  ! "
if"" 
("" 
settings"" 
."" 
	BatchSize"" "
<""# $
$num""% &
)""& '
{## 
settings$$ 
.$$ 
	BatchSize$$ "
=$$# $
$num$$% &
;$$& '
}%% 
if(( 
((( 
settings(( 
.(( 
	BatchSize(( "
>((# $
$num((% (
)((( )
{)) 
Log** 
.** 
Warning** 
(** 
$str** R
)**R S
;**S T
settings++ 
.++ 
	BatchSize++ "
=++# $
$num++% (
;++( )
},, 

innerQueue.. 
=.. 
new.. 
WriteObject.. (
[..( )
settings..) 1
...1 2
	BatchSize..2 ;
]..; <
;..< =
_00 
=00 
Task00 
.00 
Factory00 
.00 
StartNew00 %
(00% &
(00& '
)00' (
=>00) +
KeepFlushQueue00, :
(00: ;
)00; <
)00< =
;00= >
}11 	
public33 
SqliteConnection33 

Connection33  *
{33+ ,
get33- 0
;330 1
set332 5
;335 6
}337 8
public44 
bool44 
	IsWriting44 
{44 
get44  #
;44# $
private44% ,
set44- 0
;440 1
}442 3
public55 
bool55 
KeepRunning55 
{55  !
get55" %
;55% &
set55' *
;55* +
}55, -
public66 
string66 
Source66 
{66 
get66 "
;66" #
set66$ '
;66' (
}66) *
public77 
SqliteTransaction77  
?77  !
Transaction77" -
{77. /
get770 3
;773 4
set775 8
;778 9
}77: ;
public88 
ConcurrentStack88 
<88 
WriteObject88 *
>88* +

WriteQueue88, 6
{887 8
get889 <
;88< =
private88> E
set88F I
;88I J
}88K L
=88M N
new88O R
ConcurrentStack88S b
<88b c
WriteObject88c n
>88n o
(88o p
)88p q
;88q r
public:: 
void:: 
BeginTransaction:: $
(::$ %
)::% &
{;; 	
if<< 
(<< 
Transaction<< 
==<< 
null<< #
&&<<$ &

Connection<<' 1
!=<<2 4
null<<5 9
)<<9 :
{== 
Transaction>> 
=>> 

Connection>> (
.>>( )
BeginTransaction>>) 9
(>>9 :
)>>: ;
;>>; <
}?? 
}@@ 	
publicBB 
voidBB 
CommitBB 
(BB 
)BB 
{CC 	
tryDD 
{EE 
TransactionFF 
?FF 
.FF 
CommitFF #
(FF# $
)FF$ %
;FF% &
}GG 
catchHH 
(HH 
	ExceptionHH 
eHH 
)HH 
{II 
LogJJ 
.JJ 
WarningJJ 
(JJ 
eJJ 
,JJ 
$"JJ !
$strJJ! :
{JJ: ;
SourceJJ; A
}JJA B
$strJJB D
{JJD E
eJJE F
.JJF G

StackTraceJJG Q
}JJQ R
"JJR S
)JJS T
;JJT U
}KK 
finallyLL 
{MM 
TransactionNN 
=NN 
nullNN "
;NN" #
}OO 
}PP 	
publicRR 
voidRR 
DestroyRR 
(RR 
)RR 
{SS 	
ShutDownTT 
(TT 
)TT 
;TT 
tryVV 
{WW 
FileXX 
.XX 
DeleteXX 
(XX 
SourceXX "
)XX" #
;XX# $
}YY 
catchZZ 
(ZZ 
	ExceptionZZ 
eZZ 
)ZZ 
{[[ 
Log\\ 
.\\ 
Warning\\ 
(\\ 
e\\ 
,\\ 
$"\\ !
$str\\! >
{\\> ?
Source\\? E
}\\E F
"\\F G
)\\G H
;\\H I
}]] 
}^^ 	
public`` 
void`` 
KeepFlushQueue`` "
(``" #
)``# $
{aa 	
KeepRunningbb 
=bb 
truebb 
;bb 
whilecc 
(cc 
KeepRunningcc 
)cc 
{dd 
whileee 
(ee 

WriteQueueee !
.ee! "
Countee" '
>ee( )
$numee* +
)ee+ ,
{ff 
	WriteNextgg 
(gg 
)gg 
;gg  
}hh 
Threadii 
.ii 
Sleepii 
(ii 
$numii 
)ii 
;ii  
}jj 
}kk 	
internalmm 
voidmm 
ShutDownmm 
(mm 
)mm  
{nn 	
KeepRunningoo 
=oo 
falseoo 
;oo  

Connectionpp 
.pp 
Closepp 
(pp 
)pp 
;pp 

Connectionqq 
.qq 
Disposeqq 
(qq 
)qq  
;qq  !
Transactionrr 
=rr 
nullrr 
;rr 
}ss 	
privateuu 
constuu 
stringuu 
PRAGMASuu $
=uu% &
$str	uu' ®
;
uu® ©
privatevv 
readonlyvv 
WriteObjectvv $
[vv$ %
]vv% &

innerQueuevv' 1
;vv1 2
privateww 
readonlyww 

DBSettingsww #
settingsww$ ,
;ww, -
privateyy 
voidyy 
	WriteNextyy 
(yy 
)yy  
{zz 	
	IsWriting{{ 
={{ 
true{{ 
;{{ 
string|| %
SQL_INSERT_COLLECT_RESULT|| ,
=||- .
$str	||/ ã
;
||ã å
var~~ 
count~~ 
=~~ 
Math~~ 
.~~ 
Min~~  
(~~  !
settings~~! )
.~~) *
	BatchSize~~* 3
,~~3 4

WriteQueue~~5 ?
.~~? @
Count~~@ E
)~~E F
;~~F G
var 
actual 
= 

WriteQueue #
.# $
TryPopRange$ /
(/ 0

innerQueue0 :
,: ;
$num< =
,= >
count? D
)D E
;E F
if
ÅÅ 
(
ÅÅ 
actual
ÅÅ 
>
ÅÅ 
$num
ÅÅ 
)
ÅÅ 
{
ÇÇ 
var
ÉÉ 
stringBuilder
ÉÉ !
=
ÉÉ" #
new
ÉÉ$ '
StringBuilder
ÉÉ( 5
(
ÉÉ5 6
)
ÉÉ6 7
;
ÉÉ7 8
stringBuilder
ÑÑ 
.
ÑÑ 
Append
ÑÑ $
(
ÑÑ$ %'
SQL_INSERT_COLLECT_RESULT
ÑÑ% >
)
ÑÑ> ?
;
ÑÑ? @
using
ÖÖ 
var
ÖÖ 
cmd
ÖÖ 
=
ÖÖ 
new
ÖÖ  #
SqliteCommand
ÖÖ$ 1
(
ÖÖ1 2
string
ÖÖ2 8
.
ÖÖ8 9
Empty
ÖÖ9 >
,
ÖÖ> ?

Connection
ÖÖ@ J
,
ÖÖJ K
Transaction
ÖÖL W
)
ÖÖW X
;
ÖÖX Y
for
áá 
(
áá 
int
áá 
i
áá 
=
áá 
$num
áá 
;
áá 
i
áá  !
<
áá" #
actual
áá$ *
;
áá* +
i
áá, -
++
áá- /
)
áá/ 0
{
àà 
stringBuilder
ââ !
.
ââ! "
Append
ââ" (
(
ââ( )
$"
ââ) +
$str
ââ+ 4
{
ââ4 5
i
ââ5 6
}
ââ6 7
$str
ââ7 F
{
ââF G
i
ââG H
}
ââH I
$str
ââI T
{
ââT U
i
ââU V
}
ââV W
$str
ââW c
{
ââc d
i
ââd e
}
ââe f
$str
ââf t
{
âât u
i
ââu v
}
ââv w
$str
ââw y
"
âây z
)
ââz {
;
ââ{ |
cmd
ää 
.
ää 

Parameters
ää "
.
ää" #
AddWithValue
ää# /
(
ää/ 0
$"
ää0 2
$str
ää2 :
{
ää: ;
i
ää; <
}
ää< =
"
ää= >
,
ää> ?

innerQueue
ää@ J
[
ääJ K
i
ääK L
]
ääL M
.
ääM N
RunId
ääN S
)
ääS T
;
ääT U
cmd
ãã 
.
ãã 

Parameters
ãã "
.
ãã" #
AddWithValue
ãã# /
(
ãã/ 0
$"
ãã0 2
$str
ãã2 ?
{
ãã? @
i
ãã@ A
}
ããA B
"
ããB C
,
ããC D

innerQueue
ããE O
[
ããO P
i
ããP Q
]
ããQ R
.
ããR S
ColObj
ããS Y
.
ããY Z

ResultType
ããZ d
)
ããd e
;
ããe f
cmd
åå 
.
åå 

Parameters
åå "
.
åå" #
AddWithValue
åå# /
(
åå/ 0
$"
åå0 2
$str
åå2 ;
{
åå; <
i
åå< =
}
åå= >
"
åå> ?
,
åå? @

innerQueue
ååA K
[
ååK L
i
ååL M
]
ååM N
.
ååN O
RowKey
ååO U
)
ååU V
;
ååV W
cmd
çç 
.
çç 

Parameters
çç "
.
çç" #
AddWithValue
çç# /
(
çç/ 0
$"
çç0 2
$str
çç2 <
{
çç< =
i
çç= >
}
çç> ?
"
çç? @
,
çç@ A

innerQueue
ççB L
[
ççL M
i
ççM N
]
ççN O
.
ççO P
ColObj
ççP V
.
ççV W
Identity
ççW _
)
çç_ `
;
çç` a
cmd
éé 
.
éé 

Parameters
éé "
.
éé" #
AddWithValue
éé# /
(
éé/ 0
$"
éé0 2
$str
éé2 >
{
éé> ?
i
éé? @
}
éé@ A
"
ééA B
,
ééB C

innerQueue
ééD N
[
ééN O
i
ééO P
]
ééP Q
.
ééQ R

Serialized
ééR \
)
éé\ ]
;
éé] ^
}
èè 
stringBuilder
ëë 
.
ëë 
Remove
ëë $
(
ëë$ %
stringBuilder
ëë% 2
.
ëë2 3
Length
ëë3 9
-
ëë: ;
$num
ëë< =
,
ëë= >
$num
ëë? @
)
ëë@ A
;
ëëA B
cmd
íí 
.
íí 
CommandText
íí 
=
íí  !
stringBuilder
íí" /
.
íí/ 0
ToString
íí0 8
(
íí8 9
)
íí9 :
;
íí: ;
try
îî 
{
ïï 
cmd
ññ 
.
ññ 
ExecuteNonQuery
ññ '
(
ññ' (
)
ññ( )
;
ññ) *
}
óó 
catch
òò 
(
òò 
	Exception
òò  
e
òò! "
)
òò" #
{
ôô 
Log
öö 
.
öö 
Warning
öö 
(
öö  
e
öö  !
,
öö! "
$"
öö# %
$str
öö% ?
"
öö? @
)
öö@ A
;
ööA B
}
õõ 
}
úú 
	IsWriting
ûû 
=
ûû 
false
ûû 
;
ûû 
}
üü 	
}
†† 
}°° Ô
DD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\TpmObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
	TpmObject 
: 
CollectObject *
{		 
public

 
	TpmObject

 
(

 
string

 
Location

  (
)

( )
{ 	

ResultType 
= 
Types 
. 
RESULT_TYPE *
.* +
TPM+ .
;. /
this 
. 
Location 
= 
Location $
;$ %
} 	
public 
List 
< 
AlgProperty 
>  

Algorithms! +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
=: ;
new< ?
List@ D
<D E
AlgPropertyE P
>P Q
(Q R
)R S
;S T
public 
List 
< 
TpmCc 
> 
Commands #
{$ %
get& )
;) *
set+ .
;. /
}0 1
=2 3
new4 7
List8 <
<< =
TpmCc= B
>B C
(C D
)D E
;E F
public 
override 
string 
Identity '
{ 	
get 
{ 
return 
Location 
;  
} 
} 	
public 
string 
Location 
{  
get! $
;$ %
}& '
public 
string 
? 
Manufacturer #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
List 
< 

AsaNvIndex 
> 
NV  "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
new3 6
List7 ;
<; <

AsaNvIndex< F
>F G
(G H
)H I
;I J
public 

Dictionary 
< 
( 
TpmAlgId #
,# $
uint% )
)) *
,* +
byte, 0
[0 1
]1 2
>2 3
PCRs4 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
=G H
newI L

DictionaryM W
<W X
(X Y
TpmAlgIdY a
,a b
uintc g
)g h
,h i
bytej n
[n o
]o p
>p q
(q r
)r s
;s t
public 
List 
< "
CryptographicKeyObject *
>* +
PersistentKeys, :
{; <
get= @
;@ A
setB E
;E F
}G H
=I J
newK N
ListO S
<S T"
CryptographicKeyObjectT j
>j k
(k l
)l m
;m n
public   
List   
<   "
CryptographicKeyObject   *
>  * +

RandomKeys  , 6
{  7 8
get  9 <
;  < =
set  > A
;  A B
}  C D
=  E F
new  G J
List  K O
<  O P"
CryptographicKeyObject  P f
>  f g
(  g h
)  h i
;  i j
public!! 
DateTime!! 
TpmSpecDate!! #
{!!$ %
get!!& )
;!!) *
set!!+ .
;!!. /
}!!0 1
public"" 
string"" 
?"" 
Version"" 
{""  
get""! $
;""$ %
set""& )
;"") *
}""+ ,
}## 
}$$ ¶=
@D:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\Types.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Types. 3
{ 
[ 
System 
. 
Diagnostics 
. 
CodeAnalysis $
.$ %
SuppressMessage% 4
(4 5
$str5 =
,= >
$str? m
,m n
Justificationo |
=} ~
$str	 û
)
û ü
]
ü †
public 

enum 
ADDRESS_FAMILY 
{		 
	AppleTalk

 
=

 
$num

 
,

 
Atm 
= 
$num 
, 
Banyan 
= 
$num 
, 
Ccitt 
= 
$num 
, 
Chaos 
= 
$num 
, 
Cluster 
= 
$num 
, !
ControllerAreaNetwork 
= 
$num  %
,% &
DataKits 
= 
$num 
, 
DataLink 
= 
$num 
, 
DecNet 
= 
$num 
, 
Ecma 
= 
$num 
, 
FireFox 
= 
$num 
, 
HyperChannel 
= 
$num 
, 
	Ieee12844 
= 
$num 
, 
ImpLink 
= 
$num 
, 
InterNetwork 
= 
$num 
, 
InterNetworkV6 
= 
$num 
, 
Ipx 
= 
$num 
, 
Irda 
= 
$num 
, 
Iso 
= 
$num 
, 
Lat 
= 
$num 
, 
Max 
= 
$num 
, 
NetBios   
=   
$num   
,   
NetworkDesigners!! 
=!! 
$num!! 
,!! 
NS"" 

="" 
$num"" 
,"" 
Osi## 
=## 
$num## 
,## 
Packet$$ 
=$$ 
$num$$ 
,$$ 
Pup%% 
=%% 
$num%% 
,%% 
Sna&& 
=&& 
$num&& 
,&& 
Unix'' 
='' 
$num'' 
,'' 
Unknown(( 
=(( 
-(( 
$num(( 
,(( 
Unspecified)) 
=)) 
$num)) 
,)) 
	VoiceView** 
=** 
$num** 
}++ 
public00 

enum00  
ANALYSIS_RESULT_TYPE00 $
{11 
NONE55 
,55 
VERBOSE:: 
,:: 
DEBUG?? 
,?? 
INFORMATIONDD 
,DD 
WARNINGII 
,II 
ERRORNN 
,NN 
FATALSS 
}TT 
publicYY 

enumYY 
	ASA_ERRORYY 
{ZZ 
NONE[[ 
,[[ 
	UNIQUE_ID\\ 
,\\ 
INVALID_PATH]] 
,]] 
ALREADY_RUNNING^^ 
,^^ 
NO_COLLECTORS__ 
,__ 
MATCHING_SCHEMA`` 
,`` %
FAILED_TO_CREATE_DATABASEaa !
,aa! "

INVALID_IDbb 
,bb 
INVALID_RULEScc 
,cc 2
&FAILED_TO_ESTABLISH_MAIN_DB_CONNECTIONdd .
,dd. /
UNKNOWNee 
,ee 
	CANCELLEDff 
,ff 
FAILED_TO_COMMITgg 
,gg 
DATABASE_NULLhh 
}ii 
publicnn 

enumnn 
CHANGE_TYPEnn 
{oo 
INVALIDpp 
,pp 
CREATEDqq 
,qq 
DELETEDrr 
,rr 
MODIFIEDss 
,ss 
RENAMEDtt 
}uu 
[{{ 
System{{ 
.{{ 
Diagnostics{{ 
.{{ 
CodeAnalysis{{ $
.{{$ %
SuppressMessage{{% 4
({{4 5
$str{{5 =
,{{= >
$str{{? z
,{{z {
Justification	{{| â
=
{{ä ã
$str
{{å µ
)
{{µ ∂
]
{{∂ ∑
public|| 

enum|| 
DLLCHARACTERISTICS|| "
{}} 6
(IMAGE_DLLCHARACTERISTICS_HIGH_ENTROPY_VA
ÅÅ 0
=
ÅÅ1 2
$num
ÅÅ3 9
,
ÅÅ9 :3
%IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE
ÜÜ -
=
ÜÜ. /
$num
ÜÜ0 6
,
ÜÜ6 76
(IMAGE_DLLCHARACTERISTICS_FORCE_INTEGRITY
ãã 0
=
ãã1 2
$num
ãã3 9
,
ãã9 :0
"IMAGE_DLLCHARACTERISTICS_NX_COMPAT
êê *
=
êê+ ,
$num
êê- 3
,
êê3 43
%IMAGE_DLLCHARACTERISTICS_NO_ISOLATION
ïï -
=
ïï. /
$num
ïï0 6
,
ïï6 7-
IMAGE_DLLCHARACTERISTICS_NO_SEH
öö '
=
öö( )
$num
öö* 0
,
öö0 1.
 IMAGE_DLLCHARACTERISTICS_NO_BIND
üü (
=
üü) *
$num
üü+ 1
,
üü1 23
%IMAGE_DLLCHARACTERISTICS_APPCONTAINER
§§ -
=
§§. /
$num
§§0 6
,
§§6 71
#IMAGE_DLLCHARACTERISTICS_WDM_DRIVER
©© +
=
©©, -
$num
©©. 4
,
©©4 5/
!IMAGE_DLLCHARACTERISTICS_GUARD_CF
ÆÆ )
=
ÆÆ* +
$num
ÆÆ, 2
,
ÆÆ2 3<
.IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE
≥≥ 6
=
≥≥7 8
$num
≥≥9 ?
}
¥¥ 
public
∏∏ 

enum
∏∏ 
EXECUTABLE_TYPE
∏∏ 
{
ππ 
UNKNOWN
∫∫ 
,
∫∫ 
WINDOWS
ªª 
,
ªª 
MACOS
ºº 
,
ºº 
LINUX
ΩΩ 
,
ΩΩ 
NONE
ææ 
,
ææ 
JAVA
øø 
}
¿¿ 
public
≈≈ 

enum
≈≈ 
PLATFORM
≈≈ 
{
∆∆ 
WINDOWS
«« 
,
«« 
LINUX
»» 
,
»» 
MACOS
…… 
,
…… 
UNKNOWN
   
}
ÀÀ 
public
–– 

enum
–– 
RESULT_TYPE
–– 
{
—— 
UNKNOWN
’’ 
,
’’ 
FILE
⁄⁄ 
,
⁄⁄ 
PORT
ﬂﬂ 
,
ﬂﬂ 
REGISTRY
‰‰ 
,
‰‰ 
CERTIFICATE
ÈÈ 
,
ÈÈ 
SERVICE
ÓÓ 
,
ÓÓ 
USER
ÛÛ 
,
ÛÛ 
GROUP
¯¯ 
,
¯¯ 
FIREWALL
˝˝ 
,
˝˝ 
COM
ÇÇ 
,
ÇÇ 
LOG
áá 
,
áá 
FILEMONITOR
åå 
,
åå 
TPM
ëë 
,
ëë 
KEY
ññ 
,
ññ 
PROCESS
õõ 
,
õõ 
DRIVER
†† 
,
†† 
WIFI
•• 
}
¶¶ 
;
¶¶ 
public
´´ 

enum
´´ 

RUN_STATUS
´´ 
{
¨¨ 
NOT_STARTED
≠≠ 
,
≠≠ 
RUNNING
ÆÆ 
,
ÆÆ 
FAILED
ØØ 
,
ØØ 
	COMPLETED
∞∞ 
,
∞∞ 

NO_RESULTS
±± 
}
≤≤ 
public
¥¥ 

enum
¥¥ 
RUN_TYPE
¥¥ 
{
µµ 
COLLECT
∂∂ 
,
∂∂ 
MONITOR
∑∑ 
,
∑∑ 
COMPARE
∏∏ 
}
ππ 
public
ªª 

enum
ªª 
	TRANSPORT
ªª 
{
ºº 
UNKNOWN
ΩΩ 
,
ΩΩ 
TCP
ææ 
,
ææ 
UDP
øø 
}
¿¿ 
}¡¡ Ò-
LD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\UserAccountObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
UserAccountObject "
:# $
CollectObject% 2
{		 
public

 
UserAccountObject

  
(

  !
string

! '
Name

( ,
)

, -
{ 	
this 
. 
Name 
= 
Name 
; 

ResultType 
= 
RESULT_TYPE $
.$ %
USER% )
;) *
} 	
public 
string 
? 
AccountType "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
Caption 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Description "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
Disabled 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Domain 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
FullName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
GID 
{ 
get  
;  !
set" %
;% &
}' (
public 
List 
< 
string 
> 
Groups "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
new3 6
List7 ;
<; <
string< B
>B C
(C D
)D E
;E F
public 
bool 
? 
Hidden 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
HomeDirectory $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
override 
string 
Identity '
{ 	
get 
{ 
return 
string 
. 
Format $
($ %
CultureInfo% 0
.0 1
InvariantCulture1 A
,A B
$strC K
,K L
$strM U
,U V
(W X
DomainX ^
==_ a
nullb f
)f g
?h i
Namej n
:o p
$"q s
{s t
Domaint z
}z {
$str{ }
{} ~
Name	~ Ç
}
Ç É
"
É Ñ
)
Ñ Ö
;
Ö Ü
}   
}!! 	
public## 
string## 
?## 
Inactive## 
{##  !
get##" %
;##% &
set##' *
;##* +
}##, -
public$$ 
string$$ 
?$$ 
InstallDate$$ "
{$$# $
get$$% (
;$$( )
set$$* -
;$$- .
}$$/ 0
public%% 
string%% 
?%% 
LocalAccount%% #
{%%$ %
get%%& )
;%%) *
set%%+ .
;%%. /
}%%0 1
public&& 
string&& 
?&& 
Lockout&& 
{&&  
get&&! $
;&&$ %
set&&& )
;&&) *
}&&+ ,
public'' 
string'' 
Name'' 
{'' 
get''  
;''  !
set''" %
;''% &
}''' (
public(( 
string(( 
?(( 
PasswordChangeable(( )
{((* +
get((, /
;((/ 0
set((1 4
;((4 5
}((6 7
public)) 
string)) 
?)) 
PasswordExpires)) &
{))' (
get))) ,
;)), -
set)). 1
;))1 2
}))3 4
public** 
string** 
?** 
PasswordRequired** '
{**( )
get*** -
;**- .
set**/ 2
;**2 3
}**4 5
public++ 
string++ 
?++ $
PasswordStorageAlgorithm++ /
{++0 1
get++2 5
;++5 6
set++7 :
;++: ;
}++< =
public,, 
bool,, 
?,, 

Privileged,, 
{,,  !
get,," %
;,,% &
set,,' *
;,,* +
},,, -
public-- 

Dictionary-- 
<-- 
string--  
,--  !
string--" (
>--( )
?--) *

Properties--+ 5
{--6 7
get--8 ;
;--; <
set--= @
;--@ A
}--B C
public.. 
string.. 
?.. 
Shell.. 
{.. 
get.. "
;.." #
set..$ '
;..' (
}..) *
public// 
string// 
?// 
SID// 
{// 
get//  
;//  !
set//" %
;//% &
}//' (
public00 
string00 
?00 
UID00 
{00 
get00  
;00  !
set00" %
;00% &
}00' (
}11 
}22 ¶
JD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\UserGroupObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 
GroupAccountObject #
:$ %
CollectObject& 3
{ 
public		 
GroupAccountObject		 !
(		! "
string		" (
Name		) -
)		- .
{

 	
this 
. 
Name 
= 
Name 
; 

ResultType 
= 
RESULT_TYPE $
.$ %
GROUP% *
;* +
} 	
public 
string 
? 
Caption 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Description "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
Domain 
{ 
get  #
;# $
set% (
;( )
}* +
public 
override 
string 
Identity '
{ 	
get 
{ 
return 
( 
Domain 
== !
null" &
)& '
?( )
Name* .
:/ 0
$"1 3
{3 4
Domain4 :
}: ;
$str; =
{= >
Name> B
}B C
"C D
;D E
} 
} 	
public 
string 
? 
InstallDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
bool 
? 
LocalAccount !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 

Dictionary 
< 
string  
,  !
string" (
>( )
?) *

Properties+ 5
{6 7
get8 ;
;; <
set= @
;@ A
}B C
public 
string 
? 
SID 
{ 
get  
;  !
set" %
;% &
}' (
public   
int   
?   
SIDType   
{   
get   !
;  ! "
set  # &
;  & '
}  ( )
public!! 
string!! 
?!! 
Status!! 
{!! 
get!!  #
;!!# $
set!!% (
;!!( )
}!!* +
public"" 
List"" 
<"" 
string"" 
>"" 
Users"" !
{""" #
get""$ '
;""' (
set"") ,
;"", -
}"". /
=""0 1
new""2 5
List""6 :
<"": ;
string""; A
>""A B
(""B C
)""C D
;""D E
}## 
}$$ •
ED:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\WifiObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public 

class 

WifiObject 
: 
CollectObject +
{ 
public 

WifiObject 
( 
string  
SSID! %
)% &
{ 	
this 
. 
SSID 
= 
SSID 
; 
this 
. 

ResultType 
= 
Types #
.# $
RESULT_TYPE$ /
./ 0
WIFI0 4
;4 5
}		 	
public 
string 
? 
Authentication %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
? 

Encryption !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
override 
string 
Identity '
{ 	
get 
{ 
return 
SSID 
; 
} 
} 	
public 
string 
? 
Password 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
SSID 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ≤
FD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Objects\WriteObject.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Objects. 5
{ 
public		 

class		 
WriteObject		 
{

 
public 
WriteObject 
( 
CollectObject (
ColObjIn) 1
,1 2
string3 9
RunIdIn: A
)A B
{ 	
ColObj 
= 
ColObjIn 
??  
throw! &
new' *!
ArgumentNullException+ @
(@ A
nameofA G
(G H
ColObjInH P
)P Q
)Q R
;R S
RunId 
= 
RunIdIn 
; 

Serialized 
= 
ColObj 
.  

Serialized  *
;* +
RowKey 
= 
ColObj 
. 
RowKey "
;" #
} 	
public 
CollectObject 
ColObj #
{$ %
get& )
;) *
}+ ,
public 
string 
Identity 
{ 	
get 
{ 
return 
ColObj 
? 
. 
Identity '
??( *
string+ 1
.1 2
Empty2 7
;7 8
} 
} 	
public 
string 
RowKey 
{ 
get "
;" #
}$ %
public 
string 
RunId 
{ 
get !
;! "
}# $
public 
string 

Serialized  
{! "
get# &
;& '
}( )
public!! 
static!! 
WriteObject!! !
?!!! "

FromString!!# -
(!!- .
string!!. 4
SerializedIn!!5 A
,!!A B
RESULT_TYPE!!C N
ResultTypeIn!!O [
,!![ \
string!!] c
RunIdIn!!d k
)!!k l
{"" 	
var## 
deserialized## 
=## 
	JsonUtils## (
.##( )
Hydrate##) 0
(##0 1
SerializedIn##1 =
,##= >
ResultTypeIn##? K
)##K L
;##L M
if%% 
(%% 
deserialized%% 
is%% 
CollectObject%%  -
)%%- .
{&& 
return'' 
new'' 
WriteObject'' &
(''& '
deserialized''' 3
,''3 4
RunIdIn''5 <
)''< =
;''= >
}(( 
else)) 
{** 
Log++ 
.++ 
Debug++ 
(++ 
$"++ 
$str++ -
{++- .
SerializedIn++. :
}++: ;
$str++; Y
"++Y Z
)++Z [
;++[ \
return,, 
null,, 
;,, 
}-- 
}.. 	
}// 
}00 Ë7
DD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\AsaAnalyzer.cs
	namespace		 	
	Microsoft		
 
.		 
CST		 
.		 !
AttackSurfaceAnalyzer		 -
.		- .
Utils		. 3
{

 
public 

class 
AsaAnalyzer 
: 
Analyzer '
{ 
public 
AsaAnalyzer 
( 
AnalyzerOptions *
?* +
opts, 0
=1 2
null3 7
)7 8
:9 :
base; ?
(? @
opts@ D
)D E
{ 	-
!CustomPropertyExtractionDelegates -
.- .
Add. 1
(1 2$
ParseCustomAsaProperties2 J
)J K
;K L)
CustomObjectToValuesDelegates )
.) *
Add* -
(- .&
ParseCustomAsaObjectValues. H
)H I
;I J
} 	
public 
static 
( 
bool 
	Processed %
,% &
IEnumerable' 2
<2 3
string3 9
>9 :
valsExtracted; H
,H I
IEnumerableJ U
<U V
KeyValuePairV b
<b c
stringc i
,i j
stringk q
>q r
>r s
dictExtracted	t Å
)
Å Ç(
ParseCustomAsaObjectValues
É ù
(
ù û
object
û §
?
§ •
obj
¶ ©
)
© ™
{ 	
if 
( 
obj 
is 

Dictionary !
<! "
(" #
TpmAlgId# +
,+ ,
uint- 1
)1 2
,2 3
byte4 8
[8 9
]9 :
>: ;
algDict< C
)C D
{ 
return 
( 
true 
, 
Array #
.# $
Empty$ )
<) *
string* 0
>0 1
(1 2
)2 3
,3 4
algDict5 <
.< =
ToList= C
(C D
)D E
.E F
SelectF L
(L M
xM N
=>O Q
newR U
KeyValuePairV b
<b c
stringc i
,i j
stringk q
>q r
(r s
xs t
.t u
Keyu x
.x y
ToString	y Å
(
Å Ç
)
Ç É
,
É Ñ
Convert
Ö å
.
å ç
ToBase64String
ç õ
(
õ ú
x
ú ù
.
ù û
Value
û £
)
£ §
)
§ •
)
• ¶
.
¶ ß
ToList
ß ≠
(
≠ Æ
)
Æ Ø
)
Ø ∞
;
∞ ±
} 
return 
( 
false 
, 
Array  
.  !
Empty! &
<& '
string' -
>- .
(. /
)/ 0
,0 1
Array2 7
.7 8
Empty8 =
<= >
KeyValuePair> J
<J K
stringK Q
,Q R
stringS Y
>Y Z
>Z [
([ \
)\ ]
)] ^
;^ _
} 	
public 
static 
( 
bool 
, 
object #
?# $
)$ %$
ParseCustomAsaProperties& >
(> ?
object? E
?E F
objG J
,J K
stringL R
indexS X
)X Y
{ 	
switch 
( 
obj 
) 
{ 
case   

Dictionary   
<    
(    !
TpmAlgId  ! )
,  ) *
uint  + /
)  / 0
,  0 1
byte  2 6
[  6 7
]  7 8
>  8 9
algDict  : A
:  A B
var!! 
elements!!  
=!!! "
Convert!!# *
.!!* +
ToString!!+ 3
(!!3 4
index!!4 9
,!!9 :
CultureInfo!!; F
.!!F G
InvariantCulture!!G W
)!!W X
?!!X Y
.!!Y Z
Trim!!Z ^
(!!^ _
$char!!_ b
)!!b c
.!!c d
Trim!!d h
(!!h i
$char!!i l
)!!l m
.!!m n
Split!!n s
(!!s t
new!!t w
[!!w x
]!!x y
{!!z {
$char!!| 
}
!!Ä Å
,
!!Å Ç 
StringSplitOptions
!!É ï
.
!!ï ñ 
RemoveEmptyEntries
!!ñ ®
)
!!® ©
;
!!© ™
if"" 
("" 
Enum"" 
."" 
TryParse"" %
(""% &
typeof""& ,
("", -
TpmAlgId""- 5
)""5 6
,""6 7
elements""8 @
.""@ A
First""A F
(""F G
)""G H
,""H I
out""J M
object""N T
?""T U
result""V \
)""\ ]
&&""^ `
result## 
is## !
TpmAlgId##" *
	Algorithm##+ 4
&&##5 7
uint##8 <
.##< =
TryParse##= E
(##E F
elements##F N
.##N O
Last##O S
(##S T
)##T U
,##U V
out##W Z
uint##[ _
Index##` e
)##e f
&&##g i
algDict$$ 
.$$  
TryGetValue$$  +
($$+ ,
($$, -
	Algorithm$$- 6
,$$6 7
Index$$8 =
)$$= >
,$$> ?
out$$@ C
byte$$D H
[$$H I
]$$I J
?$$J K
	byteArray$$L U
)$$U V
)$$V W
{%% 
return&& 
(&&  
true&&  $
,&&$ %
	byteArray&&& /
)&&/ 0
;&&0 1
}'' 
else(( 
{)) 
return** 
(**  
true**  $
,**$ %
null**& *
)*** +
;**+ ,
}++ 
},, 
return-- 
(-- 
false-- 
,-- 
null-- 
)--  
;--  !
}.. 	
public00 
IEnumerable00 
<00 
Rule00 
>00  
Analyze00! (
(00( )
IEnumerable00) 4
<004 5
Rule005 9
>009 :
rules00; @
,00@ A
CompareResult00B O
compareResult00P ]
)00] ^
{11 	
if22 
(22 
compareResult22 
==22  
null22! %
)22% &
{33 
return44 
Array44 
.44 
Empty44 "
<44" #
Rule44# '
>44' (
(44( )
)44) *
;44* +
}55 
return77 
Analyze77 
(77 
rules77  
,77  !
compareResult77" /
.77/ 0
Base770 4
,774 5
compareResult776 C
.77C D
Compare77D K
)77K L
;77L M
}88 	
}99 
}:: û¥
CD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\AsaHelpers.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{ 
public 

static 
class 

AsaHelpers "
{ 
public 
static 

Dictionary  
<  !
string! '
,' (
string) /
>/ 0
GenerateMetadata1 A
(A B
)B C
{ 	
var 
dict 
= 
new 

Dictionary %
<% &
string& ,
,, -
string. 4
>4 5
(5 6
)6 7
;7 8
dict 
[ 
$str "
]" #
=$ %
GetVersionString& 6
(6 7
)7 8
;8 9
dict 
[ 
$str 
] 
=  
	GetOsName! *
(* +
)+ ,
., -
Trim- 1
(1 2
)2 3
;3 4
dict 
[ 
$str $
]$ %
=& '
GetOsVersion( 4
(4 5
)5 6
.6 7
Trim7 ;
(; <
)< =
;= >
return 
dict 
; 
} 	
public 
static 
string 
	GetOsName &
(& '
)' (
{ 	
if   
(   
RuntimeInformation   "
.  " #
IsOSPlatform  # /
(  / 0

OSPlatform  0 :
.  : ;
Windows  ; B
)  B C
)  C D
{!! 
return"" 

AsaHelpers"" !
.""! "
GetPlatformString""" 3
(""3 4
)""4 5
;""5 6
}## 
else$$ 
if$$ 
($$ 
RuntimeInformation$$ '
.$$' (
IsOSPlatform$$( 4
($$4 5

OSPlatform$$5 ?
.$$? @
Linux$$@ E
)$$E F
||$$G I
RuntimeInformation$$J \
.$$\ ]
IsOSPlatform$$] i
($$i j

OSPlatform$$j t
.$$t u
OSX$$u x
)$$x y
)$$y z
{%% 
if&& 
(&& !
ExternalCommandRunner&& )
.&&) *
RunExternalCommand&&* <
(&&< =
$str&&= D
,&&D E
$str&&F J
,&&J K
out&&L O
string&&P V
StdOut&&W ]
,&&] ^
out&&_ b
string&&c i
_&&j k
)&&k l
==&&m o
$num&&p q
)&&q r
{'' 
return(( 
StdOut(( !
;((! "
})) 
}** 
return++ 
$str++ 
;++ 
},, 	
public.. 
static.. 
string.. 
GetOsVersion.. )
(..) *
)..* +
{// 	
if00 
(00 
RuntimeInformation00 "
.00" #
IsOSPlatform00# /
(00/ 0

OSPlatform000 :
.00: ;
Windows00; B
)00B C
)00C D
{11 
return22 
Environment22 "
.22" #
	OSVersion22# ,
.22, -
VersionString22- :
;22: ;
}33 
else44 
if44 
(44 
RuntimeInformation44 '
.44' (
IsOSPlatform44( 4
(444 5

OSPlatform445 ?
.44? @
Linux44@ E
)44E F
||44G I
RuntimeInformation44J \
.44\ ]
IsOSPlatform44] i
(44i j

OSPlatform44j t
.44t u
OSX44u x
)44x y
)44y z
{55 
if66 
(66 !
ExternalCommandRunner66 )
.66) *
RunExternalCommand66* <
(66< =
$str66= D
,66D E
$str66F J
,66J K
out66L O
string66P V
StdOut66W ]
,66] ^
out66_ b
string66c i
_66j k
)66k l
==66m o
$num66p q
)66q r
{77 
return88 
StdOut88 !
;88! "
}99 
}:: 
return;; 
$str;; 
;;; 
}<< 	
public>> 
static>> 
PLATFORM>> 
GetPlatform>> *
(>>* +
)>>+ ,
{?? 	
if@@ 
(@@ 
RuntimeInformation@@ "
.@@" #
IsOSPlatform@@# /
(@@/ 0

OSPlatform@@0 :
.@@: ;
Linux@@; @
)@@@ A
)@@A B
{AA 
returnBB 
PLATFORMBB 
.BB  
LINUXBB  %
;BB% &
}CC 
ifDD 
(DD 
RuntimeInformationDD "
.DD" #
IsOSPlatformDD# /
(DD/ 0

OSPlatformDD0 :
.DD: ;
WindowsDD; B
)DDB C
)DDC D
{EE 
returnFF 
PLATFORMFF 
.FF  
WINDOWSFF  '
;FF' (
}GG 
ifHH 
(HH 
RuntimeInformationHH "
.HH" #
IsOSPlatformHH# /
(HH/ 0

OSPlatformHH0 :
.HH: ;
OSXHH; >
)HH> ?
)HH? @
{II 
returnJJ 
PLATFORMJJ 
.JJ  
MACOSJJ  %
;JJ% &
}KK 
returnLL 
PLATFORMLL 
.LL 
UNKNOWNLL #
;LL# $
}MM 	
publicOO 
staticOO 
stringOO 
GetPlatformStringOO .
(OO. /
)OO/ 0
{PP 	
ifQQ 
(QQ 
RuntimeInformationQQ "
.QQ" #
IsOSPlatformQQ# /
(QQ/ 0

OSPlatformQQ0 :
.QQ: ;
LinuxQQ; @
)QQ@ A
)QQA B
{RR 
returnSS 
PLATFORMSS 
.SS  
LINUXSS  %
.SS% &
ToStringSS& .
(SS. /
)SS/ 0
;SS0 1
}TT 
ifUU 
(UU 
RuntimeInformationUU "
.UU" #
IsOSPlatformUU# /
(UU/ 0

OSPlatformUU0 :
.UU: ;
WindowsUU; B
)UUB C
)UUC D
{VV 
returnWW 
PLATFORMWW 
.WW  
WINDOWSWW  '
.WW' (
ToStringWW( 0
(WW0 1
)WW1 2
;WW2 3
}XX 
ifYY 
(YY 
RuntimeInformationYY "
.YY" #
IsOSPlatformYY# /
(YY/ 0

OSPlatformYY0 :
.YY: ;
OSXYY; >
)YY> ?
)YY? @
{ZZ 
return[[ 
PLATFORM[[ 
.[[  
MACOS[[  %
.[[% &
ToString[[& .
([[. /
)[[/ 0
;[[0 1
}\\ 
return]] 
PLATFORM]] 
.]] 
UNKNOWN]] #
.]]# $
ToString]]$ ,
(]], -
)]]- .
;]]. /
}^^ 	
public`` 
static`` 
string`` 
GetTempFolder`` *
(``* +
)``+ ,
{aa 	
varbb 
lengthbb 
=bb 
$numbb 
;bb 
constcc 
stringcc 
charscc 
=cc  
$strcc! G
;ccG H
vardd 
pathdd 
=dd 
Pathdd 
.dd 
Combinedd #
(dd# $
Pathdd$ (
.dd( )
GetTempPathdd) 4
(dd4 5
)dd5 6
,dd6 7
newdd8 ;
stringdd< B
(ddB C

EnumerableddC M
.ddM N
RepeatddN T
(ddT U
charsddU Z
,ddZ [
lengthdd\ b
)ddb c
.ee 
Selectee 
(ee 
see 
=>ee 
see 
[ee 
randomee #
.ee# $
Nextee$ (
(ee( )
see) *
.ee* +
Lengthee+ 1
)ee1 2
]ee2 3
)ee3 4
.ee4 5
ToArrayee5 <
(ee< =
)ee= >
)ee> ?
)ee? @
;ee@ A
whileff 
(ff 
	Directoryff 
.ff 
Existsff #
(ff# $
pathff$ (
)ff( )
)ff) *
{gg 
pathhh 
=hh 
Pathhh 
.hh 
Combinehh #
(hh# $
Pathhh$ (
.hh( )
GetTempPathhh) 4
(hh4 5
)hh5 6
,hh6 7
newhh8 ;
stringhh< B
(hhB C

EnumerablehhC M
.hhM N
RepeathhN T
(hhT U
charshhU Z
,hhZ [
lengthhh\ b
)hhb c
.ii 
Selectii 
(ii 
sii 
=>ii 
sii 
[ii 
randomii #
.ii# $
Nextii$ (
(ii( )
sii) *
.ii* +
Lengthii+ 1
)ii1 2
]ii2 3
)ii3 4
.ii4 5
ToArrayii5 <
(ii< =
)ii= >
)ii> ?
)ii? @
;ii@ A
}jj 
returnkk 
pathkk 
;kk 
}ll 	
publicnn 
staticnn 
stringnn 
GetVersionStringnn -
(nn- .
)nn. /
{oo 	
returnpp 
(pp 
Assemblypp 
.pp  
GetExecutingAssemblypp 1
(pp1 2
)pp2 3
.pp3 4
GetCustomAttributespp4 G
(ppG H
typeofppH N
(ppN O1
%AssemblyInformationalVersionAttributeppO t
)ppt u
,ppu v
falseppw |
)pp| }
as	pp~ Ä3
%AssemblyInformationalVersionAttribute
ppÅ ¶
[
pp¶ ß
]
ppß ®
)
pp® ©
?
pp© ™
[
pp™ ´
$num
pp´ ¨
]
pp¨ ≠
.
pp≠ Æ"
InformationalVersion
ppÆ ¬
??
pp√ ≈
$str
pp∆ œ
;
ppœ –
}qq 	
publicss 
staticss 
bytess 
[ss 
]ss 
HexStringToBytesss -
(ss- .
stringss. 4
hexss5 8
)ss8 9
{tt 	
tryuu 
{vv 
ifww 
(ww 
hexww 
isww 
nullww 
)ww  
{ww! "
throwww# (
newww) ,!
ArgumentNullExceptionww- B
(wwB C
nameofwwC I
(wwI J
hexwwJ M
)wwM N
)wwN O
;wwO P
}wwQ R
varyy 
asciiyy 
=yy 
newyy 
byteyy  $
[yy$ %
hexyy% (
.yy( )
Lengthyy) /
/yy0 1
$numyy2 3
]yy3 4
;yy4 5
for{{ 
({{ 
int{{ 
i{{ 
={{ 
$num{{ 
;{{ 
i{{  !
<{{" #
hex{{$ '
.{{' (
Length{{( .
;{{. /
i{{0 1
+={{2 4
$num{{5 6
){{6 7
{|| 
var}} 
hs}} 
=}} 
hex}}  
.}}  !
	Substring}}! *
(}}* +
i}}+ ,
,}}, -
$num}}. /
)}}/ 0
;}}0 1
uint~~ 
decval~~ 
=~~  !
System~~" (
.~~( )
Convert~~) 0
.~~0 1
ToUInt32~~1 9
(~~9 :
hs~~: <
,~~< =
$num~~> @
)~~@ A
;~~A B
char 
	character "
=# $
System% +
.+ ,
Convert, 3
.3 4
ToChar4 :
(: ;
decval; A
)A B
;B C
ascii
ÄÄ 
[
ÄÄ 
i
ÄÄ 
/
ÄÄ 
$num
ÄÄ 
]
ÄÄ  
=
ÄÄ! "
(
ÄÄ# $
byte
ÄÄ$ (
)
ÄÄ( )
	character
ÄÄ) 2
;
ÄÄ2 3
}
ÅÅ 
return
ÉÉ 
ascii
ÉÉ 
;
ÉÉ 
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
e
ÖÖ 
)
ÖÖ 
when
ÖÖ  $
(
ÖÖ% &
e
ÜÜ 
is
ÜÜ 
ArgumentException
ÜÜ &
||
áá 
e
áá 
is
áá 
OverflowException
áá )
||
àà 
e
àà 
is
àà $
NullReferenceException
àà .
)
àà. /
{
ââ 
Log
ää 
.
ää 
Debug
ää 
(
ää 
$str
ää D
,
ääD E
hex
ääF I
)
ääI J
;
ääJ K
}
ãã 
return
åå 
Array
åå 
.
åå 
Empty
åå 
<
åå 
byte
åå #
>
åå# $
(
åå$ %
)
åå% &
;
åå& '
}
çç 	
public
èè 
static
èè 
bool
èè 
IsAdmin
èè "
(
èè" #
)
èè# $
{
êê 	
if
ëë 
(
ëë 
	_elevated
ëë 
is
ëë 
null
ëë !
)
ëë! "
{
íí 
	_elevated
ìì 
=
ìì 
	Elevation
ìì %
.
ìì% &
IsAdministrator
ìì& 5
(
ìì5 6
)
ìì6 7
||
ìì8 :
	Elevation
ìì; D
.
ììD E
IsRunningAsRoot
ììE T
(
ììT U
)
ììU V
;
ììV W
}
îî 
return
ïï 
(
ïï 
bool
ïï 
)
ïï 
	_elevated
ïï "
;
ïï" #
}
ññ 	
public
òò 
static
òò 
bool
òò 
IsDictionary
òò '
(
òò' (
object
òò( .
o
òò/ 0
)
òò0 1
{
ôô 	
if
öö 
(
öö 
o
öö 
==
öö 
null
öö 
)
öö 
return
öö !
false
öö" '
;
öö' (
return
õõ 
o
õõ 
is
õõ 
IDictionary
õõ #
&&
õõ$ &
o
úú 
.
úú 
GetType
úú 
(
úú 
)
úú 
.
úú 
IsGenericType
úú ,
&&
úú- /
o
ùù 
.
ùù 
GetType
ùù 
(
ùù 
)
ùù 
.
ùù &
GetGenericTypeDefinition
ùù 7
(
ùù7 8
)
ùù8 9
.
ùù9 :
IsAssignableFrom
ùù: J
(
ùùJ K
typeof
ùùK Q
(
ùùQ R

Dictionary
ùùR \
<
ùù\ ]
,
ùù] ^
>
ùù^ _
)
ùù_ `
)
ùù` a
;
ùùa b
}
ûû 	
public
†† 
static
†† 
bool
†† 
IsList
†† !
(
††! "
object
††" (
o
††) *
)
††* +
{
°° 	
if
¢¢ 
(
¢¢ 
o
¢¢ 
==
¢¢ 
null
¢¢ 
)
¢¢ 
return
¢¢ !
false
¢¢" '
;
¢¢' (
return
££ 
o
££ 
is
££ 
IList
££ 
&&
££  
o
§§ 
.
§§ 
GetType
§§ 
(
§§ 
)
§§ 
.
§§ 
IsGenericType
§§ ,
&&
§§- /
o
•• 
.
•• 
GetType
•• 
(
•• 
)
•• 
.
•• &
GetGenericTypeDefinition
•• 7
(
••7 8
)
••8 9
.
••9 :
IsAssignableFrom
••: J
(
••J K
typeof
••K Q
(
••Q R
List
••R V
<
••V W
>
••W X
)
••X Y
)
••Y Z
;
••Z [
}
¶¶ 	
public
®® 
static
®® 
string
®® 
MakeValidFileName
®® .
(
®®. /
string
®®/ 5
name
®®6 :
)
®®: ;
{
©© 	
string
™™ 
invalidChars
™™ 
=
™™  !
System
™™" (
.
™™( )
Text
™™) -
.
™™- . 
RegularExpressions
™™. @
.
™™@ A
Regex
™™A F
.
™™F G
Escape
™™G M
(
™™M N
new
™™N Q
string
™™R X
(
™™X Y
System
™™Y _
.
™™_ `
IO
™™` b
.
™™b c
Path
™™c g
.
™™g h%
GetInvalidFileNameChars
™™h 
(™™ Ä
)™™Ä Å
)™™Å Ç
)™™Ç É
;™™É Ñ
string
´´ 
invalidRegStr
´´  
=
´´! "
$"
´´# %
$str
´´% '
{
´´' (
invalidChars
´´( 4
}
´´4 5
$str
´´5 8
"
´´8 9
;
´´9 :
return
¨¨ 
System
¨¨ 
.
¨¨ 
Text
¨¨ 
.
¨¨  
RegularExpressions
¨¨ 1
.
¨¨1 2
Regex
¨¨2 7
.
¨¨7 8
Replace
¨¨8 ?
(
¨¨? @
name
¨¨@ D
,
¨¨D E
invalidRegStr
¨¨F S
,
¨¨S T
$str
¨¨U X
)
¨¨X Y
;
¨¨Y Z
}
≠≠ 	
public
ØØ 
static
ØØ 
void
ØØ 
OpenBrowser
ØØ &
(
ØØ& '
System
ØØ' -
.
ØØ- .
Uri
ØØ. 1
url
ØØ2 5
)
ØØ5 6
{
∞∞ 	
if
±± 
(
±± 
url
±± 
==
±± 
null
±± 
)
±± 
{
±± 
return
±± %
;
±±% &
}
±±' (
if
≤≤ 
(
≤≤  
RuntimeInformation
≤≤ "
.
≤≤" #
IsOSPlatform
≤≤# /
(
≤≤/ 0

OSPlatform
≤≤0 :
.
≤≤: ;
Windows
≤≤; B
)
≤≤B C
)
≤≤C D
{
≥≥ 
Process
¥¥ 
.
¥¥ 
Start
¥¥ 
(
¥¥ 
new
¥¥ !
ProcessStartInfo
¥¥" 2
(
¥¥2 3
$str
¥¥3 8
,
¥¥8 9
$"
¥¥: <
$str
¥¥< E
{
¥¥E F
url
¥¥F I
}
¥¥I J
"
¥¥J K
)
¥¥K L
)
¥¥L M
;
¥¥M N
}
µµ 
else
∂∂ 
if
∂∂ 
(
∂∂  
RuntimeInformation
∂∂ '
.
∂∂' (
IsOSPlatform
∂∂( 4
(
∂∂4 5

OSPlatform
∂∂5 ?
.
∂∂? @
Linux
∂∂@ E
)
∂∂E F
)
∂∂F G
{
∑∑ 
Process
∏∏ 
.
∏∏ 
Start
∏∏ 
(
∏∏ 
$str
∏∏ (
,
∏∏( )
url
∏∏* -
.
∏∏- .
ToString
∏∏. 6
(
∏∏6 7
)
∏∏7 8
)
∏∏8 9
;
∏∏9 :
}
ππ 
else
∫∫ 
if
∫∫ 
(
∫∫  
RuntimeInformation
∫∫ '
.
∫∫' (
IsOSPlatform
∫∫( 4
(
∫∫4 5

OSPlatform
∫∫5 ?
.
∫∫? @
OSX
∫∫@ C
)
∫∫C D
)
∫∫D E
{
ªª 
Process
ºº 
.
ºº 
Start
ºº 
(
ºº 
$str
ºº $
,
ºº$ %
url
ºº& )
.
ºº) *
ToString
ºº* 2
(
ºº2 3
)
ºº3 4
)
ºº4 5
;
ºº5 6
}
ΩΩ 
}
ææ 	
public
¿¿ 
static
¿¿ 
string
¿¿ 
RunIdsToCompareId
¿¿ .
(
¿¿. /
string
¿¿/ 5

firstRunId
¿¿6 @
,
¿¿@ A
string
¿¿B H
secondRunId
¿¿I T
)
¿¿T U
{
¡¡ 	
return
¬¬ 
$"
¬¬ 
{
¬¬ 

firstRunId
¬¬  
}
¬¬  !
$str
¬¬! $
{
¬¬$ %
secondRunId
¬¬% 0
}
¬¬0 1
"
¬¬1 2
;
¬¬2 3
}
√√ 	
public
≈≈ 
static
≈≈ 
string
≈≈ 
	SidToName
≈≈ &
(
≈≈& '
IdentityReference
≈≈' 8
?
≈≈8 9
SID
≈≈: =
)
≈≈= >
{
∆∆ 	
if
«« 
(
««  
RuntimeInformation
«« "
.
««" #
IsOSPlatform
««# /
(
««/ 0

OSPlatform
««0 :
.
««: ;
Windows
««; B
)
««B C
)
««C D
{
»» 
string
…… 
sid
…… 
=
…… 
SID
……  
?
……  !
.
……! "
Value
……" '
??
……( *
string
……+ 1
.
……1 2
Empty
……2 7
;
……7 8
string
   
identity
   
=
    !
sid
  " %
;
  % &
if
ÃÃ 
(
ÃÃ 
SidMap
ÃÃ 
.
ÃÃ 
TryGetValue
ÃÃ &
(
ÃÃ& '
sid
ÃÃ' *
,
ÃÃ* +
out
ÃÃ, /
string
ÃÃ0 6
?
ÃÃ6 7
mappedIdentity
ÃÃ8 F
)
ÃÃF G
)
ÃÃG H
{
ÕÕ 
if
ŒŒ 
(
ŒŒ 
mappedIdentity
ŒŒ &
!=
ŒŒ' )
null
ŒŒ* .
)
ŒŒ. /
{
œœ 
return
–– 
mappedIdentity
–– -
;
––- .
}
—— 
else
““ 
{
”” 
SidMap
‘‘ 
.
‘‘ 
	TryRemove
‘‘ (
(
‘‘( )
sid
‘‘) ,
,
‘‘, -
out
‘‘. 1
_
‘‘2 3
)
‘‘3 4
;
‘‘4 5
}
’’ 
}
÷÷ 
if
ŸŸ 
(
ŸŸ 
sid
ŸŸ 
.
ŸŸ 

StartsWith
ŸŸ "
(
ŸŸ" #
$str
ŸŸ# *
)
ŸŸ* +
)
ŸŸ+ ,
{
⁄⁄ 
try
€€ 
{
‹‹ 
identity
››  
=
››! "
SID
››# &
?
››& '
.
››' (
	Translate
››( 1
(
››1 2
typeof
››2 8
(
››8 9
	NTAccount
››9 B
)
››B C
)
››C D
?
››D E
.
››E F
Value
››F K
??
››L N
sid
››O R
;
››R S
}
ﬁﬁ 
catch
ﬂﬂ 
(
ﬂﬂ (
IdentityNotMappedException
ﬂﬂ 5
)
ﬂﬂ5 6
{
‡‡ 
}
·· 
}
‚‚ 
SidMap
‰‰ 
.
‰‰ 
TryAdd
‰‰ 
(
‰‰ 
sid
‰‰ !
,
‰‰! "
identity
‰‰# +
)
‰‰+ ,
;
‰‰, -
return
ÊÊ 
sid
ÊÊ 
;
ÊÊ 
}
ÁÁ 
return
ËË 
string
ËË 
.
ËË 
Empty
ËË 
;
ËË  
}
ÈÈ 	
private
ÎÎ 
static
ÎÎ 
readonly
ÎÎ 
Random
ÎÎ  &
random
ÎÎ' -
=
ÎÎ. /
new
ÎÎ0 3
Random
ÎÎ4 :
(
ÎÎ: ;
)
ÎÎ; <
;
ÎÎ< =
private
ÏÏ 
static
ÏÏ 
readonly
ÏÏ "
ConcurrentDictionary
ÏÏ  4
<
ÏÏ4 5
string
ÏÏ5 ;
,
ÏÏ; <
string
ÏÏ= C
>
ÏÏC D
SidMap
ÏÏE K
=
ÏÏL M
new
ÏÏN Q"
ConcurrentDictionary
ÏÏR f
<
ÏÏf g
string
ÏÏg m
,
ÏÏm n
string
ÏÏo u
>
ÏÏu v
(
ÏÏv w
)
ÏÏw x
;
ÏÏx y
private
ÌÌ 
static
ÌÌ 
bool
ÌÌ 
?
ÌÌ 
	_elevated
ÌÌ &
=
ÌÌ' (
null
ÌÌ) -
;
ÌÌ- .
}
ÓÓ 
}ÔÔ ò
ED:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\AssemblyInfo.cs
[ 
assembly 	
:	 
$
NeutralResourcesLanguage #
(# $
$str$ (
)( )
]) *
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{ 
} É2
FD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\CryptoHelpers.cs
	namespace		 	
	Microsoft		
 
.		 
CST		 
.		 !
AttackSurfaceAnalyzer		 -
.		- .
Utils		. 3
{

 
public 

static 
class 
CryptoHelpers %
{ 
public 
static 
string 

CreateHash '
(' (
string( .
input/ 4
)4 5
{ 	
try 
{ 
byte 
[ 
] 

hashOutput !
=" #
sha512$ *
.* +
ComputeHash+ 6
(6 7
Encoding7 ?
.? @
UTF8@ D
.D E
GetBytesE M
(M N
inputN S
)S T
)T U
;U V
return 
Convert 
. 
ToBase64String -
(- .

hashOutput. 8
)8 9
;9 :
} 
catch 
( "
CryptographicException )
e* +
)+ ,
{ 
Log 
. 
Warning 
( 
e 
, 
Strings &
.& '
Get' *
(* +
$str+ ;
); <
,< =
input> C
isD F
nullG K
?L M
$strN [
:\ ]
$"^ `
$str` a
{a b
inputb g
}g h
$strh i
"i j
)j k
;k l
return 
string 
. 
Empty #
;# $
} 
} 	
public   
static   
string   

CreateHash   '
(  ' (
Stream  ( .
stream  / 5
)  5 6
{!! 	
try"" 
{## 
return$$ 
Convert$$ 
.$$ 
ToBase64String$$ -
($$- .
sha512$$. 4
.$$4 5
ComputeHash$$5 @
($$@ A
stream$$A G
)$$G H
??$$I K
Array$$L Q
.$$Q R
Empty$$R W
<$$W X
byte$$X \
>$$\ ]
($$] ^
)$$^ _
)$$_ `
;$$` a
}%% 
catch&& 
(&& "
CryptographicException&& )
e&&* +
)&&+ ,
{'' 
Log(( 
.(( 
Warning(( 
((( 
e(( 
,(( 
Strings(( &
.((& '
Get((' *
(((* +
$str((+ ;
)((; <
,((< =
$str((> F
)((F G
;((G H
return)) 
string)) 
.)) 
Empty)) #
;))# $
}** 
}++ 	
public-- 
static-- 
double-- #
GetRandomPositiveDouble-- 4
(--4 5
double--5 ;
max--< ?
)--? @
{.. 	
var// 
bytes// 
=// 
new// 
byte//  
[//  !
$num//! "
]//" #
;//# $
crypto00 
.00 
GetBytes00 
(00 
bytes00 !
)00! "
;00" #
return11 
(11 
BitConverter11  
.11  !
ToUInt6411! )
(11) *
bytes11* /
,11/ 0
$num111 2
)112 3
>>114 6
$num117 9
)119 :
/11; <
(11= >
double11> D
)11D E
ulong11E J
.11J K
MaxValue11K S
*11T U
max11V Y
;11Y Z
}22 	
public44 
static44 
int44 "
GetRandomPositiveIndex44 0
(440 1
int441 4
max445 8
)448 9
{55 	
var66 
randomInteger66 
=66 
UInt3266  &
.66& '
MaxValue66' /
;66/ 0
while77 
(77 
randomInteger77  
==77! #
UInt3277$ *
.77* +
MaxValue77+ 3
)773 4
{88 
byte99 
[99 
]99 
data99 
=99 
new99 !
byte99" &
[99& '
$num99' (
]99( )
;99) *
crypto:: 
.:: 
GetBytes:: 
(::  
data::  $
)::$ %
;::% &
randomInteger;; 
=;; 
BitConverter;;  ,
.;;, -
ToUInt32;;- 5
(;;5 6
data;;6 :
,;;: ;
$num;;< =
);;= >
;;;> ?
}<< 
return>> 
(>> 
int>> 
)>> 
(>> 
max>> 
*>> 
(>>  
randomInteger>>  -
/>>. /
(>>0 1
double>>1 7
)>>7 8
uint>>8 <
.>>< =
MaxValue>>= E
)>>E F
)>>F G
;>>G H
}?? 	
publicAA 
staticAA 
stringAA 
GetRandomStringAA ,
(AA, -
intAA- 0

charactersAA1 ;
)AA; <
=>AA= ?
newAA@ C
stringAAD J
(AAJ K

EnumerableAAK U
.AAU V
RangeAAV [
(AA[ \
$numAA\ ]
,AA] ^

charactersAA_ i
)AAi j
.AAj k
SelectAAk q
(AAq r
_AAr s
=>AAt v
charsAAw |
[AA| }#
GetRandomPositiveIndex	AA} ì
(
AAì î
chars
AAî ô
.
AAô ö
Length
AAö †
)
AA† °
]
AA° ¢
)
AA¢ £
.
AA£ §
ToArray
AA§ ´
(
AA´ ¨
)
AA¨ ≠
)
AA≠ Æ
;
AAÆ Ø
privateCC 
constCC 
stringCC 
charsCC "
=CC# $
$strCC% K
;CCK L
privateEE 
staticEE 
readonlyEE $
RNGCryptoServiceProviderEE  8
cryptoEE9 ?
=EE@ A
newEEB E$
RNGCryptoServiceProviderEEF ^
(EE^ _
)EE_ `
;EE` a
privateGG 
staticGG 
readonlyGG 
HashAlgorithmGG  -
sha512GG. 4
=GG5 6
SHA512ManagedGG7 D
.GGD E
CreateGGE K
(GGK L
)GGL M
;GGM N
}HH 
}II K
ID:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\CryptoHelperTEst.csL
JD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\CyptoHelperTests2.csßl
HD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\DatabaseManager.cs
	namespace		 	
	Microsoft		
 
.		 
CST		 
.		 !
AttackSurfaceAnalyzer		 -
.		- .
Utils		. 3
{

 
public 

abstract 
class 
DatabaseManager )
{ 
public 
bool 
FirstRun 
{ 
get "
;" #
internal$ ,
set- 0
;0 1
}2 3
=4 5
true6 :
;: ;
public 
abstract 
bool 
HasElements (
{) *
get+ .
;. /
}0 1
public 
string 
Location 
{  
get! $
;$ %
internal& .
set/ 2
;2 3
}4 5
=6 7
$str8 @
;@ A
public 
abstract 
int 
	QueueSize %
{& '
get( +
;+ ,
}- .
public 
static 
void 
Destroy "
(" #
string# )
sqliteFilename* 8
)8 9
{ 	
var 
	directory 
= 
Path  
.  !
GetDirectoryName! 1
(1 2
sqliteFilename2 @
)@ A
;A B
if 
( 
string 
. 
IsNullOrEmpty $
($ %
	directory% .
). /
)/ 0
{ 
	directory 
= 
$str 
;  
} 
var 
toDelete 
= 
	Directory $
.$ %
EnumerateFiles% 3
(3 4
	directory4 =
,= >
sqliteFilename? M
)M N
;N O
foreach 
( 
var 
file 
in  
toDelete! )
)) *
{ 
File 
. 
Delete 
( 
file  
)  !
;! "
} 
} 	
public!! 
static!! 
int!! 
ModuloString!! &
(!!& '
string!!' -
identity!!. 6
,!!6 7
int!!8 ;
shardingFactor!!< J
)!!J K
=>!!L N
identity!!O W
.!!W X
Sum!!X [
(!![ \
x!!\ ]
=>!!^ `
x!!a b
)!!b c
%!!d e
shardingFactor!!f t
;!!t u
public## 
abstract## 
void## 
BeginTransaction## -
(##- .
)##. /
;##/ 0
public%% 
abstract%% 
void%% 
CloseDatabase%% *
(%%* +
)%%+ ,
;%%, -
public'' 
abstract'' 
void'' 
Commit'' #
(''# $
)''$ %
;''% &
public)) 
abstract)) 
void)) 
	DeleteRun)) &
())& '
string))' -
runid)). 3
)))3 4
;))4 5
public** 
abstract** 
void** 
DeleteCompareRun** -
(**- .
string**. 4

firstRunid**5 ?
,**? @
string**A G
secondRunid**H S
,**S T
string**U [
analysisHash**\ h
)**h i
;**i j
public,, 
abstract,, 
void,, 
Destroy,, $
(,,$ %
),,% &
;,,& '
public.. 
abstract.. 
IEnumerable.. #
<..# $
WriteObject..$ /
>../ 0
GetAllMissing..1 >
(..> ?
string..? E

firstRunId..F P
,..P Q
string..R X
secondRunId..Y d
)..d e
;..e f
public00 
List00 
<00 
RESULT_TYPE00 
>00   
GetCommonResultTypes00! 5
(005 6
string006 <
baseId00= C
,00C D
string00E K
	compareId00L U
)00U V
{11 	
var22 
runOne22 
=22 
GetRun22 
(22  
baseId22  &
)22& '
;22' (
var33 
runTwo33 
=33 
GetRun33 
(33  
	compareId33  )
)33) *
;33* +
return55 
runOne55 
?55 
.55 
ResultTypes55 &
.55& '
	Intersect55' 0
(550 1
runTwo551 7
?557 8
.558 9
ResultTypes559 D
??55E G
new55H K
List55L P
<55P Q
RESULT_TYPE55Q \
>55\ ]
(55] ^
)55^ _
)55_ `
.55` a
ToList55a g
(55g h
)55h i
??55j l
(55m n
runTwo55n t
?55t u
.55u v
ResultTypes	55v Å
??
55Ç Ñ
new
55Ö à
List
55â ç
<
55ç é
RESULT_TYPE
55é ô
>
55ô ö
(
55ö õ
)
55õ ú
)
55ú ù
;
55ù û
}66 	
public88 
abstract88 
bool88 "
GetComparisonCompleted88 3
(883 4
string884 :
?88: ;

firstRunId88< F
,88F G
string88H N
secondRunId88O Z
,88Z [
string88\ b
analysesHash88c o
)88o p
;88p q
public:: 
abstract:: 
List:: 
<:: 
CompareResult:: *
>::* + 
GetComparisonResults::, @
(::@ A
string::A G
baseId::H N
,::N O
string::P V
	compareId::W `
,::` a
string::b h
analysesHash::i u
,::u v
RESULT_TYPE	::w Ç

exportType
::É ç
)
::ç é
;
::é è
public<< 
abstract<< 
List<< 
<<< 
CompareResult<< *
><<* + 
GetComparisonResults<<, @
(<<@ A
string<<A G
baseId<<H N
,<<N O
string<<P V
	compareId<<W `
,<<` a
string<<b h
analysesHash<<i u
,<<u v
RESULT_TYPE	<<w Ç

resultType
<<É ç
,
<<ç é
int
<<è í
offset
<<ì ô
,
<<ô ö
int
<<õ û

numResults
<<ü ©
)
<<© ™
;
<<™ ´
public>> 
abstract>> 
int>> %
GetComparisonResultsCount>> 5
(>>5 6
string>>6 <
baseId>>= C
,>>C D
string>>E K
	compareId>>L U
,>>U V
string>>W ]
analysesHash>>^ j
,>>j k
int>>l o

resultType>>p z
)>>z {
;>>{ |
public@@ 
abstract@@ 

DBSettings@@ "
GetCurrentSettings@@# 5
(@@5 6
)@@6 7
;@@7 8
publicBB 
abstractBB 
ListBB 
<BB 
stringBB #
>BB# $
GetLatestRunIdsBB% 4
(BB4 5
intBB5 8
numberOfIdsBB9 D
,BBD E
RUN_TYPEBBF N
typeBBO S
)BBS T
;BBT U
publicDD 
abstractDD 
IEnumerableDD #
<DD# $
WriteObjectDD$ /
>DD/ 0
GetMissingFromFirstDD1 D
(DDD E
stringDDE K

firstRunIdDDL V
,DDV W
stringDDX ^
secondRunIdDD_ j
)DDj k
;DDk l
publicFF 
abstractFF 
IEnumerableFF #
<FF# $
(FF$ %
WriteObjectFF% 0
,FF0 1
WriteObjectFF2 =
)FF= >
>FF> ?
GetModifiedFF@ K
(FFK L
stringFFL R

firstRunIdFFS ]
,FF] ^
stringFF_ e
secondRunIdFFf q
)FFq r
;FFr s
publicHH 
abstractHH 
IEnumerableHH #
<HH# $
FileMonitorObjectHH$ 5
>HH5 6
GetMonitorResultsHH7 H
(HHH I
stringHHI O
runIdHHP U
,HHU V
intHHW Z
offsetHH[ a
=HHb c
$numHHd e
,HHe f
intHHg j

numResultsHHk u
=HHv w
-HHx y
$numHHy z
)HHz {
;HH{ |
publicJJ 
ListJJ 
<JJ 
stringJJ 
>JJ 
GetMonitorRunsJJ *
(JJ* +
)JJ+ ,
{KK 	
returnLL 
GetRunsLL 
(LL 
RUN_TYPELL #
.LL# $
MONITORLL$ +
)LL+ ,
;LL, -
}MM 	
publicOO 
abstractOO 
intOO  
GetNumMonitorResultsOO 0
(OO0 1
stringOO1 7
runIdOO8 =
)OO= >
;OO> ?
publicQQ 
abstractQQ 
intQQ 
GetNumResultsQQ )
(QQ) *
RESULT_TYPEQQ* 5

ResultTypeQQ6 @
,QQ@ A
stringQQB H
runIdQQI N
)QQN O
;QQO P
publicSS 
abstractSS 
ListSS 
<SS 
DataRunModelSS )
>SS) *
GetResultModelsSS+ :
(SS: ;

RUN_STATUSSS; E
	runStatusSSF O
)SSO P
;SSP Q
publicUU 
abstractUU 
IEnumerableUU #
<UU# $
WriteObjectUU$ /
>UU/ 0
GetResultsByRunidUU1 B
(UUB C
stringUUC I
runidUUJ O
)UUO P
;UUP Q
publicWW 
abstractWW 

DictionaryWW "
<WW" #
RESULT_TYPEWW# .
,WW. /
intWW0 3
>WW3 4#
GetResultTypesAndCountsWW5 L
(WWL M
stringWWM S
runIdWWT Y
)WWY Z
;WWZ [
publicYY 
abstractYY 
AsaRunYY 
?YY 
GetRunYY  &
(YY& '
stringYY' -
RunIdYY. 3
)YY3 4
;YY4 5
public[[ 
abstract[[ 
List[[ 
<[[ 
string[[ #
>[[# $
GetRuns[[% ,
([[, -
RUN_TYPE[[- 5
type[[6 :
)[[: ;
;[[; <
public]] 
abstract]] 
List]] 
<]] 
string]] #
>]]# $
GetRuns]]% ,
(]], -
)]]- .
;]]. /
public__ 
abstract__ 
List__ 
<__ 
FileMonitorEvent__ -
>__- .'
GetSerializedMonitorResults__/ J
(__J K
string__K Q
runId__R W
)__W X
;__X Y
publicaa 
abstractaa 
Settingsaa  
?aa  !
GetSettingsaa" -
(aa- .
)aa. /
;aa/ 0
publiccc 
abstractcc 
voidcc 
InsertAnalyzedcc +
(cc+ ,
CompareResultcc, 9
objIncc: ?
)cc? @
;cc@ A
publicee 
abstractee 
voidee 
InsertCompareRunee -
(ee- .
stringee. 4
?ee4 5

firstRunIdee6 @
,ee@ A
stringeeB H
secondRunIdeeI T
,eeT U
stringeeV \
analysesHashee] i
,eei j

RUN_STATUSeek u
	runStatuseev 
)	ee Ä
;
eeÄ Å
publicgg 
abstractgg 
Listgg 
<gg 
(gg 
stringgg $

firstRunIdgg% /
,gg/ 0
stringgg1 7
secondRunIdgg8 C
,ggC D
stringggE K
analysesHashggL X
,ggX Y

RUN_STATUSggZ d
	runStatusgge n
)ggn o
>ggo p
GetCompareRunsggq 
(	gg Ä
)
ggÄ Å
;
ggÅ Ç
publicii 
abstractii 
voidii 
	InsertRunii &
(ii& '
AsaRunii' -
runii. 1
)ii1 2
;ii2 3
publickk 
abstractkk 
voidkk 
RollBackkk %
(kk% &
)kk& '
;kk' (
publicmm 
abstractmm 
PLATFORMmm  
RunIdToPlatformmm! 0
(mm0 1
stringmm1 7
runidmm8 =
)mm= >
;mm> ?
publicoo 
abstractoo 
voidoo 
SetSettingsoo (
(oo( )
Settingsoo) 1
settingsoo2 :
)oo: ;
;oo; <
publicqq 
abstractqq 
	ASA_ERRORqq !
Setupqq" '
(qq' (
)qq( )
;qq) *
publicss 
abstractss 
voidss 
TrimToLatestss )
(ss) *
)ss* +
;ss+ ,
publicuu 
abstractuu 
voiduu 
UpdateCompareRunuu -
(uu- .
stringuu. 4
?uu4 5

firstRunIduu6 @
,uu@ A
stringuuB H
secondRunIduuI T
,uuT U

RUN_STATUSuuV `
	runStatusuua j
)uuj k
;uuk l
publicww 
abstractww 
voidww 
Vacuumww #
(ww# $
)ww$ %
;ww% &
public|| 
void|| 
WaitUntilFlushed|| $
(||$ %
)||% &
{}} 	
while~~ 
(~~ 
HasElements~~ 
)~~ 
{ 
Thread
ÄÄ 
.
ÄÄ 
Sleep
ÄÄ 
(
ÄÄ 
$num
ÄÄ 
)
ÄÄ 
;
ÄÄ  
}
ÅÅ 
}
ÇÇ 	
public
ÑÑ 
abstract
ÑÑ 
void
ÑÑ 
Write
ÑÑ "
(
ÑÑ" #
CollectObject
ÑÑ# 0
?
ÑÑ0 1
colObj
ÑÑ2 8
,
ÑÑ8 9
string
ÑÑ: @
?
ÑÑ@ A
runId
ÑÑB G
)
ÑÑG H
;
ÑÑH I
}
ÖÖ 
}ÜÜ ‘°
BD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\Elevation.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{		 
public

 

static

 
class

 
	Elevation

 !
{ 
internal 
static 
bool 
IsUserInAdminGroup /
(/ 0
)0 1
{ 	
bool 
fInAdminGroup 
=  
false! &
;& '
SafeTokenHandle 
? 
hToken #
=$ %
null& *
;* +
SafeTokenHandle 
? 
hTokenToCheck *
=+ ,
null- 1
;1 2
IntPtr 
pElevationType !
=" #
IntPtr$ *
.* +
Zero+ /
;/ 0
IntPtr 
pLinkedToken 
=  !
IntPtr" (
.( )
Zero) -
;- .
int 
cbSize 
= 
$num 
; 
try!! 
{"" 
if$$ 
($$ 
!$$ 
NativeMethods$$ "
.$$" #
OpenProcessToken$$# 3
($$3 4
Process$$4 ;
.$$; <
GetCurrentProcess$$< M
($$M N
)$$N O
.$$O P
Handle$$P V
,$$V W
NativeMethods%% !
.%%! "
TOKEN_QUERY%%" -
|%%. /
NativeMethods%%0 =
.%%= >
TOKEN_DUPLICATE%%> M
,%%M N
out%%O R
hToken%%S Y
)%%Y Z
)%%Z [
{&& 
throw'' 
new'' 
Win32Exception'' ,
('', -
)''- .
;''. /
}(( 
if,, 
(,, 
Environment,, 
.,,  
	OSVersion,,  )
.,,) *
Version,,* 1
.,,1 2
Major,,2 7
>=,,8 :
$num,,; <
),,< =
{-- 
cbSize22 
=22 
sizeof22 #
(22# $ 
TOKEN_ELEVATION_TYPE22$ 8
)228 9
;229 :
pElevationType33 "
=33# $
Marshal33% ,
.33, -
AllocHGlobal33- 9
(339 :
cbSize33: @
)33@ A
;33A B
if44 
(44 
pElevationType44 &
==44' )
IntPtr44* 0
.440 1
Zero441 5
)445 6
{55 
throw66 
new66 !
Win32Exception66" 0
(660 1
)661 2
;662 3
}77 
if:: 
(:: 
!:: 
NativeMethods:: &
.::& '
GetTokenInformation::' :
(::: ;
hToken::; A
,::A B#
TOKEN_INFORMATION_CLASS;; /
.;;/ 0
TokenElevationType;;0 B
,;;B C
pElevationType;;D R
,;;R S
cbSize<< 
,<< 
out<<  #
cbSize<<$ *
)<<* +
)<<+ ,
{== 
throw>> 
new>> !
Win32Exception>>" 0
(>>0 1
)>>1 2
;>>2 3
}??  
TOKEN_ELEVATION_TYPEBB (
elevTypeBB) 1
=BB2 3
(BB4 5 
TOKEN_ELEVATION_TYPEBB5 I
)BBI J
MarshalCC 
.CC  
	ReadInt32CC  )
(CC) *
pElevationTypeCC* 8
)CC8 9
;CC9 :
ifFF 
(FF 
elevTypeFF  
==FF! # 
TOKEN_ELEVATION_TYPEFF$ 8
.FF8 9%
TokenElevationTypeLimitedFF9 R
)FFR S
{GG 
cbSizeII 
=II  
IntPtrII! '
.II' (
SizeII( ,
;II, -
pLinkedTokenJJ $
=JJ% &
MarshalJJ' .
.JJ. /
AllocHGlobalJJ/ ;
(JJ; <
cbSizeJJ< B
)JJB C
;JJC D
ifKK 
(KK 
pLinkedTokenKK (
==KK) +
IntPtrKK, 2
.KK2 3
ZeroKK3 7
)KK7 8
{LL 
throwMM !
newMM" %
Win32ExceptionMM& 4
(MM4 5
)MM5 6
;MM6 7
}NN 
ifQQ 
(QQ 
!QQ 
NativeMethodsQQ *
.QQ* +
GetTokenInformationQQ+ >
(QQ> ?
hTokenQQ? E
,QQE F#
TOKEN_INFORMATION_CLASSRR 3
.RR3 4
TokenLinkedTokenRR4 D
,RRD E
pLinkedTokenRRF R
,RRR S
cbSizeSS "
,SS" #
outSS$ '
cbSizeSS( .
)SS. /
)SS/ 0
{TT 
throwUU !
newUU" %
Win32ExceptionUU& 4
(UU4 5
)UU5 6
;UU6 7
}VV 
IntPtrYY 
hLinkedTokenYY +
=YY, -
MarshalYY. 5
.YY5 6

ReadIntPtrYY6 @
(YY@ A
pLinkedTokenYYA M
)YYM N
;YYN O
hTokenToCheckZZ %
=ZZ& '
newZZ( +
SafeTokenHandleZZ, ;
(ZZ; <
hLinkedTokenZZ< H
)ZZH I
;ZZI J
}[[ 
}\\ 
ifaa 
(aa 
hTokenToCheckaa !
==aa" $
nullaa% )
)aa) *
{bb 
ifcc 
(cc 
!cc 
NativeMethodscc &
.cc& '
DuplicateTokencc' 5
(cc5 6
hTokencc6 <
,cc< =(
SECURITY_IMPERSONATION_LEVELdd 4
.dd4 5"
SecurityIdentificationdd5 K
,ddK L
outee 
hTokenToCheckee )
)ee) *
)ee* +
{ff 
throwgg 
newgg !
Win32Exceptiongg" 0
(gg0 1
)gg1 2
;gg2 3
}hh 
}ii 
usingll 
WindowsIdentityll %
idll& (
=ll) *
newll+ .
WindowsIdentityll/ >
(ll> ?
hTokenToCheckll? L
.llL M
DangerousGetHandlellM _
(ll_ `
)ll` a
)lla b
;llb c
WindowsPrincipalmm  
	principalmm! *
=mm+ ,
newmm- 0
WindowsPrincipalmm1 A
(mmA B
idmmB D
)mmD E
;mmE F
fInAdminGroupnn 
=nn 
	principalnn  )
.nn) *
IsInRolenn* 2
(nn2 3
WindowsBuiltInRolenn3 E
.nnE F
AdministratornnF S
)nnS T
;nnT U
}oo 
finallypp 
{qq 
ifss 
(ss 
hTokenss 
!=ss 
nullss "
)ss" #
{tt 
hTokenuu 
.uu 
Closeuu  
(uu  !
)uu! "
;uu" #
}vv 
ifww 
(ww 
hTokenToCheckww !
!=ww" $
nullww% )
)ww) *
{xx 
hTokenToCheckyy !
.yy! "
Closeyy" '
(yy' (
)yy( )
;yy) *
}zz 
if{{ 
({{ 
pElevationType{{ "
!={{# %
IntPtr{{& ,
.{{, -
Zero{{- 1
){{1 2
{|| 
Marshal}} 
.}} 
FreeHGlobal}} '
(}}' (
pElevationType}}( 6
)}}6 7
;}}7 8
}~~ 
if 
( 
pLinkedToken  
!=! #
IntPtr$ *
.* +
Zero+ /
)/ 0
{
ÄÄ 
Marshal
ÅÅ 
.
ÅÅ 
FreeHGlobal
ÅÅ '
(
ÅÅ' (
pLinkedToken
ÅÅ( 4
)
ÅÅ4 5
;
ÅÅ5 6
}
ÇÇ 
}
ÉÉ 
return
ÖÖ 
fInAdminGroup
ÖÖ  
;
ÖÖ  !
}
ÜÜ 	
public
ëë 
static
ëë 
bool
ëë 
IsRunAsAdmin
ëë '
(
ëë' (
)
ëë( )
{
íí 	
WindowsIdentity
ìì 
id
ìì 
=
ìì  
WindowsIdentity
ìì! 0
.
ìì0 1

GetCurrent
ìì1 ;
(
ìì; <
)
ìì< =
;
ìì= >
WindowsPrincipal
îî 
	principal
îî &
=
îî' (
new
îî) ,
WindowsPrincipal
îî- =
(
îî= >
id
îî> @
)
îî@ A
;
îîA B
return
ïï 
	principal
ïï 
.
ïï 
IsInRole
ïï %
(
ïï% & 
WindowsBuiltInRole
ïï& 8
.
ïï8 9
Administrator
ïï9 F
)
ïïF G
;
ïïG H
}
ññ 	
internal
¨¨ 
static
¨¨ 
bool
¨¨ 
IsProcessElevated
¨¨ .
(
¨¨. /
)
¨¨/ 0
{
≠≠ 	
bool
ÆÆ 
fIsElevated
ÆÆ 
=
ÆÆ 
false
ÆÆ $
;
ÆÆ$ %
SafeTokenHandle
ØØ 
?
ØØ 
hToken
ØØ #
=
ØØ$ %
null
ØØ& *
;
ØØ* +
int
∞∞ 
cbTokenElevation
∞∞  
=
∞∞! "
$num
∞∞# $
;
∞∞$ %
IntPtr
±± 
pTokenElevation
±± "
=
±±# $
IntPtr
±±% +
.
±±+ ,
Zero
±±, 0
;
±±0 1
try
≥≥ 
{
¥¥ 
if
∂∂ 
(
∂∂ 
!
∂∂ 
NativeMethods
∂∂ "
.
∂∂" #
OpenProcessToken
∂∂# 3
(
∂∂3 4
Process
∂∂4 ;
.
∂∂; <
GetCurrentProcess
∂∂< M
(
∂∂M N
)
∂∂N O
.
∂∂O P
Handle
∂∂P V
,
∂∂V W
NativeMethods
∑∑ !
.
∑∑! "
TOKEN_QUERY
∑∑" -
,
∑∑- .
out
∑∑/ 2
hToken
∑∑3 9
)
∑∑9 :
)
∑∑: ;
{
∏∏ 
throw
ππ 
new
ππ 
Win32Exception
ππ ,
(
ππ, -
)
ππ- .
;
ππ. /
}
∫∫ 
cbTokenElevation
ΩΩ  
=
ΩΩ! "
Marshal
ΩΩ# *
.
ΩΩ* +
SizeOf
ΩΩ+ 1
(
ΩΩ1 2
typeof
ΩΩ2 8
(
ΩΩ8 9
TOKEN_ELEVATION
ΩΩ9 H
)
ΩΩH I
)
ΩΩI J
;
ΩΩJ K
pTokenElevation
ææ 
=
ææ  !
Marshal
ææ" )
.
ææ) *
AllocHGlobal
ææ* 6
(
ææ6 7
cbTokenElevation
ææ7 G
)
ææG H
;
ææH I
if
øø 
(
øø 
pTokenElevation
øø #
==
øø$ &
IntPtr
øø' -
.
øø- .
Zero
øø. 2
)
øø2 3
{
¿¿ 
throw
¡¡ 
new
¡¡ 
Win32Exception
¡¡ ,
(
¡¡, -
)
¡¡- .
;
¡¡. /
}
¬¬ 
if
≈≈ 
(
≈≈ 
!
≈≈ 
NativeMethods
≈≈ "
.
≈≈" #!
GetTokenInformation
≈≈# 6
(
≈≈6 7
hToken
≈≈7 =
,
≈≈= >%
TOKEN_INFORMATION_CLASS
∆∆ +
.
∆∆+ ,
TokenElevation
∆∆, :
,
∆∆: ;
pTokenElevation
∆∆< K
,
∆∆K L
cbTokenElevation
«« $
,
««$ %
out
««& )
cbTokenElevation
««* :
)
««: ;
)
««; <
{
»» 
throw
ÃÃ 
new
ÃÃ 
Win32Exception
ÃÃ ,
(
ÃÃ, -
)
ÃÃ- .
;
ÃÃ. /
}
ÕÕ 
var
”” 
	elevation
”” 
=
”” 
Marshal
””  '
.
””' (
PtrToStructure
””( 6
(
””6 7
pTokenElevation
””7 F
,
””F G
typeof
””H N
(
””N O
TOKEN_ELEVATION
””O ^
)
””^ _
)
””_ `
;
””` a
if
’’ 
(
’’ 
	elevation
’’ 
is
’’  
TOKEN_ELEVATION
’’! 0
elevationToken
’’1 ?
)
’’? @
{
÷÷ 
fIsElevated
ŸŸ 
=
ŸŸ  !
(
ŸŸ" #
elevationToken
ŸŸ# 1
.
ŸŸ1 2
TokenIsElevated
ŸŸ2 A
!=
ŸŸB D
$num
ŸŸE F
)
ŸŸF G
;
ŸŸG H
}
⁄⁄ 
else
€€ 
{
‹‹ 
throw
ﬁﬁ 
new
ﬁﬁ $
NullReferenceException
ﬁﬁ 4
(
ﬁﬁ4 5
nameof
ﬁﬁ5 ;
(
ﬁﬁ; <
	elevation
ﬁﬁ< E
)
ﬁﬁE F
)
ﬁﬁF G
;
ﬁﬁG H
}
‡‡ 
}
·· 
finally
‚‚ 
{
„„ 
if
ÂÂ 
(
ÂÂ 
hToken
ÂÂ 
!=
ÂÂ 
null
ÂÂ "
)
ÂÂ" #
{
ÊÊ 
hToken
ÁÁ 
.
ÁÁ 
Close
ÁÁ  
(
ÁÁ  !
)
ÁÁ! "
;
ÁÁ" #
}
ËË 
if
ÈÈ 
(
ÈÈ 
pTokenElevation
ÈÈ #
!=
ÈÈ$ &
IntPtr
ÈÈ' -
.
ÈÈ- .
Zero
ÈÈ. 2
)
ÈÈ2 3
{
ÍÍ 
Marshal
ÎÎ 
.
ÎÎ 
FreeHGlobal
ÎÎ '
(
ÎÎ' (
pTokenElevation
ÎÎ( 7
)
ÎÎ7 8
;
ÎÎ8 9
}
ÏÏ 
}
ÌÌ 
return
ÔÔ 
fIsElevated
ÔÔ 
;
ÔÔ 
}
 	
public
èè 
static
èè 
int
èè &
GetProcessIntegrityLevel
èè 2
(
èè2 3
)
èè3 4
{
êê 	
int
ëë 
IL
ëë 
=
ëë 
-
ëë 
$num
ëë 
;
ëë 
SafeTokenHandle
íí 
?
íí 
hToken
íí #
=
íí$ %
null
íí& *
;
íí* +
int
ìì 
	cbTokenIL
ìì 
=
ìì 
$num
ìì 
;
ìì 
IntPtr
îî 
pTokenIL
îî 
=
îî 
IntPtr
îî $
.
îî$ %
Zero
îî% )
;
îî) *
try
ññ 
{
óó 
if
ôô 
(
ôô 
!
ôô 
NativeMethods
ôô "
.
ôô" #
OpenProcessToken
ôô# 3
(
ôô3 4
Process
ôô4 ;
.
ôô; <
GetCurrentProcess
ôô< M
(
ôôM N
)
ôôN O
.
ôôO P
Handle
ôôP V
,
ôôV W
NativeMethods
öö !
.
öö! "
TOKEN_QUERY
öö" -
,
öö- .
out
öö/ 2
hToken
öö3 9
)
öö9 :
)
öö: ;
{
õõ 
throw
úú 
new
úú 
Win32Exception
úú ,
(
úú, -
)
úú- .
;
úú. /
}
ùù 
if
££ 
(
££ 
!
££ 
NativeMethods
££ "
.
££" #!
GetTokenInformation
££# 6
(
££6 7
hToken
££7 =
,
££= >%
TOKEN_INFORMATION_CLASS
§§ +
.
§§+ ,!
TokenIntegrityLevel
§§, ?
,
§§? @
IntPtr
§§A G
.
§§G H
Zero
§§H L
,
§§L M
$num
§§N O
,
§§O P
out
•• 
	cbTokenIL
•• !
)
••! "
)
••" #
{
¶¶ 
int
ßß 
error
ßß 
=
ßß 
Marshal
ßß  '
.
ßß' (
GetLastWin32Error
ßß( 9
(
ßß9 :
)
ßß: ;
;
ßß; <
if
®® 
(
®® 
error
®® 
!=
®®  
NativeMethods
®®! .
.
®®. /'
ERROR_INSUFFICIENT_BUFFER
®®/ H
)
®®H I
{
©© 
throw
≠≠ 
new
≠≠ !
Win32Exception
≠≠" 0
(
≠≠0 1
error
≠≠1 6
)
≠≠6 7
;
≠≠7 8
}
ÆÆ 
}
ØØ 
pTokenIL
≤≤ 
=
≤≤ 
Marshal
≤≤ "
.
≤≤" #
AllocHGlobal
≤≤# /
(
≤≤/ 0
	cbTokenIL
≤≤0 9
)
≤≤9 :
;
≤≤: ;
if
≥≥ 
(
≥≥ 
pTokenIL
≥≥ 
==
≥≥ 
IntPtr
≥≥  &
.
≥≥& '
Zero
≥≥' +
)
≥≥+ ,
{
¥¥ 
throw
µµ 
new
µµ 
Win32Exception
µµ ,
(
µµ, -
)
µµ- .
;
µµ. /
}
∂∂ 
if
ªª 
(
ªª 
!
ªª 
NativeMethods
ªª "
.
ªª" #!
GetTokenInformation
ªª# 6
(
ªª6 7
hToken
ªª7 =
,
ªª= >%
TOKEN_INFORMATION_CLASS
ºº +
.
ºº+ ,!
TokenIntegrityLevel
ºº, ?
,
ºº? @
pTokenIL
ººA I
,
ººI J
	cbTokenIL
ººK T
,
ººT U
out
ΩΩ 
	cbTokenIL
ΩΩ !
)
ΩΩ! "
)
ΩΩ" #
{
ææ 
throw
øø 
new
øø 
Win32Exception
øø ,
(
øø, -
)
øø- .
;
øø. /
}
¿¿ 
var
√√ !
tokenMandatoryLabel
√√ '
=
√√( )
Marshal
√√* 1
.
√√1 2
PtrToStructure
√√2 @
(
√√@ A
pTokenIL
√√A I
,
√√I J
typeof
√√K Q
(
√√Q R#
TOKEN_MANDATORY_LABEL
√√R g
)
√√g h
)
√√h i
;
√√i j
if
≈≈ 
(
≈≈ !
tokenMandatoryLabel
≈≈ '
is
≈≈( *#
TOKEN_MANDATORY_LABEL
≈≈+ @
tokenIL
≈≈A H
)
≈≈H I
{
∆∆ 
IntPtr
…… 
pIL
…… 
=
……  
NativeMethods
……! .
.
……. / 
GetSidSubAuthority
……/ A
(
……A B
tokenIL
……B I
.
……I J
Label
……J O
.
……O P
Sid
……P S
,
……S T
$num
……U V
)
……V W
;
……W X
IL
   
=
   
Marshal
    
.
    !
	ReadInt32
  ! *
(
  * +
pIL
  + .
)
  . /
;
  / 0
}
ÀÀ 
else
ÃÃ 
{
ÕÕ 
throw
œœ 
new
œœ $
NullReferenceException
œœ 4
(
œœ4 5
nameof
œœ5 ;
(
œœ; <!
tokenMandatoryLabel
œœ< O
)
œœO P
)
œœP Q
;
œœQ R
}
—— 
}
““ 
finally
”” 
{
‘‘ 
if
÷÷ 
(
÷÷ 
hToken
÷÷ 
!=
÷÷ 
null
÷÷ "
)
÷÷" #
{
◊◊ 
hToken
ÿÿ 
.
ÿÿ 
Close
ÿÿ  
(
ÿÿ  !
)
ÿÿ! "
;
ÿÿ" #
}
ŸŸ 
if
⁄⁄ 
(
⁄⁄ 
pTokenIL
⁄⁄ 
!=
⁄⁄ 
IntPtr
⁄⁄  &
.
⁄⁄& '
Zero
⁄⁄' +
)
⁄⁄+ ,
{
€€ 
Marshal
‹‹ 
.
‹‹ 
FreeHGlobal
‹‹ '
(
‹‹' (
pTokenIL
‹‹( 0
)
‹‹0 1
;
‹‹1 2
}
›› 
}
ﬁﬁ 
return
‡‡ 
IL
‡‡ 
;
‡‡ 
}
·· 	
public
„„ 
static
„„ 
bool
„„ 
QueryElevation
„„ )
(
„„) *
)
„„* +
{
‰‰ 	
return
ÂÂ 
IsRunAsAdmin
ÂÂ 
(
ÂÂ  
)
ÂÂ  !
;
ÂÂ! "
}
ÊÊ 	
public
ËË 
static
ËË 
bool
ËË 
IsRunningAsRoot
ËË *
(
ËË* +
)
ËË+ ,
{
ÈÈ 	
if
ÍÍ 
(
ÍÍ #
ExternalCommandRunner
ÍÍ %
.
ÍÍ% & 
RunExternalCommand
ÍÍ& 8
(
ÍÍ8 9
$str
ÍÍ9 A
,
ÍÍA B
string
ÍÍC I
.
ÍÍI J
Empty
ÍÍJ O
,
ÍÍO P
out
ÍÍQ T
string
ÍÍU [
username
ÍÍ\ d
,
ÍÍd e
out
ÍÍf i
string
ÍÍj p
_
ÍÍq r
)
ÍÍr s
==
ÍÍt v
$num
ÍÍw x
)
ÍÍx y
{
ÎÎ 
return
ÏÏ 
username
ÏÏ 
.
ÏÏ  
Trim
ÏÏ  $
(
ÏÏ$ %
)
ÏÏ% &
.
ÏÏ& '
Equals
ÏÏ' -
(
ÏÏ- .
$str
ÏÏ. 4
)
ÏÏ4 5
;
ÏÏ5 6
}
ÌÌ 
return
ÓÓ 
false
ÓÓ 
;
ÓÓ 
}
ÔÔ 	
public
ÒÒ 
static
ÒÒ 
bool
ÒÒ 
IsAdministrator
ÒÒ *
(
ÒÒ* +
)
ÒÒ+ ,
{
ÚÚ 	
try
ÛÛ 
{
ÙÙ 
using
ıı 
(
ıı 
WindowsIdentity
ıı &
identity
ıı' /
=
ıı0 1
WindowsIdentity
ıı2 A
.
ııA B

GetCurrent
ııB L
(
ııL M
)
ııM N
)
ııN O
{
ˆˆ 
WindowsPrincipal
˜˜ $
	principal
˜˜% .
=
˜˜/ 0
new
˜˜1 4
WindowsPrincipal
˜˜5 E
(
˜˜E F
identity
˜˜F N
)
˜˜N O
;
˜˜O P
return
¯¯ 
	principal
¯¯ $
.
¯¯$ %
IsInRole
¯¯% -
(
¯¯- . 
WindowsBuiltInRole
¯¯. @
.
¯¯@ A
Administrator
¯¯A N
)
¯¯N O
;
¯¯O P
}
˘˘ 
}
˙˙ 
catch
˚˚ 
(
˚˚ +
PlatformNotSupportedException
˚˚ 0
)
˚˚0 1
{
¸¸ 
return
˝˝ 
false
˝˝ 
;
˝˝ 
}
˛˛ 
}
ˇˇ 	
}
ÄÄ 
}ÅÅ åC
ND:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\ExternalCommandRunner.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{ 
public		 

static		 
class		 !
ExternalCommandRunner		 -
{

 
public 
static 
int 
RunExternalCommand ,
(, -
string- 3
command4 ;
,; <
string= C
	argumentsD M
,M N
outO R
stringS Y
StdOutZ `
,` a
outb e
stringf l
StdErrm s
)s t
{ 	
using 
var 
process 
= 
new  #
Process$ +
(+ ,
), -
{ 
	StartInfo 
= 
new 
ProcessStartInfo  0
{ 
FileName 
= 
command &
,& '
	Arguments 
= 
string  &
.& '
IsNullOrEmpty' 4
(4 5
	arguments5 >
)> ?
?@ A
stringB H
.H I
EmptyI N
:O P
	argumentsQ Z
,Z ["
RedirectStandardOutput *
=+ ,
true- 1
,1 2!
RedirectStandardError )
=* +
true, 0
,0 1
UseShellExecute #
=$ %
false& +
,+ ,
CreateNoWindow "
=# $
true% )
,) *
WindowStyle 
=  !
ProcessWindowStyle" 4
.4 5
Hidden5 ;
} 
} 
; 
try 
{ 
process 
. 
Start 
( 
) 
;  
process 
. 
WaitForExit #
(# $
)$ %
;% &
} 
catch   
(   
	Exception   
e   
)   
{!! 
throw"" 
new"" 
ExternalException"" +
(""+ ,
$str"", G
+""H I
Format""J P
(""P Q
command""Q X
,""X Y
	arguments""Z c
)""c d
+""e f
$str""g k
+""l m
e""n o
.""o p
Message""p w
,""w x
e""y z
)""z {
;""{ |
}## 
StdOut%% 
=%% 
process%% 
.%% 
StandardOutput%% +
.%%+ ,
	ReadToEnd%%, 5
(%%5 6
)%%6 7
;%%7 8
StdErr&& 
=&& 
process&& 
.&& 
StandardError&& *
.&&* +
	ReadToEnd&&+ 4
(&&4 5
)&&5 6
;&&6 7
return(( 
process(( 
.(( 
ExitCode(( #
;((# $
})) 	
public++ 
static++ 
string++ 
RunExternalCommand++ /
(++/ 0
string++0 6
filename++7 ?
,++? @
string++A G
	arguments++H Q
=++R S
$str++T V
,++V W
bool++X \
Redirect++] e
=++f g
true++h l
)++l m
{,, 	
using-- 
var-- 
process-- 
=-- 
new--  #
Process--$ +
(--+ ,
)--, -
{.. 
	StartInfo// 
=// 
new// 
ProcessStartInfo//  0
{00 
FileName11 
=11 
filename11 '
,11' (
	Arguments22 
=22 
string22  &
.22& '
IsNullOrEmpty22' 4
(224 5
	arguments225 >
)22> ?
?22@ A
string22B H
.22H I
Empty22I N
:22O P
	arguments22Q Z
,22Z ["
RedirectStandardOutput33 *
=33+ ,
Redirect33- 5
,335 6!
RedirectStandardError44 )
=44* +
Redirect44, 4
,444 5
UseShellExecute55 #
=55$ %
false55& +
,55+ ,
CreateNoWindow66 "
=66# $
true66% )
,66) *
WindowStyle77 
=77  !
ProcessWindowStyle77" 4
.774 5
Hidden775 ;
}88 
}99 
;99 
var;; 
	stdOutput;; 
=;; 
new;; 
StringBuilder;;  -
(;;- .
);;. /
;;;/ 0
process<< 
.<< 
OutputDataReceived<< &
+=<<' )
(<<* +
sender<<+ 1
,<<1 2
args<<3 7
)<<7 8
=><<9 ;
	stdOutput<<< E
.<<E F

AppendLine<<F P
(<<P Q
args<<Q U
.<<U V
Data<<V Z
)<<Z [
;<<[ \
string>> 
stdError>> 
=>> 
string>> $
.>>$ %
Empty>>% *
;>>* +
try?? 
{@@ 
processAA 
.AA 
StartAA 
(AA 
)AA 
;AA  
processBB 
.BB 
BeginOutputReadLineBB +
(BB+ ,
)BB, -
;BB- .
stdErrorCC 
=CC 
processCC "
.CC" #
StandardErrorCC# 0
.CC0 1
	ReadToEndCC1 :
(CC: ;
)CC; <
;CC< =
processDD 
.DD 
WaitForExitDD #
(DD# $
)DD$ %
;DD% &
}EE 
catchFF 
(FF 
	ExceptionFF 
eFF 
)FF 
{GG 
throwHH 
newHH 
ExternalExceptionHH +
(HH+ ,
$strHH, G
+HHH I
FormatHHJ P
(HHP Q
filenameHHQ Y
,HHY Z
	argumentsHH[ d
)HHd e
+HHf g
$strHHh l
+HHm n
eHHo p
.HHp q
MessageHHq x
,HHx y
eHHz {
)HH{ |
;HH| }
}II 
ifKK 
(KK 
processKK 
.KK 
ExitCodeKK  
==KK! #
$numKK$ %
)KK% &
{LL 
returnMM 
	stdOutputMM  
.MM  !
ToStringMM! )
(MM) *
)MM* +
;MM+ ,
}NN 
elseOO 
{PP 
varQQ 
messageQQ 
=QQ 
newQQ !
StringBuilderQQ" /
(QQ/ 0
)QQ0 1
;QQ1 2
ifSS 
(SS 
!SS 
stringSS 
.SS 
IsNullOrEmptySS )
(SS) *
stdErrorSS* 2
)SS2 3
)SS3 4
{TT 
messageUU 
.UU 

AppendLineUU &
(UU& '
stdErrorUU' /
)UU/ 0
;UU0 1
}VV 
ifXX 
(XX 
	stdOutputXX 
.XX 
LengthXX $
!=XX% '
$numXX( )
)XX) *
{YY 
messageZZ 
.ZZ 

AppendLineZZ &
(ZZ& '
$strZZ' 4
)ZZ4 5
;ZZ5 6
message[[ 
.[[ 

AppendLine[[ &
([[& '
	stdOutput[[' 0
.[[0 1
ToString[[1 9
([[9 :
)[[: ;
)[[; <
;[[< =
}\\ 
throw^^ 
new^^ 
ExternalException^^ +
(^^+ ,
Format^^, 2
(^^2 3
filename^^3 ;
,^^; <
	arguments^^= F
)^^F G
+^^H I
$str^^J g
+^^h i
process^^j q
.^^q r
ExitCode^^r z
+^^{ |
$str	^^} Å
+
^^Ç É
message
^^Ñ ã
)
^^ã å
;
^^å ç
}__ 
}`` 	
privatebb 
staticbb 
stringbb 
Formatbb $
(bb$ %
stringbb% +
filenamebb, 4
,bb4 5
stringbb6 <
	argumentsbb= F
)bbF G
{cc 	
returndd 
$strdd 
+dd 
filenamedd !
+dd" #
(ee 
(ee 
stringee 
.ee 
IsNullOrEmptyee &
(ee& '
	argumentsee' 0
)ee0 1
)ee1 2
?ee3 4
stringee5 ;
.ee; <
Emptyee< A
:eeB C
$streeD G
+eeH I
	argumentseeJ S
)eeS T
+eeU V
$strff 
;ff 
}gg 	
}hh 
}ii ¨[
DD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\FileWatcher.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{ 
public		 

class		 
FileWatcher		 
:		 
IDisposable		 *
{

 
public 
FileWatcher 
( 
) 
: 
this #
(# $
$str$ '
)' (
{ 	
} 	
public 
FileWatcher 
( 
String !
DirectoryName" /
)/ 0
:1 2
this3 7
(7 8
DirectoryName8 E
,E F"
DefaultChangedDelegateG ]
,] ^"
DefaultChangedDelegate_ u
,u v#
DefaultChangedDelegate	w ç
,
ç é$
DefaultRenamedDelegate
è •
)
• ¶
{ 	
} 	
public 
FileWatcher 
( 
String !
DirectoryName" /
,/ 0
Action1 7
<7 8
	EventArgs8 A
>A B
OnChangedActionC R
,R S
ActionT Z
<Z [
	EventArgs[ d
>d e
OnCreatedActionf u
,u v
Actionw }
<} ~
	EventArgs	~ á
>
á à
OnDeletedAction
â ò
,
ò ô
Action
ö †
<
† °
	EventArgs
° ™
>
™ ´
OnRenamedAction
¨ ª
)
ª º
:
Ω æ
this
ø √
(
√ ƒ
DirectoryName
ƒ —
,
— “
OnChangedAction
” ‚
,
‚ „
OnCreatedAction
‰ Û
,
Û Ù
OnDeletedAction
ı Ñ
,
Ñ Ö
OnRenamedAction
Ü ï
,
ï ñ
DefaultFilters
ó •
,
• ¶*
DefaultIncludeSubdirectories
ß √
)
√ ƒ
{ 	
} 	
public 
FileWatcher 
( 
String !
DirectoryName" /
,/ 0
Action1 7
<7 8
	EventArgs8 A
>A B
OnChangedActionC R
,R S
ActionT Z
<Z [
	EventArgs[ d
>d e
OnCreatedActionf u
,u v
Actionw }
<} ~
	EventArgs	~ á
>
á à
OnDeletedAction
â ò
,
ò ô
Action
ö †
<
† °
	EventArgs
° ™
>
™ ´
OnRenamedAction
¨ ª
,
ª º
NotifyFilters
Ω  
NotifyFilters
À ÿ
,
ÿ Ÿ
bool
⁄ ﬁ#
IncludeSubdirectories
ﬂ Ù
)
Ù ı
{ 	
	EventList 
= 
new 
List  
<  !
	EventArgs! *
>* +
(+ ,
), -
;- .
OnChangedDelegate 
= 
OnChangedAction  /
;/ 0
OnCreatedDelegate 
= 
OnCreatedAction  /
;/ 0
OnDeletedDelegate   
=   
OnDeletedAction    /
;  / 0
OnRenamedDelegate!! 
=!! 
OnRenamedAction!!  /
;!!/ 0
watcher## 
=## 
new## 
FileSystemWatcher## +
(##+ ,
)##, -
;##- .
watcher%% 
.%% 
	BeginInit%% 
(%% 
)%% 
;%%  
watcher'' 
.'' 
Path'' 
='' 
DirectoryName'' (
;''( )
watcher(( 
.(( 
NotifyFilter((  
=((! "
NotifyFilters((# 0
;((0 1
watcher** 
.** !
IncludeSubdirectories** )
=*** +!
IncludeSubdirectories**, A
;**A B
watcher++ 
.++ 
Changed++ 
+=++ 
new++ ""
FileSystemEventHandler++# 9
(++9 :
	OnChanged++: C
)++C D
;++D E
watcher,, 
.,, 
Created,, 
+=,, 
new,, ""
FileSystemEventHandler,,# 9
(,,9 :
	OnChanged,,: C
),,C D
;,,D E
watcher-- 
.-- 
Deleted-- 
+=-- 
new-- ""
FileSystemEventHandler--# 9
(--9 :
	OnChanged--: C
)--C D
;--D E
watcher.. 
... 
Renamed.. 
+=.. 
new.. "
RenamedEventHandler..# 6
(..6 7
	OnRenamed..7 @
)..@ A
;..A B
watcher00 
.00 
EndInit00 
(00 
)00 
;00 
}11 	
public33 
List33 
<33 
	EventArgs33 
>33 
	EventList33 (
{33) *
get33+ .
;33. /
}330 1
public55 
void55 
Dispose55 
(55 
)55 
{66 	
Dispose77 
(77 
true77 
)77 
;77 
GC88 
.88 
SuppressFinalize88 
(88  
this88  $
)88$ %
;88% &
}99 	
public;; 
bool;; 
	IsRunning;; 
(;; 
);; 
{<< 	
return== 
watcher== 
.== 
EnableRaisingEvents== .
;==. /
}>> 	
public@@ 
void@@ 
Start@@ 
(@@ 
)@@ 
{AA 	
watcherBB 
.BB 
EnableRaisingEventsBB '
=BB( )
trueBB* .
;BB. /
}CC 	
publicEE 
voidEE 
StopEE 
(EE 
)EE 
{FF 	
watcherGG 
.GG 
EnableRaisingEventsGG '
=GG( )
falseGG* /
;GG/ 0
watcherHH 
.HH 
DisposeHH 
(HH 
)HH 
;HH 
}II 	
	protectedKK 
virtualKK 
voidKK 
DisposeKK &
(KK& '
boolKK' +
	disposingKK, 5
)KK5 6
{LL 	
ifMM 
(MM 
	disposingMM 
)MM 
{NN 
watcherOO 
.OO 
DisposeOO 
(OO  
)OO  !
;OO! "
}PP 
}QQ 	
privateSS 
constSS 
NotifyFiltersSS #
DefaultFiltersSS$ 2
=SS3 4
NotifyFiltersSS5 B
.SSB C

AttributesSSC M
|
TTÄ Å
NotifyFilters
TTÇ è
.
TTè ê
CreationTime
TTê ú
|UU0 1
NotifyFiltersUU2 ?
.UU? @
DirectoryNameUU@ M
|VV0 1
NotifyFiltersVV2 ?
.VV? @
FileNameVV@ H
|WW0 1
NotifyFiltersWW2 ?
.WW? @

LastAccessWW@ J
|XX0 1
NotifyFiltersXX2 ?
.XX? @
	LastWriteXX@ I
|YY0 1
NotifyFiltersYY2 ?
.YY? @
SecurityYY@ H
|ZZ0 1
NotifyFiltersZZ2 ?
.ZZ? @
SizeZZ@ D
;ZZD E
private\\ 
const\\ 
bool\\ (
DefaultIncludeSubdirectories\\ 7
=\\8 9
true\\: >
;\\> ?
private]] 
static]] 
readonly]] 
Action]]  &
<]]& '
	EventArgs]]' 0
>]]0 1"
DefaultChangedDelegate]]2 H
=]]I J
(]]K L
e]]L M
)]]M N
=>]]O Q
{]]R S
FileSystemEventArgs]]T g
i_e]]h k
=]]l m
(]]n o 
FileSystemEventArgs	]]o Ç
)
]]Ç É
e
]]É Ñ
;
]]Ñ Ö
Log
]]Ü â
.
]]â ä
Information
]]ä ï
(
]]ï ñ
i_e
]]ñ ô
.
]]ô ö

ChangeType
]]ö §
.
]]§ •
ToString
]]• ≠
(
]]≠ Æ
)
]]Æ Ø
+
]]∞ ±
$str
]]≤ µ
+
]]∂ ∑
i_e
]]∏ ª
.
]]ª º
FullPath
]]º ƒ
)
]]ƒ ≈
;
]]≈ ∆
}
]]« »
;
]]» …
private^^ 
static^^ 
readonly^^ 
Action^^  &
<^^& '
	EventArgs^^' 0
>^^0 1"
DefaultRenamedDelegate^^2 H
=^^I J
(^^K L
e^^L M
)^^M N
=>^^O Q
{^^R S
RenamedEventArgs^^T d
i_e^^e h
=^^i j
(^^k l
RenamedEventArgs^^l |
)^^| }
e^^} ~
;^^~ 
Log
^^Ä É
.
^^É Ñ
Information
^^Ñ è
(
^^è ê
i_e
^^ê ì
.
^^ì î

ChangeType
^^î û
.
^^û ü
ToString
^^ü ß
(
^^ß ®
)
^^® ©
+
^^™ ´
$str
^^¨ Ø
+
^^∞ ±
i_e
^^≤ µ
.
^^µ ∂
OldFullPath
^^∂ ¡
+
^^¬ √
$str
^^ƒ «
+
^^» …
i_e
^^  Õ
.
^^Õ Œ
FullPath
^^Œ ÷
)
^^÷ ◊
;
^^◊ ÿ
}
^^Ÿ ⁄
;
^^⁄ €
private__ 
readonly__ 
Action__ 
<__  
	EventArgs__  )
>__) *
OnChangedDelegate__+ <
;__< =
private`` 
readonly`` 
Action`` 
<``  
	EventArgs``  )
>``) *
OnCreatedDelegate``+ <
;``< =
privateaa 
readonlyaa 
Actionaa 
<aa  
	EventArgsaa  )
>aa) *
OnDeletedDelegateaa+ <
;aa< =
privatebb 
readonlybb 
Actionbb 
<bb  
	EventArgsbb  )
>bb) *
OnRenamedDelegatebb+ <
;bb< =
privatecc 
readonlycc 
FileSystemWatchercc *
watchercc+ 2
;cc2 3
privateee 
voidee 
	OnChangedee 
(ee 
objectee %
sourceee& ,
,ee, -
FileSystemEventArgsee. A
eeeB C
)eeC D
{ff 	
	EventListgg 
.gg 
Addgg 
(gg 
egg 
)gg 
;gg 
OnChangedDelegatehh 
(hh 
ehh 
)hh  
;hh  !
}ii 	
privatekk 
voidkk 
	OnCreatedkk 
(kk 
objectkk %
sourcekk& ,
,kk, -
FileSystemEventArgskk. A
ekkB C
)kkC D
{ll 	
	EventListmm 
.mm 
Addmm 
(mm 
emm 
)mm 
;mm 
OnCreatedDelegatenn 
(nn 
enn 
)nn  
;nn  !
}oo 	
privateqq 
voidqq 
	OnDeletedqq 
(qq 
objectqq %
sourceqq& ,
,qq, -
FileSystemEventArgsqq. A
eqqB C
)qqC D
{rr 	
	EventListss 
.ss 
Addss 
(ss 
ess 
)ss 
;ss 
OnDeletedDelegatett 
(tt 
ett 
)tt  
;tt  !
}uu 	
privateww 
voidww 
	OnRenamedww 
(ww 
objectww %
sourceww& ,
,ww, -
FileSystemEventArgsww. A
ewwB C
)wwC D
{xx 	
	EventListyy 
.yy 
Addyy 
(yy 
eyy 
)yy 
;yy 
OnRenamedDelegatezz 
(zz 
ezz 
)zz  
;zz  !
}{{ 	
}|| 
}}} ©U
BD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\JsonUtils.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{ 
public 

static 
class 
	JsonUtils !
{ 
static 
	JsonUtils 
( 
) 
{ 	
TypeDescriptor 
. 
AddAttributes (
(( )
typeof) /
(/ 0
(0 1
TpmAlgId1 9
,9 :
uint; ?
)? @
)@ A
,A B
newC F"
TypeConverterAttributeG ]
(] ^
typeof^ d
(d e 
TpmPcrTupleConvertere y
<y z
TpmAlgId	z Ç
,
Ç É
uint
Ñ à
>
à â
)
â ä
)
ä ã
)
ã å
;
å ç
} 	
public 
static 
string 
	Dehydrate &
(& '
CollectObject' 4
colObj5 ;
); <
{ 	
return 
JsonConvert 
. 
SerializeObject .
(. /
colObj/ 5
,5 6
jsonSettings7 C
)C D
;D E
} 	
public&& 
static&& 
CollectObject&& #
?&&# $
Hydrate&&% ,
(&&, -
string&&- 3

serialized&&4 >
,&&> ?
RESULT_TYPE&&@ K
type&&L P
)&&P Q
{'' 	
if(( 
((( 

serialized(( 
==(( 
null(( "
)((" #
{)) 
return** 
null** 
;** 
}++ 
switch-- 
(-- 
type-- 
)-- 
{.. 
case// 
RESULT_TYPE//  
.//  !
CERTIFICATE//! ,
://, -
return00 
JsonConvert00 &
.00& '
DeserializeObject00' 8
<008 9
CertificateObject009 J
>00J K
(00K L

serialized00L V
,00V W
jsonSettings00X d
)00d e
;00e f
case22 
RESULT_TYPE22  
.22  !
FILE22! %
:22% &
return33 
JsonConvert33 &
.33& '
DeserializeObject33' 8
<338 9
FileSystemObject339 I
>33I J
(33J K

serialized33K U
,33U V
jsonSettings33W c
)33c d
;33d e
case55 
RESULT_TYPE55  
.55  !
PORT55! %
:55% &
return66 
JsonConvert66 &
.66& '
DeserializeObject66' 8
<668 9
OpenPortObject669 G
>66G H
(66H I

serialized66I S
,66S T
jsonSettings66U a
)66a b
;66b c
case88 
RESULT_TYPE88  
.88  !
REGISTRY88! )
:88) *
return99 
JsonConvert99 &
.99& '
DeserializeObject99' 8
<998 9
RegistryObject999 G
>99G H
(99H I

serialized99I S
,99S T
jsonSettings99U a
)99a b
;99b c
case;; 
RESULT_TYPE;;  
.;;  !
SERVICE;;! (
:;;( )
return<< 
JsonConvert<< &
.<<& '
DeserializeObject<<' 8
<<<8 9
ServiceObject<<9 F
><<F G
(<<G H

serialized<<H R
,<<R S
jsonSettings<<T `
)<<` a
;<<a b
case>> 
RESULT_TYPE>>  
.>>  !
USER>>! %
:>>% &
return?? 
JsonConvert?? &
.??& '
DeserializeObject??' 8
<??8 9
UserAccountObject??9 J
>??J K
(??K L

serialized??L V
,??V W
jsonSettings??X d
)??d e
;??e f
caseAA 
RESULT_TYPEAA  
.AA  !
GROUPAA! &
:AA& '
returnBB 
JsonConvertBB &
.BB& '
DeserializeObjectBB' 8
<BB8 9
GroupAccountObjectBB9 K
>BBK L
(BBL M

serializedBBM W
,BBW X
jsonSettingsBBY e
)BBe f
;BBf g
caseDD 
RESULT_TYPEDD  
.DD  !
FIREWALLDD! )
:DD) *
returnEE 
JsonConvertEE &
.EE& '
DeserializeObjectEE' 8
<EE8 9
FirewallObjectEE9 G
>EEG H
(EEH I

serializedEEI S
,EES T
jsonSettingsEEU a
)EEa b
;EEb c
caseGG 
RESULT_TYPEGG  
.GG  !
COMGG! $
:GG$ %
returnHH 
JsonConvertHH &
.HH& '
DeserializeObjectHH' 8
<HH8 9
	ComObjectHH9 B
>HHB C
(HHC D

serializedHHD N
,HHN O
jsonSettingsHHP \
)HH\ ]
;HH] ^
caseJJ 
RESULT_TYPEJJ  
.JJ  !
LOGJJ! $
:JJ$ %
returnKK 
JsonConvertKK &
.KK& '
DeserializeObjectKK' 8
<KK8 9
EventLogObjectKK9 G
>KKG H
(KKH I

serializedKKI S
,KKS T
jsonSettingsKKU a
)KKa b
;KKb c
caseMM 
RESULT_TYPEMM  
.MM  !
TPMMM! $
:MM$ %
returnNN 
JsonConvertNN &
.NN& '
DeserializeObjectNN' 8
<NN8 9
	TpmObjectNN9 B
>NNB C
(NNC D

serializedNND N
,NNN O
jsonSettingsNNP \
)NN\ ]
;NN] ^
casePP 
RESULT_TYPEPP  
.PP  !
KEYPP! $
:PP$ %
returnQQ 
JsonConvertQQ &
.QQ& '
DeserializeObjectQQ' 8
<QQ8 9"
CryptographicKeyObjectQQ9 O
>QQO P
(QQP Q

serializedQQQ [
,QQ[ \
jsonSettingsQQ] i
)QQi j
;QQj k
caseSS 
RESULT_TYPESS  
.SS  !
PROCESSSS! (
:SS( )
returnTT 
JsonConvertTT &
.TT& '
DeserializeObjectTT' 8
<TT8 9
ProcessObjectTT9 F
>TTF G
(TTG H

serializedTTH R
,TTR S
jsonSettingsTTT `
)TT` a
;TTa b
caseVV 
RESULT_TYPEVV  
.VV  !
DRIVERVV! '
:VV' (
returnWW 
JsonConvertWW &
.WW& '
DeserializeObjectWW' 8
<WW8 9
DriverObjectWW9 E
>WWE F
(WWF G

serializedWWG Q
,WWQ R
jsonSettingsWWS _
)WW_ `
;WW` a
caseXX 
RESULT_TYPEXX  
.XX  !
FILEMONITORXX! ,
:XX, -
returnYY 
JsonConvertYY &
.YY& '
DeserializeObjectYY' 8
<YY8 9
FileMonitorObjectYY9 J
>YYJ K
(YYK L

serializedYYL V
,YYV W
jsonSettingsYYX d
)YYd e
;YYe f
defaultZZ 
:ZZ 
return[[ 
null[[ 
;[[  
}\\ 
}]] 	
private__ 
static__ 
readonly__ "
JsonSerializerSettings__  6
jsonSettings__7 C
=__D E
new__F I"
JsonSerializerSettings__J `
(__` a
)__a b
{__c d 
DefaultValueHandling__e y
=__z {!
DefaultValueHandling	__| ê
.
__ê ë
Ignore
__ë ó
,
__ó ò 
DateFormatHandling
__ô ´
=
__¨ ≠ 
DateFormatHandling
__Æ ¿
.
__¿ ¡
IsoDateFormat
__¡ Œ
,
__Œ œ
NullValueHandling
__– ·
=
__‚ „
NullValueHandling
__‰ ı
.
__ı ˆ
Ignore
__ˆ ¸
}
__˝ ˛
;
__˛ ˇ
}`` 
publicbb 

classbb  
TpmPcrTupleConverterbb %
<bb% &
T1bb& (
,bb( )
T2bb* ,
>bb, -
:bb. /
TypeConverterbb0 =
{cc 
publicdd 
overridedd 
booldd 
CanConvertFromdd +
(dd+ ,"
ITypeDescriptorContextdd, B
contextddC J
,ddJ K
TypeddL P

sourceTypeddQ [
)dd[ \
{ee 	
returnff 

sourceTypeff 
==ff  
typeofff! '
(ff' (
stringff( .
)ff. /
||ff0 2
baseff3 7
.ff7 8
CanConvertFromff8 F
(ffF G
contextffG N
,ffN O

sourceTypeffP Z
)ffZ [
;ff[ \
}gg 	
publicii 
overrideii 
objectii 
ConvertFromii *
(ii* +"
ITypeDescriptorContextii+ A
contextiiB I
,iiI J
CultureInfoiiK V
cultureiiW ^
,ii^ _
objectii` f
valueiig l
)iil m
{jj 	
varkk 
elementskk 
=kk 
Convertkk "
.kk" #
ToStringkk# +
(kk+ ,
valuekk, 1
,kk1 2
CultureInfokk3 >
.kk> ?
InvariantCulturekk? O
)kkO P
?kkP Q
.kkQ R
TrimkkR V
(kkV W
$charkkW Z
)kkZ [
.kk[ \
Trimkk\ `
(kk` a
$charkka d
)kkd e
.kke f
Splitkkf k
(kkk l
newkkl o
[kko p
]kkp q
{kkr s
$charkkt w
}kkx y
,kky z
StringSplitOptions	kk{ ç
.
kkç é 
RemoveEmptyEntries
kké †
)
kk† °
;
kk° ¢
ifll 
(ll 
Enumll 
.ll 
TryParsell 
(ll 
typeofll $
(ll$ %
TpmAlgIdll% -
)ll- .
,ll. /
elementsll0 8
.ll8 9
Firstll9 >
(ll> ?
)ll? @
,ll@ A
outllB E
objectllF L
?llL M
resultllN T
)llT U
&&llV X
resultllY _
isll` b
TpmAlgIdllc k
	Algorithmlll u
&&llv x
uintlly }
.ll} ~
TryParse	ll~ Ü
(
llÜ á
elements
llá è
.
llè ê
Last
llê î
(
llî ï
)
llï ñ
,
llñ ó
out
llò õ
uint
llú †
Index
ll° ¶
)
ll¶ ß
)
llß ®
{mm 
returnnn 
(nn 
	Algorithmnn !
,nn! "
Indexnn# (
)nn( )
;nn) *
}oo 
returnpp 
(pp 
TpmAlgIdpp 
.pp 
Nullpp !
,pp! "
uintpp# '
.pp' (
MaxValuepp( 0
)pp0 1
;pp1 2
}qq 	
}rr 
}ss …#
?D:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\Logger.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{ 
public 

static 
class 
Logger 
{ 
public		 
static		 
bool		 
Debug		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
static

 
bool

 
Quiet

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 
static 
bool 
Verbose "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
static 
void 
Setup  
(  !
)! "
{ 	
Setup 
( 
false 
, 
false 
) 
;  
} 	
public 
static 
void 
Setup  
(  !
bool! %
debug& +
,+ ,
bool- 1
verbose2 9
)9 :
{ 	
Setup 
( 
debug 
, 
verbose  
,  !
false" '
)' (
;( )
} 	
public 
static 
void 
Setup  
(  !
bool! %
debug& +
,+ ,
bool- 1
verbose2 9
,9 :
bool; ?
quiet@ E
)E F
{ 	
( 
Verbose 
, 
Debug 
, 
Quiet "
)" #
=$ %
(& '
verbose' .
,. /
debug0 5
,5 6
quiet7 <
)< =
;= >
if 
( 
quiet 
) 
{ 
Log 
. 
Logger 
= 
new  
LoggerConfiguration! 4
(4 5
)5 6
. 
MinimumLevel !
.! "
Warning" )
() *
)* +
. 
WriteTo 
. 
Console $
($ %
)% &
. 
CreateLogger !
(! "
)" #
;# $
}   
else!! 
if!! 
(!! 
verbose!! 
)!! 
{"" 
Log## 
.## 
Logger## 
=## 
new##  
LoggerConfiguration##! 4
(##4 5
)##5 6
.$$ 
MinimumLevel$$ !
.$$! "
Verbose$$" )
($$) *
)$$* +
.%% 
WriteTo%% 
.%% 
File%% !
(%%! "
$str%%" /
)%%/ 0
.&& 
WriteTo&& 
.&& 
Console&& $
(&&$ %
)&&% &
.'' 
CreateLogger'' !
(''! "
)''" #
;''# $
}(( 
else)) 
if)) 
()) 
debug)) 
))) 
{** 
Log++ 
.++ 
Logger++ 
=++ 
new++  
LoggerConfiguration++! 4
(++4 5
)++5 6
.,, 
MinimumLevel,, !
.,,! "
Debug,," '
(,,' (
),,( )
.-- 
WriteTo-- 
.-- 
File-- !
(--! "
$str--" /
)--/ 0
... 
WriteTo.. 
... 
Console.. $
(..$ %
)..% &
.// 
CreateLogger// !
(//! "
)//" #
;//# $
}00 
else11 
{22 
Log33 
.33 
Logger33 
=33 
new33  
LoggerConfiguration33! 4
(334 5
)335 6
.44 
MinimumLevel44  
.44  !
Information44! ,
(44, -
)44- .
.55 
WriteTo55 
.55 
Console55 #
(55# $$
restrictedToMinimumLevel55$ <
:55< =
LogEventLevel55> K
.55K L
Information55L W
)55W X
.66 
CreateLogger66  
(66  !
)66! "
;66" #
}77 
}88 	
}99 
}:: Ÿﬁ
FD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\NativeMethods.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{		 
internal 
enum (
SECURITY_IMPERSONATION_LEVEL .
{ 
SecurityAnonymous 
, "
SecurityIdentification 
, !
SecurityImpersonation 
, 
SecurityDelegation 
} 
internal 
enum  
TOKEN_ELEVATION_TYPE &
{ %
TokenElevationTypeDefault !
=" #
$num$ %
,% &"
TokenElevationTypeFull 
, %
TokenElevationTypeLimited !
}   
internal&& 
enum&& #
TOKEN_INFORMATION_CLASS&& )
{'' 
	TokenUser(( 
=(( 
$num(( 
,(( 
TokenGroups)) 
,)) 
TokenPrivileges** 
,** 

TokenOwner++ 
,++ 
TokenPrimaryGroup,, 
,,, 
TokenDefaultDacl-- 
,-- 
TokenSource.. 
,.. 
	TokenType// 
,// #
TokenImpersonationLevel00 
,00  
TokenStatistics11 
,11 
TokenRestrictedSids22 
,22 
TokenSessionId33 
,33 $
TokenGroupsAndPrivileges44  
,44  !!
TokenSessionReference55 
,55 
TokenSandBoxInert66 
,66 
TokenAuditPolicy77 
,77 
TokenOrigin88 
,88 
TokenElevationType99 
,99 
TokenLinkedToken:: 
,:: 
TokenElevation;; 
,;;  
TokenHasRestrictions<< 
,<< "
TokenAccessInformation== 
,== &
TokenVirtualizationAllowed>> "
,>>" #&
TokenVirtualizationEnabled?? "
,??" #
TokenIntegrityLevel@@ 
,@@ 
TokenUIAccessAA 
,AA  
TokenMandatoryPolicyBB 
,BB 
TokenLogonSidCC 
,CC 
MaxTokenInfoClassDD 
}EE 
internalKK 
enumKK 
WELL_KNOWN_SID_TYPEKK %
{LL 

WinNullSidMM 
=MM 
$numMM 
,MM 
WinWorldSidNN 
=NN 
$numNN 
,NN 
WinLocalSidOO 
=OO 
$numOO 
,OO 
WinCreatorOwnerSidPP 
=PP 
$numPP 
,PP 
WinCreatorGroupSidQQ 
=QQ 
$numQQ 
,QQ $
WinCreatorOwnerServerSidRR  
=RR! "
$numRR# $
,RR$ %$
WinCreatorGroupServerSidSS  
=SS! "
$numSS# $
,SS$ %
WinNtAuthoritySidTT 
=TT 
$numTT 
,TT 
WinDialupSidUU 
=UU 
$numUU 
,UU 
WinNetworkSidVV 
=VV 
$numVV 
,VV 
WinBatchSidWW 
=WW 
$numWW 
,WW 
WinInteractiveSidXX 
=XX 
$numXX 
,XX 
WinServiceSidYY 
=YY 
$numYY 
,YY 
WinAnonymousSidZZ 
=ZZ 
$numZZ 
,ZZ 
WinProxySid[[ 
=[[ 
$num[[ 
,[[ '
WinEnterpriseControllersSid\\ #
=\\$ %
$num\\& (
,\\( )

WinSelfSid]] 
=]] 
$num]] 
,]] #
WinAuthenticatedUserSid^^ 
=^^  !
$num^^" $
,^^$ % 
WinRestrictedCodeSid__ 
=__ 
$num__ !
,__! " 
WinTerminalServerSid`` 
=`` 
$num`` !
,``! "
WinRemoteLogonIdSidaa 
=aa 
$numaa  
,aa  !
WinLogonIdsSidbb 
=bb 
$numbb 
,bb 
WinLocalSystemSidcc 
=cc 
$numcc 
,cc 
WinLocalServiceSiddd 
=dd 
$numdd 
,dd   
WinNetworkServiceSidee 
=ee 
$numee !
,ee! "
WinBuiltinDomainSidff 
=ff 
$numff  
,ff  !'
WinBuiltinAdministratorsSidgg #
=gg$ %
$numgg& (
,gg( )
WinBuiltinUsersSidhh 
=hh 
$numhh 
,hh  
WinBuiltinGuestsSidii 
=ii 
$numii  
,ii  !#
WinBuiltinPowerUsersSidjj 
=jj  !
$numjj" $
,jj$ %)
WinBuiltinAccountOperatorsSidkk %
=kk& '
$numkk( *
,kk* +(
WinBuiltinSystemOperatorsSidll $
=ll% &
$numll' )
,ll) *'
WinBuiltinPrintOperatorsSidmm #
=mm$ %
$nummm& (
,mm( )(
WinBuiltinBackupOperatorsSidnn $
=nn% &
$numnn' )
,nn) *#
WinBuiltinReplicatorSidoo 
=oo  !
$numoo" $
,oo$ %7
+WinBuiltinPreWindows2000CompatibleAccessSidpp 3
=pp4 5
$numpp6 8
,pp8 9+
WinBuiltinRemoteDesktopUsersSidqq '
=qq( )
$numqq* ,
,qq, -6
*WinBuiltinNetworkConfigurationOperatorsSidrr 2
=rr3 4
$numrr5 7
,rr7 8&
WinAccountAdministratorSidss "
=ss# $
$numss% '
,ss' (
WinAccountGuestSidtt 
=tt 
$numtt 
,tt  
WinAccountKrbtgtSiduu 
=uu 
$numuu  
,uu  !%
WinAccountDomainAdminsSidvv !
=vv" #
$numvv$ &
,vv& '$
WinAccountDomainUsersSidww  
=ww! "
$numww# %
,ww% &%
WinAccountDomainGuestsSidxx !
=xx" #
$numxx$ &
,xx& '"
WinAccountComputersSidyy 
=yy  
$numyy! #
,yy# $$
WinAccountControllersSidzz  
=zz! "
$numzz# %
,zz% &#
WinAccountCertAdminsSid{{ 
={{  !
$num{{" $
,{{$ %%
WinAccountSchemaAdminsSid|| !
=||" #
$num||$ &
,||& ')
WinAccountEnterpriseAdminsSid}} %
=}}& '
$num}}( *
,}}* +%
WinAccountPolicyAdminsSid~~ !
=~~" #
$num~~$ &
,~~& ')
WinAccountRasAndIasServersSid %
=& '
$num( *
,* +&
WinNTLMAuthenticationSid
ÄÄ  
=
ÄÄ! "
$num
ÄÄ# %
,
ÄÄ% &(
WinDigestAuthenticationSid
ÅÅ "
=
ÅÅ# $
$num
ÅÅ% '
,
ÅÅ' (*
WinSChannelAuthenticationSid
ÇÇ $
=
ÇÇ% &
$num
ÇÇ' )
,
ÇÇ) *$
WinThisOrganizationSid
ÉÉ 
=
ÉÉ  
$num
ÉÉ! #
,
ÉÉ# $%
WinOtherOrganizationSid
ÑÑ 
=
ÑÑ  !
$num
ÑÑ" $
,
ÑÑ$ %6
(WinBuiltinIncomingForestTrustBuildersSid
ÖÖ 0
=
ÖÖ1 2
$num
ÖÖ3 5
,
ÖÖ5 6.
 WinBuiltinPerfMonitoringUsersSid
ÜÜ (
=
ÜÜ) *
$num
ÜÜ+ -
,
ÜÜ- .+
WinBuiltinPerfLoggingUsersSid
áá %
=
áá& '
$num
áá( *
,
áá* +.
 WinBuiltinAuthorizationAccessSid
àà (
=
àà) *
$num
àà+ -
,
àà- .7
)WinBuiltinTerminalServerLicenseServersSid
ââ 1
=
ââ2 3
$num
ââ4 6
,
ââ6 7$
WinBuiltinDCOMUsersSid
ää 
=
ää  
$num
ää! #
,
ää# $!
WinBuiltinIUsersSid
ãã 
=
ãã 
$num
ãã  
,
ãã  !
WinIUserSid
åå 
=
åå 
$num
åå 
,
åå *
WinBuiltinCryptoOperatorsSid
çç $
=
çç% &
$num
çç' )
,
çç) *"
WinUntrustedLabelSid
éé 
=
éé 
$num
éé !
,
éé! "
WinLowLabelSid
èè 
=
èè 
$num
èè 
,
èè 
WinMediumLabelSid
êê 
=
êê 
$num
êê 
,
êê 
WinHighLabelSid
ëë 
=
ëë 
$num
ëë 
,
ëë 
WinSystemLabelSid
íí 
=
íí 
$num
íí 
,
íí '
WinWriteRestrictedCodeSid
ìì !
=
ìì" #
$num
ìì$ &
,
ìì& '&
WinCreatorOwnerRightsSid
îî  
=
îî! "
$num
îî# %
,
îî% &,
WinCacheablePrincipalsGroupSid
ïï &
=
ïï' (
$num
ïï) +
,
ïï+ ,/
!WinNonCacheablePrincipalsGroupSid
ññ )
=
ññ* +
$num
ññ, .
,
ññ. /1
#WinEnterpriseReadonlyControllersSid
óó +
=
óó, -
$num
óó. 0
,
óó0 1.
 WinAccountReadonlyControllersSid
òò (
=
òò) *
$num
òò+ -
,
òò- .,
WinBuiltinEventLogReadersGroup
ôô &
=
ôô' (
$num
ôô) +
,
ôô+ ,4
&WinNewEnterpriseReadonlyControllersSid
öö .
=
öö/ 0
$num
öö1 3
,
öö3 4.
 WinBuiltinCertSvcDComAccessGroup
õõ (
=
õõ) *
$num
õõ+ -
}
úú 
[
¢¢ 
StructLayout
¢¢ 
(
¢¢ 

LayoutKind
¢¢ 
.
¢¢ 

Sequential
¢¢ '
)
¢¢' (
]
¢¢( )
internal
££ 
struct
££  
SID_AND_ATTRIBUTES
££ &
{
§§ 
public
•• 
IntPtr
•• 
Sid
•• 
;
•• 
public
¶¶ 
UInt32
¶¶ 

Attributes
¶¶  
;
¶¶  !
}
ßß 
[
¨¨ 
StructLayout
¨¨ 
(
¨¨ 

LayoutKind
¨¨ 
.
¨¨ 

Sequential
¨¨ '
)
¨¨' (
]
¨¨( )
internal
≠≠ 
struct
≠≠ 
TOKEN_ELEVATION
≠≠ #
{
ÆÆ 
public
ØØ 
Int32
ØØ 
TokenIsElevated
ØØ $
;
ØØ$ %
}
∞∞ 
[
µµ 
StructLayout
µµ 
(
µµ 

LayoutKind
µµ 
.
µµ 

Sequential
µµ '
)
µµ' (
]
µµ( )
internal
∂∂ 
struct
∂∂ #
TOKEN_MANDATORY_LABEL
∂∂ )
{
∑∑ 
public
∏∏  
SID_AND_ATTRIBUTES
∏∏ !
Label
∏∏" '
;
∏∏' (
}
ππ 
internal
ªª 
class
ªª 
NativeMethods
ªª  
{
ºº 
public
¡¡ 
const
¡¡ 
UInt32
¡¡ 
BCM_SETSHIELD
¡¡ )
=
¡¡* +
$num
¡¡, 2
;
¡¡2 3
public
√√ 
const
√√ 
Int32
√√ '
ERROR_INSUFFICIENT_BUFFER
√√ 4
=
√√5 6
$num
√√7 :
;
√√: ;
public
≈≈ 
const
≈≈ 
Int32
≈≈ )
SECURITY_MANDATORY_HIGH_RID
≈≈ 6
=
≈≈7 8
$num
≈≈9 C
;
≈≈C D
public
«« 
const
«« 
Int32
«« (
SECURITY_MANDATORY_LOW_RID
«« 5
=
««6 7
$num
««8 B
;
««B C
public
…… 
const
…… 
Int32
…… +
SECURITY_MANDATORY_MEDIUM_RID
…… 8
=
……9 :
$num
……; E
;
……E F
public
ÀÀ 
const
ÀÀ 
Int32
ÀÀ +
SECURITY_MANDATORY_SYSTEM_RID
ÀÀ 8
=
ÀÀ9 :
$num
ÀÀ; E
;
ÀÀE F
public
ÕÕ 
const
ÕÕ 
Int32
ÕÕ .
 SECURITY_MANDATORY_UNTRUSTED_RID
ÕÕ ;
=
ÕÕ< =
$num
ÕÕ> H
;
ÕÕH I
public
œœ 
const
œœ 
UInt32
œœ "
STANDARD_RIGHTS_READ
œœ 0
=
œœ1 2
$num
œœ3 =
;
œœ= >
public
—— 
const
—— 
UInt32
—— &
STANDARD_RIGHTS_REQUIRED
—— 4
=
——5 6
$num
——7 A
;
——A B
public
”” 
const
”” 
UInt32
”” "
TOKEN_ADJUST_DEFAULT
”” 0
=
””1 2
$num
””3 9
;
””9 :
public
’’ 
const
’’ 
UInt32
’’ !
TOKEN_ADJUST_GROUPS
’’ /
=
’’0 1
$num
’’2 8
;
’’8 9
public
◊◊ 
const
◊◊ 
UInt32
◊◊ %
TOKEN_ADJUST_PRIVILEGES
◊◊ 3
=
◊◊4 5
$num
◊◊6 <
;
◊◊< =
public
ŸŸ 
const
ŸŸ 
UInt32
ŸŸ $
TOKEN_ADJUST_SESSIONID
ŸŸ 2
=
ŸŸ3 4
$num
ŸŸ5 ;
;
ŸŸ; <
public
€€ 
const
€€ 
UInt32
€€ 
TOKEN_ALL_ACCESS
€€ ,
=
€€- .
(
€€/ 0&
STANDARD_RIGHTS_REQUIRED
€€0 H
|
€€I J"
TOKEN_ASSIGN_PRIMARY
‹‹  
|
‹‹! "
TOKEN_DUPLICATE
‹‹# 2
|
‹‹3 4
TOKEN_IMPERSONATE
‹‹5 F
|
‹‹G H
TOKEN_QUERY
›› 
|
››  
TOKEN_QUERY_SOURCE
›› ,
|
››- .%
TOKEN_ADJUST_PRIVILEGES
››/ F
|
››G H!
TOKEN_ADJUST_GROUPS
ﬁﬁ 
|
ﬁﬁ  !"
TOKEN_ADJUST_DEFAULT
ﬁﬁ" 6
|
ﬁﬁ7 8$
TOKEN_ADJUST_SESSIONID
ﬁﬁ9 O
)
ﬁﬁO P
;
ﬁﬁP Q
public
·· 
const
·· 
UInt32
·· "
TOKEN_ASSIGN_PRIMARY
·· 0
=
··1 2
$num
··3 9
;
··9 :
public
„„ 
const
„„ 
UInt32
„„ 
TOKEN_DUPLICATE
„„ +
=
„„, -
$num
„„. 4
;
„„4 5
public
ÂÂ 
const
ÂÂ 
UInt32
ÂÂ 
TOKEN_IMPERSONATE
ÂÂ -
=
ÂÂ. /
$num
ÂÂ0 6
;
ÂÂ6 7
public
ÁÁ 
const
ÁÁ 
UInt32
ÁÁ 
TOKEN_QUERY
ÁÁ '
=
ÁÁ( )
$num
ÁÁ* 0
;
ÁÁ0 1
public
ÈÈ 
const
ÈÈ 
UInt32
ÈÈ  
TOKEN_QUERY_SOURCE
ÈÈ .
=
ÈÈ/ 0
$num
ÈÈ1 7
;
ÈÈ7 8
public
ÎÎ 
const
ÎÎ 
UInt32
ÎÎ 

TOKEN_READ
ÎÎ &
=
ÎÎ' (
(
ÎÎ) *"
STANDARD_RIGHTS_READ
ÎÎ* >
|
ÎÎ? @
TOKEN_QUERY
ÎÎA L
)
ÎÎL M
;
ÎÎM N
public
ÌÌ 
enum
ÌÌ $
GET_FILEEX_INFO_LEVELS
ÌÌ *
{
ÓÓ 	#
GetFileExInfoStandard
ÔÔ !
,
ÔÔ! "#
GetFileExMaxInfoLevel
 !
}
ÒÒ 	
[
ÛÛ 	
	DllImport
ÛÛ	 
(
ÛÛ 
$str
ÛÛ !
,
ÛÛ! "
CharSet
ÛÛ# *
=
ÛÛ+ ,
CharSet
ÛÛ- 4
.
ÛÛ4 5
Auto
ÛÛ5 9
,
ÛÛ9 :
SetLastError
ÛÛ; G
=
ÛÛH I
true
ÛÛJ N
)
ÛÛN O
]
ÛÛO P
public
ÙÙ 
static
ÙÙ 
extern
ÙÙ 
IntPtr
ÙÙ #

CreateFile
ÙÙ$ .
(
ÙÙ. /
[
ıı 
	MarshalAs
ıı 
(
ıı 
UnmanagedType
ıı (
.
ıı( )
LPWStr
ıı) /
)
ıı/ 0
]
ıı0 1
string
ıı2 8
filename
ıı9 A
,
ııA B
[
ˆˆ 
	MarshalAs
ˆˆ 
(
ˆˆ 
UnmanagedType
ˆˆ (
.
ˆˆ( )
U4
ˆˆ) +
)
ˆˆ+ ,
]
ˆˆ, -
uint
ˆˆ. 2
access
ˆˆ3 9
,
ˆˆ9 :
[
˜˜ 
	MarshalAs
˜˜ 
(
˜˜ 
UnmanagedType
˜˜ (
.
˜˜( )
U4
˜˜) +
)
˜˜+ ,
]
˜˜, -
	FileShare
˜˜. 7
share
˜˜8 =
,
˜˜= >
IntPtr
¯¯  
securityAttributes
¯¯ )
,
¯¯) *
[
˘˘ 
	MarshalAs
˘˘ 
(
˘˘ 
UnmanagedType
˘˘ (
.
˘˘( )
U4
˘˘) +
)
˘˘+ ,
]
˘˘, -
FileMode
˘˘. 6!
creationDisposition
˘˘7 J
,
˘˘J K
[
˙˙ 
	MarshalAs
˙˙ 
(
˙˙ 
UnmanagedType
˙˙ (
.
˙˙( )
U4
˙˙) +
)
˙˙+ ,
]
˙˙, -
uint
˙˙. 2 
flagsAndAttributes
˙˙3 E
,
˙˙E F
IntPtr
˚˚ 
templateFile
˚˚ #
)
˚˚# $
;
˚˚$ %
[
ââ 	
	DllImport
ââ	 
(
ââ 
$str
ââ !
,
ââ! "
CharSet
ââ# *
=
ââ+ ,
CharSet
ââ- 4
.
ââ4 5
Auto
ââ5 9
,
ââ9 :
SetLastError
ââ; G
=
ââH I
true
ââJ N
)
ââN O
]
ââO P
public
ää 
static
ää 
extern
ää 
bool
ää !
DuplicateToken
ää" 0
(
ää0 1
SafeTokenHandle
ãã !
ExistingTokenHandle
ãã /
,
ãã/ 0*
SECURITY_IMPERSONATION_LEVEL
åå ( 
ImpersonationLevel
åå) ;
,
åå; <
out
çç 
SafeTokenHandle
çç "
DuplicateTokenHandle
çç  4
)
çç4 5
;
çç5 6
[
èè 	
	DllImport
èè	 
(
èè 
$str
èè !
,
èè! "
SetLastError
èè# /
=
èè0 1
true
èè2 6
,
èè6 7
CharSet
èè8 ?
=
èè@ A
CharSet
èèB I
.
èèI J
Unicode
èèJ Q
)
èèQ R
]
èèR S
[
êê 	
return
êê	 
:
êê 
	MarshalAs
êê 
(
êê 
UnmanagedType
êê (
.
êê( )
Bool
êê) -
)
êê- .
]
êê. /
public
ëë 
static
ëë 
extern
ëë 
bool
ëë !!
GetFileAttributesEx
ëë" 5
(
ëë5 6
string
ëë6 <

lpFileName
ëë= G
,
ëëG H$
GET_FILEEX_INFO_LEVELS
ëëI _
fInfoLevelId
ëë` l
,
ëël m
out
ëën q(
WIN32_FILE_ATTRIBUTE_DATAëër ã
fileDataëëå î
)ëëî ï
;ëëï ñ
public
ìì 
static
ìì 
string
ìì 
GetFinalPathName
ìì -
(
ìì- .
string
ìì. 4
path
ìì5 9
)
ìì9 :
{
îî 	
var
ïï 
h
ïï 
=
ïï 

CreateFile
ïï 
(
ïï 
path
ïï #
,
ïï# $
FILE_READ_EA
ññ 
,
ññ 
	FileShare
óó 
.
óó 
	ReadWrite
óó #
|
óó$ %
	FileShare
óó& /
.
óó/ 0
Delete
óó0 6
,
óó6 7
IntPtr
òò 
.
òò 
Zero
òò 
,
òò 
FileMode
ôô 
.
ôô 
Open
ôô 
,
ôô (
FILE_FLAG_BACKUP_SEMANTICS
öö *
,
öö* +
IntPtr
õõ 
.
õõ 
Zero
õõ 
)
õõ 
;
õõ 
if
úú 
(
úú 
h
úú 
==
úú "
INVALID_HANDLE_VALUE
úú )
)
úú) *
throw
ùù 
new
ùù 
Win32Exception
ùù (
(
ùù( )
)
ùù) *
;
ùù* +
try
üü 
{
†† 
var
°° 
sb
°° 
=
°° 
new
°° 
StringBuilder
°° *
(
°°* +
$num
°°+ /
)
°°/ 0
;
°°0 1
var
¢¢ 
res
¢¢ 
=
¢¢ &
GetFinalPathNameByHandle
¢¢ 2
(
¢¢2 3
h
¢¢3 4
,
¢¢4 5
sb
¢¢6 8
,
¢¢8 9
$num
¢¢: >
,
¢¢> ?
$num
¢¢@ A
)
¢¢A B
;
¢¢B C
if
££ 
(
££ 
res
££ 
==
££ 
$num
££ 
)
££ 
throw
§§ 
new
§§ 
Win32Exception
§§ ,
(
§§, -
)
§§- .
;
§§. /
return
¶¶ 
sb
¶¶ 
.
¶¶ 
ToString
¶¶ "
(
¶¶" #
)
¶¶# $
;
¶¶$ %
}
ßß 
finally
®® 
{
©© 
CloseHandle
™™ 
(
™™ 
h
™™ 
)
™™ 
;
™™ 
}
´´ 
}
¨¨ 	
[
øø 	
	DllImport
øø	 
(
øø 
$str
øø !
,
øø! "
CharSet
øø# *
=
øø+ ,
CharSet
øø- 4
.
øø4 5
Auto
øø5 9
,
øø9 :
SetLastError
øø; G
=
øøH I
true
øøJ N
)
øøN O
]
øøO P
public
¿¿ 
static
¿¿ 
extern
¿¿ 
IntPtr
¿¿ # 
GetSidSubAuthority
¿¿$ 6
(
¿¿6 7
IntPtr
¿¿7 =
pSid
¿¿> B
,
¿¿B C
UInt32
¿¿D J
nSubAuthority
¿¿K X
)
¿¿X Y
;
¿¿Y Z
[
‘‘ 	
	DllImport
‘‘	 
(
‘‘ 
$str
‘‘ !
,
‘‘! "
CharSet
‘‘# *
=
‘‘+ ,
CharSet
‘‘- 4
.
‘‘4 5
Auto
‘‘5 9
,
‘‘9 :
SetLastError
‘‘; G
=
‘‘H I
true
‘‘J N
)
‘‘N O
]
‘‘O P
[
’’ 	
return
’’	 
:
’’ 
	MarshalAs
’’ 
(
’’ 
UnmanagedType
’’ (
.
’’( )
Bool
’’) -
)
’’- .
]
’’. /
public
÷÷ 
static
÷÷ 
extern
÷÷ 
bool
÷÷ !!
GetTokenInformation
÷÷" 5
(
÷÷5 6
SafeTokenHandle
◊◊ 
hToken
◊◊ "
,
◊◊" #%
TOKEN_INFORMATION_CLASS
ÿÿ #
tokenInfoClass
ÿÿ$ 2
,
ÿÿ2 3
IntPtr
ŸŸ 

pTokenInfo
ŸŸ 
,
ŸŸ 
Int32
⁄⁄ 
tokenInfoLength
⁄⁄ !
,
⁄⁄! "
out
€€ 
Int32
€€ 
returnLength
€€ "
)
€€" #
;
€€# $
[
ÈÈ 	
	DllImport
ÈÈ	 
(
ÈÈ 
$str
ÈÈ 
,
ÈÈ 
CharSet
ÈÈ &
=
ÈÈ' (
CharSet
ÈÈ) 0
.
ÈÈ0 1
Auto
ÈÈ1 5
,
ÈÈ5 6
SetLastError
ÈÈ7 C
=
ÈÈD E
true
ÈÈF J
)
ÈÈJ K
]
ÈÈK L
[
ÍÍ 	
return
ÍÍ	 
:
ÍÍ 
	MarshalAs
ÍÍ 
(
ÍÍ 
UnmanagedType
ÍÍ (
.
ÍÍ( )
Bool
ÍÍ) -
)
ÍÍ- .
]
ÍÍ. /
public
ÎÎ 
static
ÎÎ 
extern
ÎÎ 
bool
ÎÎ !
OpenProcessToken
ÎÎ" 2
(
ÎÎ2 3
IntPtr
ÎÎ3 9
hProcess
ÎÎ: B
,
ÎÎB C
UInt32
ÏÏ 
desiredAccess
ÏÏ  
,
ÏÏ  !
out
ÏÏ" %
SafeTokenHandle
ÏÏ& 5
hToken
ÏÏ6 <
)
ÏÏ< =
;
ÏÏ= >
[
˜˜ 	
	DllImport
˜˜	 
(
˜˜ 
$str
˜˜ 
,
˜˜ 
CharSet
˜˜ $
=
˜˜% &
CharSet
˜˜' .
.
˜˜. /
Auto
˜˜/ 3
,
˜˜3 4
SetLastError
˜˜5 A
=
˜˜B C
true
˜˜D H
)
˜˜H I
]
˜˜I J
public
¯¯ 
static
¯¯ 
extern
¯¯ 
int
¯¯  
SendMessage
¯¯! ,
(
¯¯, -
IntPtr
¯¯- 3
hWnd
¯¯4 8
,
¯¯8 9
UInt32
¯¯: @
Msg
¯¯A D
,
¯¯D E
int
¯¯F I
wParam
¯¯J P
,
¯¯P Q
IntPtr
¯¯R X
lParam
¯¯Y _
)
¯¯_ `
;
¯¯` a
[
˙˙ 	
StructLayout
˙˙	 
(
˙˙ 

LayoutKind
˙˙  
.
˙˙  !

Sequential
˙˙! +
)
˙˙+ ,
]
˙˙, -
public
˚˚ 
struct
˚˚ '
WIN32_FILE_ATTRIBUTE_DATA
˚˚ /
{
¸¸ 	
public
˝˝ 
uint
˝˝ 
dwFileAttributes
˝˝ (
;
˝˝( )
public
˛˛ 
System
˛˛ 
.
˛˛ 
Runtime
˛˛ !
.
˛˛! "
InteropServices
˛˛" 1
.
˛˛1 2
ComTypes
˛˛2 :
.
˛˛: ;
FILETIME
˛˛; C
ftCreationTime
˛˛D R
;
˛˛R S
public
ˇˇ 
System
ˇˇ 
.
ˇˇ 
Runtime
ˇˇ !
.
ˇˇ! "
InteropServices
ˇˇ" 1
.
ˇˇ1 2
ComTypes
ˇˇ2 :
.
ˇˇ: ;
FILETIME
ˇˇ; C
ftLastAccessTime
ˇˇD T
;
ˇˇT U
public
ÄÄ 
System
ÄÄ 
.
ÄÄ 
Runtime
ÄÄ !
.
ÄÄ! "
InteropServices
ÄÄ" 1
.
ÄÄ1 2
ComTypes
ÄÄ2 :
.
ÄÄ: ;
FILETIME
ÄÄ; C
ftLastWriteTime
ÄÄD S
;
ÄÄS T
public
ÅÅ 
uint
ÅÅ 
nFileSizeHigh
ÅÅ %
;
ÅÅ% &
public
ÇÇ 
uint
ÇÇ 
nFileSizeLow
ÇÇ $
;
ÇÇ$ %
}
ÉÉ 	
[
ÖÖ 	
	DllImport
ÖÖ	 
(
ÖÖ 
$str
ÖÖ !
,
ÖÖ! "
CharSet
ÖÖ# *
=
ÖÖ+ ,
CharSet
ÖÖ- 4
.
ÖÖ4 5
Auto
ÖÖ5 9
,
ÖÖ9 :
SetLastError
ÖÖ; G
=
ÖÖH I
true
ÖÖJ N
)
ÖÖN O
]
ÖÖO P
internal
ÜÜ 
static
ÜÜ 
extern
ÜÜ 
bool
ÜÜ #
CloseHandle
ÜÜ$ /
(
ÜÜ/ 0
IntPtr
ÜÜ0 6
handle
ÜÜ7 =
)
ÜÜ= >
;
ÜÜ> ?
[
àà 	
	DllImport
àà	 
(
àà 
$str
àà !
)
àà! "
]
àà" #
internal
ââ 
static
ââ 
extern
ââ 
uint
ââ #$
GetCompressedFileSizeW
ââ$ :
(
ââ: ;
[
ää 
In
ää 
,
ää 
	MarshalAs
ää 
(
ää 
UnmanagedType
ää (
.
ää( )
LPWStr
ää) /
)
ää/ 0
]
ää0 1
string
ää2 8

lpFileName
ää9 C
,
ääC D
[
ãã 
Out
ãã 
,
ãã 
	MarshalAs
ãã 
(
ãã 
UnmanagedType
ãã )
.
ãã) *
U4
ãã* ,
)
ãã, -
]
ãã- .
out
ãã/ 2
uint
ãã3 7
lpFileSizeHigh
ãã8 F
)
ããF G
;
ããG H
[
çç 	
	DllImport
çç	 
(
çç 
$str
çç !
,
çç! "
SetLastError
çç# /
=
çç0 1
true
çç2 6
,
çç6 7
CharSet
çç8 ?
=
çç@ A
CharSet
ççB I
.
ççI J
Auto
ççJ N
)
ççN O
]
ççO P
internal
éé 
static
éé 
extern
éé 
bool
éé #
GetDiskFreeSpace
éé$ 4
(
éé4 5
[
éé5 6
In
éé6 8
,
éé8 9
	MarshalAs
éé: C
(
ééC D
UnmanagedType
ééD Q
.
ééQ R
LPWStr
ééR X
)
ééX Y
]
ééY Z
string
éé[ a
lpRootPathName
ééb p
,
éép q
out
èè 
uint
èè !
lpSectorsPerCluster
èè '
,
èè' (
out
êê 
uint
êê 
lpBytesPerSector
êê $
,
êê$ %
out
ëë 
uint
ëë $
lpNumberOfFreeClusters
ëë *
,
ëë* +
out
íí 
uint
íí %
lpTotalNumberOfClusters
íí +
)
íí+ ,
;
íí, -
private
îî 
const
îî 
uint
îî (
FILE_FLAG_BACKUP_SEMANTICS
îî 5
=
îî6 7
$num
îî8 A
;
îîA B
private
ññ 
const
ññ 
uint
ññ 
FILE_READ_EA
ññ '
=
ññ( )
$num
ññ* 0
;
ññ0 1
private
òò 
static
òò 
readonly
òò 
IntPtr
òò  &"
INVALID_HANDLE_VALUE
òò' ;
=
òò< =
new
òò> A
IntPtr
òòB H
(
òòH I
-
òòI J
$num
òòJ K
)
òòK L
;
òòL M
[
öö 	
	DllImport
öö	 
(
öö 
$str
öö !
,
öö! "
SetLastError
öö# /
=
öö0 1
true
öö2 6
,
öö6 7
CharSet
öö8 ?
=
öö@ A
CharSet
ööB I
.
ööI J
Auto
ööJ N
)
ööN O
]
ööO P
private
õõ 
static
õõ 
extern
õõ 
uint
õõ "&
GetFinalPathNameByHandle
õõ# ;
(
õõ; <
IntPtr
õõ< B
hFile
õõC H
,
õõH I
[
õõJ K
	MarshalAs
õõK T
(
õõT U
UnmanagedType
õõU b
.
õõb c
LPWStr
õõc i
)
õõi j
]
õõj k
StringBuilder
õõl y
lpszFilePathõõz Ü
,õõÜ á
uintõõà å
cchFilePathõõç ò
,õõò ô
uintõõö û
dwFlagsõõü ¶
)õõ¶ ß
;õõß ®
}
úú 
}ùù ˚@
GD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\RegistryWalker.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{ 
public 

static 
class 
RegistryWalker &
{ 
public 
static 
RegistryObject $
?$ %'
RegistryKeyToRegistryObject& A
(A B
RegistryKeyB M
keyN Q
,Q R
RegistryViewS _
registryView` l
)l m
{ 	
if 
( 
key 
== 
null 
) 
{ 
return 
null 
; 
} 
RegistryObject 
regObj !
=" #
new$ '
RegistryObject( 6
(6 7
key7 :
.: ;
Name; ?
,? @
registryViewA M
)M N
;N O
try 
{ 
regObj 
. 

AddSubKeys !
(! "
key" %
.% &
GetSubKeyNames& 4
(4 5
)5 6
)6 7
;7 8
} 
catch 
( 
System 
. 
ArgumentException +
)+ ,
{ 
Log 
. 
Debug 
( 
$str B
,B C
keyD G
.G H
NameH L
)L M
;M N
} 
catch 
( 
	Exception 
e 
) 
{ 
Log   
.   
Debug   
(   
e   
,   
$str   ;
,  ; <
key  = @
.  @ A
Name  A E
)  E F
;  F G
}!! 
try## 
{$$ 
foreach%% 
(%% 
RegistryAccessRule%% +
?%%+ ,
rule%%- 1
in%%2 4
key%%5 8
.%%8 9
GetAccessControl%%9 I
(%%I J
)%%J K
.%%K L
GetAccessRules%%L Z
(%%Z [
true%%[ _
,%%_ `
true%%a e
,%%e f
typeof%%g m
(%%m n
SecurityIdentifier	%%n Ä
)
%%Ä Å
)
%%Å Ç
)
%%Ç É
{&& 
if'' 
('' 
rule'' 
!='' 
null''  $
)''$ %
{(( 
string)) 
name)) #
=))$ %

AsaHelpers))& 0
.))0 1
	SidToName))1 :
()): ;
rule)); ?
.))? @
IdentityReference))@ Q
)))Q R
;))R S
if++ 
(++ 
regObj++ "
.++" #
Permissions++# .
.++. /
ContainsKey++/ :
(++: ;
name++; ?
)++? @
)++@ A
{,, 
regObj-- "
.--" #
Permissions--# .
[--. /
name--/ 3
]--3 4
.--4 5
Add--5 8
(--8 9
rule--9 =
.--= >
RegistryRights--> L
.--L M
ToString--M U
(--U V
)--V W
)--W X
;--X Y
}.. 
else// 
{00 
regObj11 "
.11" #
Permissions11# .
.11. /
Add11/ 2
(112 3
name113 7
,117 8
new119 <
List11= A
<11A B
string11B H
>11H I
(11I J
)11J K
{11L M
rule11N R
.11R S
RegistryRights11S a
.11a b
ToString11b j
(11j k
)11k l
}11m n
)11n o
;11o p
}22 
}33 
}44 
}55 
catch66 
(66 
	Exception66 
e66 
)66 
{77 
Log88 
.88 
Debug88 
(88 
e88 
,88 
$str88 J
,88J K
regObj88L R
.88R S
Key88S V
,88V W
e88X Y
.88Y Z
GetType88Z a
(88a b
)88b c
,88c d
e88e f
.88f g
Message88g n
)88n o
;88o p
}99 
regObj;; 
.;; 
Values;; 
=;; 
RegistryObject;; *
.;;* +
	GetValues;;+ 4
(;;4 5
key;;5 8
);;8 9
;;;9 :
return== 
regObj== 
;== 
}>> 	
public@@ 
static@@ 
IEnumerable@@ !
<@@! "
string@@" (
>@@( )
WalkHive@@* 2
(@@2 3
RegistryHive@@3 ?
Hive@@@ D
,@@D E
RegistryView@@F R
View@@S W
,@@W X
string@@Y _
startingKey@@` k
=@@l m
$str@@n p
)@@p q
{AA 	
StackBB 
<BB 
stringBB 
>BB 
keysBB 
=BB  
newBB! $
StackBB% *
<BB* +
stringBB+ 1
>BB1 2
(BB2 3
)BB3 4
;BB4 5
RegistryKeyDD 
?DD 
BaseKeyDD  
=DD! "
nullDD# '
;DD' (
tryEE 
{FF 
BaseKeyGG 
=GG 
RegistryKeyGG %
.GG% &
OpenBaseKeyGG& 1
(GG1 2
HiveGG2 6
,GG6 7
ViewGG8 <
)GG< =
;GG= >
}HH 
catchII 
(II 
	ExceptionII 
eII 
)II 
whenII  $
(II% &
eJJ 
isJJ 
IOExceptionJJ  
||JJ! #
eKK 
isKK 
ArgumentExceptionKK &
||KK' )
eLL 
isLL '
UnauthorizedAccessExceptionLL 0
||LL1 3
eMM 
isMM 
SystemMM 
.MM 
SecurityMM $
.MM$ %
SecurityExceptionMM% 6
)MM6 7
{NN 
LogOO 
.OO 
DebugOO 
(OO 
$"OO 
$strOO 0
{OO0 1
HiveOO1 5
}OO5 6
$strOO6 C
"OOC D
)OOD E
;OOE F
}PP 
ifRR 
(RR 
BaseKeyRR 
!=RR 
nullRR 
)RR  
{SS 
keysTT 
.TT 
PushTT 
(TT 
startingKeyTT %
)TT% &
;TT& '
whileVV 
(VV 
keysVV 
.VV 
CountVV !
>VV" #
$numVV$ %
)VV% &
{WW 
varXX 
keyXX 
=XX 
keysXX "
.XX" #
PopXX# &
(XX& '
)XX' (
;XX( )
tryYY 
{ZZ 
RegistryKey[[ #

currentKey[[$ .
=[[/ 0
BaseKey[[1 8
.[[8 9

OpenSubKey[[9 C
([[C D
key[[D G
)[[G H
;[[H I
if]] 
(]] 

currentKey]] &
!=]]' )
null]]* .
)]]. /
{^^ 
foreach__ #
(__$ %
string__% +
subkey__, 2
in__3 5

currentKey__6 @
.__@ A
GetSubKeyNames__A O
(__O P
)__P Q
)__Q R
{`` 
keysaa  $
.aa$ %
Pushaa% )
(aa) *
$"aa* ,
{aa, -
keyaa- 0
}aa0 1
$straa1 3
{aa3 4
subkeyaa4 :
}aa: ;
"aa; <
)aa< =
;aa= >
}bb 
}cc 
}dd 
catchee 
(ee 
	Exceptionee $
eee% &
)ee& '
{ff 
Loggg 
.gg 
Verbosegg #
(gg# $
$strgg$ E
,ggE F
keyggG J
,ggJ K
eggL M
.ggM N
GetTypeggN U
(ggU V
)ggV W
)ggW X
;ggX Y
}hh 
yieldjj 
returnjj  
keyjj! $
;jj$ %
}kk 
}ll 
BaseKeynn 
?nn 
.nn 
Disposenn 
(nn 
)nn 
;nn 
}oo 	
}pp 
}qq ƒ
CD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\RunManager.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{ 
public 

class 

RunManager 
{ 
public 

RunManager 
( 
) 
{ 	
} 	
}		 
}

 ï

HD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\SafeTokenHandle.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{ 
internal

 
class

 
SafeTokenHandle

 "
:

# $-
!SafeHandleZeroOrMinusOneIsInvalid

% F
{ 
internal 
SafeTokenHandle  
(  !
IntPtr! '
handle( .
). /
:0 1
base2 6
(6 7
true7 ;
); <
{ 	
base 
. 
	SetHandle 
( 
handle !
)! "
;" #
} 	
	protected 
override 
bool 
ReleaseHandle  -
(- .
). /
{ 	
return 
NativeMethods  
.  !
CloseHandle! ,
(, -
base- 1
.1 2
handle2 8
)8 9
;9 :
} 	
private 
SafeTokenHandle 
(  
)  !
:" #
base$ (
(( )
true) -
)- .
{ 	
} 	
} 
} ‘‚
ND:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\SqliteDatabaseManager.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{ 
public 

class 

DBSettings 
{ 
public 
int 
	BatchSize 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
$num- 0
;0 1
public 
int 

FlushCount 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
-. /
$num/ 0
;0 1
public 
string 
JournalMode !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
$str2 :
;: ;
public 
string 
LockingMode !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
$str2 :
;: ;
public 
bool 
LowMemoryUsage "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
false3 8
;8 9
public 
int 
PageSize 
{ 
get !
;! "
set# &
;& '
}( )
=* +
$num, 0
;0 1
public 
int 
ShardingFactor !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
$num2 3
;3 4
public 
string 
Synchronous !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
$str2 7
;7 8
} 
public 

class !
SqliteDatabaseManager &
:' (
DatabaseManager) 8
{   
public"" 
const"" 
int"" 
LOW_MEMORY_CUTOFF"" *
=""+ ,
$num""- 1
;""1 2
public$$ !
SqliteDatabaseManager$$ $
($$$ %
string$$% +
filename$$, 4
,$$4 5

DBSettings$$6 @
?$$@ A
dbSettingsIn$$B N
=$$O P
null$$Q U
)$$U V
{%% 	

dbSettings&& 
=&& 
(&& 
dbSettingsIn&& &
==&&' )
null&&* .
)&&. /
?&&0 1
new&&2 5

DBSettings&&6 @
(&&@ A
)&&A B
:&&C D
dbSettingsIn&&E Q
;&&Q R
if(( 
((( 
filename(( 
!=(( 
null((  
)((  !
{)) 
if** 
(** 
Location** 
!=** 
filename**  (
)**( )
{++ 
if,, 
(,, 
Path,, 
.,, 
IsPathRooted,, )
(,,) *
filename,,* 2
),,2 3
),,3 4
{-- 
Location..  
=..! "
filename..# +
;..+ ,
}// 
else00 
{11 
Location22  
=22! "
$"22# %
{22% &
	Directory22& /
.22/ 0
GetCurrentDirectory220 C
(22C D
)22D E
}22E F
{22F G
Path22G K
.22K L"
DirectorySeparatorChar22L b
}22b c
{22c d
filename22d l
}22l m
"22m n
;22n o
}33 
}44 
}55 
else66 
{77 
Location88 
=88 
$"88 
{88 
	Directory88 '
.88' (
GetCurrentDirectory88( ;
(88; <
)88< =
}88= >
{88> ?
Path88? C
.88C D"
DirectorySeparatorChar88D Z
}88Z [
$str88[ e
"88e f
;88f g
}99 
}:: 	
public<< 
List<< 
<<< 
SqlConnectionHolder<< '
><<' (
Connections<<) 4
{<<5 6
get<<7 :
;<<: ;
private<<< C
set<<D G
;<<G H
}<<I J
=<<K L
new<<M P
List<<Q U
<<<U V
SqlConnectionHolder<<V i
><<i j
(<<j k
)<<k l
;<<l m
public>> 
override>> 
bool>> 
HasElements>> (
{?? 	
get@@ 
{AA 
{BB 
returnCC 
ConnectionsCC &
.CC& '
AnyCC' *
(CC* +
xCC+ ,
=>CC- /
xCC0 1
.CC1 2

WriteQueueCC2 <
.CC< =
CountCC= B
>CCC D
$numCCE F
||CCG I
xCCJ K
.CCK L
	IsWritingCCL U
)CCU V
;CCV W
}DD 
}EE 
}FF 	
publicHH 
SqlConnectionHolderHH "
?HH" #
MainConnectionHH$ 2
{II 	
getJJ 
{KK 
ifLL 
(LL 
ConnectionsLL 
.LL  
AnyLL  #
(LL# $
)LL$ %
)LL% &
returnMM 
ConnectionsMM &
[MM& '
$numMM' (
]MM( )
;MM) *
returnNN 
nullNN 
;NN 
}OO 
}PP 	
publicRR 
overrideRR 
intRR 
	QueueSizeRR %
{RR& '
getRR( +
{RR, -
returnRR. 4
ConnectionsRR5 @
.RR@ A
SumRRA D
(RRD E
xRRE F
=>RRG I
xRRJ K
.RRK L

WriteQueueRRL V
.RRV W
CountRRW \
)RR\ ]
;RR] ^
}RR_ `
}RRa b
publicTT 
overrideTT 
voidTT 
BeginTransactionTT -
(TT- .
)TT. /
{UU 	
ConnectionsVV 
.VV 

AsParallelVV "
(VV" #
)VV# $
.VV$ %
ForAllVV% +
(VV+ ,
cxnVV, /
=>VV0 2
cxnVV3 6
.VV6 7
BeginTransactionVV7 G
(VVG H
)VVH I
)VVI J
;VVJ K
}WW 	
publicYY 
overrideYY 
voidYY 
CloseDatabaseYY *
(YY* +
)YY+ ,
{ZZ 	
RollBack[[ 
([[ 
)[[ 
;[[ 
Connections\\ 
.\\ 

AsParallel\\ "
(\\" #
)\\# $
.\\$ %
ForAll\\% +
(\\+ ,
cxn\\, /
=>\\0 2
{]] 
cxn^^ 
.^^ 
ShutDown^^ 
(^^ 
)^^ 
;^^ 
}__ 
)__ 
;__ 
Connections`` 
.`` 
	RemoveAll`` !
(``! "
_``" #
=>``$ &
true``' +
)``+ ,
;``, -
}aa 	
publiccc 
overridecc 
voidcc 
Commitcc #
(cc# $
)cc$ %
{dd 	
Connectionsee 
.ee 

AsParallelee "
(ee" #
)ee# $
.ee$ %
ForAllee% +
(ee+ ,
xee, -
=>ee. 0
xee1 2
.ee2 3
Commitee3 9
(ee9 :
)ee: ;
)ee; <
;ee< =
}ff 	
publichh 
overridehh 
voidhh 
	DeleteRunhh &
(hh& '
stringhh' -
runidhh. 3
)hh3 4
{ii 	
_jj 
=jj 
MainConnectionjj 
??jj !
throwjj" '
newjj( +"
NullReferenceExceptionjj, B
(jjB C
StringsjjC J
.jjJ K
GetjjK N
(jjN O
$strjjO _
)jj_ `
)jj` a
;jja b
usingkk 
varkk 
truncateRunsTablekk '
=kk( )
newkk* -
SqliteCommandkk. ;
(kk; <
SQL_TRUNCATE_RUNkk< L
,kkL M
MainConnectionkkN \
.kk\ ]

Connectionkk] g
,kkg h
MainConnectionkki w
.kkw x
Transaction	kkx É
)
kkÉ Ñ
;
kkÑ Ö
truncateRunsTablell 
.ll 

Parametersll (
.ll( )
AddWithValuell) 5
(ll5 6
$strll6 ?
,ll? @
runidllA F
)llF G
;llG H
truncateRunsTablemm 
.mm 
ExecuteNonQuerymm -
(mm- .
)mm. /
;mm/ 0
Connectionsoo 
.oo 

AsParalleloo "
(oo" #
)oo# $
.oo$ %
ForAlloo% +
(oo+ ,
cxnoo, /
=>oo0 2
{pp 
usingqq 
varqq  
truncateCollectTableqq .
=qq/ 0
newqq1 4
SqliteCommandqq5 B
(qqB C
SQL_DELETE_RUNqqC Q
,qqQ R
cxnqqS V
.qqV W

ConnectionqqW a
,qqa b
cxnqqc f
.qqf g
Transactionqqg r
)qqr s
;qqs t 
truncateCollectTablerr $
.rr$ %

Parametersrr% /
.rr/ 0
AddWithValuerr0 <
(rr< =
$strrr= F
,rrF G
runidrrH M
)rrM N
;rrN O 
truncateCollectTabless $
.ss$ %
ExecuteNonQueryss% 4
(ss4 5
)ss5 6
;ss6 7
}tt 
)tt 
;tt 
}uu 	
publicww 
overrideww 
voidww 
DeleteCompareRunww -
(ww- .
stringww. 4

firstRunIdww5 ?
,ww? @
stringwwA G
secondRunIdwwH S
,wwS T
stringwwU [
analysesHashww\ h
)wwh i
{xx 	
_yy 
=yy 
MainConnectionyy 
??yy !
throwyy" '
newyy( +"
NullReferenceExceptionyy, B
(yyB C
StringsyyC J
.yyJ K
GetyyK N
(yyN O
$stryyO _
)yy_ `
)yy` a
;yya b
usingzz 
varzz 
deleteCompareRunzz &
=zz' (
newzz) ,
SqliteCommandzz- :
(zz: ;"
SQL_DELETE_COMPARE_RUNzz; Q
,zzQ R
MainConnectionzzS a
.zza b

Connectionzzb l
,zzl m
MainConnectionzzn |
.zz| }
Transaction	zz} à
)
zzà â
;
zzâ ä
deleteCompareRun{{ 
.{{ 

Parameters{{ '
.{{' (
AddWithValue{{( 4
({{4 5
$str{{5 D
,{{D E

firstRunId{{F P
){{P Q
;{{Q R
deleteCompareRun|| 
.|| 

Parameters|| '
.||' (
AddWithValue||( 4
(||4 5
$str||5 E
,||E F
secondRunId||G R
)||R S
;||S T
deleteCompareRun}} 
.}} 

Parameters}} '
.}}' (
AddWithValue}}( 4
(}}4 5
$str}}5 E
,}}E F
analysesHash}}G S
)}}S T
;}}T U
deleteCompareRun~~ 
.~~ 
ExecuteNonQuery~~ ,
(~~, -
)~~- .
;~~. /
using
ÄÄ 
var
ÄÄ 
truncateRunsTable
ÄÄ '
=
ÄÄ( )
new
ÄÄ* -
SqliteCommand
ÄÄ. ;
(
ÄÄ; <&
SQL_TRUNCATE_COMPARE_RUN
ÄÄ< T
,
ÄÄT U
MainConnection
ÄÄV d
.
ÄÄd e

Connection
ÄÄe o
,
ÄÄo p
MainConnection
ÄÄq 
.ÄÄ Ä
TransactionÄÄÄ ã
)ÄÄã å
;ÄÄå ç
truncateRunsTable
ÅÅ 
.
ÅÅ 

Parameters
ÅÅ (
.
ÅÅ( )
AddWithValue
ÅÅ) 5
(
ÅÅ5 6
$str
ÅÅ6 E
,
ÅÅE F

firstRunId
ÅÅG Q
)
ÅÅQ R
;
ÅÅR S
truncateRunsTable
ÇÇ 
.
ÇÇ 

Parameters
ÇÇ (
.
ÇÇ( )
AddWithValue
ÇÇ) 5
(
ÇÇ5 6
$str
ÇÇ6 F
,
ÇÇF G
secondRunId
ÇÇH S
)
ÇÇS T
;
ÇÇT U
truncateRunsTable
ÉÉ 
.
ÉÉ 

Parameters
ÉÉ (
.
ÉÉ( )
AddWithValue
ÉÉ) 5
(
ÉÉ5 6
$str
ÉÉ6 F
,
ÉÉF G
analysesHash
ÉÉH T
)
ÉÉT U
;
ÉÉU V
truncateRunsTable
ÖÖ 
.
ÖÖ 
ExecuteNonQuery
ÖÖ -
(
ÖÖ- .
)
ÖÖ. /
;
ÖÖ/ 0
}
ÜÜ 	
public
ââ 
override
ââ 
void
ââ 
Destroy
ââ $
(
ââ$ %
)
ââ% &
{
ää 	
Connections
ãã 
.
ãã 

AsParallel
ãã "
(
ãã" #
)
ãã# $
.
ãã$ %
ForAll
ãã% +
(
ãã+ ,
x
ãã, -
=>
ãã. 0
x
ãã1 2
.
ãã2 3
Destroy
ãã3 :
(
ãã: ;
)
ãã; <
)
ãã< =
;
ãã= >
Connections
åå 
.
åå 
	RemoveAll
åå !
(
åå! "
x
åå" #
=>
åå$ &
true
åå' +
)
åå+ ,
;
åå, -
}
çç 	
public
èè 
bool
èè %
EstablishMainConnection
èè +
(
èè+ ,
)
èè, -
{
êê 	
if
ëë 
(
ëë 
Connections
ëë 
.
ëë 
Count
ëë !
>
ëë" #
$num
ëë$ %
)
ëë% &
{
íí 
return
ìì 
false
ìì 
;
ìì 
}
îî 
else
ïï 
{
ññ 
Connections
óó 
.
óó 
Add
óó 
(
óó  #
GenerateSqlConnection
óó  5
(
óó5 6
$num
óó6 7
)
óó7 8
)
óó8 9
;
óó9 :
return
òò 
true
òò 
;
òò 
}
ôô 
}
öö 	
public
úú 
override
úú 
IEnumerable
úú #
<
úú# $
WriteObject
úú$ /
>
úú/ 0
GetAllMissing
úú1 >
(
úú> ?
string
úú? E
?
úúE F

firstRunId
úúG Q
,
úúQ R
string
úúS Y
secondRunId
úúZ e
)
úúe f
{
ùù 	
var
ûû 
output
ûû 
=
ûû 
new
ûû 
ConcurrentQueue
ûû ,
<
ûû, -
WriteObject
ûû- 8
>
ûû8 9
(
ûû9 :
)
ûû: ;
;
ûû; <
Connections
†† 
.
†† 

AsParallel
†† "
(
††" #
)
††# $
.
††$ %
ForAll
††% +
(
††+ ,
cxn
††, /
=>
††0 2
{
°° 
if
¢¢ 
(
¢¢ 
string
¢¢ 
.
¢¢ 
IsNullOrEmpty
¢¢ (
(
¢¢( )

firstRunId
¢¢) 3
)
¢¢3 4
)
¢¢4 5
{
££ 
var
§§ 
res
§§ 
=
§§ 
GetResultsByRunid
§§ /
(
§§/ 0
secondRunId
§§0 ;
)
§§; <
;
§§< =
foreach
•• 
(
•• 
var
••  
result
••! '
in
••( *
res
••+ .
)
••. /
{
¶¶ 
output
ßß 
.
ßß 
Enqueue
ßß &
(
ßß& '
result
ßß' -
)
ßß- .
;
ßß. /
}
®® 
}
©© 
else
™™ 
{
´´ 
using
¨¨ 
var
¨¨ 
cmd
¨¨ !
=
¨¨" #
new
¨¨$ '
SqliteCommand
¨¨( 5
(
¨¨5 6)
SQL_GET_UNIQUE_BETWEEN_RUNS
¨¨6 Q
,
¨¨Q R
cxn
¨¨S V
.
¨¨V W

Connection
¨¨W a
,
¨¨a b
cxn
¨¨c f
.
¨¨f g
Transaction
¨¨g r
)
¨¨r s
;
¨¨s t
cmd
≠≠ 
.
≠≠ 

Parameters
≠≠ "
.
≠≠" #
AddWithValue
≠≠# /
(
≠≠/ 0
$str
≠≠0 ?
,
≠≠? @

firstRunId
≠≠A K
)
≠≠K L
;
≠≠L M
cmd
ÆÆ 
.
ÆÆ 

Parameters
ÆÆ "
.
ÆÆ" #
AddWithValue
ÆÆ# /
(
ÆÆ/ 0
$str
ÆÆ0 @
,
ÆÆ@ A
secondRunId
ÆÆB M
)
ÆÆM N
;
ÆÆN O
using
ØØ 
(
ØØ 
var
ØØ 
reader
ØØ %
=
ØØ& '
cmd
ØØ( +
.
ØØ+ ,
ExecuteReader
ØØ, 9
(
ØØ9 :
)
ØØ: ;
)
ØØ; <
{
∞∞ 
while
±± 
(
±± 
reader
±± %
.
±±% &
Read
±±& *
(
±±* +
)
±±+ ,
)
±±, -
{
≤≤ 
var
≥≥ 
runId
≥≥  %
=
≥≥& '
reader
≥≥( .
[
≥≥. /
$str
≥≥/ 7
]
≥≥7 8
.
≥≥8 9
ToString
≥≥9 A
(
≥≥A B
)
≥≥B C
;
≥≥C D
var
¥¥ 
resultTypeString
¥¥  0
=
¥¥1 2
reader
¥¥3 9
[
¥¥9 :
$str
¥¥: G
]
¥¥G H
.
¥¥H I
ToString
¥¥I Q
(
¥¥Q R
)
¥¥R S
;
¥¥S T
if
µµ 
(
µµ  
runId
µµ  %
!=
µµ& (
null
µµ) -
&&
µµ. 0
resultTypeString
µµ1 A
!=
µµB D
null
µµE I
)
µµI J
{
∂∂ 
var
∑∑  #
wo
∑∑$ &
=
∑∑' (
WriteObject
∑∑) 4
.
∑∑4 5

FromString
∑∑5 ?
(
∑∑? @
(
∑∑@ A
string
∑∑A G
)
∑∑G H
reader
∑∑H N
[
∑∑N O
$str
∑∑O [
]
∑∑[ \
,
∑∑\ ]
(
∑∑^ _
RESULT_TYPE
∑∑_ j
)
∑∑j k
Enum
∑∑k o
.
∑∑o p
Parse
∑∑p u
(
∑∑u v
typeof
∑∑v |
(
∑∑| }
RESULT_TYPE∑∑} à
)∑∑à â
,∑∑â ä 
resultTypeString∑∑ã õ
)∑∑õ ú
,∑∑ú ù
runId∑∑û £
)∑∑£ §
;∑∑§ •
if
∏∏  "
(
∏∏# $
wo
∏∏$ &
is
∏∏' )
WriteObject
∏∏* 5
WO
∏∏6 8
)
∏∏8 9
output
ππ$ *
.
ππ* +
Enqueue
ππ+ 2
(
ππ2 3
WO
ππ3 5
)
ππ5 6
;
ππ6 7
}
∫∫ 
}
ªª 
}
ºº 
}
ΩΩ 
}
ææ 
)
ææ 
;
ææ 
return
¿¿ 
output
¿¿ 
;
¿¿ 
}
¡¡ 	
public
√√ 
IEnumerable
√√ 
<
√√ 
WriteObject
√√ &
>
√√& '
GetAllMissing2
√√( 6
(
√√6 7
string
√√7 =

firstRunId
√√> H
,
√√H I
string
√√J P
secondRunId
√√Q \
)
√√\ ]
{
ƒƒ 	
string
≈≈ 
SQL_GROUPED
≈≈ 
=
≈≈  
$str≈≈! ù
;≈≈ù û
var
∆∆ 
output
∆∆ 
=
∆∆ 
new
∆∆ 
ConcurrentQueue
∆∆ ,
<
∆∆, -
WriteObject
∆∆- 8
>
∆∆8 9
(
∆∆9 :
)
∆∆: ;
;
∆∆; <
Connections
»» 
.
»» 

AsParallel
»» "
(
»»" #
)
»»# $
.
»»$ %
ForAll
»»% +
(
»»+ ,
cxn
»», /
=>
»»0 2
{
…… 
using
   
var
   
cmd
   
=
   
new
    #
SqliteCommand
  $ 1
(
  1 2
SQL_GROUPED
  2 =
,
  = >
cxn
  ? B
.
  B C

Connection
  C M
,
  M N
cxn
  O R
.
  R S
Transaction
  S ^
)
  ^ _
;
  _ `
cmd
ÀÀ 
.
ÀÀ 

Parameters
ÀÀ 
.
ÀÀ 
AddWithValue
ÀÀ +
(
ÀÀ+ ,
$str
ÀÀ, ;
,
ÀÀ; <

firstRunId
ÀÀ= G
)
ÀÀG H
;
ÀÀH I
cmd
ÃÃ 
.
ÃÃ 

Parameters
ÃÃ 
.
ÃÃ 
AddWithValue
ÃÃ +
(
ÃÃ+ ,
$str
ÃÃ, <
,
ÃÃ< =
secondRunId
ÃÃ> I
)
ÃÃI J
;
ÃÃJ K
using
ÕÕ 
(
ÕÕ 
var
ÕÕ 
reader
ÕÕ !
=
ÕÕ" #
cmd
ÕÕ$ '
.
ÕÕ' (
ExecuteReader
ÕÕ( 5
(
ÕÕ5 6
)
ÕÕ6 7
)
ÕÕ7 8
{
ŒŒ 
while
œœ 
(
œœ 
reader
œœ !
.
œœ! "
Read
œœ" &
(
œœ& '
)
œœ' (
)
œœ( )
{
–– 
var
—— 
runId
—— !
=
——" #
reader
——$ *
[
——* +
$str
——+ 3
]
——3 4
.
——4 5
ToString
——5 =
(
——= >
)
——> ?
;
——? @
var
““ 
resultTypeString
““ ,
=
““- .
reader
““/ 5
[
““5 6
$str
““6 C
]
““C D
.
““D E
ToString
““E M
(
““M N
)
““N O
;
““O P
if
”” 
(
”” 
runId
”” !
!=
””" $
null
””% )
&&
””* ,
resultTypeString
””- =
!=
””> @
null
””A E
)
””E F
{
‘‘ 
var
’’ 
wo
’’  "
=
’’# $
WriteObject
’’% 0
.
’’0 1

FromString
’’1 ;
(
’’; <
(
’’< =
string
’’= C
)
’’C D
reader
’’D J
[
’’J K
$str
’’K W
]
’’W X
,
’’X Y
(
’’Z [
RESULT_TYPE
’’[ f
)
’’f g
Enum
’’g k
.
’’k l
Parse
’’l q
(
’’q r
typeof
’’r x
(
’’x y
RESULT_TYPE’’y Ñ
)’’Ñ Ö
,’’Ö Ü 
resultTypeString’’á ó
)’’ó ò
,’’ò ô
runId’’ö ü
)’’ü †
;’’† °
if
÷÷ 
(
÷÷  
wo
÷÷  "
is
÷÷# %
WriteObject
÷÷& 1
WO
÷÷2 4
)
÷÷4 5
output
◊◊  &
.
◊◊& '
Enqueue
◊◊' .
(
◊◊. /
WO
◊◊/ 1
)
◊◊1 2
;
◊◊2 3
}
ÿÿ 
}
ŸŸ 
}
⁄⁄ 
}
€€ 
)
€€ 
;
€€ 
return
›› 
output
›› 
;
›› 
}
ﬁﬁ 	
public
‡‡ 
IEnumerable
‡‡ 
<
‡‡ 
WriteObject
‡‡ &
>
‡‡& '#
GetAllMissingExplicit
‡‡( =
(
‡‡= >
string
‡‡> D

firstRunId
‡‡E O
,
‡‡O P
string
‡‡Q W
secondRunId
‡‡X c
)
‡‡c d
{
·· 	
var
‚‚ 
output
‚‚ 
=
‚‚ 
new
‚‚ 
ConcurrentQueue
‚‚ ,
<
‚‚, -
WriteObject
‚‚- 8
>
‚‚8 9
(
‚‚9 :
)
‚‚: ;
;
‚‚; <
Connections
‰‰ 
.
‰‰ 

AsParallel
‰‰ "
(
‰‰" #
)
‰‰# $
.
‰‰$ %
ForAll
‰‰% +
(
‰‰+ ,
cxn
‰‰, /
=>
‰‰0 2
{
ÂÂ 
using
ÊÊ 
var
ÊÊ 
cmd
ÊÊ 
=
ÊÊ 
new
ÊÊ  #
SqliteCommand
ÊÊ$ 1
(
ÊÊ1 22
$SQL_GET_UNIQUE_BETWEEN_RUNS_EXPLICIT
ÊÊ2 V
,
ÊÊV W
cxn
ÊÊX [
.
ÊÊ[ \

Connection
ÊÊ\ f
,
ÊÊf g
cxn
ÊÊh k
.
ÊÊk l
Transaction
ÊÊl w
)
ÊÊw x
;
ÊÊx y
cmd
ÁÁ 
.
ÁÁ 

Parameters
ÁÁ 
.
ÁÁ 
AddWithValue
ÁÁ +
(
ÁÁ+ ,
$str
ÁÁ, ;
,
ÁÁ; <

firstRunId
ÁÁ= G
)
ÁÁG H
;
ÁÁH I
cmd
ËË 
.
ËË 

Parameters
ËË 
.
ËË 
AddWithValue
ËË +
(
ËË+ ,
$str
ËË, <
,
ËË< =
secondRunId
ËË> I
)
ËËI J
;
ËËJ K
using
ÈÈ 
(
ÈÈ 
var
ÈÈ 
reader
ÈÈ !
=
ÈÈ" #
cmd
ÈÈ$ '
.
ÈÈ' (
ExecuteReader
ÈÈ( 5
(
ÈÈ5 6
)
ÈÈ6 7
)
ÈÈ7 8
{
ÍÍ 
while
ÎÎ 
(
ÎÎ 
reader
ÎÎ !
.
ÎÎ! "
Read
ÎÎ" &
(
ÎÎ& '
)
ÎÎ' (
)
ÎÎ( )
{
ÏÏ 
var
ÌÌ 
runId
ÌÌ !
=
ÌÌ" #
reader
ÌÌ$ *
[
ÌÌ* +
$str
ÌÌ+ 3
]
ÌÌ3 4
.
ÌÌ4 5
ToString
ÌÌ5 =
(
ÌÌ= >
)
ÌÌ> ?
;
ÌÌ? @
var
ÓÓ 
resultTypeString
ÓÓ ,
=
ÓÓ- .
reader
ÓÓ/ 5
[
ÓÓ5 6
$str
ÓÓ6 C
]
ÓÓC D
.
ÓÓD E
ToString
ÓÓE M
(
ÓÓM N
)
ÓÓN O
;
ÓÓO P
if
ÔÔ 
(
ÔÔ 
runId
ÔÔ !
!=
ÔÔ" $
null
ÔÔ% )
&&
ÔÔ* ,
resultTypeString
ÔÔ- =
!=
ÔÔ> @
null
ÔÔA E
)
ÔÔE F
{
 
var
ÒÒ 
wo
ÒÒ  "
=
ÒÒ# $
WriteObject
ÒÒ% 0
.
ÒÒ0 1

FromString
ÒÒ1 ;
(
ÒÒ; <
(
ÒÒ< =
string
ÒÒ= C
)
ÒÒC D
reader
ÒÒD J
[
ÒÒJ K
$str
ÒÒK W
]
ÒÒW X
,
ÒÒX Y
(
ÒÒZ [
RESULT_TYPE
ÒÒ[ f
)
ÒÒf g
Enum
ÒÒg k
.
ÒÒk l
Parse
ÒÒl q
(
ÒÒq r
typeof
ÒÒr x
(
ÒÒx y
RESULT_TYPEÒÒy Ñ
)ÒÒÑ Ö
,ÒÒÖ Ü 
resultTypeStringÒÒá ó
)ÒÒó ò
,ÒÒò ô
runIdÒÒö ü
)ÒÒü †
;ÒÒ† °
if
ÚÚ 
(
ÚÚ  
wo
ÚÚ  "
is
ÚÚ# %
WriteObject
ÚÚ& 1
WO
ÚÚ2 4
)
ÚÚ4 5
output
ÛÛ  &
.
ÛÛ& '
Enqueue
ÛÛ' .
(
ÛÛ. /
WO
ÛÛ/ 1
)
ÛÛ1 2
;
ÛÛ2 3
}
ÙÙ 
}
ıı 
}
ˆˆ 
}
˜˜ 
)
˜˜ 
;
˜˜ 
return
˘˘ 
output
˘˘ 
;
˘˘ 
}
˙˙ 	
public
¸¸ 
override
¸¸ 
bool
¸¸ $
GetComparisonCompleted
¸¸ 3
(
¸¸3 4
string
¸¸4 :
?
¸¸: ;

firstRunId
¸¸< F
,
¸¸F G
string
¸¸H N
secondRunId
¸¸O Z
,
¸¸Z [
string
¸¸\ b
analysesHash
¸¸c o
)
¸¸o p
{
˝˝ 	
if
˛˛ 
(
˛˛ 
MainConnection
˛˛ 
!=
˛˛ !
null
˛˛" &
)
˛˛& '
{
ˇˇ 
using
ÄÄ 
(
ÄÄ 
var
ÄÄ 
cmd
ÄÄ 
=
ÄÄ  
new
ÄÄ! $
SqliteCommand
ÄÄ% 2
(
ÄÄ2 3:
,SQL_CHECK_IF_COMPARISON_PREVIOUSLY_COMPLETED
ÄÄ3 _
,
ÄÄ_ `
MainConnection
ÄÄa o
.
ÄÄo p

Connection
ÄÄp z
,
ÄÄz {
MainConnectionÄÄ| ä
.ÄÄä ã
TransactionÄÄã ñ
)ÄÄñ ó
)ÄÄó ò
{
ÅÅ 
cmd
ÇÇ 
.
ÇÇ 

Parameters
ÇÇ "
.
ÇÇ" #
AddWithValue
ÇÇ# /
(
ÇÇ/ 0
$str
ÇÇ0 >
,
ÇÇ> ?

firstRunId
ÇÇ@ J
??
ÇÇK M
string
ÇÇN T
.
ÇÇT U
Empty
ÇÇU Z
)
ÇÇZ [
;
ÇÇ[ \
cmd
ÉÉ 
.
ÉÉ 

Parameters
ÉÉ "
.
ÉÉ" #
AddWithValue
ÉÉ# /
(
ÉÉ/ 0
$str
ÉÉ0 A
,
ÉÉA B
secondRunId
ÉÉC N
)
ÉÉN O
;
ÉÉO P
cmd
ÑÑ 
.
ÑÑ 

Parameters
ÑÑ "
.
ÑÑ" #
AddWithValue
ÑÑ# /
(
ÑÑ/ 0
$str
ÑÑ0 @
,
ÑÑ@ A
analysesHash
ÑÑB N
)
ÑÑN O
;
ÑÑO P
using
ÖÖ 
(
ÖÖ 
var
ÖÖ 
reader
ÖÖ %
=
ÖÖ& '
cmd
ÖÖ( +
.
ÖÖ+ ,
ExecuteReader
ÖÖ, 9
(
ÖÖ9 :
)
ÖÖ: ;
)
ÖÖ; <
{
ÜÜ 
while
áá 
(
áá 
reader
áá %
.
áá% &
Read
áá& *
(
áá* +
)
áá+ ,
)
áá, -
{
àà 
return
ââ "
true
ââ# '
;
ââ' (
}
ää 
}
ãã 
}
åå 
}
çç 
else
éé 
{
èè 
Log
êê 
.
êê 
Debug
êê 
(
êê 
$str
êê \
)
êê\ ]
;
êê] ^
}
ëë 
return
ìì 
false
ìì 
;
ìì 
}
îî 	
public
ññ 
override
ññ 
List
ññ 
<
ññ 
CompareResult
ññ *
>
ññ* +"
GetComparisonResults
ññ, @
(
ññ@ A
string
ññA G
?
ññG H
baseId
ññI O
,
ññO P
string
ññQ W
	compareId
ññX a
,
ñña b
string
ññc i
analysesHash
ññj v
,
ññv w
RESULT_TYPEññx É

exportTypeññÑ é
)ññé è
{
óó 	
List
òò 
<
òò 
CompareResult
òò 
>
òò 
records
òò  '
=
òò( )
new
òò* -
List
òò. 2
<
òò2 3
CompareResult
òò3 @
>
òò@ A
(
òòA B
)
òòB C
;
òòC D
if
ôô 
(
ôô 
MainConnection
ôô 
!=
ôô !
null
ôô" &
)
ôô& '
{
öö 
using
õõ 
(
õõ 
var
õõ 
cmd
õõ 
=
õõ  
new
õõ! $
SqliteCommand
õõ% 2
(
õõ2 3$
GET_COMPARISON_RESULTS
õõ3 I
,
õõI J
MainConnection
õõK Y
.
õõY Z

Connection
õõZ d
,
õõd e
MainConnection
õõf t
.
õõt u
Transactionõõu Ä
)õõÄ Å
)õõÅ Ç
{
úú 
cmd
ùù 
.
ùù 

Parameters
ùù "
.
ùù" #
AddWithValue
ùù# /
(
ùù/ 0
$str
ùù0 ?
,
ùù? @
baseId
ùùA G
??
ùùH J
string
ùùK Q
.
ùùQ R
Empty
ùùR W
)
ùùW X
;
ùùX Y
cmd
ûû 
.
ûû 

Parameters
ûû "
.
ûû" #
AddWithValue
ûû# /
(
ûû/ 0
$str
ûû0 @
,
ûû@ A
	compareId
ûûB K
)
ûûK L
;
ûûL M
cmd
üü 
.
üü 

Parameters
üü "
.
üü" #
AddWithValue
üü# /
(
üü/ 0
$str
üü0 @
,
üü@ A
analysesHash
üüB N
)
üüN O
;
üüO P
cmd
†† 
.
†† 

Parameters
†† "
.
††" #
AddWithValue
††# /
(
††/ 0
$str
††0 >
,
††> ?

exportType
††@ J
)
††J K
;
††K L
using
°° 
(
°° 
var
°° 
reader
°° %
=
°°& '
cmd
°°( +
.
°°+ ,
ExecuteReader
°°, 9
(
°°9 :
)
°°: ;
)
°°; <
{
¢¢ 
while
££ 
(
££ 
reader
££ %
.
££% &
Read
££& *
(
££* +
)
££+ ,
)
££, -
{
§§ 
if
•• 
(
••  
reader
••  &
[
••& '
$str
••' 3
]
••3 4
.
••4 5
ToString
••5 =
(
••= >
)
••> ?
is
••@ B
string
••C I

serialized
••J T
)
••T U
records
¶¶  '
.
¶¶' (
Add
¶¶( +
(
¶¶+ ,
JsonConvert
¶¶, 7
.
¶¶7 8
DeserializeObject
¶¶8 I
<
¶¶I J
CompareResult
¶¶J W
>
¶¶W X
(
¶¶X Y

serialized
¶¶Y c
)
¶¶c d
)
¶¶d e
;
¶¶e f
}
ßß 
}
®® 
}
©© 
}
™™ 
return
´´ 
records
´´ 
;
´´ 
}
¨¨ 	
public
ÆÆ 
override
ÆÆ 
List
ÆÆ 
<
ÆÆ 
CompareResult
ÆÆ *
>
ÆÆ* +"
GetComparisonResults
ÆÆ, @
(
ÆÆ@ A
string
ÆÆA G
?
ÆÆG H
baseId
ÆÆI O
,
ÆÆO P
string
ÆÆQ W
?
ÆÆW X
	compareId
ÆÆY b
,
ÆÆb c
string
ÆÆd j
analysesHash
ÆÆk w
,
ÆÆw x
RESULT_TYPEÆÆy Ñ

resultTypeÆÆÖ è
,ÆÆè ê
intÆÆë î
offsetÆÆï õ
,ÆÆõ ú
intÆÆù †

numResultsÆÆ° ´
)ÆÆ´ ¨
{
ØØ 	
_
∞∞ 
=
∞∞ 
MainConnection
∞∞ 
??
∞∞ !
throw
∞∞" '
new
∞∞( +$
NullReferenceException
∞∞, B
(
∞∞B C
Strings
∞∞C J
.
∞∞J K
Get
∞∞K N
(
∞∞N O
$str
∞∞O _
)
∞∞_ `
)
∞∞` a
;
∞∞a b
var
±± 
results
±± 
=
±± 
new
±± 
List
±± "
<
±±" #
CompareResult
±±# 0
>
±±0 1
(
±±1 2
)
±±2 3
;
±±3 4
using
≤≤ 
(
≤≤ 
var
≤≤ 
cmd
≤≤ 
=
≤≤ 
new
≤≤  
SqliteCommand
≤≤! .
(
≤≤. /*
GET_COMPARISON_RESULTS_LIMIT
≤≤/ K
,
≤≤K L
MainConnection
≤≤M [
.
≤≤[ \

Connection
≤≤\ f
,
≤≤f g
MainConnection
≤≤h v
.
≤≤v w
Transaction≤≤w Ç
)≤≤Ç É
)≤≤É Ñ
{
≥≥ 
cmd
¥¥ 
.
¥¥ 

Parameters
¥¥ 
.
¥¥ 
AddWithValue
¥¥ +
(
¥¥+ ,
$str
¥¥, ;
,
¥¥; <
baseId
¥¥= C
??
¥¥D F
string
¥¥G M
.
¥¥M N
Empty
¥¥N S
)
¥¥S T
;
¥¥T U
cmd
µµ 
.
µµ 

Parameters
µµ 
.
µµ 
AddWithValue
µµ +
(
µµ+ ,
$str
µµ, <
,
µµ< =
	compareId
µµ> G
??
µµH J
string
µµK Q
.
µµQ R
Empty
µµR W
)
µµW X
;
µµX Y
cmd
∂∂ 
.
∂∂ 

Parameters
∂∂ 
.
∂∂ 
AddWithValue
∂∂ +
(
∂∂+ ,
$str
∂∂, <
,
∂∂< =
analysesHash
∂∂> J
)
∂∂J K
;
∂∂K L
cmd
∑∑ 
.
∑∑ 

Parameters
∑∑ 
.
∑∑ 
AddWithValue
∑∑ +
(
∑∑+ ,
$str
∑∑, :
,
∑∑: ;
(
∑∑< =
int
∑∑= @
)
∑∑@ A

resultType
∑∑A K
)
∑∑K L
;
∑∑L M
cmd
∏∏ 
.
∏∏ 

Parameters
∏∏ 
.
∏∏ 
AddWithValue
∏∏ +
(
∏∏+ ,
$str
∏∏, 5
,
∏∏5 6
offset
∏∏7 =
)
∏∏= >
;
∏∏> ?
cmd
ππ 
.
ππ 

Parameters
ππ 
.
ππ 
AddWithValue
ππ +
(
ππ+ ,
$str
ππ, 4
,
ππ4 5

numResults
ππ6 @
)
ππ@ A
;
ππA B
using
∫∫ 
(
∫∫ 
var
∫∫ 
reader
∫∫ !
=
∫∫" #
cmd
∫∫$ '
.
∫∫' (
ExecuteReader
∫∫( 5
(
∫∫5 6
)
∫∫6 7
)
∫∫7 8
{
ªª 
while
ºº 
(
ºº 
reader
ºº !
.
ºº! "
Read
ºº" &
(
ºº& '
)
ºº' (
)
ºº( )
{
ΩΩ 
if
ææ 
(
ææ 
reader
ææ "
[
ææ" #
$str
ææ# 4
]
ææ4 5
is
ææ6 8
string
ææ9 ?
meta_serialized
ææ@ O
)
ææO P
{
øø 
CompareResult
¿¿ )
obj
¿¿* -
=
¿¿. /
JsonConvert
¿¿0 ;
.
¿¿; <
DeserializeObject
¿¿< M
<
¿¿M N
CompareResult
¿¿N [
>
¿¿[ \
(
¿¿\ ]
meta_serialized
¿¿] l
)
¿¿l m
;
¿¿m n
if
¬¬ 
(
¬¬  
reader
¬¬  &
[
¬¬& '
$str
¬¬' 9
]
¬¬9 :
is
¬¬; =
string
¬¬> D
first_serialized
¬¬E U
)
¬¬U V
{
√√ 
obj
ƒƒ  #
.
ƒƒ# $
Base
ƒƒ$ (
=
ƒƒ) *
	JsonUtils
ƒƒ+ 4
.
ƒƒ4 5
Hydrate
ƒƒ5 <
(
ƒƒ< =
first_serialized
ƒƒ= M
,
ƒƒM N
(
ƒƒO P
RESULT_TYPE
ƒƒP [
)
ƒƒ[ \

resultType
ƒƒ\ f
)
ƒƒf g
;
ƒƒg h
}
≈≈ 
if
∆∆ 
(
∆∆  
reader
∆∆  &
[
∆∆& '
$str
∆∆' :
]
∆∆: ;
is
∆∆< >
string
∆∆? E
second_serialized
∆∆F W
)
∆∆W X
{
«« 
obj
»»  #
.
»»# $
Compare
»»$ +
=
»», -
	JsonUtils
»». 7
.
»»7 8
Hydrate
»»8 ?
(
»»? @
second_serialized
»»@ Q
,
»»Q R
(
»»S T
RESULT_TYPE
»»T _
)
»»_ `

resultType
»»` j
)
»»j k
;
»»k l
}
…… 
results
ÀÀ #
.
ÀÀ# $
Add
ÀÀ$ '
(
ÀÀ' (
obj
ÀÀ( +
)
ÀÀ+ ,
;
ÀÀ, -
}
ÃÃ 
}
ÕÕ 
}
ŒŒ 
}
œœ 
return
—— 
results
—— 
;
—— 
}
““ 	
public
‘‘ 
override
‘‘ 
int
‘‘ '
GetComparisonResultsCount
‘‘ 5
(
‘‘5 6
string
‘‘6 <
?
‘‘< =
baseId
‘‘> D
,
‘‘D E
string
‘‘F L
	compareId
‘‘M V
,
‘‘V W
string
‘‘X ^
analysesHash
‘‘_ k
,
‘‘k l
int
‘‘m p

resultType
‘‘q {
)
‘‘{ |
{
’’ 	
_
÷÷ 
=
÷÷ 
MainConnection
÷÷ 
??
÷÷ !
throw
÷÷" '
new
÷÷( +$
NullReferenceException
÷÷, B
(
÷÷B C
Strings
÷÷C J
.
÷÷J K
Get
÷÷K N
(
÷÷N O
$str
÷÷O _
)
÷÷_ `
)
÷÷` a
;
÷÷a b
var
◊◊ 
result_count
◊◊ 
=
◊◊ 
$num
◊◊  
;
◊◊  !
using
ÿÿ 
(
ÿÿ 
var
ÿÿ 
cmd
ÿÿ 
=
ÿÿ 
new
ÿÿ  
SqliteCommand
ÿÿ! .
(
ÿÿ. /
GET_RESULT_COUNT
ÿÿ/ ?
,
ÿÿ? @
MainConnection
ÿÿA O
.
ÿÿO P

Connection
ÿÿP Z
,
ÿÿZ [
MainConnection
ÿÿ\ j
.
ÿÿj k
Transaction
ÿÿk v
)
ÿÿv w
)
ÿÿw x
{
ŸŸ 
cmd
⁄⁄ 
.
⁄⁄ 

Parameters
⁄⁄ 
.
⁄⁄ 
AddWithValue
⁄⁄ +
(
⁄⁄+ ,
$str
⁄⁄, ;
,
⁄⁄; <
baseId
⁄⁄= C
??
⁄⁄D F
string
⁄⁄G M
.
⁄⁄M N
Empty
⁄⁄N S
)
⁄⁄S T
;
⁄⁄T U
cmd
€€ 
.
€€ 

Parameters
€€ 
.
€€ 
AddWithValue
€€ +
(
€€+ ,
$str
€€, <
,
€€< =
	compareId
€€> G
)
€€G H
;
€€H I
cmd
‹‹ 
.
‹‹ 

Parameters
‹‹ 
.
‹‹ 
AddWithValue
‹‹ +
(
‹‹+ ,
$str
‹‹, <
,
‹‹< =
analysesHash
‹‹> J
)
‹‹J K
;
‹‹K L
cmd
›› 
.
›› 

Parameters
›› 
.
›› 
AddWithValue
›› +
(
››+ ,
$str
››, :
,
››: ;

resultType
››< F
)
››F G
;
››G H
using
ﬁﬁ 
(
ﬁﬁ 
var
ﬁﬁ 
reader
ﬁﬁ !
=
ﬁﬁ" #
cmd
ﬁﬁ$ '
.
ﬁﬁ' (
ExecuteReader
ﬁﬁ( 5
(
ﬁﬁ5 6
)
ﬁﬁ6 7
)
ﬁﬁ7 8
{
ﬂﬂ 
while
‡‡ 
(
‡‡ 
reader
‡‡ !
.
‡‡! "
Read
‡‡" &
(
‡‡& '
)
‡‡' (
)
‡‡( )
{
·· 
if
‚‚ 
(
‚‚ 
reader
‚‚ "
[
‚‚" #
$str
‚‚# -
]
‚‚- .
.
‚‚. /
ToString
‚‚/ 7
(
‚‚7 8
)
‚‚8 9
is
‚‚: <
string
‚‚= C
integer
‚‚D K
)
‚‚K L
result_count
„„ (
=
„„) *
int
„„+ .
.
„„. /
Parse
„„/ 4
(
„„4 5
integer
„„5 <
,
„„< =
CultureInfo
„„> I
.
„„I J
InvariantCulture
„„J Z
)
„„Z [
;
„„[ \
}
‰‰ 
}
ÂÂ 
}
ÊÊ 
return
ÁÁ 
result_count
ÁÁ 
;
ÁÁ  
}
ËË 	
public
ÍÍ 
override
ÍÍ 

DBSettings
ÍÍ " 
GetCurrentSettings
ÍÍ# 5
(
ÍÍ5 6
)
ÍÍ6 7
{
ÎÎ 	
return
ÏÏ 

dbSettings
ÏÏ 
;
ÏÏ 
}
ÌÌ 	
public
ÔÔ 
override
ÔÔ 
List
ÔÔ 
<
ÔÔ 
string
ÔÔ #
>
ÔÔ# $
GetLatestRunIds
ÔÔ% 4
(
ÔÔ4 5
int
ÔÔ5 8
numberOfIds
ÔÔ9 D
,
ÔÔD E
RUN_TYPE
ÔÔF N
type
ÔÔO S
)
ÔÔS T
{
 	
List
ÒÒ 
<
ÒÒ 
string
ÒÒ 
>
ÒÒ 
output
ÒÒ 
=
ÒÒ  !
new
ÒÒ" %
List
ÒÒ& *
<
ÒÒ* +
string
ÒÒ+ 1
>
ÒÒ1 2
(
ÒÒ2 3
)
ÒÒ3 4
;
ÒÒ4 5
if
ÚÚ 
(
ÚÚ 
MainConnection
ÚÚ 
!=
ÚÚ !
null
ÚÚ" &
)
ÚÚ& '
{
ÛÛ 
using
ÙÙ 
(
ÙÙ 
var
ÙÙ 
cmd
ÙÙ 
=
ÙÙ  
new
ÙÙ! $
SqliteCommand
ÙÙ% 2
(
ÙÙ2 3&
SQL_SELECT_LATEST_N_RUNS
ÙÙ3 K
,
ÙÙK L
MainConnection
ÙÙM [
.
ÙÙ[ \

Connection
ÙÙ\ f
,
ÙÙf g
MainConnection
ÙÙh v
.
ÙÙv w
TransactionÙÙw Ç
)ÙÙÇ É
)ÙÙÉ Ñ
{
ıı 
cmd
ˆˆ 
.
ˆˆ 

Parameters
ˆˆ "
.
ˆˆ" #
AddWithValue
ˆˆ# /
(
ˆˆ/ 0
$str
ˆˆ0 7
,
ˆˆ7 8
type
ˆˆ9 =
)
ˆˆ= >
;
ˆˆ> ?
cmd
˜˜ 
.
˜˜ 

Parameters
˜˜ "
.
˜˜" #
AddWithValue
˜˜# /
(
˜˜/ 0
$str
˜˜0 8
,
˜˜8 9
numberOfIds
˜˜: E
)
˜˜E F
;
˜˜F G
try
¯¯ 
{
˘˘ 
using
˙˙ 
(
˙˙ 
var
˙˙ "
reader
˙˙# )
=
˙˙* +
cmd
˙˙, /
.
˙˙/ 0
ExecuteReader
˙˙0 =
(
˙˙= >
)
˙˙> ?
)
˙˙? @
{
˚˚ 
while
¸¸ !
(
¸¸" #
reader
¸¸# )
.
¸¸) *
Read
¸¸* .
(
¸¸. /
)
¸¸/ 0
)
¸¸0 1
{
˝˝ 
var
˛˛  #
str
˛˛$ '
=
˛˛( )
reader
˛˛* 0
[
˛˛0 1
$str
˛˛1 9
]
˛˛9 :
.
˛˛: ;
ToString
˛˛; C
(
˛˛C D
)
˛˛D E
;
˛˛E F
if
ˇˇ  "
(
ˇˇ# $
!
ˇˇ$ %
string
ˇˇ% +
.
ˇˇ+ ,
IsNullOrEmpty
ˇˇ, 9
(
ˇˇ9 :
str
ˇˇ: =
)
ˇˇ= >
)
ˇˇ> ?
output
ÄÄ$ *
.
ÄÄ* +
Add
ÄÄ+ .
(
ÄÄ. /
str
ÄÄ/ 2
)
ÄÄ2 3
;
ÄÄ3 4
}
ÅÅ 
}
ÇÇ 
}
ÉÉ 
catch
ÑÑ 
(
ÑÑ 
SqliteException
ÑÑ *
)
ÑÑ* +
{
ÖÖ 
Log
ÜÜ 
.
ÜÜ 
Debug
ÜÜ !
(
ÜÜ! "
$str
ÜÜ" J
,
ÜÜJ K
numberOfIds
ÜÜL W
)
ÜÜW X
;
ÜÜX Y
}
áá 
}
àà 
}
ââ 
else
ää 
{
ãã 
Log
åå 
.
åå 
Debug
åå 
(
åå 
$str
åå U
)
ååU V
;
ååV W
}
çç 
return
éé 
output
éé 
;
éé 
}
èè 	
public
ëë 
override
ëë 
IEnumerable
ëë #
<
ëë# $
WriteObject
ëë$ /
>
ëë/ 0!
GetMissingFromFirst
ëë1 D
(
ëëD E
string
ëëE K

firstRunId
ëëL V
,
ëëV W
string
ëëX ^
secondRunId
ëë_ j
)
ëëj k
{
íí 	
var
ìì 
output
ìì 
=
ìì 
new
ìì 
ConcurrentQueue
ìì ,
<
ìì, -
WriteObject
ìì- 8
>
ìì8 9
(
ìì9 :
)
ìì: ;
;
ìì; <
Connections
ïï 
.
ïï 

AsParallel
ïï "
(
ïï" #
)
ïï# $
.
ïï$ %
ForAll
ïï% +
(
ïï+ ,
cxn
ïï, /
=>
ïï0 2
{
ññ 
using
óó 
var
óó 
cmd
óó 
=
óó 
new
óó  #
SqliteCommand
óó$ 1
(
óó1 2*
SQL_GET_COLLECT_MISSING_IN_B
óó2 N
,
óóN O
cxn
óóP S
.
óóS T

Connection
óóT ^
,
óó^ _
cxn
óó` c
.
óóc d
Transaction
óód o
)
óóo p
;
óóp q
cmd
òò 
.
òò 

Parameters
òò 
.
òò 
AddWithValue
òò +
(
òò+ ,
$str
òò, ;
,
òò; <

firstRunId
òò= G
)
òòG H
;
òòH I
cmd
ôô 
.
ôô 

Parameters
ôô 
.
ôô 
AddWithValue
ôô +
(
ôô+ ,
$str
ôô, <
,
ôô< =
secondRunId
ôô> I
)
ôôI J
;
ôôJ K
using
öö 
(
öö 
var
öö 
reader
öö !
=
öö" #
cmd
öö$ '
.
öö' (
ExecuteReader
öö( 5
(
öö5 6
)
öö6 7
)
öö7 8
{
õõ 
while
úú 
(
úú 
reader
úú !
.
úú! "
Read
úú" &
(
úú& '
)
úú' (
)
úú( )
{
ùù 
var
ûû 
runId
ûû !
=
ûû" #
reader
ûû$ *
[
ûû* +
$str
ûû+ 3
]
ûû3 4
.
ûû4 5
ToString
ûû5 =
(
ûû= >
)
ûû> ?
;
ûû? @
var
üü 
resultTypeString
üü ,
=
üü- .
reader
üü/ 5
[
üü5 6
$str
üü6 C
]
üüC D
.
üüD E
ToString
üüE M
(
üüM N
)
üüN O
;
üüO P
if
†† 
(
†† 
runId
†† !
!=
††" $
null
††% )
&&
††* ,
resultTypeString
††- =
!=
††> @
null
††A E
)
††E F
{
°° 
var
¢¢ 
wo
¢¢  "
=
¢¢# $
WriteObject
¢¢% 0
.
¢¢0 1

FromString
¢¢1 ;
(
¢¢; <
(
¢¢< =
string
¢¢= C
)
¢¢C D
reader
¢¢D J
[
¢¢J K
$str
¢¢K W
]
¢¢W X
,
¢¢X Y
(
¢¢Z [
RESULT_TYPE
¢¢[ f
)
¢¢f g
Enum
¢¢g k
.
¢¢k l
Parse
¢¢l q
(
¢¢q r
typeof
¢¢r x
(
¢¢x y
RESULT_TYPE¢¢y Ñ
)¢¢Ñ Ö
,¢¢Ö Ü 
resultTypeString¢¢á ó
)¢¢ó ò
,¢¢ò ô
runId¢¢ö ü
)¢¢ü †
;¢¢† °
if
££ 
(
££  
wo
££  "
is
££# %
WriteObject
££& 1
WO
££2 4
)
££4 5
output
§§  &
.
§§& '
Enqueue
§§' .
(
§§. /
WO
§§/ 1
)
§§1 2
;
§§2 3
}
•• 
}
¶¶ 
}
ßß 
}
®® 
)
®® 
;
®® 
return
™™ 
output
™™ 
;
™™ 
}
´´ 	
public
≠≠ 
override
≠≠ 
IEnumerable
≠≠ #
<
≠≠# $
(
≠≠$ %
WriteObject
≠≠% 0
,
≠≠0 1
WriteObject
≠≠2 =
)
≠≠= >
>
≠≠> ?
GetModified
≠≠@ K
(
≠≠K L
string
≠≠L R

firstRunId
≠≠S ]
,
≠≠] ^
string
≠≠_ e
secondRunId
≠≠f q
)
≠≠q r
{
ÆÆ 	
var
ØØ 
output
ØØ 
=
ØØ 
new
ØØ 
ConcurrentQueue
ØØ ,
<
ØØ, -
(
ØØ- .
WriteObject
ØØ. 9
,
ØØ9 :
WriteObject
ØØ; F
)
ØØF G
>
ØØG H
(
ØØH I
)
ØØI J
;
ØØJ K
Connections
±± 
.
±± 

AsParallel
±± "
(
±±" #
)
±±# $
.
±±$ %
ForAll
±±% +
(
±±+ ,
cxn
±±, /
=>
±±0 2
{
≤≤ 
using
≥≥ 
var
≥≥ 
cmd
≥≥ 
=
≥≥ 
new
≥≥  #
SqliteCommand
≥≥$ 1
(
≥≥1 2&
SQL_GET_COLLECT_MODIFIED
≥≥2 J
,
≥≥J K
cxn
≥≥L O
.
≥≥O P

Connection
≥≥P Z
,
≥≥Z [
cxn
≥≥\ _
.
≥≥_ `
Transaction
≥≥` k
)
≥≥k l
;
≥≥l m
cmd
¥¥ 
.
¥¥ 

Parameters
¥¥ 
.
¥¥ 
AddWithValue
¥¥ +
(
¥¥+ ,
$str
¥¥, ;
,
¥¥; <

firstRunId
¥¥= G
)
¥¥G H
;
¥¥H I
cmd
µµ 
.
µµ 

Parameters
µµ 
.
µµ 
AddWithValue
µµ +
(
µµ+ ,
$str
µµ, <
,
µµ< =
secondRunId
µµ> I
)
µµI J
;
µµJ K
using
∂∂ 
var
∂∂ 
reader
∂∂  
=
∂∂! "
cmd
∂∂# &
.
∂∂& '
ExecuteReader
∂∂' 4
(
∂∂4 5
)
∂∂5 6
;
∂∂6 7
while
∑∑ 
(
∑∑ 
reader
∑∑ 
.
∑∑ 
Read
∑∑ "
(
∑∑" #
)
∑∑# $
)
∑∑$ %
{
∏∏ 
var
ππ 
aRunId
ππ 
=
ππ  
reader
ππ! '
[
ππ' (
$str
ππ( 2
]
ππ2 3
.
ππ3 4
ToString
ππ4 <
(
ππ< =
)
ππ= >
;
ππ> ?
var
∫∫ 
bRunId
∫∫ 
=
∫∫  
reader
∫∫! '
[
∫∫' (
$str
∫∫( 2
]
∫∫2 3
.
∫∫3 4
ToString
∫∫4 <
(
∫∫< =
)
∫∫= >
;
∫∫> ?
var
ªª 
aResultType
ªª #
=
ªª$ %
reader
ªª& ,
[
ªª, -
$str
ªª- <
]
ªª< =
.
ªª= >
ToString
ªª> F
(
ªªF G
)
ªªG H
;
ªªH I
var
ºº 
bResultType
ºº #
=
ºº$ %
reader
ºº& ,
[
ºº, -
$str
ºº- <
]
ºº< =
.
ºº= >
ToString
ºº> F
(
ººF G
)
ººG H
;
ººH I
if
ææ 
(
ææ 
aRunId
ææ 
!=
ææ !
null
ææ" &
&&
ææ' )
bRunId
ææ* 0
!=
ææ1 3
null
ææ4 8
&&
ææ9 ;
aResultType
ææ< G
!=
ææH J
null
ææK O
&&
ææP R
bResultType
ææS ^
!=
ææ_ a
null
ææb f
)
ææf g
{
øø 
if
¿¿ 
(
¿¿ 
reader
¿¿ "
[
¿¿" #
$str
¿¿# 1
]
¿¿1 2
is
¿¿3 5
string
¿¿6 <
a_serialized
¿¿= I
&&
¿¿J L
reader
¿¿M S
[
¿¿S T
$str
¿¿T b
]
¿¿b c
is
¿¿d f
string
¿¿g m
b_serialized
¿¿n z
)
¿¿z {
{
¡¡ 
var
¬¬ 
val1
¬¬  $
=
¬¬% &
WriteObject
¬¬' 2
.
¬¬2 3

FromString
¬¬3 =
(
¬¬= >
a_serialized
¬¬> J
,
¬¬J K
(
¬¬L M
RESULT_TYPE
¬¬M X
)
¬¬X Y
Enum
¬¬Y ]
.
¬¬] ^
Parse
¬¬^ c
(
¬¬c d
typeof
¬¬d j
(
¬¬j k
RESULT_TYPE
¬¬k v
)
¬¬v w
,
¬¬w x
aResultType¬¬y Ñ
)¬¬Ñ Ö
,¬¬Ö Ü
aRunId¬¬á ç
)¬¬ç é
;¬¬é è
var
√√ 
val2
√√  $
=
√√% &
WriteObject
√√' 2
.
√√2 3

FromString
√√3 =
(
√√= >
b_serialized
√√> J
,
√√J K
(
√√L M
RESULT_TYPE
√√M X
)
√√X Y
Enum
√√Y ]
.
√√] ^
Parse
√√^ c
(
√√c d
typeof
√√d j
(
√√j k
RESULT_TYPE
√√k v
)
√√v w
,
√√w x
bResultType√√y Ñ
)√√Ñ Ö
,√√Ö Ü
bRunId√√á ç
)√√ç é
;√√é è
if
≈≈ 
(
≈≈  
val1
≈≈  $
is
≈≈% '
WriteObject
≈≈( 3
V1
≈≈4 6
&&
≈≈7 9
val2
≈≈: >
is
≈≈? A
WriteObject
≈≈B M
V2
≈≈N P
)
≈≈P Q
{
∆∆ 
output
««  &
.
««& '
Enqueue
««' .
(
««. /
(
««/ 0
V1
««0 2
,
««2 3
V2
««4 6
)
««6 7
)
««7 8
;
««8 9
}
»» 
}
…… 
}
   
}
ÀÀ 
}
ÃÃ 
)
ÃÃ 
;
ÃÃ 
return
ŒŒ 
output
ŒŒ 
;
ŒŒ 
}
œœ 	
public
—— 
override
—— 
IEnumerable
—— #
<
——# $
FileMonitorObject
——$ 5
>
——5 6
GetMonitorResults
——7 H
(
——H I
string
——I O
runId
——P U
,
——U V
int
——W Z
offset
——[ a
=
——b c
$num
——d e
,
——e f
int
——g j

numResults
——k u
=
——v w
-
——x y
$num
——y z
)
——z {
{
““ 	
var
”” 
results
”” 
=
”” 
new
”” 
List
”” "
<
””" #
FileMonitorObject
””# 4
>
””4 5
(
””5 6
)
””6 7
;
””7 8
if
‘‘ 
(
‘‘ 
MainConnection
‘‘ 
!=
‘‘ !
null
‘‘" &
)
‘‘& '
{
’’ 
if
÷÷ 
(
÷÷ 

numResults
÷÷ 
==
÷÷ !
-
÷÷" #
$num
÷÷# $
)
÷÷$ %
{
◊◊ 
using
ÿÿ 
(
ÿÿ 
var
ÿÿ 
cmd
ÿÿ "
=
ÿÿ# $
new
ÿÿ% (
SqliteCommand
ÿÿ) 6
(
ÿÿ6 7'
GET_MONITOR_RESULTS_LIMIT
ÿÿ7 P
,
ÿÿP Q
MainConnection
ÿÿR `
.
ÿÿ` a

Connection
ÿÿa k
,
ÿÿk l
MainConnection
ÿÿm {
.
ÿÿ{ |
Transactionÿÿ| á
)ÿÿá à
)ÿÿà â
{
ŸŸ 
cmd
⁄⁄ 
.
⁄⁄ 

Parameters
⁄⁄ &
.
⁄⁄& '
AddWithValue
⁄⁄' 3
(
⁄⁄3 4
$str
⁄⁄4 =
,
⁄⁄= >
runId
⁄⁄? D
)
⁄⁄D E
;
⁄⁄E F
cmd
€€ 
.
€€ 

Parameters
€€ &
.
€€& '
AddWithValue
€€' 3
(
€€3 4
$str
€€4 =
,
€€= >
offset
€€? E
)
€€E F
;
€€F G
cmd
‹‹ 
.
‹‹ 

Parameters
‹‹ &
.
‹‹& '
AddWithValue
‹‹' 3
(
‹‹3 4
$str
‹‹4 <
,
‹‹< =

numResults
‹‹> H
)
‹‹H I
;
‹‹I J
using
›› 
(
›› 
var
›› "
reader
››# )
=
››* +
cmd
››, /
.
››/ 0
ExecuteReader
››0 =
(
››= >
)
››> ?
)
››? @
{
ﬁﬁ 
while
ﬂﬂ !
(
ﬂﬂ" #
reader
ﬂﬂ# )
.
ﬂﬂ) *
Read
ﬂﬂ* .
(
ﬂﬂ. /
)
ﬂﬂ/ 0
)
ﬂﬂ0 1
{
‡‡ 
if
··  "
(
··# $
reader
··$ *
[
··* +
$str
··+ 7
]
··7 8
is
··9 ;
string
··< B

serialized
··C M
)
··M N
{
‚‚  !
var
„„$ '
obj
„„( +
=
„„, -
JsonConvert
„„. 9
.
„„9 :
DeserializeObject
„„: K
<
„„K L
FileMonitorObject
„„L ]
>
„„] ^
(
„„^ _

serialized
„„_ i
)
„„i j
;
„„j k
yield
‰‰$ )
return
‰‰* 0
obj
‰‰1 4
;
‰‰4 5
}
ÂÂ  !
}
ÊÊ 
}
ÁÁ 
}
ËË 
}
ÈÈ 
else
ÍÍ 
{
ÎÎ 
using
ÏÏ 
(
ÏÏ 
var
ÏÏ 
cmd
ÏÏ "
=
ÏÏ# $
new
ÏÏ% (
SqliteCommand
ÏÏ) 6
(
ÏÏ6 7!
GET_MONITOR_RESULTS
ÏÏ7 J
,
ÏÏJ K
MainConnection
ÏÏL Z
.
ÏÏZ [

Connection
ÏÏ[ e
,
ÏÏe f
MainConnection
ÏÏg u
.
ÏÏu v
TransactionÏÏv Å
)ÏÏÅ Ç
)ÏÏÇ É
{
ÌÌ 
cmd
ÓÓ 
.
ÓÓ 

Parameters
ÓÓ &
.
ÓÓ& '
AddWithValue
ÓÓ' 3
(
ÓÓ3 4
$str
ÓÓ4 =
,
ÓÓ= >
runId
ÓÓ? D
)
ÓÓD E
;
ÓÓE F
;
ÓÓG H
using
ÔÔ 
(
ÔÔ 
var
ÔÔ "
reader
ÔÔ# )
=
ÔÔ* +
cmd
ÔÔ, /
.
ÔÔ/ 0
ExecuteReader
ÔÔ0 =
(
ÔÔ= >
)
ÔÔ> ?
)
ÔÔ? @
{
 
while
ÒÒ !
(
ÒÒ" #
reader
ÒÒ# )
.
ÒÒ) *
Read
ÒÒ* .
(
ÒÒ. /
)
ÒÒ/ 0
)
ÒÒ0 1
{
ÚÚ 
if
ÛÛ  "
(
ÛÛ# $
reader
ÛÛ$ *
[
ÛÛ* +
$str
ÛÛ+ 7
]
ÛÛ7 8
is
ÛÛ9 ;
string
ÛÛ< B

serialized
ÛÛC M
)
ÛÛM N
{
ÙÙ  !
var
ıı$ '
obj
ıı( +
=
ıı, -
JsonConvert
ıı. 9
.
ıı9 :
DeserializeObject
ıı: K
<
ııK L
FileMonitorObject
ııL ]
>
ıı] ^
(
ıı^ _

serialized
ıı_ i
)
ııi j
;
ııj k
yield
ˆˆ$ )
return
ˆˆ* 0
obj
ˆˆ1 4
;
ˆˆ4 5
}
˜˜  !
}
¯¯ 
}
˘˘ 
}
˙˙ 
}
˚˚ 
}
¸¸ 
else
˝˝ 
{
˛˛ 
Log
ˇˇ 
.
ˇˇ 
Debug
ˇˇ 
(
ˇˇ 
$str
ˇˇ Q
)
ˇˇQ R
;
ˇˇR S
}
ÄÄ 
}
ÅÅ 	
public
ÉÉ 
override
ÉÉ 
int
ÉÉ "
GetNumMonitorResults
ÉÉ 0
(
ÉÉ0 1
string
ÉÉ1 7
runId
ÉÉ8 =
)
ÉÉ= >
{
ÑÑ 	
_
ÖÖ 
=
ÖÖ 
MainConnection
ÖÖ 
??
ÖÖ !
throw
ÖÖ" '
new
ÖÖ( +$
NullReferenceException
ÖÖ, B
(
ÖÖB C
Strings
ÖÖC J
.
ÖÖJ K
Get
ÖÖK N
(
ÖÖN O
$str
ÖÖO _
)
ÖÖ_ `
)
ÖÖ` a
;
ÖÖa b
using
áá 
(
áá 
var
áá 
cmd
áá 
=
áá 
new
áá  
SqliteCommand
áá! .
(
áá. /(
GET_RESULT_COUNT_MONITORED
áá/ I
,
ááI J
MainConnection
ááK Y
.
ááY Z

Connection
ááZ d
,
áád e
MainConnection
ááf t
.
áát u
Transactionááu Ä
)ááÄ Å
)ááÅ Ç
{
àà 
cmd
ââ 
.
ââ 

Parameters
ââ 
.
ââ 
AddWithValue
ââ +
(
ââ+ ,
$str
ââ, 5
,
ââ5 6
runId
ââ7 <
)
ââ< =
;
ââ= >
using
ää 
(
ää 
var
ää 
reader
ää !
=
ää" #
cmd
ää$ '
.
ää' (
ExecuteReader
ää( 5
(
ää5 6
)
ää6 7
)
ää7 8
{
ãã 
while
åå 
(
åå 
reader
åå !
.
åå! "
Read
åå" &
(
åå& '
)
åå' (
)
åå( )
{
çç 
if
éé 
(
éé 
reader
éé "
[
éé" #
$str
éé# -
]
éé- .
.
éé. /
ToString
éé/ 7
(
éé7 8
)
éé8 9
is
éé: <
string
éé= C
integer
ééD K
)
ééK L
return
èè "
int
èè# &
.
èè& '
Parse
èè' ,
(
èè, -
integer
èè- 4
,
èè4 5
CultureInfo
èè6 A
.
èèA B
InvariantCulture
èèB R
)
èèR S
;
èèS T
}
êê 
}
ëë 
}
íí 
return
îî 
$num
îî 
;
îî 
}
ïï 	
public
óó 
override
óó 
int
óó 
GetNumResults
óó )
(
óó) *
RESULT_TYPE
óó* 5

ResultType
óó6 @
,
óó@ A
string
óóB H
runId
óóI N
)
óóN O
{
òò 	
try
ôô 
{
öö 
if
õõ 
(
õõ 
MainConnection
õõ "
!=
õõ# %
null
õõ& *
)
õõ* +
{
úú 
using
ùù 
(
ùù 
var
ùù 
cmd
ùù "
=
ùù# $
new
ùù% (
SqliteCommand
ùù) 6
(
ùù6 7!
SQL_GET_NUM_RESULTS
ùù7 J
,
ùùJ K
MainConnection
ùùL Z
.
ùùZ [

Connection
ùù[ e
,
ùùe f
MainConnection
ùùg u
.
ùùu v
Transactionùùv Å
)ùùÅ Ç
)ùùÇ É
{
ûû 
cmd
üü 
.
üü 

Parameters
üü &
.
üü& '
AddWithValue
üü' 3
(
üü3 4
$str
üü4 =
,
üü= >
runId
üü? D
)
üüD E
;
üüE F
cmd
†† 
.
†† 

Parameters
†† &
.
††& '
AddWithValue
††' 3
(
††3 4
$str
††4 B
,
††B C

ResultType
††D N
.
††N O
ToString
††O W
(
††W X
)
††X Y
)
††Y Z
;
††Z [
using
¢¢ 
(
¢¢ 
var
¢¢ "
reader
¢¢# )
=
¢¢* +
cmd
¢¢, /
.
¢¢/ 0
ExecuteReader
¢¢0 =
(
¢¢= >
)
¢¢> ?
)
¢¢? @
{
££ 
while
§§ !
(
§§" #
reader
§§# )
.
§§) *
Read
§§* .
(
§§. /
)
§§/ 0
)
§§0 1
{
•• 
return
¶¶  &
int
¶¶' *
.
¶¶* +
Parse
¶¶+ 0
(
¶¶0 1
reader
¶¶1 7
[
¶¶7 8
$str
¶¶8 C
]
¶¶C D
.
¶¶D E
ToString
¶¶E M
(
¶¶M N
)
¶¶N O
??
¶¶P R
$str
¶¶S W
,
¶¶W X
CultureInfo
¶¶Y d
.
¶¶d e
InvariantCulture
¶¶e u
)
¶¶u v
;
¶¶v w
}
ßß 
}
®® 
}
©© 
}
™™ 
}
´´ 
catch
¨¨ 
(
¨¨ 
SqliteException
¨¨ "
)
¨¨" #
{
≠≠ 
Log
ÆÆ 
.
ÆÆ 
Error
ÆÆ 
(
ÆÆ 
Strings
ÆÆ !
.
ÆÆ! "
Get
ÆÆ" %
(
ÆÆ% &
$str
ÆÆ& /
)
ÆÆ/ 0
,
ÆÆ0 1

MethodBase
ÆÆ2 <
.
ÆÆ< =
GetCurrentMethod
ÆÆ= M
(
ÆÆM N
)
ÆÆN O
?
ÆÆO P
.
ÆÆP Q
Name
ÆÆQ U
)
ÆÆU V
;
ÆÆV W
}
ØØ 
return
∞∞ 
-
∞∞ 
$num
∞∞ 
;
∞∞ 
}
±± 	
public
≥≥ 
override
≥≥ 
List
≥≥ 
<
≥≥ 
DataRunModel
≥≥ )
>
≥≥) *
GetResultModels
≥≥+ :
(
≥≥: ;

RUN_STATUS
≥≥; E
	runStatus
≥≥F O
)
≥≥O P
{
¥¥ 	
var
µµ 
output
µµ 
=
µµ 
new
µµ 
List
µµ !
<
µµ! "
DataRunModel
µµ" .
>
µµ. /
(
µµ/ 0
)
µµ0 1
;
µµ1 2
if
∑∑ 
(
∑∑ 
MainConnection
∑∑ 
!=
∑∑ !
null
∑∑" &
)
∑∑& '
{
∏∏ 
using
ππ 
(
ππ 
var
ππ 
cmd
ππ 
=
ππ  
new
ππ! $
SqliteCommand
ππ% 2
(
ππ2 3 
SQL_QUERY_ANALYZED
ππ3 E
,
ππE F
MainConnection
ππG U
.
ππU V

Connection
ππV `
,
ππ` a
MainConnection
ππb p
.
ππp q
Transaction
ππq |
)
ππ| }
)
ππ} ~
{
∫∫ 
cmd
ªª 
.
ªª 

Parameters
ªª "
.
ªª" #
AddWithValue
ªª# /
(
ªª/ 0
$str
ªª0 9
,
ªª9 :
	runStatus
ªª; D
)
ªªD E
;
ªªE F
using
ΩΩ 
(
ΩΩ 
var
ΩΩ 
reader
ΩΩ %
=
ΩΩ& '
cmd
ΩΩ( +
.
ΩΩ+ ,
ExecuteReader
ΩΩ, 9
(
ΩΩ9 :
)
ΩΩ: ;
)
ΩΩ; <
{
ææ 
while
øø 
(
øø 
reader
øø %
.
øø% &
Read
øø& *
(
øø* +
)
øø+ ,
)
øø, -
{
¿¿ 
output
¡¡ "
.
¡¡" #
Add
¡¡# &
(
¡¡& '
new
¡¡' *
DataRunModel
¡¡+ 7
(
¡¡7 8
KeyIn
¡¡8 =
:
¡¡= >
reader
¡¡? E
[
¡¡E F
$str
¡¡F S
]
¡¡S T
.
¡¡T U
ToString
¡¡U ]
(
¡¡] ^
)
¡¡^ _
+
¡¡` a
$str
¡¡b i
+
¡¡j k
reader
¡¡l r
[
¡¡r s
$str¡¡s É
]¡¡É Ñ
.¡¡Ñ Ö
ToString¡¡Ö ç
(¡¡ç é
)¡¡é è
,¡¡è ê
TextIn¡¡ë ó
:¡¡ó ò
reader¡¡ô ü
[¡¡ü †
$str¡¡† ≠
]¡¡≠ Æ
.¡¡Æ Ø
ToString¡¡Ø ∑
(¡¡∑ ∏
)¡¡∏ π
+¡¡∫ ª
$str¡¡º √
+¡¡ƒ ≈
reader¡¡∆ Ã
[¡¡Ã Õ
$str¡¡Õ ›
]¡¡› ﬁ
.¡¡ﬁ ﬂ
ToString¡¡ﬂ Á
(¡¡Á Ë
)¡¡Ë È
)¡¡È Í
)¡¡Í Î
;¡¡Î Ï
}
¬¬ 
}
√√ 
}
ƒƒ 
}
≈≈ 
else
∆∆ 
{
«« 
Log
»» 
.
»» 
Debug
»» 
(
»» 
$str
»» M
)
»»M N
;
»»N O
}
…… 
return
   
output
   
;
   
}
ÀÀ 	
public
ÕÕ 
override
ÕÕ 
IEnumerable
ÕÕ #
<
ÕÕ# $
WriteObject
ÕÕ$ /
>
ÕÕ/ 0
GetResultsByRunid
ÕÕ1 B
(
ÕÕB C
string
ÕÕC I
runid
ÕÕJ O
)
ÕÕO P
{
ŒŒ 	
foreach
œœ 
(
œœ 
var
œœ 
cxn
œœ 
in
œœ 
Connections
œœ  +
)
œœ+ ,
{
–– 
using
—— 
var
—— 
cmd
—— 
=
—— 
new
——  #
SqliteCommand
——$ 1
(
——1 2'
SQL_GET_RESULTS_BY_RUN_ID
——2 K
,
——K L
cxn
——M P
.
——P Q

Connection
——Q [
,
——[ \
cxn
——] `
.
——` a
Transaction
——a l
)
——l m
;
——m n
cmd
”” 
.
”” 

Parameters
”” 
.
”” 
AddWithValue
”” +
(
””+ ,
$str
””, 5
,
””5 6
runid
””7 <
)
””< =
;
””= >
using
‘‘ 
(
‘‘ 
var
‘‘ 
reader
‘‘ !
=
‘‘" #
cmd
‘‘$ '
.
‘‘' (
ExecuteReader
‘‘( 5
(
‘‘5 6
)
‘‘6 7
)
‘‘7 8
{
’’ 
while
÷÷ 
(
÷÷ 
reader
÷÷ !
.
÷÷! "
Read
÷÷" &
(
÷÷& '
)
÷÷' (
)
÷÷( )
{
◊◊ 
var
ÿÿ 
runId
ÿÿ !
=
ÿÿ" #
reader
ÿÿ$ *
[
ÿÿ* +
$str
ÿÿ+ 3
]
ÿÿ3 4
.
ÿÿ4 5
ToString
ÿÿ5 =
(
ÿÿ= >
)
ÿÿ> ?
;
ÿÿ? @
var
ŸŸ 
resultTypeString
ŸŸ ,
=
ŸŸ- .
reader
ŸŸ/ 5
[
ŸŸ5 6
$str
ŸŸ6 C
]
ŸŸC D
.
ŸŸD E
ToString
ŸŸE M
(
ŸŸM N
)
ŸŸN O
;
ŸŸO P
if
⁄⁄ 
(
⁄⁄ 
runId
⁄⁄ !
!=
⁄⁄" $
null
⁄⁄% )
&&
⁄⁄* ,
resultTypeString
⁄⁄- =
!=
⁄⁄> @
null
⁄⁄A E
)
⁄⁄E F
{
€€ 
var
‹‹ 
wo
‹‹  "
=
‹‹# $
WriteObject
‹‹% 0
.
‹‹0 1

FromString
‹‹1 ;
(
‹‹; <
(
‹‹< =
string
‹‹= C
)
‹‹C D
reader
‹‹D J
[
‹‹J K
$str
‹‹K W
]
‹‹W X
,
‹‹X Y
(
‹‹Z [
RESULT_TYPE
‹‹[ f
)
‹‹f g
Enum
‹‹g k
.
‹‹k l
Parse
‹‹l q
(
‹‹q r
typeof
‹‹r x
(
‹‹x y
RESULT_TYPE‹‹y Ñ
)‹‹Ñ Ö
,‹‹Ö Ü 
resultTypeString‹‹á ó
)‹‹ó ò
,‹‹ò ô
runId‹‹ö ü
)‹‹ü †
;‹‹† °
if
›› 
(
››  
wo
››  "
is
››# %
WriteObject
››& 1
WO
››2 4
)
››4 5
{
ﬁﬁ 
yield
ﬂﬂ  %
return
ﬂﬂ& ,
WO
ﬂﬂ- /
;
ﬂﬂ/ 0
}
‡‡ 
}
·· 
}
‚‚ 
}
„„ 
}
‰‰ 
}
ÂÂ 	
public
ÁÁ 
override
ÁÁ 

Dictionary
ÁÁ "
<
ÁÁ" #
RESULT_TYPE
ÁÁ# .
,
ÁÁ. /
int
ÁÁ0 3
>
ÁÁ3 4%
GetResultTypesAndCounts
ÁÁ5 L
(
ÁÁL M
string
ÁÁM S
runId
ÁÁT Y
)
ÁÁY Z
{
ËË 	
var
ÈÈ 
outDict
ÈÈ 
=
ÈÈ 
new
ÈÈ 

Dictionary
ÈÈ (
<
ÈÈ( )
RESULT_TYPE
ÈÈ) 4
,
ÈÈ4 5
int
ÈÈ6 9
>
ÈÈ9 :
(
ÈÈ: ;
)
ÈÈ; <
{
ÈÈ= >
}
ÈÈ? @
;
ÈÈ@ A
try
ÍÍ 
{
ÎÎ 
if
ÏÏ 
(
ÏÏ 
MainConnection
ÏÏ "
!=
ÏÏ# %
null
ÏÏ& *
)
ÏÏ* +
{
ÌÌ 
using
ÓÓ 
(
ÓÓ 
var
ÓÓ 
cmd
ÓÓ "
=
ÓÓ# $
new
ÓÓ% (
SqliteCommand
ÓÓ) 6
(
ÓÓ6 7)
SQL_GET_RESULT_TYPES_COUNTS
ÓÓ7 R
,
ÓÓR S
MainConnection
ÓÓT b
.
ÓÓb c

Connection
ÓÓc m
,
ÓÓm n
MainConnection
ÓÓo }
.
ÓÓ} ~
TransactionÓÓ~ â
)ÓÓâ ä
)ÓÓä ã
{
ÔÔ 
cmd
 
.
 

Parameters
 &
.
& '
AddWithValue
' 3
(
3 4
$str
4 =
,
= >
runId
? D
)
D E
;
E F
using
ÚÚ 
(
ÚÚ 
var
ÚÚ "
reader
ÚÚ# )
=
ÚÚ* +
cmd
ÚÚ, /
.
ÚÚ/ 0
ExecuteReader
ÚÚ0 =
(
ÚÚ= >
)
ÚÚ> ?
)
ÚÚ? @
{
ÛÛ 
while
ÙÙ !
(
ÙÙ" #
reader
ÙÙ# )
.
ÙÙ) *
Read
ÙÙ* .
(
ÙÙ. /
)
ÙÙ/ 0
)
ÙÙ0 1
{
ıı 
if
ˆˆ  "
(
ˆˆ# $
Enum
ˆˆ$ (
.
ˆˆ( )
TryParse
ˆˆ) 1
(
ˆˆ1 2
reader
ˆˆ2 8
[
ˆˆ8 9
$str
ˆˆ9 F
]
ˆˆF G
.
ˆˆG H
ToString
ˆˆH P
(
ˆˆP Q
)
ˆˆQ R
,
ˆˆR S
out
ˆˆT W
RESULT_TYPE
ˆˆX c
result_type
ˆˆd o
)
ˆˆo p
)
ˆˆp q
{
˜˜  !
outDict
¯¯$ +
.
¯¯+ ,
TryAdd
¯¯, 2
(
¯¯2 3
result_type
¯¯3 >
,
¯¯> ?
int
¯¯@ C
.
¯¯C D
Parse
¯¯D I
(
¯¯I J
reader
¯¯J P
[
¯¯P Q
$str
¯¯Q X
]
¯¯X Y
.
¯¯Y Z
ToString
¯¯Z b
(
¯¯b c
)
¯¯c d
??
¯¯e g
$str
¯¯h l
,
¯¯l m
CultureInfo
¯¯n y
.
¯¯y z
InvariantCulture¯¯z ä
)¯¯ä ã
)¯¯ã å
;¯¯å ç
}
˘˘  !
}
˙˙ 
}
˚˚ 
}
¸¸ 
}
˝˝ 
}
˛˛ 
catch
ˇˇ 
(
ˇˇ 
SqliteException
ˇˇ "
)
ˇˇ" #
{
ÄÄ 
Log
ÅÅ 
.
ÅÅ 
Error
ÅÅ 
(
ÅÅ 
Strings
ÅÅ !
.
ÅÅ! "
Get
ÅÅ" %
(
ÅÅ% &
$str
ÅÅ& =
)
ÅÅ= >
)
ÅÅ> ?
;
ÅÅ? @
}
ÇÇ 
return
ÉÉ 
outDict
ÉÉ 
;
ÉÉ 
}
ÑÑ 	
public
ÜÜ 
override
ÜÜ 
AsaRun
ÜÜ 
?
ÜÜ 
GetRun
ÜÜ  &
(
ÜÜ& '
string
ÜÜ' -
RunId
ÜÜ. 3
)
ÜÜ3 4
{
áá 	
_
àà 
=
àà 
MainConnection
àà 
??
àà !
throw
àà" '
new
àà( +$
NullReferenceException
àà, B
(
ààB C
Strings
ààC J
.
ààJ K
Get
ààK N
(
ààN O
$str
ààO _
)
àà_ `
)
àà` a
;
ààa b
using
ää 
(
ää 
var
ää 
cmd
ää 
=
ää 
new
ää  
SqliteCommand
ää! .
(
ää. /
SQL_GET_RUN
ää/ :
,
ää: ;
MainConnection
ää< J
.
ääJ K

Connection
ääK U
,
ääU V
MainConnection
ääW e
.
ääe f
Transaction
ääf q
)
ääq r
)
äär s
{
ãã 
cmd
åå 
.
åå 

Parameters
åå 
.
åå 
AddWithValue
åå +
(
åå+ ,
$str
åå, 5
,
åå5 6
RunId
åå7 <
)
åå< =
;
åå= >
using
çç 
(
çç 
var
çç 
reader
çç !
=
çç" #
cmd
çç$ '
.
çç' (
ExecuteReader
çç( 5
(
çç5 6
)
çç6 7
)
çç7 8
{
éé 
while
èè 
(
èè 
reader
èè !
.
èè! "
Read
èè" &
(
èè& '
)
èè' (
)
èè( )
{
êê 
if
ëë 
(
ëë 
reader
ëë "
[
ëë" #
$str
ëë# /
]
ëë/ 0
.
ëë0 1
ToString
ëë1 9
(
ëë9 :
)
ëë: ;
is
ëë< >
string
ëë? E

serialized
ëëF P
)
ëëP Q
return
íí "
JsonConvert
íí# .
.
íí. /
DeserializeObject
íí/ @
<
íí@ A
AsaRun
ííA G
>
ííG H
(
ííH I

serialized
ííI S
)
ííS T
;
ííT U
}
ìì 
}
îî 
}
ïï 
return
ññ 
null
ññ 
;
ññ 
}
óó 	
public
ôô 
override
ôô 
List
ôô 
<
ôô 
(
ôô 
string
ôô $

firstRunId
ôô% /
,
ôô/ 0
string
ôô1 7
secondRunId
ôô8 C
,
ôôC D
string
ôôE K
analysesHash
ôôL X
,
ôôX Y

RUN_STATUS
ôôZ d
	runStatus
ôôe n
)
ôôn o
>
ôôo p
GetCompareRuns
ôôq 
(ôô Ä
)ôôÄ Å
{
öö 	
_
õõ 
=
õõ 
MainConnection
õõ 
??
õõ !
throw
õõ" '
new
õõ( +$
NullReferenceException
õõ, B
(
õõB C
Strings
õõC J
.
õõJ K
Get
õõK N
(
õõN O
$str
õõO _
)
õõ_ `
)
õõ` a
;
õõa b
var
ùù 
Runs
ùù 
=
ùù 
new
ùù 
List
ùù 
<
ùù  
(
ùù  !
string
ùù! '

firstRunId
ùù( 2
,
ùù2 3
string
ùù4 :
secondRunId
ùù; F
,
ùùF G
string
ùùH N
analysesHash
ùùO [
,
ùù[ \

RUN_STATUS
ùù] g
	runStatus
ùùh q
)
ùùq r
>
ùùr s
(
ùùs t
)
ùùt u
;
ùùu v
using
üü 
var
üü 
cmd
üü 
=
üü 
new
üü 
SqliteCommand
üü  -
(
üü- .%
SQL_SELECT_COMPARE_RUNS
üü. E
,
üüE F
MainConnection
üüG U
.
üüU V

Connection
üüV `
,
üü` a
MainConnection
üüb p
.
üüp q
Transaction
üüq |
)
üü| }
;
üü} ~
using
†† 
(
†† 
var
†† 
reader
†† 
=
†† 
cmd
††  #
.
††# $
ExecuteReader
††$ 1
(
††1 2
)
††2 3
)
††3 4
{
°° 
while
¢¢ 
(
¢¢ 
reader
¢¢ 
.
¢¢ 
Read
¢¢ "
(
¢¢" #
)
¢¢# $
)
¢¢$ %
{
££ 
Runs
§§ 
.
§§ 
Add
§§ 
(
§§ 
(
§§ 
(
§§ 
string
§§ %
)
§§% &
reader
§§& ,
[
§§, -
$str
§§- :
]
§§: ;
,
§§; <
(
§§= >
string
§§> D
)
§§D E
reader
§§E K
[
§§K L
$str
§§L \
]
§§\ ]
,
§§] ^
(
§§_ `
string
§§` f
)
§§f g
reader
§§g m
[
§§m n
$str
§§n }
]
§§} ~
,
§§~ 
(§§Ä Å

RUN_STATUS§§Å ã
)§§ã å
Enum§§å ê
.§§ê ë
Parse§§ë ñ
(§§ñ ó
typeof§§ó ù
(§§ù û

RUN_STATUS§§û ®
)§§® ©
,§§© ™
(§§´ ¨
string§§¨ ≤
)§§≤ ≥
reader§§≥ π
[§§π ∫
$str§§∫ ¬
]§§¬ √
)§§√ ƒ
)§§ƒ ≈
)§§≈ ∆
;§§∆ «
}
•• 
}
¶¶ 
return
ßß 
Runs
ßß 
;
ßß 
}
®® 	
public
©© 
override
©© 
List
©© 
<
©© 
string
©© #
>
©©# $
GetRuns
©©% ,
(
©©, -
)
©©- .
{
™™ 	
_
´´ 
=
´´ 
MainConnection
´´ 
??
´´ !
throw
´´" '
new
´´( +$
NullReferenceException
´´, B
(
´´B C
Strings
´´C J
.
´´J K
Get
´´K N
(
´´N O
$str
´´O _
)
´´_ `
)
´´` a
;
´´a b
List
≠≠ 
<
≠≠ 
string
≠≠ 
>
≠≠ 
Runs
≠≠ 
=
≠≠ 
new
≠≠  #
List
≠≠$ (
<
≠≠( )
string
≠≠) /
>
≠≠/ 0
(
≠≠0 1
)
≠≠1 2
;
≠≠2 3
using
ØØ 
var
ØØ 
cmd
ØØ 
=
ØØ 
new
ØØ 
SqliteCommand
ØØ  -
(
ØØ- .
SQL_SELECT_RUNS
ØØ. =
,
ØØ= >
MainConnection
ØØ? M
.
ØØM N

Connection
ØØN X
,
ØØX Y
MainConnection
ØØZ h
.
ØØh i
Transaction
ØØi t
)
ØØt u
;
ØØu v
using
∞∞ 
(
∞∞ 
var
∞∞ 
reader
∞∞ 
=
∞∞ 
cmd
∞∞  #
.
∞∞# $
ExecuteReader
∞∞$ 1
(
∞∞1 2
)
∞∞2 3
)
∞∞3 4
{
±± 
while
≤≤ 
(
≤≤ 
reader
≤≤ 
.
≤≤ 
Read
≤≤ "
(
≤≤" #
)
≤≤# $
)
≤≤$ %
{
≥≥ 
Runs
¥¥ 
.
¥¥ 
Add
¥¥ 
(
¥¥ 
(
¥¥ 
string
¥¥ $
)
¥¥$ %
reader
¥¥% +
[
¥¥+ ,
$str
¥¥, 4
]
¥¥4 5
)
¥¥5 6
;
¥¥6 7
}
µµ 
}
∂∂ 
return
∑∑ 
Runs
∑∑ 
;
∑∑ 
}
∏∏ 	
public
∫∫ 
override
∫∫ 
List
∫∫ 
<
∫∫ 
string
∫∫ #
>
∫∫# $
GetRuns
∫∫% ,
(
∫∫, -
RUN_TYPE
∫∫- 5
type
∫∫6 :
)
∫∫: ;
{
ªª 	
_
ºº 
=
ºº 
MainConnection
ºº 
??
ºº !
throw
ºº" '
new
ºº( +$
NullReferenceException
ºº, B
(
ººB C
Strings
ººC J
.
ººJ K
Get
ººK N
(
ººN O
$str
ººO _
)
ºº_ `
)
ºº` a
;
ººa b
List
ææ 
<
ææ 
string
ææ 
>
ææ 
Runs
ææ 
=
ææ 
new
ææ  #
List
ææ$ (
<
ææ( )
string
ææ) /
>
ææ/ 0
(
ææ0 1
)
ææ1 2
;
ææ2 3
using
¿¿ 
var
¿¿ 
cmd
¿¿ 
=
¿¿ 
new
¿¿ 
SqliteCommand
¿¿  -
(
¿¿- .%
SQL_SELECT_RUNS_BY_TYPE
¿¿. E
,
¿¿E F
MainConnection
¿¿G U
.
¿¿U V

Connection
¿¿V `
,
¿¿` a
MainConnection
¿¿b p
.
¿¿p q
Transaction
¿¿q |
)
¿¿| }
;
¿¿} ~
cmd
¡¡ 
.
¡¡ 

Parameters
¡¡ 
.
¡¡ 
AddWithValue
¡¡ '
(
¡¡' (
$str
¡¡( /
,
¡¡/ 0
type
¡¡1 5
)
¡¡5 6
;
¡¡6 7
using
¬¬ 
(
¬¬ 
var
¬¬ 
reader
¬¬ 
=
¬¬ 
cmd
¬¬  #
.
¬¬# $
ExecuteReader
¬¬$ 1
(
¬¬1 2
)
¬¬2 3
)
¬¬3 4
{
√√ 
while
ƒƒ 
(
ƒƒ 
reader
ƒƒ 
.
ƒƒ 
Read
ƒƒ "
(
ƒƒ" #
)
ƒƒ# $
)
ƒƒ$ %
{
≈≈ 
Runs
∆∆ 
.
∆∆ 
Add
∆∆ 
(
∆∆ 
(
∆∆ 
string
∆∆ $
)
∆∆$ %
reader
∆∆% +
[
∆∆+ ,
$str
∆∆, 4
]
∆∆4 5
)
∆∆5 6
;
∆∆6 7
}
«« 
}
»» 
return
…… 
Runs
…… 
;
…… 
}
   	
public
ÃÃ 
override
ÃÃ 
List
ÃÃ 
<
ÃÃ 
FileMonitorEvent
ÃÃ -
>
ÃÃ- .)
GetSerializedMonitorResults
ÃÃ/ J
(
ÃÃJ K
string
ÃÃK Q
runId
ÃÃR W
)
ÃÃW X
{
ÕÕ 	
List
ŒŒ 
<
ŒŒ 
FileMonitorEvent
ŒŒ !
>
ŒŒ! "
records
ŒŒ# *
=
ŒŒ+ ,
new
ŒŒ- 0
List
ŒŒ1 5
<
ŒŒ5 6
FileMonitorEvent
ŒŒ6 F
>
ŒŒF G
(
ŒŒG H
)
ŒŒH I
;
ŒŒI J
if
œœ 
(
œœ 
MainConnection
œœ 
!=
œœ !
null
œœ" &
)
œœ& '
{
–– 
using
—— 
(
—— 
var
—— 
cmd
—— 
=
——  
new
——! $
SqliteCommand
——% 2
(
——2 3$
GET_SERIALIZED_RESULTS
——3 I
,
——I J
MainConnection
——K Y
.
——Y Z

Connection
——Z d
,
——d e
MainConnection
——f t
.
——t u
Transaction——u Ä
)——Ä Å
)——Å Ç
{
““ 
cmd
”” 
.
”” 

Parameters
”” "
.
””" #
AddWithValue
””# /
(
””/ 0
$str
””0 9
,
””9 :
runId
””; @
)
””@ A
;
””A B
using
‘‘ 
(
‘‘ 
var
‘‘ 
reader
‘‘ %
=
‘‘& '
cmd
‘‘( +
.
‘‘+ ,
ExecuteReader
‘‘, 9
(
‘‘9 :
)
‘‘: ;
)
‘‘; <
{
’’ 
FileMonitorEvent
÷÷ (
obj
÷÷) ,
;
÷÷, -
while
ÿÿ 
(
ÿÿ 
reader
ÿÿ %
.
ÿÿ% &
Read
ÿÿ& *
(
ÿÿ* +
)
ÿÿ+ ,
)
ÿÿ, -
{
ŸŸ 
if
⁄⁄ 
(
⁄⁄  
reader
⁄⁄  &
[
⁄⁄& '
$str
⁄⁄' 3
]
⁄⁄3 4
.
⁄⁄4 5
ToString
⁄⁄5 =
(
⁄⁄= >
)
⁄⁄> ?
is
⁄⁄@ B
string
⁄⁄C I

serialized
⁄⁄J T
)
⁄⁄T U
{
€€ 
obj
‹‹  #
=
‹‹$ %
JsonConvert
‹‹& 1
.
‹‹1 2
DeserializeObject
‹‹2 C
<
‹‹C D
FileMonitorEvent
‹‹D T
>
‹‹T U
(
‹‹U V

serialized
‹‹V `
)
‹‹` a
;
‹‹a b
obj
››  #
.
››# $

ChangeType
››$ .
=
››/ 0
(
››1 2
CHANGE_TYPE
››2 =
)
››= >
int
››> A
.
››A B
Parse
››B G
(
››G H
reader
››H N
[
››N O
$str
››O \
]
››\ ]
.
››] ^
ToString
››^ f
(
››f g
)
››g h
??
››i k
$str
››l o
,
››o p
CultureInfo
››q |
.
››| }
InvariantCulture››} ç
)››ç é
;››é è
records
ﬁﬁ  '
.
ﬁﬁ' (
Add
ﬁﬁ( +
(
ﬁﬁ+ ,
obj
ﬁﬁ, /
)
ﬁﬁ/ 0
;
ﬁﬁ0 1
}
ﬂﬂ 
}
‡‡ 
}
·· 
}
‚‚ 
}
„„ 
return
ÂÂ 
records
ÂÂ 
;
ÂÂ 
}
ÊÊ 	
public
ËË 
override
ËË 
Settings
ËË  
?
ËË  !
GetSettings
ËË" -
(
ËË- .
)
ËË. /
{
ÈÈ 	
try
ÍÍ 
{
ÎÎ 
using
ÏÏ 
var
ÏÏ 
getSettings
ÏÏ %
=
ÏÏ& '
new
ÏÏ( +
SqliteCommand
ÏÏ, 9
(
ÏÏ9 :(
SQL_GET_PERSISTED_SETTINGS
ÏÏ: T
,
ÏÏT U
MainConnection
ÏÏV d
?
ÏÏd e
.
ÏÏe f

Connection
ÏÏf p
,
ÏÏp q
MainConnectionÏÏr Ä
?ÏÏÄ Å
.ÏÏÅ Ç
TransactionÏÏÇ ç
)ÏÏç é
;ÏÏé è
getSettings
ÌÌ 
.
ÌÌ 

Parameters
ÌÌ &
.
ÌÌ& '
AddWithValue
ÌÌ' 3
(
ÌÌ3 4
$str
ÌÌ4 9
,
ÌÌ9 :
$str
ÌÌ; F
)
ÌÌF G
;
ÌÌG H
using
ÓÓ 
var
ÓÓ 
reader
ÓÓ  
=
ÓÓ! "
getSettings
ÓÓ# .
.
ÓÓ. /
ExecuteReader
ÓÓ/ <
(
ÓÓ< =
)
ÓÓ= >
;
ÓÓ> ?
if
ÒÒ 
(
ÒÒ 
reader
ÒÒ 
.
ÒÒ 
HasRows
ÒÒ "
)
ÒÒ" #
{
ÚÚ 
while
ÛÛ 
(
ÛÛ 
reader
ÛÛ !
.
ÛÛ! "
Read
ÛÛ" &
(
ÛÛ& '
)
ÛÛ' (
)
ÛÛ( )
{
ÙÙ 
if
ıı 
(
ıı 
reader
ıı "
[
ıı" #
$str
ıı# /
]
ıı/ 0
.
ıı0 1
ToString
ıı1 9
(
ıı9 :
)
ıı: ;
is
ıı< >
string
ıı? E
settings
ııF N
)
ııN O
{
ˆˆ 
return
˜˜ "
JsonConvert
˜˜# .
.
˜˜. /
DeserializeObject
˜˜/ @
<
˜˜@ A
Settings
˜˜A I
>
˜˜I J
(
˜˜J K
settings
˜˜K S
)
˜˜S T
;
˜˜T U
}
¯¯ 
}
˘˘ 
}
˙˙ 
}
˚˚ 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸ 
e
¸¸ 
)
¸¸ 
when
¸¸  $
(
¸¸% &
e
¸¸& '
is
¸¸( *
SqliteException
¸¸+ :
||
¸¸; =
e
¸¸> ?
is
¸¸@ B#
ArgumentNullException
¸¸C X
||
¸¸Y [
e
¸¸\ ]
is
¸¸^ `$
NullReferenceException
¸¸a w
)
¸¸w x
{
˝˝ 
Log
˛˛ 
.
˛˛ 
Debug
˛˛ 
(
˛˛ 
$str
˛˛ E
)
˛˛E F
;
˛˛F G
}
ÄÄ 
return
ÇÇ 
null
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
public
ÖÖ 
override
ÖÖ 
void
ÖÖ 
InsertAnalyzed
ÖÖ +
(
ÖÖ+ ,
CompareResult
ÖÖ, 9
objIn
ÖÖ: ?
)
ÖÖ? @
{
ÜÜ 	
if
áá 
(
áá 
objIn
áá 
!=
áá 
null
áá 
&&
áá  
MainConnection
áá! /
!=
áá0 2
null
áá3 7
)
áá7 8
{
àà 
using
ââ 
(
ââ 
var
ââ 
cmd
ââ 
=
ââ  
new
ââ! $
SqliteCommand
ââ% 2
(
ââ2 3(
SQL_INSERT_FINDINGS_RESULT
ââ3 M
,
ââM N
MainConnection
ââO ]
.
ââ] ^

Connection
ââ^ h
,
ââh i
MainConnection
ââj x
.
ââx y
Transactionâây Ñ
)ââÑ Ö
)ââÖ Ü
{
ää 
cmd
ãã 
.
ãã 

Parameters
ãã "
.
ãã" #
AddWithValue
ãã# /
(
ãã/ 0
$str
ãã0 ?
,
ãã? @
objIn
ããA F
.
ããF G
	BaseRunId
ããG P
??
ããQ S
string
ããT Z
.
ããZ [
Empty
ãã[ `
)
ãã` a
;
ããa b
cmd
åå 
.
åå 

Parameters
åå "
.
åå" #
AddWithValue
åå# /
(
åå/ 0
$str
åå0 @
,
åå@ A
objIn
ååB G
.
ååG H
CompareRunId
ååH T
)
ååT U
;
ååU V
cmd
çç 
.
çç 

Parameters
çç "
.
çç" #
AddWithValue
çç# /
(
çç/ 0
$str
çç0 >
,
çç> ?
objIn
çç@ E
.
ççE F

ResultType
ççF P
)
ççP Q
;
ççQ R
cmd
éé 
.
éé 

Parameters
éé "
.
éé" #
AddWithValue
éé# /
(
éé/ 0
$str
éé0 8
,
éé8 9
objIn
éé: ?
.
éé? @
Analysis
éé@ H
)
ééH I
;
ééI J
cmd
èè 
.
èè 

Parameters
èè "
.
èè" #
AddWithValue
èè# /
(
èè/ 0
$str
èè0 ;
,
èè; <
objIn
èè= B
.
èèB C
Identity
èèC K
)
èèK L
;
èèL M
cmd
êê 
.
êê 

Parameters
êê "
.
êê" #
AddWithValue
êê# /
(
êê/ 0
$str
êê0 C
,
êêC D
JsonConvert
êêE P
.
êêP Q
SerializeObject
êêQ `
(
êê` a
objIn
êêa f
.
êêf g
Base
êêg k
)
êêk l
)
êêl m
;
êêm n
cmd
ëë 
.
ëë 

Parameters
ëë "
.
ëë" #
AddWithValue
ëë# /
(
ëë/ 0
$str
ëë0 D
,
ëëD E
JsonConvert
ëëF Q
.
ëëQ R
SerializeObject
ëëR a
(
ëëa b
objIn
ëëb g
.
ëëg h
Compare
ëëh o
)
ëëo p
)
ëëp q
;
ëëq r
cmd
íí 
.
íí 

Parameters
íí "
.
íí" #
AddWithValue
íí# /
(
íí/ 0
$str
íí0 @
,
íí@ A
objIn
ííB G
.
ííG H
AnalysesHash
ííH T
)
ííT U
;
ííU V
objIn
îî 
.
îî 
Base
îî 
=
îî  
null
îî! %
;
îî% &
objIn
ïï 
.
ïï 
Compare
ïï !
=
ïï" #
null
ïï$ (
;
ïï( )
cmd
ññ 
.
ññ 

Parameters
ññ "
.
ññ" #
AddWithValue
ññ# /
(
ññ/ 0
$str
ññ0 B
,
ññB C
JsonConvert
ññD O
.
ññO P
SerializeObject
ññP _
(
ññ_ `
objIn
ññ` e
)
ññe f
)
ññf g
;
ññg h
cmd
óó 
.
óó 
ExecuteNonQuery
óó '
(
óó' (
)
óó( )
;
óó) *
}
òò 
}
ôô 
else
öö 
{
õõ 
Log
úú 
.
úú 
Debug
úú 
(
úú 
$str
úú T
)
úúT U
;
úúU V
}
ùù 
}
ûû 	
public
†† 
override
†† 
void
†† 
InsertCompareRun
†† -
(
††- .
string
††. 4
?
††4 5

firstRunId
††6 @
,
††@ A
string
††B H
secondRunId
††I T
,
††T U
string
††V \
analysesHash
††] i
,
††i j

RUN_STATUS
††k u
	runStatus
††v 
)†† Ä
{
°° 	
_
¢¢ 
=
¢¢ 
MainConnection
¢¢ 
??
¢¢ !
throw
¢¢" '
new
¢¢( +$
NullReferenceException
¢¢, B
(
¢¢B C
Strings
¢¢C J
.
¢¢J K
Get
¢¢K N
(
¢¢N O
$str
¢¢O _
)
¢¢_ `
)
¢¢` a
;
¢¢a b
using
££ 
(
££ 
var
££ 
cmd
££ 
=
££ 
new
££  
SqliteCommand
££! .
(
££. /.
 INSERT_RUN_INTO_RESULT_TABLE_SQL
££/ O
,
££O P
MainConnection
££Q _
.
££_ `

Connection
££` j
,
££j k
MainConnection
££l z
.
££z {
Transaction££{ Ü
)££Ü á
)££á à
{
§§ 
cmd
•• 
.
•• 

Parameters
•• 
.
•• 
AddWithValue
•• +
(
••+ ,
$str
••, :
,
••: ;

firstRunId
••< F
??
••G I
string
••J P
.
••P Q
Empty
••Q V
)
••V W
;
••W X
cmd
¶¶ 
.
¶¶ 

Parameters
¶¶ 
.
¶¶ 
AddWithValue
¶¶ +
(
¶¶+ ,
$str
¶¶, =
,
¶¶= >
secondRunId
¶¶? J
)
¶¶J K
;
¶¶K L
cmd
ßß 
.
ßß 

Parameters
ßß 
.
ßß 
AddWithValue
ßß +
(
ßß+ ,
$str
ßß, <
,
ßß< =
analysesHash
ßß> J
)
ßßJ K
;
ßßK L
cmd
®® 
.
®® 

Parameters
®® 
.
®® 
AddWithValue
®® +
(
®®+ ,
$str
®®, 5
,
®®5 6
	runStatus
®®7 @
)
®®@ A
;
®®A B
cmd
©© 
.
©© 
ExecuteNonQuery
©© #
(
©©# $
)
©©$ %
;
©©% &
}
™™ 
}
´´ 	
public
≠≠ 
override
≠≠ 
void
≠≠ 
	InsertRun
≠≠ &
(
≠≠& '
AsaRun
≠≠' -
run
≠≠. 1
)
≠≠1 2
{
ÆÆ 	
if
ØØ 
(
ØØ 
run
ØØ 
==
ØØ 
null
ØØ 
)
ØØ 
{
∞∞ 
return
±± 
;
±± 
}
≤≤ 
if
≥≥ 
(
≥≥ 
MainConnection
≥≥ 
!=
≥≥ !
null
≥≥" &
)
≥≥& '
{
¥¥ 
using
µµ 
var
µµ 
cmd
µµ 
=
µµ 
new
µµ  #
SqliteCommand
µµ$ 1
(
µµ1 2
SQL_INSERT_RUN
µµ2 @
,
µµ@ A
MainConnection
µµB P
.
µµP Q

Connection
µµQ [
,
µµ[ \
MainConnection
µµ] k
.
µµk l
Transaction
µµl w
)
µµw x
;
µµx y
cmd
∂∂ 
.
∂∂ 

Parameters
∂∂ 
.
∂∂ 
AddWithValue
∂∂ +
(
∂∂+ ,
$str
∂∂, 5
,
∂∂5 6
run
∂∂7 :
.
∂∂: ;
RunId
∂∂; @
)
∂∂@ A
;
∂∂A B
cmd
∑∑ 
.
∑∑ 

Parameters
∑∑ 
.
∑∑ 
AddWithValue
∑∑ +
(
∑∑+ ,
$str
∑∑, 3
,
∑∑3 4
run
∑∑5 8
.
∑∑8 9
Type
∑∑9 =
)
∑∑= >
;
∑∑> ?
cmd
∏∏ 
.
∏∏ 

Parameters
∏∏ 
.
∏∏ 
AddWithValue
∏∏ +
(
∏∏+ ,
$str
∏∏, 9
,
∏∏9 :
JsonConvert
∏∏; F
.
∏∏F G
SerializeObject
∏∏G V
(
∏∏V W
run
∏∏W Z
)
∏∏Z [
)
∏∏[ \
;
∏∏\ ]
try
∫∫ 
{
ªª 
cmd
ºº 
.
ºº 
ExecuteNonQuery
ºº '
(
ºº' (
)
ºº( )
;
ºº) *
}
ΩΩ 
catch
ææ 
(
ææ 
SqliteException
ææ &
e
ææ' (
)
ææ( )
{
øø 
Log
¿¿ 
.
¿¿ 
Warning
¿¿ 
(
¿¿  
e
¿¿  !
.
¿¿! "

StackTrace
¿¿" ,
)
¿¿, -
;
¿¿- .
Log
¡¡ 
.
¡¡ 
Warning
¡¡ 
(
¡¡  
e
¡¡  !
.
¡¡! "
Message
¡¡" )
)
¡¡) *
;
¡¡* +
}
¬¬ 
}
√√ 
else
ƒƒ 
{
≈≈ 
Log
∆∆ 
.
∆∆ 
Debug
∆∆ 
(
∆∆ 
$str
∆∆ O
)
∆∆O P
;
∆∆P Q
}
«« 
}
»» 	
public
   
int
   !
PopulateConnections
   &
(
  & '
)
  ' (
{
ÀÀ 	
var
ÃÃ  
connectionsCreated
ÃÃ "
=
ÃÃ# $
$num
ÃÃ% &
;
ÃÃ& '
for
ÕÕ 
(
ÕÕ 
int
ÕÕ 
i
ÕÕ 
=
ÕÕ 
Connections
ÕÕ $
.
ÕÕ$ %
Count
ÕÕ% *
;
ÕÕ* +
i
ÕÕ, -
<
ÕÕ. /

dbSettings
ÕÕ0 :
.
ÕÕ: ;
ShardingFactor
ÕÕ; I
;
ÕÕI J
i
ÕÕK L
++
ÕÕL N
)
ÕÕN O
{
ŒŒ 
Connections
œœ 
.
œœ 
Add
œœ 
(
œœ  #
GenerateSqlConnection
œœ  5
(
œœ5 6
i
œœ6 7
)
œœ7 8
)
œœ8 9
;
œœ9 : 
connectionsCreated
–– "
++
––" $
;
––$ %
}
—— 
return
““  
connectionsCreated
““ %
;
““% &
}
”” 	
public
’’ 
override
’’ 
void
’’ 
RollBack
’’ %
(
’’% &
)
’’& '
{
÷÷ 	
if
◊◊ 
(
◊◊ 
Connections
◊◊ 
!=
◊◊ 
null
◊◊ #
)
◊◊# $
{
ÿÿ 
Connections
ŸŸ 
.
ŸŸ 

AsParallel
ŸŸ &
(
ŸŸ& '
)
ŸŸ' (
.
ŸŸ( )
ForAll
ŸŸ) /
(
ŸŸ/ 0
cxn
ŸŸ0 3
=>
ŸŸ4 6
{
⁄⁄ 
try
€€ 
{
‹‹ 
cxn
›› 
.
›› 
Transaction
›› '
?
››' (
.
››( )
Rollback
››) 1
(
››1 2
)
››2 3
;
››3 4
}
ﬁﬁ 
catch
ﬂﬂ 
(
ﬂﬂ 
	Exception
ﬂﬂ $
e
ﬂﬂ% &
)
ﬂﬂ& '
{
‡‡ 
Log
·· 
.
·· 
Verbose
·· #
(
··# $
$str
··$ G
,
··G H
cxn
··I L
.
··L M
Source
··M S
,
··S T
e
··U V
.
··V W
GetType
··W ^
(
··^ _
)
··_ `
,
··` a
e
··b c
.
··c d
Message
··d k
)
··k l
;
··l m
}
‚‚ 
cxn
„„ 
.
„„ 
Transaction
„„ #
=
„„$ %
null
„„& *
;
„„* +
}
‰‰ 
)
‰‰ 
;
‰‰ 
}
ÂÂ 
}
ÊÊ 	
public
ËË 
override
ËË 
PLATFORM
ËË  
RunIdToPlatform
ËË! 0
(
ËË0 1
string
ËË1 7
runid
ËË8 =
)
ËË= >
{
ÈÈ 	
if
ÍÍ 
(
ÍÍ 
MainConnection
ÍÍ 
!=
ÍÍ !
null
ÍÍ" &
)
ÍÍ& '
{
ÎÎ 
var
ÏÏ 
Run
ÏÏ 
=
ÏÏ 
GetRun
ÏÏ  
(
ÏÏ  !
runid
ÏÏ! &
)
ÏÏ& '
;
ÏÏ' (
if
ÌÌ 
(
ÌÌ 
Run
ÌÌ 
!=
ÌÌ 
null
ÌÌ 
)
ÌÌ  
{
ÓÓ 
return
ÔÔ 
Run
ÔÔ 
.
ÔÔ 
Platform
ÔÔ '
;
ÔÔ' (
}
 
else
ÒÒ 
{
ÚÚ 
Log
ÛÛ 
.
ÛÛ 
Debug
ÛÛ 
(
ÛÛ 
$str
ÛÛ _
)
ÛÛ_ `
;
ÛÛ` a
}
ÙÙ 
}
ıı 
else
ˆˆ 
{
˜˜ 
Log
¯¯ 
.
¯¯ 
Debug
¯¯ 
(
¯¯ 
$str
¯¯ S
)
¯¯S T
;
¯¯T U
}
˘˘ 
return
˙˙ 
PLATFORM
˙˙ 
.
˙˙ 
UNKNOWN
˙˙ #
;
˙˙# $
}
˚˚ 	
public
˝˝ 
override
˝˝ 
void
˝˝ 
SetSettings
˝˝ (
(
˝˝( )
Settings
˝˝) 1
settings
˝˝2 :
)
˝˝: ;
{
˛˛ 	
if
ˇˇ 
(
ˇˇ 
MainConnection
ˇˇ 
!=
ˇˇ !
null
ˇˇ" &
&&
ˇˇ' )
MainConnection
ˇˇ* 8
.
ˇˇ8 9

Connection
ˇˇ9 C
!=
ˇˇD F
null
ˇˇG K
)
ˇˇK L
{
ÄÄ 
try
ÅÅ 
{
ÇÇ 
using
ÉÉ 
var
ÉÉ 
cmd
ÉÉ !
=
ÉÉ" #
new
ÉÉ$ '
SqliteCommand
ÉÉ( 5
(
ÉÉ5 6+
SQL_UPSERT_PERSISTED_SETTINGS
ÉÉ6 S
,
ÉÉS T
MainConnection
ÉÉU c
?
ÉÉc d
.
ÉÉd e

Connection
ÉÉe o
,
ÉÉo p
MainConnection
ÉÉq 
?ÉÉ Ä
.ÉÉÄ Å
TransactionÉÉÅ å
)ÉÉå ç
;ÉÉç é
cmd
ÑÑ 
.
ÑÑ 

Parameters
ÑÑ "
.
ÑÑ" #
AddWithValue
ÑÑ# /
(
ÑÑ/ 0
$str
ÑÑ0 =
,
ÑÑ= >
JsonConvert
ÑÑ? J
.
ÑÑJ K
SerializeObject
ÑÑK Z
(
ÑÑZ [
settings
ÑÑ[ c
)
ÑÑc d
)
ÑÑd e
;
ÑÑe f
cmd
ÖÖ 
.
ÖÖ 

Parameters
ÖÖ "
.
ÖÖ" #
AddWithValue
ÖÖ# /
(
ÖÖ/ 0
$str
ÖÖ0 5
,
ÖÖ5 6
$str
ÖÖ7 B
)
ÖÖB C
;
ÖÖC D
cmd
ÜÜ 
.
ÜÜ 
ExecuteNonQuery
ÜÜ '
(
ÜÜ' (
)
ÜÜ( )
;
ÜÜ) *
}
áá 
catch
àà 
(
àà 
SqliteException
àà &
)
àà& '
{
ââ 
Log
ää 
.
ää 
Warning
ää 
(
ää  
$str
ää  F
)
ääF G
;
ääG H
}
ãã 
}
åå 
else
çç 
{
éé 
Log
èè 
.
èè 
Warning
èè 
(
èè 
$str
èè B
)
èèB C
;
èèC D
}
êê 
}
ëë 	
public
ìì 
override
ìì 
	ASA_ERROR
ìì !
Setup
ìì" '
(
ìì' (
)
ìì( )
{
îî 	
CloseDatabase
ññ 
(
ññ 
)
ññ 
;
ññ 
if
òò 
(
òò 
!
òò %
EstablishMainConnection
òò (
(
òò( )
)
òò) *
)
òò* +
{
ôô 
Log
öö 
.
öö 
Fatal
öö 
(
öö 
Strings
öö !
.
öö! "
Get
öö" %
(
öö% &
$str
öö& G
)
ööG H
,
ööH I
Location
ööJ R
)
ööR S
;
ööS T
return
õõ 
	ASA_ERROR
õõ  
.
õõ  !4
&FAILED_TO_ESTABLISH_MAIN_DB_CONNECTION
õõ! G
;
õõG H
}
úú 
var
ûû 
settingsFromDb
ûû 
=
ûû  
GetSettings
ûû! ,
(
ûû, -
)
ûû- .
;
ûû. /
if
üü 
(
üü 
settingsFromDb
üü 
!=
üü !
null
üü" &
)
üü& '
{
†† 
FirstRun
°° 
=
°° 
false
°°  
;
°°  !
if
££ 
(
££ 
SCHEMA_VERSION
££ "
!=
££# %
settingsFromDb
££& 4
.
££4 5
SchemaVersion
££5 B
)
££B C
{
§§ 
Log
•• 
.
•• 
Fatal
•• 
(
•• 
Strings
•• %
.
••% &
Get
••& )
(
••) *
$str
••* 7
)
••7 8
,
••8 9
settingsFromDb
••: H
.
••H I
SchemaVersion
••I V
,
••V W
SCHEMA_VERSION
••X f
)
••f g
;
••g h
return
¶¶ 
	ASA_ERROR
¶¶ $
.
¶¶$ %
MATCHING_SCHEMA
¶¶% 4
;
¶¶4 5
}
ßß 
if
©© 
(
©© 
settingsFromDb
©© "
.
©©" #
ShardingFactor
©©# 1
!=
©©2 4

dbSettings
©©5 ?
.
©©? @
ShardingFactor
©©@ N
)
©©N O
{
™™ 
Log
´´ 
.
´´ 
Information
´´ #
(
´´# $
Strings
´´$ +
.
´´+ ,
Get
´´, /
(
´´/ 0
$str
´´0 H
)
´´H I
,
´´I J

dbSettings
´´K U
.
´´U V
ShardingFactor
´´V d
,
´´d e
settingsFromDb
´´f t
.
´´t u
ShardingFactor´´u É
)´´É Ñ
;´´Ñ Ö
}
¨¨ 

dbSettings
ÆÆ 
.
ÆÆ 
ShardingFactor
ÆÆ )
=
ÆÆ* +
settingsFromDb
ÆÆ, :
.
ÆÆ: ;
ShardingFactor
ÆÆ; I
;
ÆÆI J
}
ØØ 
else
∞∞ 
{
±± 
FirstRun
≤≤ 
=
≤≤ 
true
≤≤ 
;
≤≤  
}
≥≥ !
PopulateConnections
µµ 
(
µµ  
)
µµ  !
;
µµ! "
if
∑∑ 
(
∑∑ 
MainConnection
∑∑ 
==
∑∑ !
null
∑∑" &
)
∑∑& '
{
∏∏ 
Log
ππ 
.
ππ 
Fatal
ππ 
(
ππ 
Strings
ππ !
.
ππ! "
Get
ππ" %
(
ππ% &
$str
ππ& G
)
ππG H
,
ππH I
Location
ππJ R
)
ππR S
;
ππS T
return
∫∫ 
	ASA_ERROR
∫∫  
.
∫∫  !4
&FAILED_TO_ESTABLISH_MAIN_DB_CONNECTION
∫∫! G
;
∫∫G H
}
ªª 
if
ΩΩ 
(
ΩΩ 
FirstRun
ΩΩ 
)
ΩΩ 
{
ææ 
try
øø 
{
¿¿ 
BeginTransaction
¡¡ $
(
¡¡$ %
)
¡¡% &
;
¡¡& '
using
√√ 
var
√√ 
cmd2
√√ "
=
√√# $
new
√√% (
SqliteCommand
√√) 6
(
√√6 7
SQL_CREATE_RUNS
√√7 F
,
√√F G
MainConnection
√√H V
.
√√V W

Connection
√√W a
,
√√a b
MainConnection
√√c q
.
√√q r
Transaction
√√r }
)
√√} ~
;
√√~ 
cmd2
ƒƒ 
.
ƒƒ 
ExecuteNonQuery
ƒƒ (
(
ƒƒ( )
)
ƒƒ) *
;
ƒƒ* +
cmd2
∆∆ 
.
∆∆ 
CommandText
∆∆ $
=
∆∆% & 
SQL_CREATE_RESULTS
∆∆' 9
;
∆∆9 :
cmd2
«« 
.
«« 
ExecuteNonQuery
«« (
(
««( )
)
««) *
;
««* +
cmd2
…… 
.
…… 
CommandText
…… $
=
……% &)
SQL_CREATE_FINDINGS_RESULTS
……' B
;
……B C
cmd2
   
.
   
ExecuteNonQuery
   (
(
  ( )
)
  ) *
;
  * +
cmd2
ÃÃ 
.
ÃÃ 
CommandText
ÃÃ $
=
ÃÃ% &-
SQL_CREATE_FINDINGS_LEVEL_INDEX
ÃÃ' F
;
ÃÃF G
cmd2
ÕÕ 
.
ÕÕ 
ExecuteNonQuery
ÕÕ (
(
ÕÕ( )
)
ÕÕ) *
;
ÕÕ* +
cmd2
œœ 
.
œœ 
CommandText
œœ $
=
œœ% &3
%SQL_CREATE_FINDINGS_RESULT_TYPE_INDEX
œœ' L
;
œœL M
cmd2
–– 
.
–– 
ExecuteNonQuery
–– (
(
––( )
)
––) *
;
––* +
cmd2
““ 
.
““ 
CommandText
““ $
=
““% &0
"SQL_CREATE_FINDINGS_IDENTITY_INDEX
““' I
;
““I J
cmd2
”” 
.
”” 
ExecuteNonQuery
”” (
(
””( )
)
””) *
;
””* +
cmd2
’’ 
.
’’ 
CommandText
’’ $
=
’’% &9
+SQL_CREATE_FINDINGS_LEVEL_RESULT_TYPE_INDEX
’’' R
;
’’R S
cmd2
÷÷ 
.
÷÷ 
ExecuteNonQuery
÷÷ (
(
÷÷( )
)
÷÷) *
;
÷÷* +
cmd2
ÿÿ 
.
ÿÿ 
CommandText
ÿÿ $
=
ÿÿ% &+
SQL_CREATE_PERSISTED_SETTINGS
ÿÿ' D
;
ÿÿD E
cmd2
ŸŸ 
.
ŸŸ 
ExecuteNonQuery
ŸŸ (
(
ŸŸ( )
)
ŸŸ) *
;
ŸŸ* +
SetSettings
€€ 
(
€€  
new
€€  #
Settings
€€$ ,
(
€€, -
)
€€- .
{
‹‹ 
SchemaVersion
›› %
=
››& '
SCHEMA_VERSION
››( 6
,
››6 7
ShardingFactor
ﬁﬁ &
=
ﬁﬁ' (

dbSettings
ﬁﬁ) 3
.
ﬁﬁ3 4
ShardingFactor
ﬁﬁ4 B
,
ﬁﬁB C
}
ﬂﬂ 
)
ﬂﬂ 
;
ﬂﬂ 
Connections
·· 
.
··  

AsParallel
··  *
(
··* +
)
··+ ,
.
··, -
ForAll
··- 3
(
··3 4
cxn
··4 7
=>
··8 :
{
‚‚ 
using
„„ 
(
„„ 
var
„„ "
innerCmd
„„# +
=
„„, -
new
„„. 1
SqliteCommand
„„2 ?
(
„„? @(
SQL_CREATE_COLLECT_RESULTS
„„@ Z
,
„„Z [
cxn
„„\ _
.
„„_ `

Connection
„„` j
,
„„j k
cxn
„„l o
.
„„o p
Transaction
„„p {
)
„„{ |
)
„„| }
{
‰‰ 
innerCmd
ÂÂ $
.
ÂÂ$ %
ExecuteNonQuery
ÂÂ% 4
(
ÂÂ4 5
)
ÂÂ5 6
;
ÂÂ6 7
innerCmd
ÁÁ $
.
ÁÁ$ %
CommandText
ÁÁ% 0
=
ÁÁ1 2-
SQL_CREATE_COLLECT_RUN_ID_INDEX
ÁÁ3 R
;
ÁÁR S
innerCmd
ËË $
.
ËË$ %
ExecuteNonQuery
ËË% 4
(
ËË4 5
)
ËË5 6
;
ËË6 7
innerCmd
ÍÍ $
.
ÍÍ$ %
CommandText
ÍÍ% 0
=
ÍÍ1 2@
2SQL_CREATE_COLLECT_RUN_KEY_IDENTITY_COMBINED_INDEX
ÍÍ3 e
;
ÍÍe f
innerCmd
ÎÎ $
.
ÎÎ$ %
ExecuteNonQuery
ÎÎ% 4
(
ÎÎ4 5
)
ÎÎ5 6
;
ÎÎ6 7
innerCmd
ÌÌ $
.
ÌÌ$ %
CommandText
ÌÌ% 0
=
ÌÌ1 26
(SQL_CREATE_COLLECT_RUN_ID_IDENTITY_INDEX
ÌÌ3 [
;
ÌÌ[ \
innerCmd
ÓÓ $
.
ÓÓ$ %
ExecuteNonQuery
ÓÓ% 4
(
ÓÓ4 5
)
ÓÓ5 6
;
ÓÓ6 7
}
ÔÔ 
}
 
)
 
;
 
}
ÒÒ 
catch
ÚÚ 
(
ÚÚ 
SqliteException
ÚÚ &
e
ÚÚ' (
)
ÚÚ( )
{
ÛÛ 
Log
ÙÙ 
.
ÙÙ 
Debug
ÙÙ 
(
ÙÙ 
e
ÙÙ 
,
ÙÙ  
$str
ÙÙ! C
)
ÙÙC D
;
ÙÙD E
return
ıı 
	ASA_ERROR
ıı $
.
ıı$ %'
FAILED_TO_CREATE_DATABASE
ıı% >
;
ıı> ?
}
ˆˆ 
finally
˜˜ 
{
¯¯ 
Commit
˘˘ 
(
˘˘ 
)
˘˘ 
;
˘˘ 
}
˙˙ 
}
˚˚ 
return
¸¸ 
	ASA_ERROR
¸¸ 
.
¸¸ 
NONE
¸¸ !
;
¸¸! "
}
˝˝ 	
public
ˇˇ 
void
ˇˇ ;
-StallIfHighMemoryUsageAndLowMemoryModeEnabled
ˇˇ A
(
ˇˇA B
)
ˇˇB C
{
ÄÄ 	
if
ÅÅ 
(
ÅÅ 

dbSettings
ÅÅ 
.
ÅÅ 
LowMemoryUsage
ÅÅ )
)
ÅÅ) *
{
ÇÇ 
int
ÉÉ 

stallCount
ÉÉ 
=
ÉÉ  
$num
ÉÉ! "
;
ÉÉ" #
while
ÑÑ 
(
ÑÑ 
	QueueSize
ÑÑ  
>
ÑÑ! "
LOW_MEMORY_CUTOFF
ÑÑ# 4
)
ÑÑ4 5
{
ÖÖ 
if
ÜÜ 
(
ÜÜ 

stallCount
ÜÜ "
++
ÜÜ" $
%
ÜÜ% &
$num
ÜÜ' +
==
ÜÜ, .
$num
ÜÜ/ 0
)
ÜÜ0 1
{
áá 
Log
àà 
.
àà 
Verbose
àà #
(
àà# $
$str
àà$ Z
,
ààZ [
	QueueSize
àà\ e
)
ààe f
;
ààf g
}
ââ 
Thread
ää 
.
ää 
Sleep
ää  
(
ää  !
$num
ää! "
)
ää" #
;
ää# $
}
ãã 
}
åå 
}
çç 	
public
èè 
override
èè 
void
èè 
TrimToLatest
èè )
(
èè) *
)
èè* +
{
êê 	
if
ëë 
(
ëë 
MainConnection
ëë 
!=
ëë !
null
ëë" &
)
ëë& '
{
íí 
using
ìì 
var
ìì 
cmd
ìì 
=
ìì 
new
ìì  #
SqliteCommand
ìì$ 1
(
ìì1 2
GET_RUNS
ìì2 :
,
ìì: ;
MainConnection
ìì< J
.
ììJ K

Connection
ììK U
,
ììU V
MainConnection
ììW e
.
ììe f
Transaction
ììf q
)
ììq r
;
ììr s
using
îî 
(
îî 
var
îî 
reader
îî !
=
îî" #
cmd
îî$ '
.
îî' (
ExecuteReader
îî( 5
(
îî5 6
)
îî6 7
)
îî7 8
{
ïï 
reader
óó 
.
óó 
Read
óó 
(
óó  
)
óó  !
;
óó! "
while
ôô 
(
ôô 
reader
ôô !
.
ôô! "
Read
ôô" &
(
ôô& '
)
ôô' (
)
ôô( )
{
öö 
	DeleteRun
õõ !
(
õõ! "
(
õõ" #
string
õõ# )
)
õõ) *
reader
õõ* 0
[
õõ0 1
$str
õõ1 9
]
õõ9 :
)
õõ: ;
;
õõ; <
}
úú 
}
ùù 
}
ûû 
else
üü 
{
†† 
Log
°° 
.
°° 
Debug
°° 
(
°° 
$str
°° C
)
°°C D
;
°°D E
}
¢¢ 
}
££ 	
public
•• 
override
•• 
void
•• 
UpdateCompareRun
•• -
(
••- .
string
••. 4
?
••4 5

firstRunId
••6 @
,
••@ A
string
••B H
secondRunId
••I T
,
••T U

RUN_STATUS
••V `
	runStatus
••a j
)
••j k
{
¶¶ 	
_
ßß 
=
ßß 
MainConnection
ßß 
??
ßß !
throw
ßß" '
new
ßß( +$
NullReferenceException
ßß, B
(
ßßB C
Strings
ßßC J
.
ßßJ K
Get
ßßK N
(
ßßN O
$str
ßßO _
)
ßß_ `
)
ßß` a
;
ßßa b
using
®® 
(
®® 
var
®® 
cmd
®® 
=
®® 
new
®®  
SqliteCommand
®®! .
(
®®. /(
UPDATE_RUN_IN_RESULT_TABLE
®®/ I
,
®®I J
MainConnection
®®K Y
.
®®Y Z

Connection
®®Z d
,
®®d e
MainConnection
®®f t
.
®®t u
Transaction®®u Ä
)®®Ä Å
)®®Å Ç
{
©© 
cmd
™™ 
.
™™ 

Parameters
™™ 
.
™™ 
AddWithValue
™™ +
(
™™+ ,
$str
™™, :
,
™™: ;

firstRunId
™™< F
??
™™G I
string
™™J P
.
™™P Q
Empty
™™Q V
)
™™V W
;
™™W X
cmd
´´ 
.
´´ 

Parameters
´´ 
.
´´ 
AddWithValue
´´ +
(
´´+ ,
$str
´´, =
,
´´= >
secondRunId
´´? J
)
´´J K
;
´´K L
cmd
¨¨ 
.
¨¨ 

Parameters
¨¨ 
.
¨¨ 
AddWithValue
¨¨ +
(
¨¨+ ,
$str
¨¨, 5
,
¨¨5 6
	runStatus
¨¨7 @
)
¨¨@ A
;
¨¨A B
cmd
≠≠ 
.
≠≠ 
ExecuteNonQuery
≠≠ #
(
≠≠# $
)
≠≠$ %
;
≠≠% &
}
ÆÆ 
}
ØØ 	
public
±± 
override
±± 
void
±± 
Vacuum
±± #
(
±±# $
)
±±$ %
{
≤≤ 	
Connections
≥≥ 
.
≥≥ 

AsParallel
≥≥ "
(
≥≥" #
)
≥≥# $
.
≥≥$ %
ForAll
≥≥% +
(
≥≥+ ,
cxn
≥≥, /
=>
≥≥0 2
{
¥¥ 
using
µµ 
var
µµ 
	inner_cmd
µµ #
=
µµ$ %
new
µµ& )
SqliteCommand
µµ* 7
(
µµ7 8

SQL_VACUUM
µµ8 B
,
µµB C
cxn
µµD G
.
µµG H

Connection
µµH R
,
µµR S
cxn
µµT W
.
µµW X
Transaction
µµX c
)
µµc d
;
µµd e
	inner_cmd
∂∂ 
.
∂∂ 
ExecuteNonQuery
∂∂ )
(
∂∂) *
)
∂∂* +
;
∂∂+ ,
}
∑∑ 
)
∑∑ 
;
∑∑ 
}
∏∏ 	
public
∫∫ 
override
∫∫ 
void
∫∫ 
Write
∫∫ "
(
∫∫" #
CollectObject
∫∫# 0
?
∫∫0 1
colObj
∫∫2 8
,
∫∫8 9
string
∫∫: @
?
∫∫@ A
runId
∫∫B G
)
∫∫G H
{
ªª 	
if
ºº 
(
ºº 
colObj
ºº 
!=
ºº 
null
ºº 
&&
ºº !
runId
ºº" '
!=
ºº( *
null
ºº+ /
)
ºº/ 0
{
ΩΩ 
var
ææ 
objIn
ææ 
=
ææ 
new
ææ 
WriteObject
ææ  +
(
ææ+ ,
colObj
ææ, 2
,
ææ2 3
runId
ææ4 9
)
ææ9 :
;
ææ: ;
Connections
øø 
[
øø 
ModuloString
øø (
(
øø( )
objIn
øø) .
.
øø. /
Identity
øø/ 7
,
øø7 8
shardingFactor
øø9 G
:
øøG H

dbSettings
øøI S
.
øøS T
ShardingFactor
øøT b
)
øøb c
]
øøc d
.
øød e

WriteQueue
øøe o
.
øøo p
Push
øøp t
(
øøt u
objIn
øøu z
)
øøz {
;
øø{ |
}
¿¿ 
}
¡¡ 	
private
√√ 
const
√√ 
string
√√ $
GET_COMPARISON_RESULTS
√√ 3
=
√√4 5
$str√√6 ∆
;√√∆ «
private
ƒƒ 
const
ƒƒ 
string
ƒƒ *
GET_COMPARISON_RESULTS_LIMIT
ƒƒ 9
=
ƒƒ: ;
$strƒƒ< Ç
;ƒƒÇ É
private
≈≈ 
const
≈≈ 
string
≈≈ !
GET_MONITOR_RESULTS
≈≈ 0
=
≈≈1 2
$str
≈≈3 s
;
≈≈s t
private
∆∆ 
const
∆∆ 
string
∆∆ '
GET_MONITOR_RESULTS_LIMIT
∆∆ 6
=
∆∆7 8
$str∆∆9 é
;∆∆é è
private
»» 
const
»» 
string
»» 
GET_RESULT_COUNT
»» -
=
»». /
$str»»0 ”
;»»” ‘
private
   
const
   
string
   (
GET_RESULT_COUNT_MONITORED
   7
=
  8 9
$str
  : |
;
  | }
private
ÃÃ 
const
ÃÃ 
string
ÃÃ 
GET_RUNS
ÃÃ %
=
ÃÃ& '
$str
ÃÃ( V
;
ÃÃV W
private
ÕÕ 
const
ÕÕ 
string
ÕÕ $
GET_SERIALIZED_RESULTS
ÕÕ 3
=
ÕÕ4 5
$strÕÕ6 à
;ÕÕà â
private
ŒŒ 
const
ŒŒ 
string
ŒŒ .
 INSERT_RUN_INTO_RESULT_TABLE_SQL
ŒŒ =
=
ŒŒ> ?
$strŒŒ@ À
;ŒŒÀ Ã
private
œœ 
const
œœ 
int
œœ 
SCHEMA_VERSION
œœ (
=
œœ) *
$num
œœ+ -
;
œœ- .
private
–– 
const
–– 
string
–– :
,SQL_CHECK_IF_COMPARISON_PREVIOUSLY_COMPLETED
–– I
=
––J K
$str––L ∆
;––∆ «
private
—— 
const
—— 
string
—— (
SQL_CREATE_COLLECT_RESULTS
—— 7
=
——8 9
$str——: ÷
;——÷ ◊
private
““ 
const
““ 
string
““ 6
(SQL_CREATE_COLLECT_RUN_ID_IDENTITY_INDEX
““ E
=
““F G
$str““H £
;““£ §
private
”” 
const
”” 
string
”” -
SQL_CREATE_COLLECT_RUN_ID_INDEX
”” <
=
””= >
$str””? á
;””á à
private
‘‘ 
const
‘‘ 
string
‘‘ @
2SQL_CREATE_COLLECT_RUN_KEY_IDENTITY_COMBINED_INDEX
‘‘ O
=
‘‘P Q
$str‘‘R ¬
;‘‘¬ √
private
’’ 
const
’’ 
string
’’ 0
"SQL_CREATE_FINDINGS_IDENTITY_INDEX
’’ ?
=
’’@ A
$str’’B à
;’’à â
private
÷÷ 
const
÷÷ 
string
÷÷ -
SQL_CREATE_FINDINGS_LEVEL_INDEX
÷÷ <
=
÷÷= >
$str
÷÷? 
;÷÷ Ä
private
◊◊ 
const
◊◊ 
string
◊◊ 9
+SQL_CREATE_FINDINGS_LEVEL_RESULT_TYPE_INDEX
◊◊ H
=
◊◊I J
$str◊◊K §
;◊◊§ •
private
ÿÿ 
const
ÿÿ 
string
ÿÿ 3
%SQL_CREATE_FINDINGS_RESULT_TYPE_INDEX
ÿÿ B
=
ÿÿC D
$strÿÿE ë
;ÿÿë í
private
ŸŸ 
const
ŸŸ 
string
ŸŸ )
SQL_CREATE_FINDINGS_RESULTS
ŸŸ 8
=
ŸŸ9 :
$strŸŸ; å
;ŸŸå ç
private
⁄⁄ 
const
⁄⁄ 
string
⁄⁄ +
SQL_CREATE_PERSISTED_SETTINGS
⁄⁄ :
=
⁄⁄; <
$str⁄⁄= ì
;⁄⁄ì î
private
€€ 
const
€€ 
string
€€  
SQL_CREATE_RESULTS
€€ /
=
€€0 1
$str€€2 †
;€€† °
private
‹‹ 
const
‹‹ 
string
‹‹ 
SQL_CREATE_RUNS
‹‹ ,
=
‹‹- .
$str‹‹/ å
;‹‹å ç
private
›› 
const
›› 
string
›› 
SQL_DELETE_RUN
›› +
=
››, -
$str
››. X
;
››X Y
private
ﬁﬁ 
const
ﬁﬁ 
string
ﬁﬁ $
SQL_DELETE_COMPARE_RUN
ﬁﬁ 3
=
ﬁﬁ4 5
$strﬁﬁ6 Æ
;ﬁﬁÆ Ø
private
ﬂﬂ 
const
ﬂﬂ 
string
ﬂﬂ *
SQL_GET_COLLECT_MISSING_IN_B
ﬂﬂ 9
=
ﬂﬂ: ;
$strﬂﬂ< Ã
;ﬂﬂÃ Õ
private
·· 
const
·· 
string
·· &
SQL_GET_COLLECT_MODIFIED
·· 5
=
··6 7
$str··8 ö
+··õ ú
$str‚‚< ñ
+‚‚ó ò
$str
„„@ ~
+„„ Ä
$str
‰‰D |
+
‰‰} ~
$strÂÂH §
+ÂÂ• ¶
$strÊÊL ®
;ÊÊ® ©
private
ËË 
const
ËË 
string
ËË !
SQL_GET_NUM_RESULTS
ËË 0
=
ËË1 2
$strËË3 î
;ËËî ï
private
ÈÈ 
const
ÈÈ 
string
ÈÈ (
SQL_GET_PERSISTED_SETTINGS
ÈÈ 7
=
ÈÈ8 9
$str
ÈÈ: r
;
ÈÈr s
private
ÍÍ 
const
ÍÍ 
string
ÍÍ )
SQL_GET_RESULT_TYPES_COUNTS
ÍÍ 8
=
ÍÍ9 :
$strÍÍ; ö
;ÍÍö õ
private
ÎÎ 
const
ÎÎ 
string
ÎÎ '
SQL_GET_RESULTS_BY_RUN_ID
ÎÎ 6
=
ÎÎ7 8
$str
ÎÎ9 g
;
ÎÎg h
private
ÏÏ 
const
ÏÏ 
string
ÏÏ 
SQL_GET_RUN
ÏÏ (
=
ÏÏ) *
$str
ÏÏ+ V
;
ÏÏV W
private
ÌÌ 
const
ÌÌ 
string
ÌÌ )
SQL_GET_UNIQUE_BETWEEN_RUNS
ÌÌ 8
=
ÌÌ9 :
$strÌÌ; Ë
;ÌÌË È
private
ÓÓ 
const
ÓÓ 
string
ÓÓ 2
$SQL_GET_UNIQUE_BETWEEN_RUNS_EXPLICIT
ÓÓ A
=
ÓÓB C
$strÓÓD ù
;ÓÓù û
private
ÔÔ 
const
ÔÔ 
string
ÔÔ (
SQL_INSERT_FINDINGS_RESULT
ÔÔ 7
=
ÔÔ8 9
$strÔÔ: ‚
;ÔÔ‚ „
private
 
const
 
string
 
SQL_INSERT_RUN
 +
=
, -
$str. Ä
;Ä Å
private
ÒÒ 
const
ÒÒ 
string
ÒÒ  
SQL_QUERY_ANALYZED
ÒÒ /
=
ÒÒ0 1
$str
ÒÒ2 `
;
ÒÒ` a
private
ÚÚ 
const
ÚÚ 
string
ÚÚ &
SQL_SELECT_LATEST_N_RUNS
ÚÚ 5
=
ÚÚ6 7
$strÚÚ8 à
;ÚÚà â
private
ÛÛ 
const
ÛÛ 
string
ÛÛ %
SQL_SELECT_RUNS_BY_TYPE
ÛÛ 4
=
ÛÛ5 6
$str
ÛÛ7 ~
;
ÛÛ~ 
private
ÙÙ 
const
ÙÙ 
string
ÙÙ 
SQL_SELECT_RUNS
ÙÙ ,
=
ÙÙ- .
$str
ÙÙ/ e
;
ÙÙe f
private
ıı 
const
ıı 
string
ıı %
SQL_SELECT_COMPARE_RUNS
ıı 4
=
ıı5 6
$str
ıı7 a
;
ııa b
private
ˆˆ 
const
ˆˆ 
string
ˆˆ 
SQL_TRUNCATE_RUN
ˆˆ -
=
ˆˆ. /
$str
ˆˆ0 W
;
ˆˆW X
private
˜˜ 
const
˜˜ 
string
˜˜ &
SQL_TRUNCATE_COMPARE_RUN
˜˜ 5
=
˜˜6 7
$str˜˜8 ±
;˜˜± ≤
private
¯¯ 
const
¯¯ 
string
¯¯ +
SQL_UPSERT_PERSISTED_SETTINGS
¯¯ :
=
¯¯; <
$str¯¯= ì
;¯¯ì î
private
˙˙ 
const
˙˙ 
string
˙˙ 

SQL_VACUUM
˙˙ '
=
˙˙( )
$str
˙˙* 2
;
˙˙2 3
private
¸¸ 
const
¸¸ 
string
¸¸ (
UPDATE_RUN_IN_RESULT_TABLE
¸¸ 7
=
¸¸8 9
$str¸¸: ß
;¸¸ß ®
private
˛˛ 

DBSettings
˛˛ 

dbSettings
˛˛ %
=
˛˛& '
new
˛˛( +

DBSettings
˛˛, 6
(
˛˛6 7
)
˛˛7 8
;
˛˛8 9
private
Ä	Ä	 !
SqlConnectionHolder
Ä	Ä	 ##
GenerateSqlConnection
Ä	Ä	$ 9
(
Ä	Ä	9 :
int
Ä	Ä	: =
i
Ä	Ä	> ?
)
Ä	Ä	? @
{
Å	Å	 	
if
Ç	Ç	 
(
Ç	Ç	 
i
Ç	Ç	 
==
Ç	Ç	 
$num
Ç	Ç	 
)
Ç	Ç	 
{
É	É	 
return
Ñ	Ñ	 
new
Ñ	Ñ	 !
SqlConnectionHolder
Ñ	Ñ	 .
(
Ñ	Ñ	. /
Location
Ñ	Ñ	/ 7
,
Ñ	Ñ	7 8

dbSettings
Ñ	Ñ	9 C
)
Ñ	Ñ	C D
;
Ñ	Ñ	D E
}
Ö	Ö	 
else
Ü	Ü	 
{
á	á	 
return
à	à	 
new
à	à	 !
SqlConnectionHolder
à	à	 .
(
à	à	. /
$"
à	à	/ 1
{
à	à	1 2
Location
à	à	2 :
}
à	à	: ;
$str
à	à	; <
{
à	à	< =
i
à	à	= >
}
à	à	> ?
"
à	à	? @
,
à	à	@ A

dbSettings
à	à	B L
)
à	à	L M
;
à	à	M N
}
â	â	 
}
ä	ä	 	
}
ã	ã	 
}å	å	 ≈
@D:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\Strings.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Utils. 3
{		 
public

 

static

 
class

 
Strings

 
{ 
public 
static 
string 
Get  
(  !
string! '
key( +
)+ ,
{ 	
if 
( 

stringList 
. 
ContainsKey &
(& '
key' *
)* +
)+ ,
{ 
return 

stringList !
[! "
key" %
]% &
;& '
} 
return 
key 
; 
} 	
public 
static 
void 
Setup  
(  !
string! '
locale( .
=/ 0
$str1 3
)3 4
{ 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
locale% +
)+ ,
), -
{ 
using 
Stream 
? 
stream $
=% &
typeof' -
(- .
FileSystemObject. >
)> ?
.? @
Assembly@ H
.H I%
GetManifestResourceStreamI b
(b c
$str	c ô
)
ô ö
;
ö õ
if 
( 
stream 
is 
Stream $
)$ %
{ 

stringList 
. 
Clear $
($ %
)% &
;& '
using 
ResourceReader (
reader) /
=0 1
new2 5
ResourceReader6 D
(D E
streamE K
)K L
;L M
foreach 
( 
DictionaryEntry ,
?, -
entry. 3
in4 6
reader7 =
)= >
{ 
if   
(   
entry   !
is  " $
DictionaryEntry  % 4
dictionaryEntry  5 D
)  D E
{!! 
var"" 
keyStr""  &
=""' (
dictionaryEntry"") 8
.""8 9
Key""9 <
.""< =
ToString""= E
(""E F
)""F G
;""G H
var## 
valueStr##  (
=##) *
dictionaryEntry##+ :
.##: ;
Value##; @
?##@ A
.##A B
ToString##B J
(##J K
)##K L
;##L M
if$$ 
($$  
!$$  !
string$$! '
.$$' (
IsNullOrEmpty$$( 5
($$5 6
keyStr$$6 <
)$$< =
&&$$> @
!$$A B
string$$B H
.$$H I
IsNullOrEmpty$$I V
($$V W
valueStr$$W _
)$$_ `
)$$` a

stringList%%  *
.%%* +
TryAdd%%+ 1
(%%1 2
keyStr%%2 8
,%%8 9
valueStr%%: B
)%%B C
;%%C D
}&& 
}'' 
}(( 
})) 
}** 	
private// 
static// 
readonly// 

Dictionary//  *
<//* +
string//+ 1
,//1 2
string//3 9
>//9 :

stringList//; E
=//F G
new//H K

Dictionary//L V
<//V W
string//W ]
,//] ^
string//_ e
>//e f
(//f g
)//g h
;//h i
}00 
}11 ®o
TD:\sonarcube_projects\AttackSurfaceAnalyzer\Lib\Utils\Win32OpenPortListenerHelper.cs
	namespace

 	
	Microsoft


 
.

 
CST

 
.

 !
AttackSurfaceAnalyzer

 -
.

- .
Utils

. 3
{ 
public 

static 
class 
Win32ProcessPorts )
{ 
public 
static 
List 
< 
ProcessPort &
>& '
ProcessPortMap( 6
{ 	
get 
{ 
if 
(  
CachedProcessPortMap (
==) +
null, 0
)0 1
{  
CachedProcessPortMap (
=) *
GetNetStatPorts+ :
(: ;
); <
;< =
} 
return  
CachedProcessPortMap +
;+ ,
} 
} 	
private   
static   
List   
<   
ProcessPort   '
>  ' (
?  ( ) 
CachedProcessPortMap  * >
=  ? @
null  A E
;  E F
private'' 
static'' 
List'' 
<'' 
ProcessPort'' '
>''' (
GetNetStatPorts'') 8
(''8 9
)''9 :
{(( 	
List)) 
<)) 
ProcessPort)) 
>)) 
ProcessPorts)) *
=))+ ,
new))- 0
List))1 5
<))5 6
ProcessPort))6 A
>))A B
())B C
)))C D
;))D E
try++ 
{,, 
using-- 
(-- 
Process-- 
Proc-- #
=--$ %
new--& )
Process--* 1
(--1 2
)--2 3
)--3 4
{.. 
ProcessStartInfo// $
	StartInfo//% .
=/// 0
new//1 4
ProcessStartInfo//5 E
(//E F
)//F G
{00 
FileName11  
=11! "
$str11# 0
,110 1
	Arguments22 !
=22" #
$str22$ .
,22. /
WindowStyle33 #
=33$ %
ProcessWindowStyle33& 8
.338 9
Hidden339 ?
,33? @
UseShellExecute44 '
=44( )
false44* /
,44/ 0!
RedirectStandardInput55 -
=55. /
true550 4
,554 5"
RedirectStandardOutput66 .
=66/ 0
true661 5
,665 6!
RedirectStandardError77 -
=77. /
true770 4
}88 
;88 
Proc:: 
.:: 
	StartInfo:: "
=::# $
	StartInfo::% .
;::. /
Proc;; 
.;; 
Start;; 
(;; 
);;  
;;;  !
StreamReader==  
StandardOutput==! /
===0 1
Proc==2 6
.==6 7
StandardOutput==7 E
;==E F
StreamReader>>  
StandardError>>! .
=>>/ 0
Proc>>1 5
.>>5 6
StandardError>>6 C
;>>C D
string@@ 
NetStatContent@@ )
=@@* +
StandardOutput@@, :
.@@: ;
	ReadToEnd@@; D
(@@D E
)@@E F
+@@G H
StandardError@@I V
.@@V W
	ReadToEnd@@W `
(@@` a
)@@a b
;@@b c
ifBB 
(BB 
ProcBB 
.BB 
ExitCodeBB %
!=BB& (
$numBB) *
)BB* +
{CC 
LogDD 
.DD 
ErrorDD !
(DD! "
$strDD" `
)DD` a
;DDa b
returnEE 
ProcessPortsEE +
;EE+ ,
}FF 
stringHH 
[HH 
]HH 
NetStatRowsHH (
=HH) *
RegexHH+ 0
.HH0 1
SplitHH1 6
(HH6 7
NetStatContentHH7 E
,HHE F
$strHHG M
)HHM N
;HHN O
foreachJJ 
(JJ 
varJJ  
_outputLineJJ! ,
inJJ- /
NetStatRowsJJ0 ;
)JJ; <
{KK 
ifLL 
(LL 
_outputLineLL '
==LL( *
nullLL+ /
)LL/ 0
{MM 
continueNN $
;NN$ %
}OO 
varQQ 

outputLineQQ &
=QQ' (
_outputLineQQ) 4
.QQ4 5
TrimQQ5 9
(QQ9 :
)QQ: ;
;QQ; <
stringSS 
[SS 
]SS  
TokensSS! '
=SS( )
RegexSS* /
.SS/ 0
SplitSS0 5
(SS5 6

outputLineSS6 @
,SS@ A
$strSSB H
)SSH I
;SSI J
tryTT 
{UU 
ifVV 
(VV  
TokensVV  &
.VV& '
LengthVV' -
<VV. /
$numVV0 1
)VV1 2
{WW 
continueXX  (
;XX( )
}YY 
stringZZ "
	IpAddressZZ# ,
=ZZ- .
RegexZZ/ 4
.ZZ4 5
ReplaceZZ5 <
(ZZ< =
TokensZZ= C
[ZZC D
$numZZD E
]ZZE F
,ZZF G
$strZZH T
,ZZT U
$strZZV _
)ZZ_ `
;ZZ` a
if\\ 
(\\  
Tokens\\  &
.\\& '
Length\\' -
>\\. /
$num\\0 1
&&\\2 4
Tokens\\5 ;
[\\; <
$num\\< =
]\\= >
.\\> ?
Equals\\? E
(\\E F
$str\\F K
)\\K L
)\\L M
{]] 
if^^  "
(^^# $
!^^$ %
Tokens^^% +
[^^+ ,
$num^^, -
]^^- .
.^^. /
Equals^^/ 5
(^^5 6
$str^^6 A
)^^A B
)^^B C
{^^D E
continue^^F N
;^^N O
}^^P Q
ProcessPorts__  ,
.__, -
Add__- 0
(__0 1
new__1 4
ProcessPort__5 @
(__@ A
GetProcessName``$ 2
(``2 3
Convert``3 :
.``: ;
ToInt32``; B
(``B C
Tokens``C I
[``I J
$num``J K
]``K L
,``L M
CultureInfo``N Y
.``Y Z
InvariantCulture``Z j
)``j k
)``k l
,``l m
Convertaa$ +
.aa+ ,
ToInt32aa, 3
(aa3 4
Tokensaa4 :
[aa: ;
$numaa; <
]aa< =
,aa= >
CultureInfoaa? J
.aaJ K
InvariantCultureaaK [
)aa[ \
,aa\ ]
	IpAddressbb$ -
.bb- .
Containsbb. 6
(bb6 7
$strbb7 @
)bb@ A
?bbB C
$"bbD F
{bbF G
TokensbbG M
[bbM N
$numbbN O
]bbO P
}bbP Q
$strbbQ S
"bbS T
:bbU V
$"bbW Y
{bbY Z
TokensbbZ `
[bb` a
$numbba b
]bbb c
}bbc d
$strbbd f
"bbf g
,bbg h
Convertcc$ +
.cc+ ,
ToInt32cc, 3
(cc3 4
	IpAddresscc4 =
.cc= >
Splitcc> C
(ccC D
$charccD G
)ccG H
[ccH I
$numccI J
]ccJ K
,ccK L
CultureInfoccM X
.ccX Y
InvariantCultureccY i
)cci j
)dd  !
)dd! "
;dd" #
}ee 
elseff  
ifff! #
(ff$ %
Tokensff% +
.ff+ ,
Lengthff, 2
==ff3 5
$numff6 7
&&ff8 :
(ff; <
Tokensff< B
[ffB C
$numffC D
]ffD E
.ffE F
EqualsffF L
(ffL M
$strffM R
)ffR S
)ffS T
)ffT U
{gg 
ProcessPortshh  ,
.hh, -
Addhh- 0
(hh0 1
newhh1 4
ProcessPorthh5 @
(hh@ A
GetProcessNameii$ 2
(ii2 3
Convertii3 :
.ii: ;
ToInt32ii; B
(iiB C
TokensiiC I
[iiI J
$numiiJ K
]iiK L
,iiL M
CultureInfoiiN Y
.iiY Z
InvariantCultureiiZ j
)iij k
)iik l
,iil m
Convertjj$ +
.jj+ ,
ToInt32jj, 3
(jj3 4
Tokensjj4 :
[jj: ;
$numjj; <
]jj< =
,jj= >
CultureInfojj? J
.jjJ K
InvariantCulturejjK [
)jj[ \
,jj\ ]
	IpAddresskk$ -
.kk- .
Containskk. 6
(kk6 7
$strkk7 @
)kk@ A
?kkB C
$"kkD F
{kkF G
TokenskkG M
[kkM N
$numkkN O
]kkO P
}kkP Q
$strkkQ S
"kkS T
:kkU V
$"kkW Y
{kkY Z
TokenskkZ `
[kk` a
$numkka b
]kkb c
}kkc d
$strkkd f
"kkf g
,kkg h
Convertll$ +
.ll+ ,
ToInt32ll, 3
(ll3 4
	IpAddressll4 =
.ll= >
Splitll> C
(llC D
$charllD G
)llG H
[llH I
$numllI J
]llJ K
,llK L
CultureInfollM X
.llX Y
InvariantCulturellY i
)lli j
)mm  !
)mm! "
;mm" #
}nn 
elseoo  
{pp 
ifqq  "
(qq# $
!qq$ %

outputLineqq% /
.qq/ 0

StartsWithqq0 :
(qq: ;
$strqq; B
)qqB C
&&qqD F
!qqG H

outputLineqqH R
.qqR S

StartsWithqqS ]
(qq] ^
$strqq^ f
)qqf g
&&qqh j
!qqk l
Stringqql r
.qqr s
IsNullOrWhiteSpace	qqs Ö
(
qqÖ Ü

outputLine
qqÜ ê
)
qqê ë
)
qqë í
{rr  !
Logss$ '
.ss' (
Warningss( /
(ss/ 0
$strss0 o
,sso p

outputLinessq {
)ss{ |
;ss| }
}tt  !
}uu 
}vv 
catchww 
(ww 
	Exceptionww (
eww) *
)ww* +
{xx 
Logyy 
.yy  
Warningyy  '
(yy' (
$stryy( i
,yyi j

outputLineyyk u
)yyu v
;yyv w
}zz 
}{{ 
}|| 
}}} 
catch~~ 
(~~ 
	Exception~~ 
ex~~ 
)~~  
{ 
Log
ÄÄ 
.
ÄÄ 
Warning
ÄÄ 
(
ÄÄ 
$str
ÄÄ >
,
ÄÄ> ?
ex
ÄÄ@ B
.
ÄÄB C
Message
ÄÄC J
)
ÄÄJ K
;
ÄÄK L
}
ÅÅ 
return
ÇÇ 
ProcessPorts
ÇÇ 
;
ÇÇ  
}
ÉÉ 	
private
ää 
static
ää 
string
ää 
GetProcessName
ää ,
(
ää, -
int
ää- 0
	ProcessId
ää1 :
)
ää: ;
{
ãã 	
try
åå 
{
çç 
return
éé 
Process
éé 
.
éé 
GetProcessById
éé -
(
éé- .
	ProcessId
éé. 7
)
éé7 8
.
éé8 9

MainModule
éé9 C
.
ééC D
FileName
ééD L
;
ééL M
}
èè 
catch
êê 
{
ëë 
return
íí 
$str
íí 
;
íí 
}
ìì 
}
îî 	
}
ïï 
public
öö 

class
öö 
ProcessPort
öö 
{
õõ 
public
úú 
int
úú 

PortNumber
úú 
{
ùù 	
get
ûû 
{
ûû 
return
ûû 
_PortNumber
ûû $
;
ûû$ %
}
ûû& '
}
üü 	
public
°° 
int
°° 
	ProcessId
°° 
{
¢¢ 	
get
££ 
{
££ 
return
££ 

_ProcessId
££ #
;
££# $
}
££% &
}
§§ 	
public
¶¶ 
string
¶¶ 
ProcessName
¶¶ !
{
ßß 	
get
®® 
{
®® 
return
®® 
_ProcessName
®® %
;
®®% &
}
®®' (
}
©© 	
public
´´ 
string
´´ $
ProcessPortDescription
´´ ,
{
¨¨ 	
get
≠≠ 
{
ÆÆ 
return
ØØ 
string
ØØ 
.
ØØ 
Format
ØØ $
(
ØØ$ %
CultureInfo
ØØ% 0
.
ØØ0 1
InvariantCulture
ØØ1 A
,
ØØA B
$str
ØØC _
,
ØØ_ `
_ProcessName
ØØa m
,
ØØm n
	_Protocol
ØØo x
,
ØØx y
_PortNumberØØz Ö
,ØØÖ Ü

_ProcessIdØØá ë
)ØØë í
;ØØí ì
}
∞∞ 
}
±± 	
public
≥≥ 
string
≥≥ 
Protocol
≥≥ 
{
¥¥ 	
get
µµ 
{
µµ 
return
µµ 
	_Protocol
µµ "
;
µµ" #
}
µµ$ %
}
∂∂ 	
internal
øø 
ProcessPort
øø 
(
øø 
string
øø #
ProcessName
øø$ /
,
øø/ 0
int
øø1 4
	ProcessId
øø5 >
,
øø> ?
string
øø@ F
Protocol
øøG O
,
øøO P
int
øøQ T

PortNumber
øøU _
)
øø_ `
{
¿¿ 	
_ProcessName
¡¡ 
=
¡¡ 
ProcessName
¡¡ &
;
¡¡& '

_ProcessId
¬¬ 
=
¬¬ 
	ProcessId
¬¬ "
;
¬¬" #
	_Protocol
√√ 
=
√√ 
Protocol
√√  
;
√√  !
_PortNumber
ƒƒ 
=
ƒƒ 

PortNumber
ƒƒ $
;
ƒƒ$ %
}
≈≈ 	
private
«« 
readonly
«« 
int
«« 
_PortNumber
«« (
=
««) *
$num
««+ ,
;
««, -
private
»» 
readonly
»» 
int
»» 

_ProcessId
»» '
=
»»( )
$num
»»* +
;
»»+ ,
private
…… 
readonly
…… 
string
…… 
_ProcessName
……  ,
=
……- .
String
……/ 5
.
……5 6
Empty
……6 ;
;
……; <
private
   
readonly
   
string
   
	_Protocol
    )
=
  * +
String
  , 2
.
  2 3
Empty
  3 8
;
  8 9
}
ÀÀ 
}ÃÃ 