Ã$
:D:\sonarcube_projects\AttackSurfaceAnalyzer\Cli\AppData.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Cli. 1
{ 
public 

class 
AppData 
{ 
public		 !
CollectCommandOptions		 $
CollectOptions		% 3
{		4 5
get		6 9
;		9 :
set		; >
;		> ?
}		@ A
=		B C
new		D G!
CollectCommandOptions		H ]
(		] ^
)		^ _
;		_ `
public

 !
MonitorCommandOptions

 $
MonitorOptions

% 3
{

4 5
get

6 9
;

9 :
set

; >
;

> ?
}

@ A
=

B C
new

D G!
MonitorCommandOptions

H ]
(

] ^
)

^ _
;

_ `
public '
ExportCollectCommandOptions *'
ExportCollectCommandOptions+ F
{G H
getI L
;L M
setN Q
;Q R
}S T
=U V
newW Z'
ExportCollectCommandOptions[ v
(v w
)w x
;x y
public 
string 

FirstRunId  
{ 	
get 
{ 
return 
$" 
{ 
RunId 
}  
$str  '
"' (
;( )
} 
} 	
public 
string 
SecondRunId !
{ 	
get 
{ 
return 
$" 
{ 
RunId 
}  
$str  &
"& '
;' (
} 
} 	
public 
string 
MonitorRunId "
{ 	
get 
{ 
return   
$"   
{   
RunId   
}    
$str    +
"  + ,
;  , -
}!! 
}"" 	
public$$ 

Dictionary$$ 
<$$ 
RESULT_TYPE$$ %
,$$% & 
ANALYSIS_RESULT_TYPE$$' ;
>$$; <
DefaultLevels$$= J
=$$K L
new$$M P

Dictionary$$Q [
<$$[ \
RESULT_TYPE$$\ g
,$$g h 
ANALYSIS_RESULT_TYPE$$i }
>$$} ~
($$~ 
)	$$ €
;
$$€ 
public%% 
List%% 
<%% 
AsaRule%% 
>%% 
Rules%% "
{%%# $
get%%% (
;%%( )
set%%* -
;%%- .
}%%/ 0
=%%1 2
new%%3 6
List%%7 ;
<%%; <
AsaRule%%< C
>%%C D
(%%D E
)%%E F
;%%F G
public&& 
List&& 
<&& 
CollectObject&& !
>&&! "
TestObjects&&# .
{&&/ 0
get&&1 4
;&&4 5
set&&6 9
;&&9 :
}&&; <
=&&= >
new&&? B
List&&C G
<&&G H
CollectObject&&H U
>&&U V
(&&V W
)&&W X
;&&X Y
public(( 
string(( 
RunId(( 
{(( 
get(( !
;((! "
set((# &
;((& '
}((( )
=((* +
string((, 2
.((2 3
Empty((3 8
;((8 9
public)) !
CompareCommandOptions)) $!
CompareCommandOptions))% :
{)); <
get** 
{++ 
return,, 
new,, !
CompareCommandOptions,, 0
(,,0 1'
ExportCollectCommandOptions,,1 L
.,,L M

FirstRunId,,M W
,,,W X'
ExportCollectCommandOptions,,Y t
.,,t u
SecondRunId	,,u €
)
,,€ 
{-- (
ApplySubObjectRulesToMonitor.. 0
=..1 2
true..3 7
,..7 8
AnalysesFile//  
=//! "
RuleFile//# +
.//+ ,
LoadEmbeddedFilters//, ?
(//? @
)//@ A
,//A B
DatabaseFilename00 $
=00% &'
ExportCollectCommandOptions00' B
.00B C
DatabaseFilename00C S
,00S T
DisableAnalysis11 #
=11$ %'
ExportCollectCommandOptions11& A
.11A B
DisableAnalysis11B Q
,11Q R
SaveToDatabase22 "
=22# $'
ExportCollectCommandOptions22% @
.22@ A
SaveToDatabase22A O
,22O P

RunScripts33 
=33  '
ExportCollectCommandOptions33! <
.33< =

RunScripts33= G
}44 
;44 
}55 
}66 	
}77 
}88 ƒ 

ND:\sonarcube_projects\AttackSurfaceAnalyzer\Cli\AttackSurfaceAnalyzerClient.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Cli. 1
{ 
public 

static 
class '
AttackSurfaceAnalyzerClient 3
{ 
private 
static 
List 
< 
BaseCollector )
>) *

collectors+ 5
=6 7
new8 ;
List< @
<@ A
BaseCollectorA N
>N O
(O P
)P Q
;Q R
private   
static   
readonly   
List    $
<  $ %
BaseMonitor  % 0
>  0 1
monitors  2 :
=  ; <
new  = @
List  A E
<  E F
BaseMonitor  F Q
>  Q R
(  R S
)  S T
;  T U
private!! 
static!! 
List!! 
<!! 
BaseCompare!! '
>!!' (
comparators!!) 4
=!!5 6
new!!7 :
List!!; ?
<!!? @
BaseCompare!!@ K
>!!K L
(!!L M
)!!M N
;!!N O
public## 
static## 
DatabaseManager## %
?##% &
DatabaseManager##' 6
{##7 8
get##9 <
;##< =
private##> E
set##F I
;##I J
}##K L
private%% 
static%% 
void%% 
SetupLogging%% (
(%%( )
CommandOptions%%) 7
opts%%8 <
)%%< =
{&& 	
Logger(( 
.(( 
Setup(( 
((( 
true(( 
,(( 
opts(( #
.((# $
Verbose(($ +
,((+ ,
opts((- 1
.((1 2
Quiet((2 7
)((7 8
;((8 9
},, 	
private.. 
static.. 
void.. 
SetupDatabase.. )
(..) *
CommandOptions..* 8
opts..9 =
)..= >
{// 	
var00 

dbSettings00 
=00 
new00  

DBSettings00! +
(00+ ,
)00, -
{11 
ShardingFactor22 
=22  
opts22! %
.22% &
Shards22& ,
,22, -
LowMemoryUsage33 
=33  
opts33! %
.33% &
LowMemoryUsage33& 4
}44 
;44 

SetupOrDie55 
(55 
opts55 
.55 
DatabaseFilename55 ,
,55, -

dbSettings55. 8
)558 9
;559 :
}66 	
private88 
static88 
void88 
Main88  
(88  !
string88! '
[88' (
]88( )
args88* .
)88. /
{99 	!
AttackSurfaceAnalyzer;; !
.;;! "
Utils;;" '
.;;' (
Logger;;( .
.;;. /
Setup;;/ 4
(;;4 5
true;;5 9
,;;9 :
false;;; @
);;@ A
;;;A B
var?? 
version?? 
=?? 
(?? 
Assembly?? #
.@@ 
GetEntryAssembly@@ )
(@@) *
)@@* +
?@@+ ,
.AA 
GetCustomAttributesAA ,
(AA, -
typeofAA- 3
(AA3 41
%AssemblyInformationalVersionAttributeAA4 Y
)AAY Z
,AAZ [
falseAA\ a
)AAa b
asAAc e2
%AssemblyInformationalVersionAttribute	AAf ‹
[
AA‹ Œ
]
AAŒ 
)
AA 
?
AA 
[BB 
$numBB 
]BB 
.BB  
InformationalVersionBB 0
??BB1 3
$strBB4 =
;BB= >
LogDD 
.DD 
InformationDD 
(DD 
$strDD 9
,DD9 :
versionDD; B
)DDB C
;DDC D!
AttackSurfaceAnalyzerFF !
.FF! "
UtilsFF" '
.FF' (
StringsFF( /
.FF/ 0
SetupFF0 5
(FF5 6
)FF6 7
;FF7 8
varHH 

argsResultHH 
=HH 
ParserHH #
.HH# $
DefaultHH$ +
.HH+ ,
ParseArgumentsHH, :
<HH: ;!
CollectCommandOptionsHH; P
,HHP Q!
MonitorCommandOptionsHHR g
,HHg h(
ExportMonitorCommandOptions	HHi „
,
HH„ …)
ExportCollectCommandOptions
HH† ¡
,
HH¡ ¢"
ConfigCommandOptions
HH£ ·
,
HH· ¸
GuiCommandOptions
HH¹ Ê
,
HHÊ Ë
VerifyOptions
HHÌ Ù
,
HHÙ Ú&
GuidedModeCommandOptions
HHÛ ó
>
HHó ô
(
HHô õ
args
HHõ ù
)
HHù ú
.II 
	MapResultII 
(II 
(JJ !
CollectCommandOptionsJJ *
optsJJ+ /
)JJ/ 0
=>JJ1 3
{KK 
SetupLoggingLL $
(LL$ %
optsLL% )
)LL) *
;LL* +
SetupDatabaseMM %
(MM% &
optsMM& *
)MM* +
;MM+ ,
returnNN 
RunCollectCommandNN 0
(NN0 1
optsNN1 5
)NN5 6
;NN6 7
}OO 
,OO 
(PP !
MonitorCommandOptionsPP *
optsPP+ /
)PP/ 0
=>PP1 3
{QQ 
SetupLoggingRR $
(RR$ %
optsRR% )
)RR) *
;RR* +
SetupDatabaseSS %
(SS% &
optsSS& *
)SS* +
;SS+ ,
returnTT 
RunMonitorCommandTT 0
(TT0 1
optsTT1 5
)TT5 6
;TT6 7
}UU 
,UU 
(VV '
ExportCollectCommandOptionsVV 0
optsVV1 5
)VV5 6
=>VV7 9
{WW 
SetupLoggingXX $
(XX$ %
optsXX% )
)XX) *
;XX* +
SetupDatabaseYY %
(YY% &
optsYY& *
)YY* +
;YY+ ,
returnZZ #
RunExportCollectCommandZZ 6
(ZZ6 7
optsZZ7 ;
)ZZ; <
;ZZ< =
}[[ 
,[[ 
(\\ '
ExportMonitorCommandOptions\\ 0
opts\\1 5
)\\5 6
=>\\7 9
{]] 
SetupLogging^^ $
(^^$ %
opts^^% )
)^^) *
;^^* +
SetupDatabase__ %
(__% &
opts__& *
)__* +
;__+ ,
return`` #
RunExportMonitorCommand`` 6
(``6 7
opts``7 ;
)``; <
;``< =
}aa 
,aa 
(bb  
ConfigCommandOptionsbb )
optsbb* .
)bb. /
=>bb0 2
{cc 
SetupLoggingdd $
(dd$ %
optsdd% )
)dd) *
;dd* +
returnee 
RunConfigCommandee /
(ee/ 0
optsee0 4
)ee4 5
;ee5 6
}ff 
,ff 
(gg 
GuiCommandOptionsgg &
optsgg' +
)gg+ ,
=>gg- /
{hh 
SetupLoggingii $
(ii$ %
optsii% )
)ii) *
;ii* +
SetupDatabasejj %
(jj% &
optsjj& *
)jj* +
;jj+ ,
returnkk 
RunGuiCommandkk ,
(kk, -
optskk- 1
)kk1 2
;kk2 3
}ll 
,ll 
(mm 
VerifyOptionsmm "
optsmm# '
)mm' (
=>mm) +
{nn 
SetupLoggingoo $
(oo$ %
optsoo% )
)oo) *
;oo* +
SetupDatabasepp %
(pp% &
optspp& *
)pp* +
;pp+ ,
returnqq !
RunVerifyRulesCommandqq 4
(qq4 5
optsqq5 9
)qq9 :
;qq: ;
}rr 
,rr 
(ss $
GuidedModeCommandOptionsss -
optsss. 2
)ss2 3
=>ss4 6
{tt 
SetupLogginguu $
(uu$ %
optsuu% )
)uu) *
;uu* +
SetupDatabasevv %
(vv% &
optsvv& *
)vv* +
;vv+ ,
returnww  
RunGuidedModeCommandww 3
(ww3 4
optsww4 8
)ww8 9
;ww9 :
}xx 
,xx 
errsyy 
=>yy 
	ASA_ERRORyy %
.yy% &
UNKNOWNyy& -
)zz 
;zz 
DatabaseManager{{ 
?{{ 
.{{ 
CloseDatabase{{ *
({{* +
){{+ ,
;{{, -
Log|| 
.|| 
CloseAndFlush|| 
(|| 
)|| 
;||  
Environment}} 
.}} 
Exit}} 
(}} 
(}} 
int}} !
)}}! "

argsResult}}" ,
)}}, -
;}}- .
}~~ 	
private
…… 
static
…… 
RuleFile
…… )
LoadRulesFromFileOrEmbedded
……  ;
(
……; <
string
……< B
?
……B C
analysisFile
……D P
)
……P Q
=>
……R T
string
……U [
.
……[ \
IsNullOrEmpty
……\ i
(
……i j
analysisFile
……j v
)
……v w
?
……x y
RuleFile……z ‚
.……‚ ƒ#
LoadEmbeddedFilters……ƒ –
(……– —
)……— ˜
:……™ š
RuleFile……› £
.……£ ¤
FromFile……¤ ¬
(……¬ ­
analysisFile……­ ¹
)……¹ º
;……º »
private
‡‡ 
static
‡‡ 
	ASA_ERROR
‡‡  "
RunGuidedModeCommand
‡‡! 5
(
‡‡5 6&
GuidedModeCommandOptions
‡‡6 N
opts
‡‡O S
)
‡‡S T
{
ˆˆ 	
opts
‰‰ 
.
‰‰ 
RunId
‰‰ 
=
‰‰ 
opts
‰‰ 
.
‰‰ 
RunId
‰‰ #
?
‰‰# $
.
‰‰$ %
Trim
‰‰% )
(
‰‰) *
)
‰‰* +
??
‰‰, .
DateTime
‰‰/ 7
.
‰‰7 8
Now
‰‰8 ;
.
‰‰; <
ToString
‰‰< D
(
‰‰D E
$str
‰‰E H
,
‰‰H I
CultureInfo
‰‰J U
.
‰‰U V
InvariantCulture
‰‰V f
)
‰‰f g
;
‰‰g h
var
‹‹ 
firstCollectRunId
‹‹ !
=
‹‹" #
$"
‹‹$ &
{
‹‹& '
opts
‹‹' +
.
‹‹+ ,
RunId
‹‹, 1
}
‹‹1 2
$str
‹‹2 ;
"
‹‹; <
;
‹‹< =
var
ŒŒ  
secondCollectRunId
ŒŒ "
=
ŒŒ# $
$"
ŒŒ% '
{
ŒŒ' (
opts
ŒŒ( ,
.
ŒŒ, -
RunId
ŒŒ- 2
}
ŒŒ2 3
$str
ŒŒ3 9
"
ŒŒ9 :
;
ŒŒ: ;
var
 
monitorRunId
 
=
 
$"
 !
{
! "
opts
" &
.
& '
RunId
' ,
}
, -
$str
- 8
"
8 9
;
9 :
var
 
collectorOpts
 
=
 #
CollectCommandOptions
  5
.
5 6"
FromCollectorOptions
6 J
(
J K
opts
K O
)
O P
;
P Q
collectorOpts
‘‘ 
.
‘‘ 
RunId
‘‘ 
=
‘‘  !
firstCollectRunId
‘‘" 3
;
‘‘3 4
RunCollectCommand
““ 
(
““ 
collectorOpts
““ +
)
““+ ,
;
““, -
var
•• 
monitorOpts
•• 
=
•• 
new
•• !#
MonitorCommandOptions
••" 7
(
••7 8
)
••8 9
{
–– 
Duration
—— 
=
—— 
opts
—— 
.
——  
Duration
——  (
,
——( )"
MonitoredDirectories
˜˜ $
=
˜˜% &
opts
˜˜' +
.
˜˜+ ,"
MonitoredDirectories
˜˜, @
,
˜˜@ A%
EnableFileSystemMonitor
™™ '
=
™™( )
opts
™™* .
.
™™. /%
EnableFileSystemMonitor
™™/ F
,
™™F G
GatherHashes
šš 
=
šš 
opts
šš #
.
šš# $
GatherHashes
šš$ 0
,
šš0 1
FileNamesOnly
›› 
=
›› 
opts
››  $
.
››$ %
FileNamesOnly
››% 2
,
››2 3
RunId
œœ 
=
œœ 
monitorRunId
œœ $
,
œœ$ %
}
 
;
 
RunMonitorCommand
ŸŸ 
(
ŸŸ 
monitorOpts
ŸŸ )
)
ŸŸ) *
;
ŸŸ* +
collectorOpts
¡¡ 
.
¡¡ 
RunId
¡¡ 
=
¡¡  ! 
secondCollectRunId
¡¡" 4
;
¡¡4 5
RunCollectCommand
££ 
(
££ 
collectorOpts
££ +
)
££+ ,
;
££, -
var
¥¥ 
analysisFile
¥¥ 
=
¥¥ )
LoadRulesFromFileOrEmbedded
¥¥ :
(
¥¥: ;
opts
¥¥; ?
.
¥¥? @
AnalysesFile
¥¥@ L
)
¥¥L M
;
¥¥M N
if
§§ 
(
§§ 
!
§§ 
analysisFile
§§ 
.
§§ 
Rules
§§ #
.
§§# $
Any
§§$ '
(
§§' (
)
§§( )
)
§§) *
{
¨¨ 
Log
©© 
.
©© 
Warning
©© 
(
©© 
Strings
©© #
.
©©# $
Get
©©$ '
(
©©' (
$str
©©( 5
)
©©5 6
)
©©6 7
;
©©7 8
return
ªª 
	ASA_ERROR
ªª  
.
ªª  !
INVALID_RULES
ªª! .
;
ªª. /
}
«« 
var
­­ 
compareOpts
­­ 
=
­­ 
new
­­ !#
CompareCommandOptions
­­" 7
(
­­7 8
firstCollectRunId
­­8 I
,
­­I J 
secondCollectRunId
­­K ]
)
­­] ^
{
®® 
DisableAnalysis
¯¯ 
=
¯¯  !
opts
¯¯" &
.
¯¯& '
DisableAnalysis
¯¯' 6
,
¯¯6 7
AnalysesFile
°° 
=
°° 
analysisFile
°° +
,
°°+ ,

RunScripts
±± 
=
±± 
opts
±± !
.
±±! "

RunScripts
±±" ,
}
²² 
;
²² 
var
´´ 
results
´´ 
=
´´ 
CompareRuns
´´ %
(
´´% &
compareOpts
´´& 1
)
´´1 2
;
´´2 3
if
¶¶ 
(
¶¶ 
opts
¶¶ 
.
¶¶ 
SaveToDatabase
¶¶ #
)
¶¶# $
{
·· "
InsertCompareResults
¸¸ $
(
¸¸$ %
results
¸¸% ,
,
¸¸, -
firstCollectRunId
¸¸. ?
,
¸¸? @ 
secondCollectRunId
¸¸A S
,
¸¸S T
analysisFile
¸¸U a
.
¸¸a b
GetHash
¸¸b i
(
¸¸i j
)
¸¸j k
)
¸¸k l
;
¸¸l m
}
¹¹ 
var
»»  
monitorCompareOpts
»» "
=
»»# $
new
»»% (#
CompareCommandOptions
»») >
(
»»> ?
null
»»? C
,
»»C D
monitorRunId
»»E Q
)
»»Q R
{
¼¼ 
DisableAnalysis
½½ 
=
½½  !
opts
½½" &
.
½½& '
DisableAnalysis
½½' 6
,
½½6 7
AnalysesFile
¾¾ 
=
¾¾ 
analysisFile
¾¾ +
,
¾¾+ ,*
ApplySubObjectRulesToMonitor
¿¿ ,
=
¿¿- .
opts
¿¿/ 3
.
¿¿3 4*
ApplySubObjectRulesToMonitor
¿¿4 P
,
¿¿P Q

RunScripts
ÀÀ 
=
ÀÀ 
opts
ÀÀ !
.
ÀÀ! "

RunScripts
ÀÀ" ,
}
ÁÁ 
;
ÁÁ 
var
ÃÃ 
monitorResult
ÃÃ 
=
ÃÃ 
AnalyzeMonitored
ÃÃ  0
(
ÃÃ0 1 
monitorCompareOpts
ÃÃ1 C
)
ÃÃC D
;
ÃÃD E
if
ÅÅ 
(
ÅÅ 
opts
ÅÅ 
.
ÅÅ 
SaveToDatabase
ÅÅ #
)
ÅÅ# $
{
ÆÆ "
InsertCompareResults
ÇÇ $
(
ÇÇ$ %
monitorResult
ÇÇ% 2
,
ÇÇ2 3
null
ÇÇ4 8
,
ÇÇ8 9
monitorRunId
ÇÇ: F
,
ÇÇF G
analysisFile
ÇÇH T
.
ÇÇT U
GetHash
ÇÇU \
(
ÇÇ\ ]
)
ÇÇ] ^
)
ÇÇ^ _
;
ÇÇ_ `
}
ÈÈ 
Parallel
ÊÊ 
.
ÊÊ 
ForEach
ÊÊ 
(
ÊÊ 
monitorResult
ÊÊ *
.
ÊÊ* +
Keys
ÊÊ+ /
,
ÊÊ/ 0
key
ÊÊ1 4
=>
ÊÊ5 7
{
ËË 
results
ÌÌ 
.
ÌÌ 
TryAdd
ÌÌ 
(
ÌÌ 
key
ÌÌ "
,
ÌÌ" #
monitorResult
ÌÌ$ 1
[
ÌÌ1 2
key
ÌÌ2 5
]
ÌÌ5 6
)
ÌÌ6 7
;
ÌÌ7 8
}
ÍÍ 
)
ÍÍ 
;
ÍÍ 
var
ÎÎ 
exOpts
ÎÎ 
=
ÎÎ 
new
ÎÎ 
ExportOptions
ÎÎ *
(
ÎÎ* +
)
ÎÎ+ ,
;
ÎÎ, -
exOpts
ÏÏ 
.
ÏÏ 
OutputSarif
ÏÏ 
=
ÏÏ  
opts
ÏÏ! %
.
ÏÏ% &
ExportSarif
ÏÏ& 1
;
ÏÏ1 2
exOpts
ĞĞ 
.
ĞĞ 

OutputPath
ĞĞ 
=
ĞĞ 
opts
ĞĞ  $
.
ĞĞ$ %

OutputPath
ĞĞ% /
;
ĞĞ/ 0
exOpts
ÑÑ 
.
ÑÑ 
ExplodedOutput
ÑÑ !
=
ÑÑ" #
opts
ÑÑ$ (
.
ÑÑ( )
ExplodedOutput
ÑÑ) 7
;
ÑÑ7 8
return
ÒÒ "
ExportCompareResults
ÒÒ '
(
ÒÒ' (
results
ÒÒ( /
,
ÒÒ/ 0
exOpts
ÒÒ1 7
,
ÒÒ7 8

AsaHelpers
ÒÒ9 C
.
ÒÒC D
MakeValidFileName
ÒÒD U
(
ÒÒU V
opts
ÒÒV Z
.
ÒÒZ [
RunId
ÒÒ[ `
)
ÒÒ` a
,
ÒÒa b
analysisFile
ÒÒc o
.
ÒÒo p
GetHash
ÒÒp w
(
ÒÒw x
)
ÒÒx y
,
ÒÒy z
analysisFileÒÒ{ ‡
.ÒÒ‡ ˆ
RulesÒÒˆ 
)ÒÒ 
;ÒÒ 
}
ÓÓ 	
public
ÕÕ 
static
ÕÕ "
ConcurrentDictionary
ÕÕ *
<
ÕÕ* +
(
ÕÕ+ ,
RESULT_TYPE
ÕÕ, 7
,
ÕÕ7 8
CHANGE_TYPE
ÕÕ9 D
)
ÕÕD E
,
ÕÕE F
List
ÕÕG K
<
ÕÕK L
CompareResult
ÕÕL Y
>
ÕÕY Z
>
ÕÕZ [
AnalyzeMonitored
ÕÕ\ l
(
ÕÕl m$
CompareCommandOptionsÕÕm ‚
optsÕÕƒ ‡
)ÕÕ‡ ˆ
{
ÖÖ 	
if
×× 
(
×× 
DatabaseManager
×× 
is
××  "
null
××# '
)
××' (
{
ØØ 
Log
ÙÙ 
.
ÙÙ 
Error
ÙÙ 
(
ÙÙ 
$str
ÙÙ 3
,
ÙÙ3 4
$str
ÙÙ5 K
)
ÙÙK L
;
ÙÙL M
return
ÚÚ 
new
ÚÚ "
ConcurrentDictionary
ÚÚ /
<
ÚÚ/ 0
(
ÚÚ0 1
RESULT_TYPE
ÚÚ1 <
,
ÚÚ< =
CHANGE_TYPE
ÚÚ> I
)
ÚÚI J
,
ÚÚJ K
List
ÚÚL P
<
ÚÚP Q
CompareResult
ÚÚQ ^
>
ÚÚ^ _
>
ÚÚ_ `
(
ÚÚ` a
)
ÚÚa b
;
ÚÚb c
}
ÛÛ 
if
ÜÜ 
(
ÜÜ 
opts
ÜÜ 
is
ÜÜ 
null
ÜÜ 
||
ÜÜ 
opts
ÜÜ  $
.
ÜÜ$ %
SecondRunId
ÜÜ% 0
is
ÜÜ1 3
null
ÜÜ4 8
)
ÜÜ8 9
{
ÜÜ: ;
return
ÜÜ< B
new
ÜÜC F"
ConcurrentDictionary
ÜÜG [
<
ÜÜ[ \
(
ÜÜ\ ]
RESULT_TYPE
ÜÜ] h
,
ÜÜh i
CHANGE_TYPE
ÜÜj u
)
ÜÜu v
,
ÜÜv w
List
ÜÜx |
<
ÜÜ| }
CompareResultÜÜ} Š
>ÜÜŠ ‹
>ÜÜ‹ Œ
(ÜÜŒ 
)ÜÜ 
;ÜÜ 
}ÜÜ ‘
var
İİ 
analyzer
İİ 
=
İİ 
new
İİ 
AsaAnalyzer
İİ *
(
İİ* +
new
İİ+ .
AnalyzerOptions
İİ/ >
(
İİ> ?
opts
İİ? C
.
İİC D

RunScripts
İİD N
)
İİN O
)
İİO P
;
İİP Q
return
ŞŞ 
AnalyzeMonitored
ŞŞ #
(
ŞŞ# $
opts
ŞŞ$ (
,
ŞŞ( )
analyzer
ŞŞ* 2
,
ŞŞ2 3
DatabaseManager
ŞŞ4 C
.
ŞŞC D
GetMonitorResults
ŞŞD U
(
ŞŞU V
opts
ŞŞV Z
.
ŞŞZ [
SecondRunId
ŞŞ[ f
)
ŞŞf g
,
ŞŞg h
opts
ŞŞi m
.
ŞŞm n
AnalysesFile
ŞŞn z
??
ŞŞ{ }
throwŞŞ~ ƒ
newŞŞ„ ‡%
ArgumentNullExceptionŞŞˆ 
(ŞŞ 
nameofŞŞ ¤
(ŞŞ¤ ¥
optsŞŞ¥ ©
.ŞŞ© ª
AnalysesFileŞŞª ¶
)ŞŞ¶ ·
)ŞŞ· ¸
)ŞŞ¸ ¹
;ŞŞ¹ º
}
ßß 	
public
áá 
static
áá "
ConcurrentDictionary
áá *
<
áá* +
(
áá+ ,
RESULT_TYPE
áá, 7
,
áá7 8
CHANGE_TYPE
áá9 D
)
ááD E
,
ááE F
List
ááG K
<
ááK L
CompareResult
ááL Y
>
ááY Z
>
ááZ [
AnalyzeMonitored
áá\ l
(
áál m$
CompareCommandOptionsáám ‚
optsááƒ ‡
,áá‡ ˆ
AsaAnalyzeráá‰ ”
analyzeráá• 
,áá 
IEnumerableááŸ ª
<ááª «
MonitorObjectáá« ¸
>áá¸ ¹
collectObjectsááº È
,ááÈ É
RuleFileááÊ Ò
ruleFileááÓ Û
)ááÛ Ü
{
ââ 	
if
ãã 
(
ãã 
opts
ãã 
is
ãã 
null
ãã 
)
ãã 
{
ãã 
return
ãã  &
new
ãã' *"
ConcurrentDictionary
ãã+ ?
<
ãã? @
(
ãã@ A
RESULT_TYPE
ããA L
,
ããL M
CHANGE_TYPE
ããN Y
)
ããY Z
,
ããZ [
List
ãã\ `
<
ãã` a
CompareResult
ããa n
>
ããn o
>
ãão p
(
ããp q
)
ããq r
;
ããr s
}
ããt u
var
ää 
results
ää 
=
ää 
new
ää "
ConcurrentDictionary
ää 2
<
ää2 3
(
ää3 4
RESULT_TYPE
ää4 ?
,
ää? @
CHANGE_TYPE
ääA L
)
ääL M
,
ääM N
List
ääO S
<
ääS T
CompareResult
ääT a
>
ääa b
>
ääb c
(
ääc d
)
ääd e
;
ääe f
var
åå 
analysesHash
åå 
=
åå 
ruleFile
åå '
.
åå' (
GetHash
åå( /
(
åå/ 0
)
åå0 1
;
åå1 2
Parallel
ææ 
.
ææ 
ForEach
ææ 
(
ææ 
collectObjects
ææ +
,
ææ+ ,
monitorResult
ææ- :
=>
ææ; =
{
çç 
var
èè 
shellResult
èè 
=
èè  !
new
èè" %
CompareResult
èè& 3
(
èè3 4
)
èè4 5
{
éé 
Compare
êê 
=
êê 
monitorResult
êê +
,
êê+ ,
CompareRunId
ëë  
=
ëë! "
opts
ëë# '
.
ëë' (
SecondRunId
ëë( 3
}
ìì 
;
ìì 
shellResult
îî 
.
îî 
Rules
îî !
=
îî" #
analyzer
îî$ ,
.
îî, -
Analyze
îî- 4
(
îî4 5
ruleFile
îî5 =
.
îî= >
Rules
îî> C
,
îîC D
shellResult
îîE P
)
îîP Q
.
îîQ R
ToList
îîR X
(
îîX Y
)
îîY Z
;
îîZ [
shellResult
ïï 
.
ïï 
AnalysesHash
ïï (
=
ïï) *
analysesHash
ïï+ 7
;
ïï7 8
if
ññ 
(
ññ 
opts
ññ 
.
ññ *
ApplySubObjectRulesToMonitor
ññ 5
)
ññ5 6
{
òò 
switch
óó 
(
óó 
monitorResult
óó )
)
óó) *
{
ôô 
case
õõ 
FileMonitorObject
õõ .
fmo
õõ/ 2
:
õõ2 3
var
öö 

innerShell
öö  *
=
öö+ ,
new
öö- 0
CompareResult
öö1 >
(
öö> ?
)
öö? @
{
÷÷ 
Compare
øø  '
=
øø( )
fmo
øø* -
.
øø- .
FileSystemObject
øø. >
,
øø> ?
CompareRunId
ùù  ,
=
ùù- .
opts
ùù/ 3
.
ùù3 4
SecondRunId
ùù4 ?
}
úú 
;
úú 
shellResult
ûû '
.
ûû' (
Rules
ûû( -
.
ûû- .
AddRange
ûû. 6
(
ûû6 7
analyzer
ûû7 ?
.
ûû? @
Analyze
ûû@ G
(
ûûG H
ruleFile
ûûH P
.
ûûP Q
Rules
ûûQ V
,
ûûV W

innerShell
ûûX b
)
ûûb c
)
ûûc d
;
ûûd e
break
üü !
;
üü! "
}
ıı 
}
şş 
shellResult
€€ 
.
€€ 
Analysis
€€ $
=
€€% &
shellResult
€€' 2
.
€€2 3
Rules
€€3 8
.
€€8 9
Count
€€9 >
>
€€? @
$num
€€A B
?
€€C D
shellResult
€€E P
.
€€P Q
Rules
€€Q V
.
€€V W
Max
€€W Z
(
€€Z [
x
€€[ \
=>
€€] _
(
€€` a
(
€€a b
AsaRule
€€b i
)
€€i j
x
€€j k
)
€€k l
.
€€l m
Flag
€€m q
)
€€q r
:
€€s t
ruleFile
€€u }
.
€€} ~
DefaultLevels€€~ ‹
[€€‹ Œ
shellResult€€Œ —
.€€— ˜

ResultType€€˜ ¢
]€€¢ £
;€€£ ¤
results
 
.
 
TryAdd
 
(
 
(
  
monitorResult
  -
.
- .

ResultType
. 8
,
8 9
monitorResult
: G
.
G H

ChangeType
H R
)
R S
,
S T
new
U X
List
Y ]
<
] ^
CompareResult
^ k
>
k l
(
l m
)
m n
)
n o
;
o p
results
‚‚ 
[
‚‚ 
(
‚‚ 
monitorResult
‚‚ &
.
‚‚& '

ResultType
‚‚' 1
,
‚‚1 2
monitorResult
‚‚3 @
.
‚‚@ A

ChangeType
‚‚A K
)
‚‚K L
]
‚‚L M
.
‚‚M N
Add
‚‚N Q
(
‚‚Q R
shellResult
‚‚R ]
)
‚‚] ^
;
‚‚^ _
}
ƒƒ 
)
ƒƒ 
;
ƒƒ 
return
„„ 
results
„„ 
;
„„ 
}
…… 	
private
‡‡ 
static
‡‡ 
	ASA_ERROR
‡‡  #
RunVerifyRulesCommand
‡‡! 6
(
‡‡6 7
VerifyOptions
‡‡7 D
opts
‡‡E I
)
‡‡I J
{
ˆˆ 	
var
‰‰ 
analyzer
‰‰ 
=
‰‰ 
new
‰‰ 
AsaAnalyzer
‰‰ *
(
‰‰* +
new
‰‰+ .
AnalyzerOptions
‰‰/ >
(
‰‰> ?
opts
‰‰? C
.
‰‰C D

RunScripts
‰‰D N
)
‰‰N O
)
‰‰O P
;
‰‰P Q
var
ŠŠ 
ruleFile
ŠŠ 
=
ŠŠ )
LoadRulesFromFileOrEmbedded
ŠŠ 6
(
ŠŠ6 7
opts
ŠŠ7 ;
.
ŠŠ; <
AnalysisFile
ŠŠ< H
)
ŠŠH I
;
ŠŠI J
if
‹‹ 
(
‹‹ 
!
‹‹ 
ruleFile
‹‹ 
.
‹‹ 
Rules
‹‹ 
.
‹‹  
Any
‹‹  #
(
‹‹# $
)
‹‹$ %
)
‹‹% &
{
ŒŒ 
Log
 
.
 
Warning
 
(
 
Strings
 #
.
# $
Get
$ '
(
' (
$str
( 5
)
5 6
)
6 7
;
7 8
return
 
	ASA_ERROR
  
.
  !
INVALID_RULES
! .
;
. /
}
 
var
 

violations
 
=
 
analyzer
 %
.
% &!
EnumerateRuleIssues
& 9
(
9 :
ruleFile
: B
.
B C
Rules
C H
)
H I
;
I J
OAT
‘‘ 
.
‘‘ 
Utils
‘‘ 
.
‘‘ 
Strings
‘‘ 
.
‘‘ 
Setup
‘‘ #
(
‘‘# $
)
‘‘$ %
;
‘‘% &
OAT
’’ 
.
’’ 
Utils
’’ 
.
’’ 
Helpers
’’ 
.
’’ 
PrintViolations
’’ -
(
’’- .

violations
’’. 8
)
’’8 9
;
’’9 :
if
““ 
(
““ 

violations
““ 
.
““ 
Any
““ 
(
““ 
)
““  
)
““  !
{
”” 
Log
•• 
.
•• 
Error
•• 
(
•• 
$str
•• D
,
••D E

violations
••F P
.
••P Q
Count
••Q V
(
••V W
)
••W X
,
••X Y
opts
••Z ^
.
••^ _
AnalysisFile
••_ k
??
••l n
$str
••o y
)
••y z
;
••z {
return
–– 
	ASA_ERROR
––  
.
––  !
INVALID_RULES
––! .
;
––. /
}
—— 
Log
˜˜ 
.
˜˜ 
Information
˜˜ 
(
˜˜ 
$str
˜˜ @
,
˜˜@ A
ruleFile
˜˜B J
.
˜˜J K
Rules
˜˜K P
.
˜˜P Q
Count
˜˜Q V
(
˜˜V W
)
˜˜W X
)
˜˜X Y
;
˜˜Y Z
return
™™ 
	ASA_ERROR
™™ 
.
™™ 
NONE
™™ !
;
™™! "
}
šš 	
internal
œœ 
static
œœ 
void
œœ "
InsertCompareResults
œœ 1
(
œœ1 2"
ConcurrentDictionary
œœ2 F
<
œœF G
(
œœG H
RESULT_TYPE
œœH S
,
œœS T
CHANGE_TYPE
œœU `
)
œœ` a
,
œœa b
List
œœc g
<
œœg h
CompareResult
œœh u
>
œœu v
>
œœv w
results
œœx 
,œœ €
stringœœ ‡
?œœ‡ ˆ

FirstRunIdœœ‰ “
,œœ“ ”
stringœœ• ›
SecondRunIdœœœ §
,œœ§ ¨
stringœœ© ¯
AnalysesHashœœ° ¼
)œœ¼ ½
{
 	
if
 
(
 
DatabaseManager
 
is
  "
null
# '
)
' (
{
ŸŸ 
Log
   
.
   
Error
   
(
   
$str
   3
,
  3 4
$str
  5 K
)
  K L
;
  L M
return
¡¡ 
;
¡¡ 
}
¢¢ 
DatabaseManager
££ 
.
££ 
InsertCompareRun
££ ,
(
££, -

FirstRunId
££- 7
,
££7 8
SecondRunId
££9 D
,
££D E
AnalysesHash
££F R
,
££R S

RUN_STATUS
££T ^
.
££^ _
RUNNING
££_ f
)
££f g
;
££g h
foreach
¤¤ 
(
¤¤ 
var
¤¤ 
key
¤¤ 
in
¤¤ 
results
¤¤  '
.
¤¤' (
Keys
¤¤( ,
)
¤¤, -
{
¥¥ 
if
¦¦ 
(
¦¦ 
results
¦¦ 
.
¦¦ 
TryGetValue
¦¦ '
(
¦¦' (
key
¦¦( +
,
¦¦+ ,
out
¦¦- 0
List
¦¦1 5
<
¦¦5 6
CompareResult
¦¦6 C
>
¦¦C D
?
¦¦D E
obj
¦¦F I
)
¦¦I J
)
¦¦J K
{
§§ 
if
¨¨ 
(
¨¨ 
obj
¨¨ 
is
¨¨ 
List
¨¨ #
<
¨¨# $
CompareResult
¨¨$ 1
>
¨¨1 2
Queue
¨¨3 8
)
¨¨8 9
{
©© 
foreach
ªª 
(
ªª  !
var
ªª! $
result
ªª% +
in
ªª, .
Queue
ªª/ 4
)
ªª4 5
{
«« 
DatabaseManager
¬¬ +
.
¬¬+ ,
InsertAnalyzed
¬¬, :
(
¬¬: ;
result
¬¬; A
)
¬¬A B
;
¬¬B C
}
­­ 
}
®® 
}
¯¯ 
}
°° 
DatabaseManager
±± 
.
±± 
UpdateCompareRun
±± ,
(
±±, -

FirstRunId
±±- 7
,
±±7 8
SecondRunId
±±9 D
,
±±D E

RUN_STATUS
±±F P
.
±±P Q
	COMPLETED
±±Q Z
)
±±Z [
;
±±[ \
DatabaseManager
³³ 
.
³³ 
Commit
³³ "
(
³³" #
)
³³# $
;
³³$ %
}
´´ 	
private
¶¶ 
static
¶¶ 
void
¶¶ 

SetupOrDie
¶¶ &
(
¶¶& '
string
¶¶' -
path
¶¶. 2
,
¶¶2 3

DBSettings
¶¶4 >
?
¶¶> ?
dbSettingsIn
¶¶@ L
=
¶¶M N
null
¶¶O S
)
¶¶S T
{
·· 	
DatabaseManager
¸¸ 
=
¸¸ 
new
¸¸ !#
SqliteDatabaseManager
¸¸" 7
(
¸¸7 8
path
¸¸8 <
,
¸¸< =
dbSettingsIn
¸¸> J
)
¸¸J K
;
¸¸K L
var
¹¹ 
	errorCode
¹¹ 
=
¹¹ 
DatabaseManager
¹¹ +
.
¹¹+ ,
Setup
¹¹, 1
(
¹¹1 2
)
¹¹2 3
;
¹¹3 4
if
»» 
(
»» 
	errorCode
»» 
!=
»» 
	ASA_ERROR
»» &
.
»»& '
NONE
»»' +
)
»»+ ,
{
¼¼ 
Log
½½ 
.
½½ 
Fatal
½½ 
(
½½ #
AttackSurfaceAnalyzer
½½ /
.
½½/ 0
Utils
½½0 5
.
½½5 6
Strings
½½6 =
.
½½= >
Get
½½> A
(
½½A B
$str
½½B Y
)
½½Y Z
)
½½Z [
;
½½[ \
Environment
¾¾ 
.
¾¾ 
Exit
¾¾  
(
¾¾  !
(
¾¾! "
int
¾¾" %
)
¾¾% &
	errorCode
¾¾& /
)
¾¾/ 0
;
¾¾0 1
}
¿¿ 
}
ÀÀ 	
private
ÂÂ 
static
ÂÂ 
	ASA_ERROR
ÂÂ  
RunGuiCommand
ÂÂ! .
(
ÂÂ. /
GuiCommandOptions
ÂÂ/ @
opts
ÂÂA E
)
ÂÂE F
{
ÃÃ 	
var
ÄÄ 
server
ÄÄ 
=
ÄÄ 
Host
ÄÄ 
.
ÄÄ "
CreateDefaultBuilder
ÄÄ 2
(
ÄÄ2 3
Array
ÄÄ3 8
.
ÄÄ8 9
Empty
ÄÄ9 >
<
ÄÄ> ?
string
ÄÄ? E
>
ÄÄE F
(
ÄÄF G
)
ÄÄG H
)
ÄÄH I
.
ÈÈ &
ConfigureWebHostDefaults
ÈÈ )
(
ÈÈ) *

webBuilder
ÈÈ* 4
=>
ÈÈ5 7
{
ÉÉ 

webBuilder
ÊÊ 
.
ÊÊ 

UseStartup
ÊÊ )
<
ÊÊ) *
Startup
ÊÊ* 1
>
ÊÊ1 2
(
ÊÊ2 3
)
ÊÊ3 4
;
ÊÊ4 5
}
ËË 
)
ËË 
.
ÌÌ 
Build
ÌÌ 
(
ÌÌ 
)
ÌÌ 
;
ÌÌ 
if
ÎÎ 
(
ÎÎ 
!
ÎÎ 
opts
ÎÎ 
.
ÎÎ 
NoLaunch
ÎÎ 
)
ÎÎ 
{
ÏÏ 
(
ĞĞ 
(
ĞĞ 
Action
ĞĞ 
)
ĞĞ 
(
ĞĞ 
async
ĞĞ 
(
ĞĞ  !
)
ĞĞ! "
=>
ĞĞ# %
{
ÑÑ 
await
ÒÒ 
Task
ÒÒ 
.
ÒÒ 
Run
ÒÒ "
(
ÒÒ" #
(
ÒÒ# $
)
ÒÒ$ %
=>
ÒÒ& (!
SleepAndOpenBrowser
ÒÒ) <
(
ÒÒ< =
$num
ÒÒ= A
)
ÒÒA B
)
ÒÒB C
.
ÒÒC D
ConfigureAwait
ÒÒD R
(
ÒÒR S
false
ÒÒS X
)
ÒÒX Y
;
ÒÒY Z
}
ÓÓ 
)
ÓÓ 
)
ÓÓ 
(
ÓÓ 
)
ÓÓ 
;
ÓÓ 
}
ÔÔ 
server
ÖÖ 
.
ÖÖ 
Run
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
return
×× 
$num
×× 
;
×× 
}
ØØ 	
private
ÚÚ 
static
ÚÚ 
void
ÚÚ !
SleepAndOpenBrowser
ÚÚ /
(
ÚÚ/ 0
int
ÚÚ0 3
sleep
ÚÚ4 9
)
ÚÚ9 :
{
ÛÛ 	
Thread
ÜÜ 
.
ÜÜ 
Sleep
ÜÜ 
(
ÜÜ 
sleep
ÜÜ 
)
ÜÜ 
;
ÜÜ  

AsaHelpers
İİ 
.
İİ 
OpenBrowser
İİ "
(
İİ" #
new
İİ# &
System
İİ' -
.
İİ- .
Uri
İİ. 1
(
İİ1 2
$str
İİ2 I
)
İİI J
)
İİJ K
;
İİK L
}
ŞŞ 	
[
àà 	
System
àà	 
.
àà 
Diagnostics
àà 
.
àà 
CodeAnalysis
àà (
.
àà( )
SuppressMessage
àà) 8
(
àà8 9
$str
àà9 @
,
àà@ A
$str
ààB z
,
ààz {
Justificationàà| ‰
=ààŠ ‹
$strààŒ —
)àà— ˜
]àà˜ ™
[
áá 	
System
áá	 
.
áá 
Diagnostics
áá 
.
áá 
CodeAnalysis
áá (
.
áá( )
SuppressMessage
áá) 8
(
áá8 9
$str
áá9 H
,
ááH I
$str
ááJ j
,
ááj k
Justification
áál y
=
ááz {
$stráá| ‡
)áá‡ ˆ
]ááˆ ‰
private
ââ 
static
ââ 
	ASA_ERROR
ââ  
RunConfigCommand
ââ! 1
(
ââ1 2"
ConfigCommandOptions
ââ2 F
opts
ââG K
)
ââK L
{
ãã 	
if
ää 
(
ää 
opts
ää 
.
ää 
ResetDatabase
ää "
)
ää" #
{
åå 
var
ææ 
filename
ææ 
=
ææ 
opts
ææ #
.
ææ# $
DatabaseFilename
ææ$ 4
;
ææ4 5
DatabaseManager
çç 
.
çç  
Destroy
çç  '
(
çç' (
opts
çç( ,
.
çç, -
DatabaseFilename
çç- =
)
çç= >
;
çç> ?
Log
èè 
.
èè 
Information
èè 
(
èè  
Strings
èè  '
.
èè' (
Get
èè( +
(
èè+ ,
$str
èè, ?
)
èè? @
,
èè@ A
filename
èèB J
)
èèJ K
;
èèK L
}
éé 
else
êê 
{
ëë 
SetupDatabase
ìì 
(
ìì 
opts
ìì "
)
ìì" #
;
ìì# $
if
íí 
(
íí 
DatabaseManager
íí #
is
íí$ &
null
íí' +
)
íí+ ,
{
îî 
Log
ïï 
.
ïï 
Error
ïï 
(
ïï 
$str
ïï 7
,
ïï7 8
$str
ïï9 K
)
ïïK L
;
ïïL M
return
ğğ 
	ASA_ERROR
ğğ $
.
ğğ$ %
DATABASE_NULL
ğğ% 2
;
ğğ2 3
}
ññ 
if
òò 
(
òò 
opts
òò 
.
òò 
ListRuns
òò !
)
òò! "
{
óó 
if
ôô 
(
ôô 
DatabaseManager
ôô '
.
ôô' (
FirstRun
ôô( 0
)
ôô0 1
{
õõ 
Log
öö 
.
öö 
Warning
öö #
(
öö# $
Strings
öö$ +
.
öö+ ,
Get
öö, /
(
öö/ 0
$str
öö0 G
)
ööG H
,
ööH I
opts
ööJ N
.
ööN O
DatabaseFilename
ööO _
)
öö_ `
;
öö` a
}
÷÷ 
else
øø 
{
ùù 
Log
úú 
.
úú 
Information
úú '
(
úú' (
Strings
úú( /
.
úú/ 0
Get
úú0 3
(
úú3 4
$str
úú4 M
)
úúM N
,
úúN O
opts
úúP T
.
úúT U
DatabaseFilename
úúU e
)
úúe f
;
úúf g
List
ûû 
<
ûû 
string
ûû #
>
ûû# $
CollectRuns
ûû% 0
=
ûû1 2
DatabaseManager
ûû3 B
.
ûûB C
GetRuns
ûûC J
(
ûûJ K
RUN_TYPE
ûûK S
.
ûûS T
COLLECT
ûûT [
)
ûû[ \
;
ûû\ ]
if
üü 
(
üü 
CollectRuns
üü '
.
üü' (
Count
üü( -
>
üü. /
$num
üü0 1
)
üü1 2
{
ıı 
Log
şş 
.
şş  
Information
şş  +
(
şş+ ,
Strings
şş, 3
.
şş3 4
Get
şş4 7
(
şş7 8
$str
şş8 ?
)
şş? @
,
şş@ A
Strings
şşB I
.
şşI J
Get
şşJ M
(
şşM N
$str
şşN h
)
şşh i
)
şşi j
;
şşj k
foreach
ÿÿ #
(
ÿÿ$ %
string
ÿÿ% +
runId
ÿÿ, 1
in
ÿÿ2 4
CollectRuns
ÿÿ5 @
)
ÿÿ@ A
{
€€ 
var
  #
run
$ '
=
( )
DatabaseManager
* 9
.
9 :
GetRun
: @
(
@ A
runId
A F
)
F G
;
G H
if
ƒƒ  "
(
ƒƒ# $
run
ƒƒ$ '
is
ƒƒ( *
AsaRun
ƒƒ+ 1
)
ƒƒ1 2
{
„„  !
Log
……$ '
.
……' (
Information
……( 3
(
……3 4
$str
……4 ]
,
……] ^
run
††$ '
.
††' (
	Timestamp
††( 1
,
††1 2
run
‡‡$ '
.
‡‡' (
Version
‡‡( /
,
‡‡/ 0
run
ˆˆ$ '
.
ˆˆ' (
RunId
ˆˆ( -
)
ˆˆ- .
;
ˆˆ. /
var
ŠŠ$ '"
resultTypesAndCounts
ŠŠ( <
=
ŠŠ= >
DatabaseManager
ŠŠ? N
.
ŠŠN O%
GetResultTypesAndCounts
ŠŠO f
(
ŠŠf g
run
ŠŠg j
.
ŠŠj k
RunId
ŠŠk p
)
ŠŠp q
;
ŠŠq r
foreach
ŒŒ$ +
(
ŒŒ, -
var
ŒŒ- 0
kvPair
ŒŒ1 7
in
ŒŒ8 :"
resultTypesAndCounts
ŒŒ; O
)
ŒŒO P
{
$ %
Log
( +
.
+ ,
Information
, 7
(
7 8
$str
8 C
,
C D
kvPair
E K
.
K L
Key
L O
,
O P
kvPair
Q W
.
W X
Value
X ]
)
] ^
;
^ _
}
$ %
}
  !
}
‘‘ 
}
’’ 
else
““ 
{
”” 
Log
•• 
.
••  
Information
••  +
(
••+ ,
Strings
••, 3
.
••3 4
Get
••4 7
(
••7 8
$str
••8 G
)
••G H
)
••H I
;
••I J
}
–– 
List
˜˜ 
<
˜˜ 
string
˜˜ #
>
˜˜# $
MonitorRuns
˜˜% 0
=
˜˜1 2
DatabaseManager
˜˜3 B
.
˜˜B C
GetRuns
˜˜C J
(
˜˜J K
RUN_TYPE
˜˜K S
.
˜˜S T
MONITOR
˜˜T [
)
˜˜[ \
;
˜˜\ ]
if
™™ 
(
™™ 
MonitorRuns
™™ '
.
™™' (
Count
™™( -
>
™™. /
$num
™™0 1
)
™™1 2
{
šš 
Log
›› 
.
››  
Information
››  +
(
››+ ,
Strings
››, 3
.
››3 4
Get
››4 7
(
››7 8
$str
››8 ?
)
››? @
,
››@ A
Strings
››B I
.
››I J
Get
››J M
(
››M N
$str
››N h
)
››h i
)
››i j
;
››j k
foreach
 #
(
$ %
string
% +

monitorRun
, 6
in
7 9
MonitorRuns
: E
)
E F
{
 
var
ŸŸ  #
run
ŸŸ$ '
=
ŸŸ( )
DatabaseManager
ŸŸ* 9
.
ŸŸ9 :
GetRun
ŸŸ: @
(
ŸŸ@ A

monitorRun
ŸŸA K
)
ŸŸK L
;
ŸŸL M
if
¡¡  "
(
¡¡# $
run
¡¡$ '
!=
¡¡( *
null
¡¡+ /
)
¡¡/ 0
{
¢¢  !
string
££$ *
output
££+ 1
=
££2 3
$"
££4 6
{
££6 7
run
££7 :
.
££: ;
RunId
££; @
}
££@ A
$str
££A B
{
££B C
run
££C F
.
££F G
	Timestamp
££G P
}
££P Q
$str
££Q R
{
££R S
run
££S V
.
££V W
Version
££W ^
}
££^ _
$str
££_ `
{
££` a
run
££a d
.
££d e
Type
££e i
}
££i j
"
££j k
;
££k l
Log
¤¤$ '
.
¤¤' (
Information
¤¤( 3
(
¤¤3 4
output
¤¤4 :
)
¤¤: ;
;
¤¤; <
Log
¥¥$ '
.
¥¥' (
Information
¥¥( 3
(
¥¥3 4
string
¥¥4 :
.
¥¥: ;
Join
¥¥; ?
(
¥¥? @
$char
¥¥@ C
,
¥¥C D
run
¥¥E H
.
¥¥H I
ResultTypes
¥¥I T
.
¥¥T U
Where
¥¥U Z
(
¥¥Z [
x
¥¥[ \
=>
¥¥] _
run
¥¥` c
.
¥¥c d
ResultTypes
¥¥d o
.
¥¥o p
Contains
¥¥p x
(
¥¥x y
x
¥¥y z
)
¥¥z {
)
¥¥{ |
)
¥¥| }
)
¥¥} ~
;
¥¥~ 
}
¦¦  !
}
§§ 
}
¨¨ 
else
©© 
{
ªª 
Log
«« 
.
««  
Information
««  +
(
««+ ,
Strings
««, 3
.
««3 4
Get
««4 7
(
««7 8
$str
««8 G
)
««G H
)
««H I
;
««I J
}
¬¬ 
}
­­ 
}
®® 
if
°° 
(
°° 
opts
°° 
.
°° 
DeleteRunId
°° $
!=
°°% '
null
°°( ,
)
°°, -
{
±± 
DatabaseManager
²² #
.
²²# $
	DeleteRun
²²$ -
(
²²- .
opts
²². 2
.
²²2 3
DeleteRunId
²²3 >
)
²²> ?
;
²²? @
}
³³ 
if
´´ 
(
´´ 
opts
´´ 
.
´´ 
TrimToLatest
´´ %
)
´´% &
{
µµ 
DatabaseManager
¶¶ #
.
¶¶# $
TrimToLatest
¶¶$ 0
(
¶¶0 1
)
¶¶1 2
;
¶¶2 3
}
·· 
}
¸¸ 
return
¹¹ 
	ASA_ERROR
¹¹ 
.
¹¹ 
NONE
¹¹ !
;
¹¹! "
}
ºº 	
private
¼¼ 
static
¼¼ 
	ASA_ERROR
¼¼  %
RunExportCollectCommand
¼¼! 8
(
¼¼8 9)
ExportCollectCommandOptions
¼¼9 T
opts
¼¼U Y
)
¼¼Y Z
{
½½ 	
if
¾¾ 
(
¾¾ 
DatabaseManager
¾¾ 
is
¾¾  "
null
¾¾# '
)
¾¾' (
{
¿¿ 
Log
ÀÀ 
.
ÀÀ 
Error
ÀÀ 
(
ÀÀ 
$str
ÀÀ 3
,
ÀÀ3 4
$str
ÀÀ5 N
)
ÀÀN O
;
ÀÀO P
return
ÁÁ 
	ASA_ERROR
ÁÁ  
.
ÁÁ  !
DATABASE_NULL
ÁÁ! .
;
ÁÁ. /
}
ÂÂ 
if
ÃÃ 
(
ÃÃ 
opts
ÃÃ 
.
ÃÃ 

OutputPath
ÃÃ 
!=
ÃÃ  "
null
ÃÃ# '
&&
ÃÃ( *
!
ÃÃ+ ,
	Directory
ÃÃ, 5
.
ÃÃ5 6
Exists
ÃÃ6 <
(
ÃÃ< =
opts
ÃÃ= A
.
ÃÃA B

OutputPath
ÃÃB L
)
ÃÃL M
)
ÃÃM N
{
ÄÄ 
Log
ÅÅ 
.
ÅÅ 
Fatal
ÅÅ 
(
ÅÅ 
Strings
ÅÅ !
.
ÅÅ! "
Get
ÅÅ" %
(
ÅÅ% &
$str
ÅÅ& >
)
ÅÅ> ?
,
ÅÅ? @
opts
ÅÅA E
.
ÅÅE F

OutputPath
ÅÅF P
)
ÅÅP Q
;
ÅÅQ R
return
ÆÆ 
$num
ÆÆ 
;
ÆÆ 
}
ÇÇ 
if
ÉÉ 
(
ÉÉ 
opts
ÉÉ 
.
ÉÉ 
ExportSingleRun
ÉÉ $
)
ÉÉ$ %
{
ÊÊ 
if
ËË 
(
ËË 
opts
ËË 
.
ËË 
SecondRunId
ËË $
is
ËË% '
null
ËË( ,
)
ËË, -
{
ÌÌ 
Log
ÍÍ 
.
ÍÍ 
Information
ÍÍ #
(
ÍÍ# $
$str
ÍÍ$ S
)
ÍÍS T
;
ÍÍT U
List
ÎÎ 
<
ÎÎ 
string
ÎÎ 
>
ÎÎ  
runIds
ÎÎ! '
=
ÎÎ( )
DatabaseManager
ÎÎ* 9
.
ÎÎ9 :
GetLatestRunIds
ÎÎ: I
(
ÎÎI J
$num
ÎÎJ K
,
ÎÎK L
RUN_TYPE
ÎÎM U
.
ÎÎU V
COLLECT
ÎÎV ]
)
ÎÎ] ^
;
ÎÎ^ _
if
ÏÏ 
(
ÏÏ 
runIds
ÏÏ 
.
ÏÏ 
Count
ÏÏ $
<
ÏÏ% &
$num
ÏÏ' (
)
ÏÏ( )
{
ĞĞ 
Log
ÑÑ 
.
ÑÑ 
Fatal
ÑÑ !
(
ÑÑ! "
Strings
ÑÑ" )
.
ÑÑ) *
Get
ÑÑ* -
(
ÑÑ- .
$str
ÑÑ. J
)
ÑÑJ K
)
ÑÑK L
;
ÑÑL M
return
ÒÒ 
	ASA_ERROR
ÒÒ (
.
ÒÒ( )

INVALID_ID
ÒÒ) 3
;
ÒÒ3 4
}
ÓÓ 
else
ÔÔ 
{
ÕÕ 
opts
×× 
.
×× 
SecondRunId
×× (
=
××) *
runIds
××+ 1
.
××1 2
First
××2 7
(
××7 8
)
××8 9
;
××9 :
opts
ØØ 
.
ØØ 

FirstRunId
ØØ '
=
ØØ( )
null
ØØ* .
;
ØØ. /
}
ÙÙ 
}
ÚÚ 
}
ÛÛ 
else
ÜÜ 
if
ÜÜ 
(
ÜÜ 
opts
ÜÜ 
.
ÜÜ 

FirstRunId
ÜÜ $
is
ÜÜ% '
null
ÜÜ( ,
||
ÜÜ- /
opts
ÜÜ0 4
.
ÜÜ4 5
SecondRunId
ÜÜ5 @
is
ÜÜA C
null
ÜÜD H
)
ÜÜH I
{
İİ 
Log
ŞŞ 
.
ŞŞ 
Information
ŞŞ 
(
ŞŞ  
$str
ŞŞ  N
)
ŞŞN O
;
ŞŞO P
List
ßß 
<
ßß 
string
ßß 
>
ßß 
runIds
ßß #
=
ßß$ %
DatabaseManager
ßß& 5
.
ßß5 6
GetLatestRunIds
ßß6 E
(
ßßE F
$num
ßßF G
,
ßßG H
RUN_TYPE
ßßI Q
.
ßßQ R
COLLECT
ßßR Y
)
ßßY Z
;
ßßZ [
if
áá 
(
áá 
runIds
áá 
.
áá 
Count
áá  
<
áá! "
$num
áá# $
)
áá$ %
{
ââ 
Log
ãã 
.
ãã 
Fatal
ãã 
(
ãã 
Strings
ãã %
.
ãã% &
Get
ãã& )
(
ãã) *
$str
ãã* F
)
ããF G
)
ããG H
;
ããH I
System
ää 
.
ää 
Environment
ää &
.
ää& '
Exit
ää' +
(
ää+ ,
-
ää, -
$num
ää- .
)
ää. /
;
ää/ 0
}
åå 
else
ææ 
{
çç 
opts
èè 
.
èè 
SecondRunId
èè $
=
èè% &
runIds
èè' -
.
èè- .
First
èè. 3
(
èè3 4
)
èè4 5
;
èè5 6
opts
éé 
.
éé 

FirstRunId
éé #
=
éé$ %
runIds
éé& ,
.
éé, -
	ElementAt
éé- 6
(
éé6 7
$num
éé7 8
)
éé8 9
;
éé9 :
}
êê 
}
ëë 
var
íí 
ruleFile
íí 
=
íí )
LoadRulesFromFileOrEmbedded
íí 6
(
íí6 7
opts
íí7 ;
.
íí; <
AnalysesFile
íí< H
)
ííH I
;
ííI J
if
îî 
(
îî 
!
îî 
ruleFile
îî 
.
îî 
Rules
îî 
.
îî  
Any
îî  #
(
îî# $
)
îî$ %
)
îî% &
{
ïï 
Log
ğğ 
.
ğğ 
Warning
ğğ 
(
ğğ 
Strings
ğğ #
.
ğğ# $
Get
ğğ$ '
(
ğğ' (
$str
ğğ( 5
)
ğğ5 6
)
ğğ6 7
;
ğğ7 8
return
ññ 
	ASA_ERROR
ññ  
.
ññ  !
INVALID_RULES
ññ! .
;
ññ. /
}
òò 
Log
ôô 
.
ôô 
Information
ôô 
(
ôô 
Strings
ôô #
.
ôô# $
Get
ôô$ '
(
ôô' (
$str
ôô( 3
)
ôô3 4
,
ôô4 5
opts
ôô6 :
.
ôô: ;

FirstRunId
ôô; E
,
ôôE F
opts
ôôG K
.
ôôK L
SecondRunId
ôôL W
)
ôôW X
;
ôôX Y#
CompareCommandOptions
öö !
options
öö" )
=
öö* +
new
öö, /#
CompareCommandOptions
öö0 E
(
ööE F
opts
ööF J
.
ööJ K

FirstRunId
ööK U
,
ööU V
opts
ööW [
.
öö[ \
SecondRunId
öö\ g
)
öög h
{
÷÷ 
DatabaseFilename
øø  
=
øø! "
opts
øø# '
.
øø' (
DatabaseFilename
øø( 8
,
øø8 9
AnalysesFile
ùù 
=
ùù 
ruleFile
ùù '
,
ùù' (
DisableAnalysis
úú 
=
úú  !
opts
úú" &
.
úú& '
DisableAnalysis
úú' 6
,
úú6 7
SaveToDatabase
ûû 
=
ûû  
opts
ûû! %
.
ûû% &
SaveToDatabase
ûû& 4
,
ûû4 5

RunScripts
üü 
=
üü 
opts
üü !
.
üü! "

RunScripts
üü" ,
}
ıı 
;
ıı 
var
ÿÿ 
results
ÿÿ 
=
ÿÿ 
CompareRuns
ÿÿ %
(
ÿÿ% &
options
ÿÿ& -
)
ÿÿ- .
;
ÿÿ. /
var
€€ 
analysesHash
€€ 
=
€€ 
options
€€ &
.
€€& '
AnalysesFile
€€' 3
.
€€3 4
GetHash
€€4 ;
(
€€; <
)
€€< =
;
€€= >
if
 
(
 
opts
 
.
 
SaveToDatabase
 #
)
# $
{
‚‚ "
InsertCompareResults
ƒƒ $
(
ƒƒ$ %
results
ƒƒ% ,
,
ƒƒ, -
opts
ƒƒ. 2
.
ƒƒ2 3

FirstRunId
ƒƒ3 =
,
ƒƒ= >
opts
ƒƒ? C
.
ƒƒC D
SecondRunId
ƒƒD O
,
ƒƒO P
analysesHash
ƒƒQ ]
)
ƒƒ] ^
;
ƒƒ^ _
}
„„ 
return
†† "
ExportCompareResults
†† '
(
††' (
results
††( /
,
††/ 0
opts
††1 5
,
††5 6

AsaHelpers
††7 A
.
††A B
MakeValidFileName
††B S
(
††S T
opts
††T X
.
††X Y

FirstRunId
††Y c
+
††d e
$str
††f l
+
††m n
opts
††o s
.
††s t
SecondRunId
††t 
)†† €
,††€ 
analysesHash††‚ 
,†† 
ruleFile†† ˜
.††˜ ™
Rules††™ 
)†† Ÿ
;††Ÿ  
}
‡‡ 	
private
‰‰ 
static
‰‰ 
	ASA_ERROR
‰‰  "
ExportCompareResults
‰‰! 5
(
‰‰5 6"
ConcurrentDictionary
‰‰6 J
<
‰‰J K
(
‰‰K L
RESULT_TYPE
‰‰L W
,
‰‰W X
CHANGE_TYPE
‰‰Y d
)
‰‰d e
,
‰‰e f
List
‰‰g k
<
‰‰k l
CompareResult
‰‰l y
>
‰‰y z
>
‰‰z {
	resultsIn‰‰| …
,‰‰… †
ExportOptions‰‰‡ ”
opts‰‰• ™
,‰‰™ š
string‰‰› ¡
baseFileName‰‰¢ ®
,‰‰® ¯
string‰‰° ¶
analysesHash‰‰· Ã
,‰‰Ã Ä
IEnumerable‰‰Å Ğ
<‰‰Ğ Ñ
AsaRule‰‰Ñ Ø
>‰‰Ø Ù
rules‰‰Ú ß
)‰‰ß à
{
ŠŠ 	
var
‹‹ 
results
‹‹ 
=
‹‹ 
	resultsIn
‹‹ #
.
‹‹# $
Select
‹‹$ *
(
‹‹* +
x
‹‹+ ,
=>
‹‹- /
new
‹‹0 3
KeyValuePair
‹‹4 @
<
‹‹@ A
string
‹‹A G
,
‹‹G H
object
‹‹I O
>
‹‹O P
(
‹‹P Q
$"
‹‹Q S
{
‹‹S T
x
‹‹T U
.
‹‹U V
Key
‹‹V Y
.
‹‹Y Z
Item1
‹‹Z _
}
‹‹_ `
$str
‹‹` a
{
‹‹a b
x
‹‹b c
.
‹‹c d
Key
‹‹d g
.
‹‹g h
Item2
‹‹h m
}
‹‹m n
"
‹‹n o
,
‹‹o p
x
‹‹q r
.
‹‹r s
Value
‹‹s x
)
‹‹x y
)
‹‹y z
.
‹‹z {
ToDictionary‹‹{ ‡
(‹‹‡ ˆ
x‹‹ˆ ‰
=>‹‹Š Œ
x‹‹ 
.‹‹ 
Key‹‹ ’
,‹‹’ “
x‹‹” •
=>‹‹– ˜
x‹‹™ š
.‹‹š ›
Value‹‹›  
)‹‹  ¡
;‹‹¡ ¢
JsonSerializer
ŒŒ 

serializer
ŒŒ %
=
ŒŒ& '
JsonSerializer
ŒŒ( 6
.
ŒŒ6 7
Create
ŒŒ7 =
(
ŒŒ= >
new
ŒŒ> A$
JsonSerializerSettings
ŒŒB X
(
ŒŒX Y
)
ŒŒY Z
{
 

Formatting
 
=
 

Formatting
 '
.
' (
Indented
( 0
,
0 1
NullValueHandling
 !
=
" #
NullValueHandling
$ 5
.
5 6
Ignore
6 <
,
< ="
DefaultValueHandling
 $
=
% &"
DefaultValueHandling
' ;
.
; <
Ignore
< B
,
B C

Converters
‘‘ 
=
‘‘ 
new
‘‘  
List
‘‘! %
<
‘‘% &
JsonConverter
‘‘& 3
>
‘‘3 4
(
‘‘4 5
)
‘‘5 6
{
‘‘7 8
new
‘‘9 <!
StringEnumConverter
‘‘= P
(
‘‘P Q
)
‘‘Q R
}
‘‘S T
,
‘‘T U
ContractResolver
’’  
=
’’! "
new
’’# &'
AsaExportContractResolver
’’' @
(
’’@ A
)
’’A B
}
““ 
)
““ 
;
““ 
var
”” 

outputPath
”” 
=
”” 
opts
”” !
.
””! "

OutputPath
””" ,
;
””, -
if
•• 
(
•• 

outputPath
•• 
is
•• 
null
•• "
)
••" #
{
–– 

outputPath
—— 
=
—— 
	Directory
—— &
.
——& '!
GetCurrentDirectory
——' :
(
——: ;
)
——; <
;
——< =
}
˜˜ 
var
™™ 
metadata
™™ 
=
™™ 

AsaHelpers
™™ %
.
™™% &
GenerateMetadata
™™& 6
(
™™6 7
)
™™7 8
;
™™8 9
metadata
šš 
.
šš 
Add
šš 
(
šš 
$str
šš (
,
šš( )
analysesHash
šš* 6
)
šš6 7
;
šš7 8
if
›› 
(
›› 
opts
›› 
.
›› 
ExplodedOutput
›› #
)
››# $
{
œœ 
results
 
.
 
Add
 
(
 
$str
 &
,
& '
metadata
( 0
)
0 1
;
1 2
string
ŸŸ 
path
ŸŸ 
=
ŸŸ 
Path
ŸŸ "
.
ŸŸ" #
Combine
ŸŸ# *
(
ŸŸ* +

outputPath
ŸŸ+ 5
,
ŸŸ5 6

AsaHelpers
ŸŸ7 A
.
ŸŸA B
MakeValidFileName
ŸŸB S
(
ŸŸS T
baseFileName
ŸŸT `
)
ŸŸ` a
)
ŸŸa b
;
ŸŸb c
	Directory
   
.
   
CreateDirectory
   )
(
  ) *
path
  * .
)
  . /
;
  / 0
foreach
¡¡ 
(
¡¡ 
var
¡¡ 
key
¡¡  
in
¡¡! #
results
¡¡$ +
.
¡¡+ ,
Keys
¡¡, 0
)
¡¡0 1
{
¢¢ 
string
££ 
filePath
££ #
=
££$ %
Path
££& *
.
££* +
Combine
££+ 2
(
££2 3
path
££3 7
,
££7 8

AsaHelpers
££9 C
.
££C D
MakeValidFileName
££D U
(
££U V
key
££V Y
)
££Y Z
)
££Z [
;
££[ \
if
¤¤ 
(
¤¤ 
opts
¤¤ 
.
¤¤ 
OutputSarif
¤¤ (
)
¤¤( )
{
¥¥ 
WriteSarifLog
¦¦ %
(
¦¦% &
new
¦¦& )

Dictionary
¦¦* 4
<
¦¦4 5
string
¦¦5 ;
,
¦¦; <
object
¦¦= C
>
¦¦C D
(
¦¦D E
)
¦¦E F
{
¦¦G H
{
¦¦I J
key
¦¦K N
,
¦¦N O
results
¦¦P W
[
¦¦W X
key
¦¦X [
]
¦¦[ \
}
¦¦] ^
}
¦¦_ `
,
¦¦` a
rules
¦¦b g
,
¦¦g h
filePath
¦¦i q
)
¦¦q r
;
¦¦r s
}
§§ 
else
¨¨ 
{
©© 
using
ªª 
(
ªª 
StreamWriter
ªª +
sw
ªª, .
=
ªª/ 0
new
ªª1 4
StreamWriter
ªª5 A
(
ªªA B
filePath
ªªB J
)
ªªJ K
)
ªªK L
{
«« 
using
¬¬ !
(
¬¬" #

JsonWriter
¬¬# -
writer
¬¬. 4
=
¬¬5 6
new
¬¬7 :
JsonTextWriter
¬¬; I
(
¬¬I J
sw
¬¬J L
)
¬¬L M
)
¬¬M N
{
­­ 

serializer
®®  *
.
®®* +
	Serialize
®®+ 4
(
®®4 5
writer
®®5 ;
,
®®; <
results
®®= D
[
®®D E
key
®®E H
]
®®H I
)
®®I J
;
®®J K
}
¯¯ 
}
°° 
}
±± 
}
²² 
Log
³³ 
.
³³ 
Information
³³ 
(
³³  
Strings
³³  '
.
³³' (
Get
³³( +
(
³³+ ,
$str
³³, =
)
³³= >
,
³³> ?
(
³³@ A
new
³³A D
DirectoryInfo
³³E R
(
³³R S
path
³³S W
)
³³W X
)
³³X Y
.
³³Y Z
FullName
³³Z b
)
³³b c
;
³³c d
}
´´ 
else
µµ 
{
¶¶ 
string
·· 
path
·· 
=
·· 
Path
·· "
.
··" #
Combine
··# *
(
··* +

outputPath
··+ 5
,
··5 6

AsaHelpers
··7 A
.
··A B
MakeValidFileName
··B S
(
··S T
baseFileName
··T `
+
··a b
$str
··c v
)
··v w
)
··w x
;
··x y
var
¸¸ 
output
¸¸ 
=
¸¸ 
new
¸¸  

Dictionary
¸¸! +
<
¸¸+ ,
string
¸¸, 2
,
¸¸2 3
object
¸¸4 :
>
¸¸: ;
(
¸¸; <
)
¸¸< =
;
¸¸= >
output
¹¹ 
[
¹¹ 
$str
¹¹  
]
¹¹  !
=
¹¹" #
results
¹¹$ +
;
¹¹+ ,
output
ºº 
[
ºº 
$str
ºº !
]
ºº! "
=
ºº# $
metadata
ºº% -
;
ºº- .
if
¼¼ 
(
¼¼ 
opts
¼¼ 
.
¼¼ 
OutputSarif
¼¼ $
)
¼¼$ %
{
½½ 
string
¾¾ 
	pathSarif
¾¾ $
=
¾¾% &
Path
¾¾' +
.
¾¾+ ,
Combine
¾¾, 3
(
¾¾3 4

outputPath
¾¾4 >
,
¾¾> ?

AsaHelpers
¾¾@ J
.
¾¾J K
MakeValidFileName
¾¾K \
(
¾¾\ ]
baseFileName
¾¾] i
+
¾¾j k
$str
¾¾l |
)
¾¾| }
)
¾¾} ~
;
¾¾~ 
WriteSarifLog
¿¿ !
(
¿¿! "
output
¿¿" (
,
¿¿( )
rules
¿¿* /
,
¿¿/ 0
	pathSarif
¿¿1 :
)
¿¿: ;
;
¿¿; <
Log
ÀÀ 
.
ÀÀ 
Information
ÀÀ #
(
ÀÀ# $
Strings
ÀÀ$ +
.
ÀÀ+ ,
Get
ÀÀ, /
(
ÀÀ/ 0
$str
ÀÀ0 A
)
ÀÀA B
,
ÀÀB C
(
ÀÀD E
new
ÀÀE H
FileInfo
ÀÀI Q
(
ÀÀQ R
	pathSarif
ÀÀR [
)
ÀÀ[ \
)
ÀÀ\ ]
.
ÀÀ] ^
FullName
ÀÀ^ f
)
ÀÀf g
;
ÀÀg h
}
ÁÁ 
else
ÂÂ 
{
ÃÃ 
using
ÅÅ 
(
ÅÅ 
StreamWriter
ÅÅ '
sw
ÅÅ( *
=
ÅÅ+ ,
new
ÅÅ- 0
StreamWriter
ÅÅ1 =
(
ÅÅ= >
path
ÅÅ> B
)
ÅÅB C
)
ÅÅC D
{
ÆÆ 
using
ÇÇ 
(
ÇÇ 

JsonWriter
ÇÇ )
writer
ÇÇ* 0
=
ÇÇ1 2
new
ÇÇ3 6
JsonTextWriter
ÇÇ7 E
(
ÇÇE F
sw
ÇÇF H
)
ÇÇH I
)
ÇÇI J
{
ÈÈ 

serializer
ÉÉ &
.
ÉÉ& '
	Serialize
ÉÉ' 0
(
ÉÉ0 1
writer
ÉÉ1 7
,
ÉÉ7 8
output
ÉÉ9 ?
)
ÉÉ? @
;
ÉÉ@ A
}
ÊÊ 
}
ËË 
Log
ÌÌ 
.
ÌÌ 
Information
ÌÌ #
(
ÌÌ# $
Strings
ÌÌ$ +
.
ÌÌ+ ,
Get
ÌÌ, /
(
ÌÌ/ 0
$str
ÌÌ0 A
)
ÌÌA B
,
ÌÌB C
(
ÌÌD E
new
ÌÌE H
FileInfo
ÌÌI Q
(
ÌÌQ R
path
ÌÌR V
)
ÌÌV W
)
ÌÌW X
.
ÌÌX Y
FullName
ÌÌY a
)
ÌÌa b
;
ÌÌb c
}
ÍÍ 
}
ÎÎ 
return
ÏÏ 
	ASA_ERROR
ÏÏ 
.
ÏÏ 
NONE
ÏÏ !
;
ÏÏ! "
}
ĞĞ 	
public
ØØ 
static
ØØ 
void
ØØ 
WriteSarifLog
ØØ (
(
ØØ( )

Dictionary
ØØ) 3
<
ØØ3 4
string
ØØ4 :
,
ØØ: ;
object
ØØ< B
>
ØØB C
output
ØØD J
,
ØØJ K
IEnumerable
ØØL W
<
ØØW X
AsaRule
ØØX _
>
ØØ_ `
rules
ØØa f
,
ØØf g
string
ØØh n
outputFilePath
ØØo }
)
ØØ} ~
{
ÙÙ 	
var
ÚÚ 
log
ÚÚ 
=
ÚÚ 
GenerateSarifLog
ÚÚ &
(
ÚÚ& '
output
ÚÚ' -
,
ÚÚ- .
rules
ÚÚ/ 4
)
ÚÚ4 5
;
ÚÚ5 6
var
ÜÜ 
settings
ÜÜ 
=
ÜÜ 
new
ÜÜ $
JsonSerializerSettings
ÜÜ 5
(
ÜÜ5 6
)
ÜÜ6 7
{
İİ 

Formatting
ŞŞ 
=
ŞŞ 

Formatting
ŞŞ '
.
ŞŞ' (
Indented
ŞŞ( 0
,
ŞŞ0 1
}
ßß 
;
ßß 
File
áá 
.
áá 
WriteAllText
áá 
(
áá 
outputFilePath
áá ,
,
áá, -
JsonConvert
áá. 9
.
áá9 :
SerializeObject
áá: I
(
ááI J
log
ááJ M
,
ááM N
settings
ááO W
)
ááW X
)
ááX Y
;
ááY Z
}
ââ 	
public
ää 
static
ää 
SarifLog
ää 
GenerateSarifLog
ää /
(
ää/ 0

Dictionary
ää0 :
<
ää: ;
string
ää; A
,
ääA B
object
ääC I
>
ääI J
output
ääK Q
,
ääQ R
IEnumerable
ääS ^
<
ää^ _
AsaRule
ää_ f
>
ääf g
rules
ääh m
)
ääm n
{
åå 	
var
ææ 
metadata
ææ 
=
ææ 
(
ææ 

Dictionary
ææ &
<
ææ& '
string
ææ' -
,
ææ- .
string
ææ/ 5
>
ææ5 6
)
ææ6 7
output
ææ7 =
[
ææ= >
$str
ææ> H
]
ææH I
;
ææI J
var
çç 
results
çç 
=
çç 
(
çç 

Dictionary
çç %
<
çç% &
string
çç& ,
,
çç, -
object
çç. 4
>
çç4 5
)
çç5 6
output
çç6 <
[
çç< =
$str
çç= F
]
ççF G
;
ççG H
var
èè 
version
èè 
=
èè 
metadata
èè "
[
èè" #
$str
èè# 4
]
èè4 5
;
èè5 6
var
êê 
log
êê 
=
êê 
new
êê 
SarifLog
êê "
(
êê" #
)
êê# $
;
êê$ %
SarifVersion
ëë 
sarifVersion
ëë %
=
ëë& '
SarifVersion
ëë( 4
.
ëë4 5
Current
ëë5 <
;
ëë< =
log
ìì 
.
ìì 
	SchemaUri
ìì 
=
ìì 
sarifVersion
ìì (
.
ìì( ) 
ConvertToSchemaUri
ìì) ;
(
ìì; <
)
ìì< =
;
ìì= >
log
íí 
.
íí 
Version
íí 
=
íí 
sarifVersion
íí &
;
íí& '
log
îî 
.
îî 
Runs
îî 
=
îî 
new
îî 
List
îî 
<
îî  
Run
îî  #
>
îî# $
(
îî$ %
)
îî% &
;
îî& '
var
ïï 
run
ïï 
=
ïï 
new
ïï 
Run
ïï 
(
ïï 
)
ïï 
;
ïï  
var
ğğ 
	artifacts
ğğ 
=
ğğ 
new
ğğ 
List
ğğ  $
<
ğğ$ %
Artifact
ğğ% -
>
ğğ- .
(
ğğ. /
)
ğğ/ 0
;
ğğ0 1
run
ññ 
.
ññ 
Tool
ññ 
=
ññ 
new
ññ 
Tool
ññ 
{
òò 
Driver
óó 
=
óó 
new
óó 
ToolComponent
óó *
{
ôô 
Name
õõ 
=
õõ 
$"
õõ 
$str
õõ 4
"
õõ4 5
,
õõ5 6
InformationUri
öö "
=
öö# $
new
öö% (
Uri
öö) ,
(
öö, -
$str
öö- b
)
ööb c
,
ööc d
Organization
÷÷  
=
÷÷! "
$str
÷÷# .
,
÷÷. /
Version
øø 
=
øø 
version
øø %
,
øø% &
}
ùù 
}
úú 
;
úú 
var
üü "
reportingDescriptors
üü $
=
üü% &
new
üü' *
List
üü+ /
<
üü/ 0!
ReportingDescriptor
üü0 C
>
üüC D
(
üüD E
)
üüE F
;
üüF G
foreach
şş 
(
şş 
var
şş 
rule
şş 
in
şş  
rules
şş! &
)
şş& '
{
ÿÿ 
if
€€ 
(
€€ 
!
€€ "
reportingDescriptors
€€ )
.
€€) *
Any
€€* -
(
€€- .
r
€€. /
=>
€€0 2
r
€€3 4
.
€€4 5
Id
€€5 7
==
€€8 :
rule
€€; ?
.
€€? @
Name
€€@ D
)
€€D E
)
€€E F
{
 
var
‚‚ !
reportingDescriptor
‚‚ +
=
‚‚, -
new
‚‚. 1!
ReportingDescriptor
‚‚2 E
(
‚‚E F
)
‚‚F G
{
ƒƒ 
FullDescription
„„ '
=
„„( )
new
„„* -&
MultiformatMessageString
„„. F
(
„„F G
)
„„G H
{
„„I J
Text
„„K O
=
„„P Q
rule
„„R V
.
„„V W
Description
„„W b
}
„„c d
,
„„d e
Id
…… 
=
…… 
rule
…… !
.
……! "
Name
……" &
,
……& '
}
†† 
;
†† !
reportingDescriptor
‡‡ '
.
‡‡' ("
DefaultConfiguration
‡‡( <
=
‡‡= >
new
‡‡? B$
ReportingConfiguration
‡‡C Y
(
‡‡Y Z
)
‡‡Z [
{
ˆˆ 
Level
‰‰ 
=
‰‰ "
GetSarifFailureLevel
‰‰  4
(
‰‰4 5
(
‰‰5 6"
ANALYSIS_RESULT_TYPE
‰‰6 J
)
‰‰J K
rule
‰‰K O
.
‰‰O P
Severity
‰‰P X
)
‰‰X Y
}
ŠŠ 
;
ŠŠ !
reportingDescriptor
‹‹ '
.
‹‹' (
SetProperty
‹‹( 3
(
‹‹3 4
$str
‹‹4 A
,
‹‹A B
string
‹‹C I
.
‹‹I J
Join
‹‹J N
(
‹‹N O
$char
‹‹O R
,
‹‹R S
rule
‹‹T X
.
‹‹X Y
ChangeTypes
‹‹Y d
)
‹‹d e
)
‹‹e f
;
‹‹f g!
reportingDescriptor
ŒŒ '
.
ŒŒ' (
SetProperty
ŒŒ( 3
(
ŒŒ3 4
$str
ŒŒ4 ?
,
ŒŒ? @
string
ŒŒA G
.
ŒŒG H
Join
ŒŒH L
(
ŒŒL M
$char
ŒŒM P
,
ŒŒP Q
rule
ŒŒR V
.
ŒŒV W
	Platforms
ŒŒW `
)
ŒŒ` a
)
ŒŒa b
;
ŒŒb c!
reportingDescriptor
 '
.
' (
SetProperty
( 3
(
3 4
$str
4 @
,
@ A
rule
B F
.
F G

ResultType
G Q
.
Q R
ToString
R Z
(
Z [
)
[ \
)
\ ]
;
] ^"
reportingDescriptors
 (
.
( )
Add
) ,
(
, -!
reportingDescriptor
- @
)
@ A
;
A B
}
 
}
 
run
’’ 
.
’’ 
Tool
’’ 
.
’’ 
Driver
’’ 
.
’’ 
Rules
’’ !
=
’’" #
new
’’$ '
List
’’( ,
<
’’, -!
ReportingDescriptor
’’- @
>
’’@ A
(
’’A B"
reportingDescriptors
’’B V
)
’’V W
;
’’W X
var
”” 
sarifResults
”” 
=
”” 
new
”” "
List
””# '
<
””' (
Result
””( .
>
””. /
(
””/ 0
)
””0 1
;
””1 2
foreach
–– 
(
–– 
var
–– 
item
–– 
in
––  
results
––! (
)
––( )
{
—— 
var
˜˜ 
compareResults
˜˜ "
=
˜˜# $
(
˜˜% &
List
˜˜& *
<
˜˜* +
CompareResult
˜˜+ 8
>
˜˜8 9
)
˜˜9 :
item
˜˜: >
.
˜˜> ?
Value
˜˜? D
;
˜˜D E
foreach
™™ 
(
™™ 
var
™™ 
compareResult
™™ *
in
™™+ -
compareResults
™™. <
)
™™< =
{
šš 
if
›› 
(
›› 
!
›› 
	artifacts
›› "
.
››" #
Any
››# &
(
››& '
a
››' (
=>
››) +
a
››, -
.
››- .
Location
››. 6
.
››6 7
Description
››7 B
.
››B C
Text
››C G
.
››G H
ToString
››H P
(
››P Q
)
››Q R
==
››S U
compareResult
››V c
.
››c d
Identity
››d l
)
››l m
)
››m n
{
œœ 
var
 
artifact
 $
=
% &
new
' *
Artifact
+ 3
{
 
Location
ŸŸ $
=
ŸŸ% &
new
ŸŸ' *
ArtifactLocation
ŸŸ+ ;
(
ŸŸ; <
)
ŸŸ< =
{
   
Index
¡¡  %
=
¡¡& '
	artifacts
¡¡( 1
.
¡¡1 2
Count
¡¡2 7
,
¡¡7 8
Description
¢¢  +
=
¢¢, -
new
¢¢. 1
Message
¢¢2 9
(
¢¢9 :
)
¢¢: ;
{
¢¢< =
Text
¢¢> B
=
¢¢C D
compareResult
¢¢E R
.
¢¢R S
Identity
¢¢S [
}
¢¢\ ]
}
££ 
}
¤¤ 
;
¤¤ 
if
¦¦ 
(
¦¦ 
Uri
¦¦ 
.
¦¦  
	TryCreate
¦¦  )
(
¦¦) *
compareResult
¦¦* 7
.
¦¦7 8
Identity
¦¦8 @
,
¦¦@ A
UriKind
¦¦B I
.
¦¦I J 
RelativeOrAbsolute
¦¦J \
,
¦¦\ ]
out
¦¦^ a
Uri
¦¦b e
?
¦¦e f
outUri
¦¦g m
)
¦¦m n
)
¦¦n o
{
§§ 
artifact
¨¨ $
.
¨¨$ %
Location
¨¨% -
.
¨¨- .
Uri
¨¨. 1
=
¨¨2 3
outUri
¨¨4 :
;
¨¨: ;
}
©© 
artifact
««  
.
««  !
SetProperty
««! ,
(
««, -
$str
««- 7
,
««7 8
compareResult
««9 F
.
««F G
Analysis
««G O
.
««O P
ToString
««P X
(
««X Y
)
««Y Z
)
««Z [
;
««[ \
if
­­ 
(
­­ 
compareResult
­­ )
.
­­) *
Base
­­* .
!=
­­/ 1
null
­­2 6
)
­­6 7
{
®® 
artifact
¯¯ $
.
¯¯$ %
SetProperty
¯¯% 0
(
¯¯0 1
$str
¯¯1 7
,
¯¯7 8
compareResult
¯¯9 F
.
¯¯F G
Base
¯¯G K
)
¯¯K L
;
¯¯L M
}
°° 
if
²² 
(
²² 
!
²² 
string
²² #
.
²²# $ 
IsNullOrWhiteSpace
²²$ 6
(
²²6 7
compareResult
²²7 D
.
²²D E
	BaseRunId
²²E N
)
²²N O
)
²²O P
{
³³ 
artifact
´´ $
.
´´$ %
SetProperty
´´% 0
(
´´0 1
$str
´´1 <
,
´´< =
compareResult
´´> K
.
´´K L
	BaseRunId
´´L U
.
´´U V
ToString
´´V ^
(
´´^ _
)
´´_ `
)
´´` a
;
´´a b
}
µµ 
artifact
··  
.
··  !
SetProperty
··! ,
(
··, -
$str
··- 9
,
··9 :
compareResult
··; H
.
··H I

ChangeType
··I S
.
··S T
ToString
··T \
(
··\ ]
)
··] ^
)
··^ _
;
··_ `
if
¹¹ 
(
¹¹ 
compareResult
¹¹ )
.
¹¹) *
Compare
¹¹* 1
!=
¹¹2 4
null
¹¹5 9
)
¹¹9 :
{
ºº 
artifact
»» $
.
»»$ %
SetProperty
»»% 0
(
»»0 1
$str
»»1 :
,
»»: ;
compareResult
»»< I
.
»»I J
Compare
»»J Q
)
»»Q R
;
»»R S
}
¼¼ 
if
¾¾ 
(
¾¾ 
!
¾¾ 
string
¾¾ #
.
¾¾# $ 
IsNullOrWhiteSpace
¾¾$ 6
(
¾¾6 7
compareResult
¾¾7 D
.
¾¾D E
CompareRunId
¾¾E Q
)
¾¾Q R
)
¾¾R S
{
¿¿ 
artifact
ÀÀ $
.
ÀÀ$ %
SetProperty
ÀÀ% 0
(
ÀÀ0 1
$str
ÀÀ1 ?
,
ÀÀ? @
compareResult
ÀÀA N
.
ÀÀN O
CompareRunId
ÀÀO [
)
ÀÀ[ \
;
ÀÀ\ ]
}
ÁÁ 
if
ÃÃ 
(
ÃÃ 
compareResult
ÃÃ )
.
ÃÃ) *
Diffs
ÃÃ* /
!=
ÃÃ0 2
null
ÃÃ3 7
&&
ÃÃ8 :
compareResult
ÃÃ; H
.
ÃÃH I
Diffs
ÃÃI N
.
ÃÃN O
Count
ÃÃO T
>
ÃÃU V
$num
ÃÃW X
)
ÃÃX Y
{
ÄÄ 
artifact
ÅÅ $
.
ÅÅ$ %
SetProperty
ÅÅ% 0
(
ÅÅ0 1
$str
ÅÅ1 8
,
ÅÅ8 9
compareResult
ÅÅ: G
.
ÅÅG H
Diffs
ÅÅH M
)
ÅÅM N
;
ÅÅN O
}
ÆÆ 
artifact
ÈÈ  
.
ÈÈ  !
SetProperty
ÈÈ! ,
(
ÈÈ, -
$str
ÈÈ- 9
,
ÈÈ9 :
compareResult
ÈÈ; H
.
ÈÈH I

ResultType
ÈÈI S
.
ÈÈS T
ToString
ÈÈT \
(
ÈÈ\ ]
)
ÈÈ] ^
)
ÈÈ^ _
;
ÈÈ_ `
	artifacts
ÊÊ !
.
ÊÊ! "
Add
ÊÊ" %
(
ÊÊ% &
artifact
ÊÊ& .
)
ÊÊ. /
;
ÊÊ/ 0
}
ËË 
foreach
ÍÍ 
(
ÍÍ 
var
ÍÍ  
rule
ÍÍ! %
in
ÍÍ& (
compareResult
ÍÍ) 6
.
ÍÍ6 7
Rules
ÍÍ7 <
)
ÍÍ< =
{
ÎÎ 
var
ÏÏ 
sarifResult
ÏÏ '
=
ÏÏ( )
new
ÏÏ* -
Result
ÏÏ. 4
(
ÏÏ4 5
)
ÏÏ5 6
;
ÏÏ6 7
int
ĞĞ 
index
ĞĞ !
=
ĞĞ" #
	artifacts
ĞĞ$ -
.
ĞĞ- .
	FindIndex
ĞĞ. 7
(
ĞĞ7 8
a
ĞĞ8 9
=>
ĞĞ: <
a
ĞĞ= >
.
ĞĞ> ?
Location
ĞĞ? G
.
ĞĞG H
Description
ĞĞH S
.
ĞĞS T
Text
ĞĞT X
==
ĞĞY [
compareResult
ĞĞ\ i
.
ĞĞi j
Identity
ĞĞj r
)
ĞĞr s
;
ĞĞs t
sarifResult
ÒÒ #
.
ÒÒ# $
	Locations
ÒÒ$ -
=
ÒÒ. /
new
ÒÒ0 3
List
ÒÒ4 8
<
ÒÒ8 9
Location
ÒÒ9 A
>
ÒÒA B
(
ÒÒB C
)
ÒÒC D
{
ÓÓ 
new
ÔÔ 
Location
ÔÔ  (
(
ÔÔ( )
)
ÔÔ) *
{
ÔÔ+ ,
PhysicalLocation
ÕÕ  0
=
ÕÕ1 2
new
ÕÕ3 6
PhysicalLocation
ÕÕ7 G
(
ÕÕG H
)
ÕÕH I
{
ÖÖ  !
ArtifactLocation
××$ 4
=
××5 6
new
××7 :
ArtifactLocation
××; K
(
××K L
)
××L M
{
ØØ$ %
Index
ÙÙ( -
=
ÙÙ. /
index
ÙÙ0 5
}
ÚÚ$ %
}
ÛÛ  !
}
ÜÜ 
}
İİ 
;
İİ 
sarifResult
ßß #
.
ßß# $
Level
ßß$ )
=
ßß* +"
GetSarifFailureLevel
ßß, @
(
ßß@ A
(
ßßA B"
ANALYSIS_RESULT_TYPE
ßßB V
)
ßßV W
rule
ßßW [
.
ßß[ \
Severity
ßß\ d
)
ßßd e
;
ßße f
if
áá 
(
áá 
!
áá 
string
áá #
.
áá# $ 
IsNullOrWhiteSpace
áá$ 6
(
áá6 7
rule
áá7 ;
.
áá; <
Name
áá< @
)
áá@ A
)
ááA B
{
ââ 
sarifResult
ãã '
.
ãã' (
RuleId
ãã( .
=
ãã/ 0
rule
ãã1 5
.
ãã5 6
Name
ãã6 :
;
ãã: ;
}
ää 
sarifResult
ææ #
.
ææ# $
Message
ææ$ +
=
ææ, -
new
ææ. 1
Message
ææ2 9
(
ææ9 :
)
ææ: ;
{
ææ< =
Text
ææ> B
=
ææC D
string
ææE K
.
ææK L
Format
ææL R
(
ææR S
$str
ææS c
,
ææc d
rule
ææe i
.
ææi j
Name
ææj n
,
ææn o
compareResult
ææp }
.
ææ} ~
Identityææ~ †
,ææ† ‡
compareResultææˆ •
.ææ• –

ChangeTypeææ–  
.ææ  ¡
ToStringææ¡ ©
(ææ© ª
)ææª «
)ææ« ¬
}ææ­ ®
;ææ® ¯
sarifResults
èè $
.
èè$ %
Add
èè% (
(
èè( )
sarifResult
èè) 4
)
èè4 5
;
èè5 6
}
éé 
}
êê 
}
ëë 
run
íí 
.
íí 
Results
íí 
=
íí 
sarifResults
íí &
;
íí& '
run
îî 
.
îî 
	Artifacts
îî 
=
îî 
	artifacts
îî %
;
îî% &
run
ğğ 
.
ğğ 
SetProperty
ğğ 
(
ğğ 
$str
ğğ (
,
ğğ( )
metadata
ğğ* 2
[
ğğ2 3
$str
ğğ3 ?
]
ğğ? @
)
ğğ@ A
;
ğğA B
run
ññ 
.
ññ 
SetProperty
ññ 
(
ññ 
$str
ññ /
,
ññ/ 0
metadata
ññ1 9
[
ññ9 :
$str
ññ: M
]
ññM N
)
ññN O
;
ññO P
run
òò 
.
òò 
SetProperty
òò 
(
òò 
$str
òò +
,
òò+ ,
metadata
òò- 5
[
òò5 6
$str
òò6 E
]
òòE F
)
òòF G
;
òòG H
log
ôô 
.
ôô 
Runs
ôô 
.
ôô 
Add
ôô 
(
ôô 
run
ôô 
)
ôô 
;
ôô 
return
öö 
log
öö 
;
öö 
}
÷÷ 	
private
ùù 
static
ùù 
FailureLevel
ùù #"
GetSarifFailureLevel
ùù$ 8
(
ùù8 9"
ANALYSIS_RESULT_TYPE
ùù9 M
type
ùùN R
)
ùùR S
{
úú 	
return
ûû 
type
ûû 
switch
ûû 
{
üü "
ANALYSIS_RESULT_TYPE
ıı $
.
ıı$ %
NONE
ıı% )
or
ıı* ,"
ANALYSIS_RESULT_TYPE
şş $
.
şş$ %
VERBOSE
şş% ,
or
şş- /"
ANALYSIS_RESULT_TYPE
ÿÿ $
.
ÿÿ$ %
DEBUG
ÿÿ% *
or
ÿÿ+ -"
ANALYSIS_RESULT_TYPE
€€ $
.
€€$ %
INFORMATION
€€% 0
=>
€€1 3
FailureLevel
€€4 @
.
€€@ A
Note
€€A E
,
€€E F"
ANALYSIS_RESULT_TYPE
 $
.
$ %
WARNING
% ,
=>
- /
FailureLevel
0 <
.
< =
Warning
= D
,
D E"
ANALYSIS_RESULT_TYPE
‚‚ $
.
‚‚$ %
ERROR
‚‚% *
or
‚‚+ -"
ANALYSIS_RESULT_TYPE
‚‚. B
.
‚‚B C
FATAL
‚‚C H
=>
‚‚I K
FailureLevel
‚‚L X
.
‚‚X Y
Error
‚‚Y ^
,
‚‚^ _
_
ƒƒ 
=>
ƒƒ 
FailureLevel
ƒƒ !
.
ƒƒ! "
None
ƒƒ" &
,
ƒƒ& '
}
„„ 
;
„„ 
}
…… 	
private
‡‡ 
class
‡‡ '
AsaExportContractResolver
‡‡ /
:
‡‡0 1%
DefaultContractResolver
‡‡2 I
{
ˆˆ 	
public
‰‰ 
static
‰‰ 
readonly
‰‰ "'
AsaExportContractResolver
‰‰# <
Instance
‰‰= E
=
‰‰F G
new
‰‰H K'
AsaExportContractResolver
‰‰L e
(
‰‰e f
)
‰‰f g
;
‰‰g h
	protected
‹‹ 
override
‹‹ 
JsonProperty
‹‹ +
CreateProperty
‹‹, :
(
‹‹: ;

MemberInfo
‹‹; E
member
‹‹F L
,
‹‹L M!
MemberSerialization
‹‹N a!
memberSerialization
‹‹b u
)
‹‹u v
{
ŒŒ 
JsonProperty
 
property
 %
=
& '
base
( ,
.
, -
CreateProperty
- ;
(
; <
member
< B
,
B C!
memberSerialization
D W
)
W X
;
X Y
if
 
(
 
property
 
.
 
DeclaringType
 *
==
+ -
typeof
. 4
(
4 5
RegistryObject
5 C
)
C D
)
D E
{
 
if
‘‘ 
(
‘‘ 
property
‘‘  
.
‘‘  !
PropertyName
‘‘! -
==
‘‘. 0
$str
‘‘1 :
||
‘‘; =
property
‘‘> F
.
‘‘F G
PropertyName
‘‘G S
==
‘‘T V
$str
‘‘W _
)
‘‘_ `
{
’’ 
property
““  
.
““  !
ShouldSerialize
““! 0
=
““1 2
_
““3 4
=>
““5 7
{
““8 9
return
““: @
false
““A F
;
““F G
}
““H I
;
““I J
}
”” 
}
•• 
if
—— 
(
—— 
property
—— 
.
—— 
DeclaringType
—— *
==
——+ -
typeof
——. 4
(
——4 5
Rule
——5 9
)
——9 :
)
——: ;
{
˜˜ 
if
™™ 
(
™™ 
property
™™  
.
™™  !
PropertyName
™™! -
!=
™™. 0
$str
™™1 7
&&
™™8 :
property
™™; C
.
™™C D
PropertyName
™™D P
!=
™™Q S
$str
™™T a
&&
™™b d
property
™™e m
.
™™m n
PropertyName
™™n z
!=
™™{ }
$str™™~ „
)™™„ …
{
šš 
property
››  
.
››  !
ShouldSerialize
››! 0
=
››1 2
_
››3 4
=>
››5 7
{
››8 9
return
››: @
false
››A F
;
››F G
}
››H I
;
››I J
}
œœ 
}
 
if
ŸŸ 
(
ŸŸ 
property
ŸŸ 
.
ŸŸ 
DeclaringType
ŸŸ *
==
ŸŸ+ -
typeof
ŸŸ. 4
(
ŸŸ4 5
CompareResult
ŸŸ5 B
)
ŸŸB C
)
ŸŸC D
{
   
if
¡¡ 
(
¡¡ 
property
¡¡  
.
¡¡  !
PropertyName
¡¡! -
==
¡¡. 0
$str
¡¡1 ?
)
¡¡? @
{
¢¢ 
property
££  
.
££  !
ShouldSerialize
££! 0
=
££1 2
_
££3 4
=>
££5 7
{
££8 9
return
££: @
false
££A F
;
££F G
}
££H I
;
££I J
}
¤¤ 
}
¥¥ 
return
§§ 
property
§§ 
;
§§  
}
¨¨ 
}
©© 	
private
«« 
static
«« 
	ASA_ERROR
««  %
RunExportMonitorCommand
««! 8
(
««8 9)
ExportMonitorCommandOptions
««9 T
opts
««U Y
)
««Y Z
{
¬¬ 	
if
­­ 
(
­­ 
DatabaseManager
­­ 
is
­­  "
null
­­# '
)
­­' (
{
®® 
Log
¯¯ 
.
¯¯ 
Error
¯¯ 
(
¯¯ 
$str
¯¯ 3
,
¯¯3 4
$str
¯¯5 N
)
¯¯N O
;
¯¯O P
return
°° 
	ASA_ERROR
°°  
.
°°  !
DATABASE_NULL
°°! .
;
°°. /
}
±± 
if
²² 
(
²² 
opts
²² 
.
²² 
RunId
²² 
is
²² 
null
²² "
)
²²" #
{
³³ 
var
´´ 
runIds
´´ 
=
´´ 
DatabaseManager
´´ ,
.
´´, -
GetLatestRunIds
´´- <
(
´´< =
$num
´´= >
,
´´> ?
RUN_TYPE
´´@ H
.
´´H I
MONITOR
´´I P
)
´´P Q
;
´´Q R
if
µµ 
(
µµ 
runIds
µµ 
.
µµ 
Any
µµ 
(
µµ 
)
µµ  
)
µµ  !
{
¶¶ 
opts
·· 
.
·· 
RunId
·· 
=
··  
runIds
··! '
.
··' (
First
··( -
(
··- .
)
··. /
;
··/ 0
}
¸¸ 
else
¹¹ 
{
ºº 
Log
»» 
.
»» 
Fatal
»» 
(
»» 
Strings
»» %
.
»»% &
Get
»»& )
(
»») *
$str
»»* F
)
»»F G
)
»»G H
;
»»H I
return
¼¼ 
	ASA_ERROR
¼¼ $
.
¼¼$ %

INVALID_ID
¼¼% /
;
¼¼/ 0
}
½½ 
}
¾¾ 
var
ÀÀ 
ruleFile
ÀÀ 
=
ÀÀ )
LoadRulesFromFileOrEmbedded
ÀÀ 6
(
ÀÀ6 7
opts
ÀÀ7 ;
.
ÀÀ; <
AnalysesFile
ÀÀ< H
)
ÀÀH I
;
ÀÀI J
if
ÁÁ 
(
ÁÁ 
!
ÁÁ 
ruleFile
ÁÁ 
.
ÁÁ 
Rules
ÁÁ 
.
ÁÁ  
Any
ÁÁ  #
(
ÁÁ# $
)
ÁÁ$ %
)
ÁÁ% &
{
ÂÂ 
Log
ÃÃ 
.
ÃÃ 
Warning
ÃÃ 
(
ÃÃ 
Strings
ÃÃ #
.
ÃÃ# $
Get
ÃÃ$ '
(
ÃÃ' (
$str
ÃÃ( 5
)
ÃÃ5 6
)
ÃÃ6 7
;
ÃÃ7 8
return
ÄÄ 
	ASA_ERROR
ÄÄ  
.
ÄÄ  !
INVALID_RULES
ÄÄ! .
;
ÄÄ. /
}
ÅÅ 
var
ÆÆ  
monitorCompareOpts
ÆÆ "
=
ÆÆ# $
new
ÆÆ% (#
CompareCommandOptions
ÆÆ) >
(
ÆÆ> ?
null
ÆÆ? C
,
ÆÆC D
opts
ÆÆE I
.
ÆÆI J
RunId
ÆÆJ O
)
ÆÆO P
{
ÇÇ 
DisableAnalysis
ÈÈ 
=
ÈÈ  !
opts
ÈÈ" &
.
ÈÈ& '
DisableAnalysis
ÈÈ' 6
,
ÈÈ6 7
AnalysesFile
ÉÉ 
=
ÉÉ 
ruleFile
ÉÉ '
,
ÉÉ' (*
ApplySubObjectRulesToMonitor
ÊÊ ,
=
ÊÊ- .
opts
ÊÊ/ 3
.
ÊÊ3 4*
ApplySubObjectRulesToMonitor
ÊÊ4 P
,
ÊÊP Q

RunScripts
ËË 
=
ËË 
opts
ËË !
.
ËË! "

RunScripts
ËË" ,
}
ÌÌ 
;
ÌÌ 
var
ÎÎ 
monitorResult
ÎÎ 
=
ÎÎ 
AnalyzeMonitored
ÎÎ  0
(
ÎÎ0 1 
monitorCompareOpts
ÎÎ1 C
)
ÎÎC D
;
ÎÎD E
var
ĞĞ 
analysesHash
ĞĞ 
=
ĞĞ  
monitorCompareOpts
ĞĞ 1
.
ĞĞ1 2
AnalysesFile
ĞĞ2 >
.
ĞĞ> ?
GetHash
ĞĞ? F
(
ĞĞF G
)
ĞĞG H
;
ĞĞH I
if
ÒÒ 
(
ÒÒ 
opts
ÒÒ 
.
ÒÒ 
SaveToDatabase
ÒÒ #
)
ÒÒ# $
{
ÓÓ "
InsertCompareResults
ÔÔ $
(
ÔÔ$ %
monitorResult
ÔÔ% 2
,
ÔÔ2 3
null
ÔÔ4 8
,
ÔÔ8 9
opts
ÔÔ: >
.
ÔÔ> ?
RunId
ÔÔ? D
,
ÔÔD E
analysesHash
ÔÔF R
)
ÔÔR S
;
ÔÔS T
}
ÕÕ 
return
×× "
ExportCompareResults
×× '
(
××' (
monitorResult
××( 5
,
××5 6
opts
××7 ;
,
××; <

AsaHelpers
××= G
.
××G H
MakeValidFileName
××H Y
(
××Y Z
opts
××Z ^
.
××^ _
RunId
××_ d
)
××d e
,
××e f
analysesHash
××g s
,
××s t
ruleFile
××u }
.
××} ~
Rules××~ ƒ
)××ƒ „
;××„ …
}
ØØ 	
public
ÚÚ 
static
ÚÚ 
void
ÚÚ 
WriteMonitorJson
ÚÚ +
(
ÚÚ+ ,
string
ÚÚ, 2
RunId
ÚÚ3 8
,
ÚÚ8 9
int
ÚÚ: =

ResultType
ÚÚ> H
,
ÚÚH I
string
ÚÚJ P

OutputPath
ÚÚQ [
)
ÚÚ[ \
{
ÛÛ 	
if
ÜÜ 
(
ÜÜ 
DatabaseManager
ÜÜ 
is
ÜÜ  "
null
ÜÜ# '
)
ÜÜ' (
{
İİ 
Log
ŞŞ 
.
ŞŞ 
Error
ŞŞ 
(
ŞŞ 
$str
ŞŞ 3
,
ŞŞ3 4
$str
ŞŞ5 G
)
ŞŞG H
;
ŞŞH I
return
ßß 
;
ßß 
}
àà 
var
áá "
invalidFileNameChars
áá $
=
áá% &
Path
áá' +
.
áá+ ,!
GetInvalidPathChars
áá, ?
(
áá? @
)
áá@ A
.
ááA B
ToList
ááB H
(
ááH I
)
ááI J
;
ááJ K

OutputPath
ââ 
=
ââ 
new
ââ 
string
ââ #
(
ââ# $

OutputPath
ââ$ .
.
ââ. /
Select
ââ/ 5
(
ââ5 6
ch
ââ6 8
=>
ââ9 ;"
invalidFileNameChars
ââ< P
.
ââP Q
Contains
ââQ Y
(
ââY Z
ch
ââZ \
)
ââ\ ]
?
ââ^ _
Convert
ââ` g
.
ââg h
ToChar
ââh n
(
âân o#
invalidFileNameCharsââo ƒ
.ââƒ „
IndexOfââ„ ‹
(ââ‹ Œ
chââŒ 
)ââ 
+ââ ‘
$numââ’ ”
)ââ” •
:ââ– —
chââ˜ š
)ââš ›
.ââ› œ
ToArrayââœ £
(ââ£ ¤
)ââ¤ ¥
)ââ¥ ¦
;ââ¦ §
List
ää 
<
ää 
FileMonitorEvent
ää !
>
ää! "
records
ää# *
=
ää+ ,
DatabaseManager
ää- <
.
ää< =)
GetSerializedMonitorResults
ää= X
(
ääX Y
RunId
ääY ^
)
ää^ _
;
ää_ `
JsonSerializer
ææ 

serializer
ææ %
=
ææ& '
JsonSerializer
ææ( 6
.
ææ6 7
Create
ææ7 =
(
ææ= >
new
ææ> A$
JsonSerializerSettings
ææB X
(
ææX Y
)
ææY Z
{
çç 

Formatting
èè 
=
èè 

Formatting
èè '
.
èè' (
Indented
èè( 0
,
èè0 1
NullValueHandling
éé !
=
éé" #
NullValueHandling
éé$ 5
.
éé5 6
Ignore
éé6 <
,
éé< ="
DefaultValueHandling
êê $
=
êê% &"
DefaultValueHandling
êê' ;
.
êê; <
Ignore
êê< B
,
êêB C

Converters
ëë 
=
ëë 
new
ëë  
List
ëë! %
<
ëë% &
JsonConverter
ëë& 3
>
ëë3 4
(
ëë4 5
)
ëë5 6
{
ëë7 8
new
ëë9 <!
StringEnumConverter
ëë= P
(
ëëP Q
)
ëëQ R
}
ëëS T
}
ìì 
)
ìì 
;
ìì 
var
íí 
output
íí 
=
íí 
new
íí 

Dictionary
íí '
<
íí' (
string
íí( .
,
íí. /
Object
íí0 6
>
íí6 7
(
íí7 8
)
íí8 9
;
íí9 :
output
îî 
[
îî 
$str
îî 
]
îî 
=
îî 
records
îî  '
;
îî' (
output
ïï 
[
ïï 
$str
ïï 
]
ïï 
=
ïï  

AsaHelpers
ïï! +
.
ïï+ ,
GenerateMetadata
ïï, <
(
ïï< =
)
ïï= >
;
ïï> ?
string
ğğ 
path
ğğ 
=
ğğ 
Path
ğğ 
.
ğğ 
Combine
ğğ &
(
ğğ& '

OutputPath
ğğ' 1
,
ğğ1 2

AsaHelpers
ğğ3 =
.
ğğ= >
MakeValidFileName
ğğ> O
(
ğğO P
RunId
ğğP U
+
ğğV W
$str
ğğX f
+
ğğg h
(
ğği j
(
ğğj k
RESULT_TYPE
ğğk v
)
ğğv w

ResultTypeğğw 
)ğğ ‚
.ğğ‚ ƒ
ToStringğğƒ ‹
(ğğ‹ Œ
)ğğŒ 
+ğğ 
$strğğ ›
)ğğ› œ
)ğğœ 
;ğğ 
using
òò 
(
òò 
StreamWriter
òò 
sw
òò  "
=
òò# $
new
òò% (
StreamWriter
òò) 5
(
òò5 6
path
òò6 :
)
òò: ;
)
òò; <
using
óó 
(
óó 

JsonWriter
óó 
writer
óó $
=
óó% &
new
óó' *
JsonTextWriter
óó+ 9
(
óó9 :
sw
óó: <
)
óó< =
)
óó= >
{
ôô 

serializer
õõ 
.
õõ 
	Serialize
õõ $
(
õõ$ %
writer
õõ% +
,
õõ+ ,
output
õõ- 3
)
õõ3 4
;
õõ4 5
}
öö 
Log
øø 
.
øø 
Information
øø 
(
øø 
Strings
øø #
.
øø# $
Get
øø$ '
(
øø' (
$str
øø( 9
)
øø9 :
,
øø: ;
(
øø< =
new
øø= @
FileInfo
øøA I
(
øøI J
path
øøJ N
)
øøN O
)
øøO P
.
øøP Q
FullName
øøQ Y
)
øøY Z
;
øøZ [
}
ùù 	
private
ûû 
static
ûû 
	ASA_ERROR
ûû  
RunMonitorCommand
ûû! 2
(
ûû2 3#
MonitorCommandOptions
ûû3 H
opts
ûûI M
)
ûûM N
{
üü 	
if
ıı 
(
ıı 
DatabaseManager
ıı 
is
ıı  "
null
ıı# '
)
ıı' (
{
şş 
Log
ÿÿ 
.
ÿÿ 
Error
ÿÿ 
(
ÿÿ 
$str
ÿÿ 3
,
ÿÿ3 4
$str
ÿÿ5 H
)
ÿÿH I
;
ÿÿI J
return
€€ 
	ASA_ERROR
€€  
.
€€  !
DATABASE_NULL
€€! .
;
€€. /
}
 
if
‚‚ 
(
‚‚ 
opts
‚‚ 
.
‚‚ 
RunId
‚‚ 
is
‚‚ 
string
‚‚ $
)
‚‚$ %
{
ƒƒ 
opts
„„ 
.
„„ 
RunId
„„ 
=
„„ 
opts
„„ !
.
„„! "
RunId
„„" '
.
„„' (
Trim
„„( ,
(
„„, -
)
„„- .
;
„„. /
}
…… 
else
†† 
{
‡‡ 
opts
ˆˆ 
.
ˆˆ 
RunId
ˆˆ 
=
ˆˆ 
DateTime
ˆˆ %
.
ˆˆ% &
Now
ˆˆ& )
.
ˆˆ) *
ToString
ˆˆ* 2
(
ˆˆ2 3
$str
ˆˆ3 6
,
ˆˆ6 7
CultureInfo
ˆˆ8 C
.
ˆˆC D
InvariantCulture
ˆˆD T
)
ˆˆT U
;
ˆˆU V
}
‰‰ 
if
‹‹ 
(
‹‹ 
opts
‹‹ 
.
‹‹ 
	Overwrite
‹‹ 
)
‹‹ 
{
ŒŒ 
DatabaseManager
 
.
  
	DeleteRun
  )
(
) *
opts
* .
.
. /
RunId
/ 4
)
4 5
;
5 6
}
 
else
 
{
 
if
‘‘ 
(
‘‘ 
DatabaseManager
‘‘ #
.
‘‘# $
GetRun
‘‘$ *
(
‘‘* +
opts
‘‘+ /
.
‘‘/ 0
RunId
‘‘0 5
)
‘‘5 6
!=
‘‘7 9
null
‘‘: >
)
‘‘> ?
{
’’ 
Log
““ 
.
““ 
Error
““ 
(
““ 
Strings
““ %
.
““% &
Get
““& )
(
““) *
$str
““* @
)
““@ A
)
““A B
;
““B C
return
”” 
	ASA_ERROR
”” $
.
””$ %
	UNIQUE_ID
””% .
;
””. /
}
•• 
}
–– 
var
—— 
run
—— 
=
—— 
new
—— 
AsaRun
——  
(
——  !
RunId
——! &
:
——& '
opts
——( ,
.
——, -
RunId
——- 2
,
——2 3
	Timestamp
——4 =
:
——= >
DateTime
——? G
.
——G H
Now
——H K
,
——K L
Version
——M T
:
——T U

AsaHelpers
——V `
.
——` a
GetVersionString
——a q
(
——q r
)
——r s
,
——s t
Platform
——u }
:
——} ~

AsaHelpers—— ‰
.——‰ Š
GetPlatform——Š •
(——• –
)——– —
,——— ˜
new——™ œ
List—— ¡
<——¡ ¢
RESULT_TYPE——¢ ­
>——­ ®
(——® ¯
)——¯ °
{——± ²
RESULT_TYPE——³ ¾
.——¾ ¿
FILEMONITOR——¿ Ê
}——Ë Ì
,——Ì Í
RUN_TYPE——Î Ö
.——Ö ×
MONITOR——× Ş
)——Ş ß
;——ß à
DatabaseManager
™™ 
.
™™ 
	InsertRun
™™ %
(
™™% &
run
™™& )
)
™™) *
;
™™* +
var
›› 
returnValue
›› 
=
›› 
	ASA_ERROR
›› '
.
››' (
NONE
››( ,
;
››, -
if
 
(
 
opts
 
.
 %
EnableFileSystemMonitor
 ,
)
, -
{
 
monitors
ŸŸ 
.
ŸŸ 
Add
ŸŸ 
(
ŸŸ 
new
ŸŸ  
FileSystemMonitor
ŸŸ! 2
(
ŸŸ2 3
opts
ŸŸ3 7
,
ŸŸ7 8
x
ŸŸ9 :
=>
ŸŸ; =
DatabaseManager
ŸŸ> M
.
ŸŸM N
Write
ŸŸN S
(
ŸŸS T
x
ŸŸT U
,
ŸŸU V
opts
ŸŸW [
.
ŸŸ[ \
RunId
ŸŸ\ a
)
ŸŸa b
)
ŸŸb c
)
ŸŸc d
;
ŸŸd e
}
   
if
¢¢ 
(
¢¢ 
monitors
¢¢ 
.
¢¢ 
Count
¢¢ 
==
¢¢ !
$num
¢¢" #
)
¢¢# $
{
££ 
Log
¤¤ 
.
¤¤ 
Warning
¤¤ 
(
¤¤ 
Strings
¤¤ #
.
¤¤# $
Get
¤¤$ '
(
¤¤' (
$str
¤¤( 8
)
¤¤8 9
)
¤¤9 :
;
¤¤: ;
returnValue
¥¥ 
=
¥¥ 
	ASA_ERROR
¥¥ '
.
¥¥' (
NO_COLLECTORS
¥¥( 5
;
¥¥5 6
}
¦¦ 
using
¨¨ 
var
¨¨ 
	exitEvent
¨¨ 
=
¨¨  !
new
¨¨" %
ManualResetEvent
¨¨& 6
(
¨¨6 7
false
¨¨7 <
)
¨¨< =
;
¨¨= >
if
«« 
(
«« 
opts
«« 
.
«« 
Duration
«« 
>
«« 
$num
««  !
)
««! "
{
¬¬ 
Log
­­ 
.
­­ 
Information
­­ 
(
­­  
$str
­­  .
,
­­. /
Strings
­­0 7
.
­­7 8
Get
­­8 ;
(
­­; <
$str
­­< O
)
­­O P
,
­­P Q
opts
­­R V
.
­­V W
Duration
­­W _
,
­­_ `
Strings
­­a h
.
­­h i
Get
­­i l
(
­­l m
$str
­­m v
)
­­v w
)
­­w x
;
­­x y
using
®® 
var
®® 
aTimer
®®  
=
®®! "
new
®®# &
System
®®' -
.
®®- .
Timers
®®. 4
.
®®4 5
Timer
®®5 :
{
¯¯ 
Interval
°° 
=
°° 
opts
°° #
.
°°# $
Duration
°°$ ,
*
°°- .
$num
°°/ 1
*
°°2 3
$num
°°4 8
,
°°8 9
	AutoReset
±± 
=
±± 
false
±±  %
,
±±% &
}
²² 
;
²² 
aTimer
³³ 
.
³³ 
Elapsed
³³ 
+=
³³ !
(
³³" #
source
³³# )
,
³³) *
e
³³+ ,
)
³³, -
=>
³³. 0
{
³³1 2
	exitEvent
³³3 <
.
³³< =
Set
³³= @
(
³³@ A
)
³³A B
;
³³B C
}
³³D E
;
³³E F
aTimer
¶¶ 
.
¶¶ 
Enabled
¶¶ 
=
¶¶  
true
¶¶! %
;
¶¶% &
}
·· 
foreach
¹¹ 
(
¹¹ 
FileSystemMonitor
¹¹ &
c
¹¹' (
in
¹¹) +
monitors
¹¹, 4
)
¹¹4 5
{
ºº 
Log
»» 
.
»» 
Information
»» 
(
»»  
Strings
»»  '
.
»»' (
Get
»»( +
(
»»+ ,
$str
»», 3
)
»»3 4
,
»»4 5
c
»»6 7
.
»»7 8
GetType
»»8 ?
(
»»? @
)
»»@ A
.
»»A B
Name
»»B F
)
»»F G
;
»»G H
try
½½ 
{
¾¾ 
c
¿¿ 
.
¿¿ 
StartRun
¿¿ 
(
¿¿ 
)
¿¿  
;
¿¿  !
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ  
ex
ÁÁ! #
)
ÁÁ# $
{
ÂÂ 
Log
ÃÃ 
.
ÃÃ 
Error
ÃÃ 
(
ÃÃ 
Strings
ÃÃ %
.
ÃÃ% &
Get
ÃÃ& )
(
ÃÃ) *
$str
ÃÃ* >
)
ÃÃ> ?
,
ÃÃ? @
c
ÃÃA B
.
ÃÃB C
GetType
ÃÃC J
(
ÃÃJ K
)
ÃÃK L
.
ÃÃL M
Name
ÃÃM Q
,
ÃÃQ R
ex
ÃÃS U
.
ÃÃU V
Message
ÃÃV ]
,
ÃÃ] ^
ex
ÃÃ_ a
.
ÃÃa b

StackTrace
ÃÃb l
)
ÃÃl m
;
ÃÃm n
returnValue
ÄÄ 
=
ÄÄ  !
	ASA_ERROR
ÄÄ" +
.
ÄÄ+ ,
UNKNOWN
ÄÄ, 3
;
ÄÄ3 4
}
ÅÅ 
}
ÆÆ 
void
ÈÈ #
consoleCancelDelegate
ÈÈ &
(
ÈÈ& '
object
ÈÈ' -
?
ÈÈ- .
sender
ÈÈ/ 5
,
ÈÈ5 6$
ConsoleCancelEventArgs
ÈÈ7 M
args
ÈÈN R
)
ÈÈR S
{
ÉÉ 
args
ÊÊ 
.
ÊÊ 
Cancel
ÊÊ 
=
ÊÊ 
true
ÊÊ "
;
ÊÊ" #
	exitEvent
ËË 
.
ËË 
Set
ËË 
(
ËË 
)
ËË 
;
ËË  
}
ÌÌ 
;
ÌÌ 
Console
ÎÎ 
.
ÎÎ 
CancelKeyPress
ÎÎ "
+=
ÎÎ# %#
consoleCancelDelegate
ÎÎ& ;
;
ÎÎ; <
Console
ĞĞ 
.
ĞĞ 
Write
ĞĞ 
(
ĞĞ 
Strings
ĞĞ !
.
ĞĞ! "
Get
ĞĞ" %
(
ĞĞ% &
$str
ĞĞ& 8
)
ĞĞ8 9
)
ĞĞ9 :
;
ĞĞ: ;
WriteSpinner
ÓÓ 
(
ÓÓ 
	exitEvent
ÓÓ "
)
ÓÓ" #
;
ÓÓ# $
Log
ÔÔ 
.
ÔÔ 
Information
ÔÔ 
(
ÔÔ 
$str
ÔÔ 
)
ÔÔ 
;
ÔÔ  
foreach
ÖÖ 
(
ÖÖ 
var
ÖÖ 
c
ÖÖ 
in
ÖÖ 
monitors
ÖÖ &
)
ÖÖ& '
{
×× 
Log
ØØ 
.
ØØ 
Information
ØØ 
(
ØØ  
Strings
ØØ  '
.
ØØ' (
Get
ØØ( +
(
ØØ+ ,
$str
ØØ, 1
)
ØØ1 2
,
ØØ2 3
c
ØØ4 5
.
ØØ5 6
GetType
ØØ6 =
(
ØØ= >
)
ØØ> ?
.
ØØ? @
Name
ØØ@ D
)
ØØD E
;
ØØE F
try
ÚÚ 
{
ÛÛ 
c
ÜÜ 
.
ÜÜ 
StopRun
ÜÜ 
(
ÜÜ 
)
ÜÜ 
;
ÜÜ  
if
İİ 
(
İİ 
c
İİ 
is
İİ 
FileSystemMonitor
İİ .
)
İİ. /
{
ŞŞ 
(
ßß 
(
ßß 
FileSystemMonitor
ßß +
)
ßß+ ,
c
ßß, -
)
ßß- .
.
ßß. /
Dispose
ßß/ 6
(
ßß6 7
)
ßß7 8
;
ßß8 9
}
àà 
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ  
ex
ââ! #
)
ââ# $
{
ãã 
Log
ää 
.
ää 
Error
ää 
(
ää 
ex
ää  
,
ää  !
$str
ää" -
,
ää- .
c
ää/ 0
.
ää0 1
GetType
ää1 8
(
ää8 9
)
ää9 :
.
ää: ;
Name
ää; ?
,
ää? @
ex
ääA C
.
ääC D
Message
ääD K
,
ääK L
Strings
ääM T
.
ääT U
Get
ääU X
(
ääX Y
$str
ääY g
)
ääg h
)
ääh i
;
ääi j
}
åå 
}
ææ 
FlushResults
èè 
(
èè 
)
èè 
;
èè 
DatabaseManager
êê 
.
êê 
Commit
êê "
(
êê" #
)
êê# $
;
êê$ %
Console
ìì 
.
ìì 
CancelKeyPress
ìì "
-=
ìì# %#
consoleCancelDelegate
ìì& ;
;
ìì; <
return
îî 
returnValue
îî 
;
îî 
}
ïï 	
public
ññ 
static
ññ 
List
ññ 
<
ññ 
BaseCollector
ññ (
>
ññ( )
GetCollectors
ññ* 7
(
ññ7 8
)
ññ8 9
{
òò 	
return
óó 

collectors
óó 
;
óó 
}
ôô 	
public
öö 
static
öö 
List
öö 
<
öö 
BaseMonitor
öö &
>
öö& '
GetMonitors
öö( 3
(
öö3 4
)
öö4 5
{
÷÷ 	
return
øø 
monitors
øø 
;
øø 
}
ùù 	
public
ûû 
static
ûû 
List
ûû 
<
ûû 
BaseCompare
ûû &
>
ûû& '
GetComparators
ûû( 6
(
ûû6 7
)
ûû7 8
{
üü 	
return
ıı 
comparators
ıı 
;
ıı 
}
şş 	
public
€€ 
static
€€ "
ConcurrentDictionary
€€ *
<
€€* +
(
€€+ ,
RESULT_TYPE
€€, 7
,
€€7 8
CHANGE_TYPE
€€9 D
)
€€D E
,
€€E F
List
€€G K
<
€€K L
CompareResult
€€L Y
>
€€Y Z
>
€€Z [
CompareRuns
€€\ g
(
€€g h#
CompareCommandOptions
€€h }
opts€€~ ‚
)€€‚ ƒ
{
 	
if
‚‚ 
(
‚‚ 
opts
‚‚ 
is
‚‚ 
null
‚‚ 
)
‚‚ 
{
ƒƒ 
throw
„„ 
new
„„ #
ArgumentNullException
„„ /
(
„„/ 0
nameof
„„0 6
(
„„6 7
opts
„„7 ;
)
„„; <
)
„„< =
;
„„= >
}
…… 
if
†† 
(
†† 
DatabaseManager
†† 
is
††  "
null
††# '
)
††' (
{
‡‡ 
Log
ˆˆ 
.
ˆˆ 
Error
ˆˆ 
(
ˆˆ 
$str
ˆˆ 3
,
ˆˆ3 4
$str
ˆˆ5 B
)
ˆˆB C
;
ˆˆC D
return
‰‰ 
new
‰‰ "
ConcurrentDictionary
‰‰ /
<
‰‰/ 0
(
‰‰0 1
RESULT_TYPE
‰‰1 <
,
‰‰< =
CHANGE_TYPE
‰‰> I
)
‰‰I J
,
‰‰J K
List
‰‰L P
<
‰‰P Q
CompareResult
‰‰Q ^
>
‰‰^ _
>
‰‰_ `
(
‰‰` a
)
‰‰a b
;
‰‰b c
}
ŠŠ 
comparators
‹‹ 
=
‹‹ 
new
‹‹ 
List
‹‹ "
<
‹‹" #
BaseCompare
‹‹# .
>
‹‹. /
(
‹‹/ 0
)
‹‹0 1
;
‹‹1 2

Dictionary
 
<
 
string
 
,
 
string
 %
>
% &
EndEvent
' /
=
0 1
new
2 5

Dictionary
6 @
<
@ A
string
A G
,
G H
string
I O
>
O P
(
P Q
)
Q R
;
R S
BaseCompare
 
c
 
=
 
new
 
BaseCompare
  +
(
+ ,
)
, -
;
- .
var
 
watch
 
=
 
System
 
.
 
Diagnostics
 *
.
* +
	Stopwatch
+ 4
.
4 5
StartNew
5 =
(
= >
)
> ?
;
? @
if
 
(
 
!
 
c
 
.
 

TryCompare
 
(
 
opts
 "
.
" #

FirstRunId
# -
,
- .
opts
/ 3
.
3 4
SecondRunId
4 ?
,
? @
DatabaseManager
A P
)
P Q
)
Q R
{
‘‘ 
Log
’’ 
.
’’ 
Warning
’’ 
(
’’ 
Strings
’’ #
.
’’# $
Get
’’$ '
(
’’' (
$str
’’( 7
)
’’7 8
+
’’9 :
$str
’’; C
,
’’C D
c
’’E F
.
’’F G
GetType
’’G N
(
’’N O
)
’’O P
.
’’P Q
Name
’’Q U
)
’’U V
;
’’V W
}
““ 
watch
•• 
.
•• 
Stop
•• 
(
•• 
)
•• 
;
•• 
TimeSpan
–– 
t
–– 
=
–– 
TimeSpan
–– !
.
––! "
FromMilliseconds
––" 2
(
––2 3
watch
––3 8
.
––8 9!
ElapsedMilliseconds
––9 L
)
––L M
;
––M N
string
—— 
answer
—— 
=
—— 
string
—— "
.
——" #
Format
——# )
(
——) *
CultureInfo
——* 5
.
——5 6
InvariantCulture
——6 F
,
——F G
$str
——H j
,
——j k
t
˜˜$ %
.
˜˜% &
Hours
˜˜& +
,
˜˜+ ,
t
™™$ %
.
™™% &
Minutes
™™& -
,
™™- .
t
šš$ %
.
šš% &
Seconds
šš& -
,
šš- .
t
››$ %
.
››% &
Milliseconds
››& 2
)
››2 3
;
››3 4
Log
 
.
 
Information
 
(
 
Strings
 #
.
# $
Get
$ '
(
' (
$str
( 3
)
3 4
,
4 5
$str
6 A
,
A B
answer
C I
)
I J
;
J K
if
ŸŸ 
(
ŸŸ 
!
ŸŸ 
opts
ŸŸ 
.
ŸŸ 
DisableAnalysis
ŸŸ %
)
ŸŸ% &
{
   
if
¡¡ 
(
¡¡ 
opts
¡¡ 
.
¡¡ 
AnalysesFile
¡¡ %
is
¡¡& (
not
¡¡) ,
null
¡¡- 1
)
¡¡1 2
{
¢¢ 
watch
££ 
=
££ 
	Stopwatch
££ %
.
££% &
StartNew
££& .
(
££. /
)
££/ 0
;
££0 1
var
¤¤ 
analyzer
¤¤  
=
¤¤! "
new
¤¤# &
AsaAnalyzer
¤¤' 2
(
¤¤2 3
new
¤¤3 6
AnalyzerOptions
¤¤7 F
(
¤¤F G
opts
¤¤G K
.
¤¤K L

RunScripts
¤¤L V
)
¤¤V W
)
¤¤W X
;
¤¤X Y
var
¥¥ 
platform
¥¥  
=
¥¥! "
DatabaseManager
¥¥# 2
.
¥¥2 3
RunIdToPlatform
¥¥3 B
(
¥¥B C
opts
¥¥C G
.
¥¥G H
SecondRunId
¥¥H S
)
¥¥S T
;
¥¥T U
var
¦¦ 

violations
¦¦ "
=
¦¦# $
analyzer
¦¦% -
.
¦¦- .!
EnumerateRuleIssues
¦¦. A
(
¦¦A B
opts
¦¦B F
.
¦¦F G
AnalysesFile
¦¦G S
.
¦¦S T
Rules
¦¦T Y
)
¦¦Y Z
;
¦¦Z [
var
§§ 
analysesHash
§§ $
=
§§% &
opts
§§' +
.
§§+ ,
AnalysesFile
§§, 8
.
§§8 9
GetHash
§§9 @
(
§§@ A
)
§§A B
;
§§B C
OAT
¨¨ 
.
¨¨ 
Utils
¨¨ 
.
¨¨ 
Strings
¨¨ %
.
¨¨% &
Setup
¨¨& +
(
¨¨+ ,
)
¨¨, -
;
¨¨- .
OAT
©© 
.
©© 
Utils
©© 
.
©© 
Helpers
©© %
.
©©% &
PrintViolations
©©& 5
(
©©5 6

violations
©©6 @
)
©©@ A
;
©©A B
if
ªª 
(
ªª 

violations
ªª "
.
ªª" #
Any
ªª# &
(
ªª& '
)
ªª' (
)
ªª( )
{
«« 
Log
¬¬ 
.
¬¬ 
Error
¬¬ !
(
¬¬! "
$str
¬¬" `
,
¬¬` a

violations
¬¬b l
.
¬¬l m
Count
¬¬m r
(
¬¬r s
)
¬¬s t
,
¬¬t u
opts
¬¬v z
.
¬¬z {
AnalysesFile¬¬{ ‡
?¬¬‡ ˆ
.¬¬ˆ ‰
Source¬¬‰ 
??¬¬ ’
$str¬¬“ 
)¬¬ 
;¬¬ Ÿ
}
­­ 
else
®® 
{
¯¯ 
if
°° 
(
°° 
c
°° 
.
°° 
Results
°° %
.
°°% &
Count
°°& +
>
°°, -
$num
°°. /
)
°°/ 0
{
±± 
foreach
²² #
(
²²$ %
var
²²% (
key
²²) ,
in
²²- /
c
²²0 1
.
²²1 2
Results
²²2 9
.
²²9 :
Keys
²²: >
)
²²> ?
{
³³ 
if
´´  "
(
´´# $
c
´´$ %
.
´´% &
Results
´´& -
[
´´- .
key
´´. 1
]
´´1 2
is
´´3 5
List
´´6 :
<
´´: ;
CompareResult
´´; H
>
´´H I
queue
´´J O
)
´´O P
{
µµ  !
queue
¶¶$ )
.
¶¶) *

AsParallel
¶¶* 4
(
¶¶4 5
)
¶¶5 6
.
¶¶6 7
ForAll
¶¶7 =
(
¶¶= >
res
¶¶> A
=>
¶¶B D
{
··$ %
var
»»( +
selectedRules
»», 9
=
»»: ;
opts
»»< @
.
»»@ A
AnalysesFile
»»A M
.
»»M N
Rules
»»N S
.
»»S T
Where
»»T Y
(
»»Y Z
(
»»Z [
rule
»»[ _
)
»»_ `
=>
»»a c
(
¼¼, -
rule
¼¼- 1
.
¼¼1 2
ChangeTypes
¼¼2 =
==
¼¼> @
null
¼¼A E
||
¼¼F H
rule
¼¼I M
.
¼¼M N
ChangeTypes
¼¼N Y
.
¼¼Y Z
Contains
¼¼Z b
(
¼¼b c
res
¼¼c f
.
¼¼f g

ChangeType
¼¼g q
)
¼¼q r
)
¼¼r s
&&
½½0 2
(
½½3 4
rule
½½4 8
.
½½8 9
	Platforms
½½9 B
==
½½C E
null
½½F J
||
½½K M
rule
½½N R
.
½½R S
	Platforms
½½S \
.
½½\ ]
Contains
½½] e
(
½½e f
platform
½½f n
)
½½n o
)
½½o p
&&
¾¾0 2
(
¾¾3 4
rule
¾¾4 8
.
¾¾8 9

ResultType
¾¾9 C
==
¾¾D F
res
¾¾G J
.
¾¾J K

ResultType
¾¾K U
)
¾¾U V
)
¾¾V W
;
¾¾W X
res
¿¿( +
.
¿¿+ ,
Rules
¿¿, 1
=
¿¿2 3
analyzer
¿¿4 <
.
¿¿< =
Analyze
¿¿= D
(
¿¿D E
selectedRules
¿¿E R
,
¿¿R S
res
¿¿T W
.
¿¿W X
Base
¿¿X \
,
¿¿\ ]
res
¿¿^ a
.
¿¿a b
Compare
¿¿b i
)
¿¿i j
.
¿¿j k
ToList
¿¿k q
(
¿¿q r
)
¿¿r s
;
¿¿s t
res
ÀÀ( +
.
ÀÀ+ ,
Analysis
ÀÀ, 4
=
ÀÀ5 6
res
ÀÀ7 :
.
ÀÀ: ;
Rules
ÀÀ; @
.
ÀÀ@ A
Count
ÀÀA F
>
ÁÁ7 8
$num
ÁÁ9 :
?
ÁÁ; <
res
ÁÁ= @
.
ÁÁ@ A
Rules
ÁÁA F
.
ÁÁF G
Max
ÁÁG J
(
ÁÁJ K
x
ÁÁK L
=>
ÁÁM O
(
ÁÁP Q
(
ÁÁQ R
AsaRule
ÁÁR Y
)
ÁÁY Z
x
ÁÁZ [
)
ÁÁ[ \
.
ÁÁ\ ]
Flag
ÁÁ] a
)
ÁÁa b
:
ÁÁc d
opts
ÁÁe i
.
ÁÁi j
AnalysesFile
ÁÁj v
.
ÁÁv w
DefaultLevelsÁÁw „
[ÁÁ„ …
resÁÁ… ˆ
.ÁÁˆ ‰

ResultTypeÁÁ‰ “
]ÁÁ“ ”
;ÁÁ” •
res
ÂÂ( +
.
ÂÂ+ ,
AnalysesHash
ÂÂ, 8
=
ÂÂ9 :
analysesHash
ÂÂ; G
;
ÂÂG H
}
ÃÃ$ %
)
ÃÃ% &
;
ÃÃ& '
}
ÄÄ  !
}
ÅÅ 
}
ÆÆ 
}
ÇÇ 
watch
ÉÉ 
.
ÉÉ 
Stop
ÉÉ 
(
ÉÉ 
)
ÉÉ  
;
ÉÉ  !
t
ÊÊ 
=
ÊÊ 
TimeSpan
ÊÊ  
.
ÊÊ  !
FromMilliseconds
ÊÊ! 1
(
ÊÊ1 2
watch
ÊÊ2 7
.
ÊÊ7 8!
ElapsedMilliseconds
ÊÊ8 K
)
ÊÊK L
;
ÊÊL M
answer
ËË 
=
ËË 
string
ËË #
.
ËË# $
Format
ËË$ *
(
ËË* +
CultureInfo
ËË+ 6
.
ËË6 7
InvariantCulture
ËË7 G
,
ËËG H
$str
ËËI k
,
ËËk l
t
ÌÌ, -
.
ÌÌ- .
Hours
ÌÌ. 3
,
ÌÌ3 4
t
ÍÍ, -
.
ÍÍ- .
Minutes
ÍÍ. 5
,
ÍÍ5 6
t
ÎÎ, -
.
ÎÎ- .
Seconds
ÎÎ. 5
,
ÎÎ5 6
t
ÏÏ, -
.
ÏÏ- .
Milliseconds
ÏÏ. :
)
ÏÏ: ;
;
ÏÏ; <
Log
ĞĞ 
.
ĞĞ 
Information
ĞĞ #
(
ĞĞ# $
Strings
ĞĞ$ +
.
ĞĞ+ ,
Get
ĞĞ, /
(
ĞĞ/ 0
$str
ĞĞ0 ;
)
ĞĞ; <
,
ĞĞ< =
$str
ĞĞ> H
,
ĞĞH I
answer
ĞĞJ P
)
ĞĞP Q
;
ĞĞQ R
}
ÑÑ 
else
ÒÒ 
{
ÓÓ 
Log
ÔÔ 
.
ÔÔ 
Error
ÔÔ 
(
ÔÔ 
Strings
ÔÔ %
.
ÔÔ% &
Get
ÔÔ& )
(
ÔÔ) *
$str
ÔÔ* <
)
ÔÔ< =
)
ÔÔ= >
;
ÔÔ> ?
}
ÕÕ 
}
ÖÖ 
return
ØØ 
c
ØØ 
.
ØØ 
Results
ØØ 
;
ØØ 
}
ÙÙ 	
public
ÛÛ 
static
ÛÛ 
	ASA_ERROR
ÛÛ "
RunGuiMonitorCommand
ÛÛ  4
(
ÛÛ4 5#
MonitorCommandOptions
ÛÛ5 J
opts
ÛÛK O
)
ÛÛO P
{
ÜÜ 	
if
İİ 
(
İİ 
DatabaseManager
İİ 
is
İİ  "
null
İİ# '
)
İİ' (
{
ŞŞ 
Log
ßß 
.
ßß 
Error
ßß 
(
ßß 
$str
ßß 3
,
ßß3 4
$str
ßß5 K
)
ßßK L
;
ßßL M
return
àà 
	ASA_ERROR
àà  
.
àà  !
DATABASE_NULL
àà! .
;
àà. /
}
áá 
if
ââ 
(
ââ 
opts
ââ 
is
ââ 
null
ââ 
)
ââ 
{
ãã 
return
ää 
	ASA_ERROR
ää  
.
ää  !
NO_COLLECTORS
ää! .
;
ää. /
}
åå 
var
ææ 
setResultTypes
ææ 
=
ææ  
new
ææ! $
List
ææ% )
<
ææ) *
RESULT_TYPE
ææ* 5
>
ææ5 6
(
ææ6 7
)
ææ7 8
;
ææ8 9
if
çç 
(
çç 
opts
çç 
.
çç %
EnableFileSystemMonitor
çç ,
)
çç, -
{
èè 
monitors
éé 
.
éé 
Add
éé 
(
éé 
new
éé  
FileSystemMonitor
éé! 2
(
éé2 3
opts
éé3 7
,
éé7 8
x
éé9 :
=>
éé; =
DatabaseManager
éé> M
.
ééM N
Write
ééN S
(
ééS T
x
ééT U
,
ééU V
opts
ééW [
.
éé[ \
RunId
éé\ a
)
ééa b
)
ééb c
)
ééc d
;
ééd e
setResultTypes
êê 
.
êê 
Add
êê "
(
êê" #
RESULT_TYPE
êê# .
.
êê. /
FILEMONITOR
êê/ :
)
êê: ;
;
êê; <
}
ëë 
if
íí 
(
íí 
monitors
íí 
.
íí 
Count
íí 
==
íí !
$num
íí" #
)
íí# $
{
îî 
Log
ïï 
.
ïï 
Warning
ïï 
(
ïï 
Strings
ïï #
.
ïï# $
Get
ïï$ '
(
ïï' (
$str
ïï( 8
)
ïï8 9
)
ïï9 :
;
ïï: ;
}
ğğ 
var
ññ 
run
ññ 
=
ññ 
new
ññ 
AsaRun
ññ  
(
ññ  !
RunId
ññ! &
:
ññ& '
opts
ññ( ,
?
ññ, -
.
ññ- .
RunId
ññ. 3
??
ññ4 6
string
ññ7 =
.
ññ= >
Empty
ññ> C
,
ññC D
	Timestamp
ññE N
:
ññN O
DateTime
ññP X
.
ññX Y
Now
ññY \
,
ññ\ ]
Version
ññ^ e
:
ññe f

AsaHelpers
ññg q
.
ññq r
GetVersionStringññr ‚
(ññ‚ ƒ
)ññƒ „
,ññ„ …
Platformññ† 
:ññ 

AsaHelpersññ š
.ññš ›
GetPlatformññ› ¦
(ññ¦ §
)ññ§ ¨
,ññ¨ ©
ResultTypesññª µ
:ññµ ¶
setResultTypesññ· Å
,ññÅ Æ
TypeññÇ Ë
:ññË Ì
RUN_TYPEññÍ Õ
.ññÕ Ö
MONITORññÖ İ
)ññİ Ş
;ññŞ ß
DatabaseManager
óó 
.
óó 
	InsertRun
óó %
(
óó% &
run
óó& )
)
óó) *
;
óó* +
foreach
ôô 
(
ôô 
var
ôô 
c
ôô 
in
ôô 
monitors
ôô &
)
ôô& '
{
õõ 
c
öö 
.
öö 
StartRun
öö 
(
öö 
)
öö 
;
öö 
}
÷÷ 
return
ùù 
	ASA_ERROR
ùù 
.
ùù 
NONE
ùù !
;
ùù! "
}
úú 	
public
üü 
static
üü 
int
üü 
StopMonitors
üü &
(
üü& '
)
üü' (
{
ıı 	
foreach
ÿÿ 
(
ÿÿ 
var
ÿÿ 
c
ÿÿ 
in
ÿÿ 
monitors
ÿÿ &
)
ÿÿ& '
{
€	€	 
Log
		 
.
		 
Information
		 
(
		  
Strings
		  '
.
		' (
Get
		( +
(
		+ ,
$str
		, 1
)
		1 2
,
		2 3
c
		4 5
.
		5 6
GetType
		6 =
(
		= >
)
		> ?
.
		? @
Name
		@ D
)
		D E
;
		E F
c
ƒ	ƒ	 
.
ƒ	ƒ	 
StopRun
ƒ	ƒ	 
(
ƒ	ƒ	 
)
ƒ	ƒ	 
;
ƒ	ƒ	 
}
„	„	 
FlushResults
†	†	 
(
†	†	 
)
†	†	 
;
†	†	 
if
ˆ	ˆ	 
(
ˆ	ˆ	 
DatabaseManager
ˆ	ˆ	 
is
ˆ	ˆ	  "
null
ˆ	ˆ	# '
)
ˆ	ˆ	' (
{
‰	‰	 
Log
Š	Š	 
.
Š	Š	 
Error
Š	Š	 
(
Š	Š	 
$str
Š	Š	 3
,
Š	Š	3 4
$str
Š	Š	5 K
)
Š	Š	K L
;
Š	Š	L M
return
‹	‹	 
(
‹	‹	 
int
‹	‹	 
)
‹	‹	 
	ASA_ERROR
‹	‹	 %
.
‹	‹	% &
DATABASE_NULL
‹	‹	& 3
;
‹	‹	3 4
}
Œ	Œ	 
DatabaseManager
		 
.
		 
Commit
		 "
(
		" #
)
		# $
;
		$ %
return
		 
$num
		 
;
		 
}
‘	‘	 	
public
“	“	 
static
“	“	 
void
“	“	 
AdminOrWarn
“	“	 &
(
“	“	& '
)
“	“	' (
{
”	”	 	
if
•	•	 
(
•	•	  
RuntimeInformation
•	•	 "
.
•	•	" #
IsOSPlatform
•	•	# /
(
•	•	/ 0

OSPlatform
•	•	0 :
.
•	•	: ;
Windows
•	•	; B
)
•	•	B C
)
•	•	C D
{
–	–	 
if
—	—	 
(
—	—	 
!
—	—	 
	Elevation
—	—	 
.
—	—	 
IsAdministrator
—	—	 .
(
—	—	. /
)
—	—	/ 0
)
—	—	0 1
{
˜	˜	 
Log
™	™	 
.
™	™	 
Information
™	™	 #
(
™	™	# $
Strings
™	™	$ +
.
™	™	+ ,
Get
™	™	, /
(
™	™	/ 0
$str
™	™	0 @
)
™	™	@ A
)
™	™	A B
;
™	™	B C
}
š	š	 
}
›	›	 
else
œ	œ	 
if
œ	œ	 
(
œ	œ	  
RuntimeInformation
œ	œ	 '
.
œ	œ	' (
IsOSPlatform
œ	œ	( 4
(
œ	œ	4 5

OSPlatform
œ	œ	5 ?
.
œ	œ	? @
Linux
œ	œ	@ E
)
œ	œ	E F
)
œ	œ	F G
{
		 
if
		 
(
		 
!
		 
	Elevation
		 
.
		 
IsRunningAsRoot
		 .
(
		. /
)
		/ 0
)
		0 1
{
Ÿ	Ÿ	 
Log
 	 	 
.
 	 	 
Information
 	 	 #
(
 	 	# $
Strings
 	 	$ +
.
 	 	+ ,
Get
 	 	, /
(
 	 	/ 0
$str
 	 	0 ?
)
 	 	? @
)
 	 	@ A
;
 	 	A B
}
¡	¡	 
}
¢	¢	 
else
£	£	 
if
£	£	 
(
£	£	  
RuntimeInformation
£	£	 '
.
£	£	' (
IsOSPlatform
£	£	( 4
(
£	£	4 5

OSPlatform
£	£	5 ?
.
£	£	? @
OSX
£	£	@ C
)
£	£	C D
)
£	£	D E
{
¤	¤	 
if
¥	¥	 
(
¥	¥	 
!
¥	¥	 
	Elevation
¥	¥	 
.
¥	¥	 
IsRunningAsRoot
¥	¥	 .
(
¥	¥	. /
)
¥	¥	/ 0
)
¥	¥	0 1
{
¦	¦	 
Log
§	§	 
.
§	§	 
Information
§	§	 #
(
§	§	# $
Strings
§	§	$ +
.
§	§	+ ,
Get
§	§	, /
(
§	§	/ 0
$str
§	§	0 ?
)
§	§	? @
)
§	§	@ A
;
§	§	A B
}
¨	¨	 
}
©	©	 
}
ª	ª	 	
public
¬	¬	 
static
¬	¬	 
	ASA_ERROR
¬	¬	 
RunCollectCommand
¬	¬	  1
(
¬	¬	1 2#
CollectCommandOptions
¬	¬	2 G
opts
¬	¬	H L
)
¬	¬	L M
{
­	­	 	
if
®	®	 
(
®	®	 
DatabaseManager
®	®	 
is
®	®	  "
null
®	®	# '
)
®	®	' (
{
¯	¯	 
Log
°	°	 
.
°	°	 
Error
°	°	 
(
°	°	 
$str
°	°	 3
,
°	°	3 4
$str
°	°	5 H
)
°	°	H I
;
°	°	I J
return
±	±	 
	ASA_ERROR
±	±	  
.
±	±	  !
DATABASE_NULL
±	±	! .
;
±	±	. /
}
²	²	 
if
³	³	 
(
³	³	 
opts
³	³	 
==
³	³	 
null
³	³	 
)
³	³	 
{
³	³	 
return
³	³	  &
	ASA_ERROR
³	³	' 0
.
³	³	0 1
NO_COLLECTORS
³	³	1 >
;
³	³	> ?
}
³	³	@ A

collectors
´	´	 
.
´	´	 
Clear
´	´	 
(
´	´	 
)
´	´	 
;
´	´	 
AdminOrWarn
µ	µ	 
(
µ	µ	 
)
µ	µ	 
;
µ	µ	 
opts
·	·	 
.
·	·	 
RunId
·	·	 
=
·	·	 
opts
·	·	 
.
·	·	 
RunId
·	·	 #
?
·	·	# $
.
·	·	$ %
Trim
·	·	% )
(
·	·	) *
)
·	·	* +
??
·	·	, .
DateTime
·	·	/ 7
.
·	·	7 8
Now
·	·	8 ;
.
·	·	; <
ToString
·	·	< D
(
·	·	D E
$str
·	·	E H
,
·	·	H I
CultureInfo
·	·	J U
.
·	·	U V
InvariantCulture
·	·	V f
)
·	·	f g
;
·	·	g h
if
¹	¹	 
(
¹	¹	 
opts
¹	¹	 
.
¹	¹	  
MatchedCollectorId
¹	¹	 '
!=
¹	¹	( *
null
¹	¹	+ /
)
¹	¹	/ 0
{
º	º	 
var
»	»	 

matchedRun
»	»	 
=
»	»	  
DatabaseManager
»	»	! 0
.
»	»	0 1
GetRun
»	»	1 7
(
»	»	7 8
opts
»	»	8 <
.
»	»	< = 
MatchedCollectorId
»	»	= O
)
»	»	O P
;
»	»	P Q
if
¼	¼	 
(
¼	¼	 

matchedRun
¼	¼	 
is
¼	¼	 !
AsaRun
¼	¼	" (
)
¼	¼	( )
{
½	½	 
foreach
¾	¾	 
(
¾	¾	 
var
¾	¾	  

resultType
¾	¾	! +
in
¾	¾	, .

matchedRun
¾	¾	/ 9
.
¾	¾	9 :
ResultTypes
¾	¾	: E
)
¾	¾	E F
{
¿	¿	 
switch
À	À	 
(
À	À	  

resultType
À	À	  *
)
À	À	* +
{
Á	Á	 
case
Â	Â	  
RESULT_TYPE
Â	Â	! ,
.
Â	Â	, -
FILE
Â	Â	- 1
:
Â	Â	1 2
opts
Ã	Ã	  $
.
Ã	Ã	$ %'
EnableFileSystemCollector
Ã	Ã	% >
=
Ã	Ã	? @
true
Ã	Ã	A E
;
Ã	Ã	E F
break
Ä	Ä	  %
;
Ä	Ä	% &
case
Æ	Æ	  
RESULT_TYPE
Æ	Æ	! ,
.
Æ	Æ	, -
PORT
Æ	Æ	- 1
:
Æ	Æ	1 2
opts
Ç	Ç	  $
.
Ç	Ç	$ %(
EnableNetworkPortCollector
Ç	Ç	% ?
=
Ç	Ç	@ A
true
Ç	Ç	B F
;
Ç	Ç	F G
break
È	È	  %
;
È	È	% &
case
Ê	Ê	  
RESULT_TYPE
Ê	Ê	! ,
.
Ê	Ê	, -
CERTIFICATE
Ê	Ê	- 8
:
Ê	Ê	8 9
opts
Ë	Ë	  $
.
Ë	Ë	$ %(
EnableCertificateCollector
Ë	Ë	% ?
=
Ë	Ë	@ A
true
Ë	Ë	B F
;
Ë	Ë	F G
break
Ì	Ì	  %
;
Ì	Ì	% &
case
Î	Î	  
RESULT_TYPE
Î	Î	! ,
.
Î	Î	, -
COM
Î	Î	- 0
:
Î	Î	0 1
opts
Ï	Ï	  $
.
Ï	Ï	$ %&
EnableComObjectCollector
Ï	Ï	% =
=
Ï	Ï	> ?
true
Ï	Ï	@ D
;
Ï	Ï	D E
break
Ğ	Ğ	  %
;
Ğ	Ğ	% &
case
Ò	Ò	  
RESULT_TYPE
Ò	Ò	! ,
.
Ò	Ò	, -
FIREWALL
Ò	Ò	- 5
:
Ò	Ò	5 6
opts
Ó	Ó	  $
.
Ó	Ó	$ %%
EnableFirewallCollector
Ó	Ó	% <
=
Ó	Ó	= >
true
Ó	Ó	? C
;
Ó	Ó	C D
break
Ô	Ô	  %
;
Ô	Ô	% &
case
Ö	Ö	  
RESULT_TYPE
Ö	Ö	! ,
.
Ö	Ö	, -
LOG
Ö	Ö	- 0
:
Ö	Ö	0 1
opts
×	×	  $
.
×	×	$ %%
EnableEventLogCollector
×	×	% <
=
×	×	= >
true
×	×	? C
;
×	×	C D
break
Ø	Ø	  %
;
Ø	Ø	% &
case
Ú	Ú	  
RESULT_TYPE
Ú	Ú	! ,
.
Ú	Ú	, -
SERVICE
Ú	Ú	- 4
:
Ú	Ú	4 5
opts
Û	Û	  $
.
Û	Û	$ %$
EnableServiceCollector
Û	Û	% ;
=
Û	Û	< =
true
Û	Û	> B
;
Û	Û	B C
break
Ü	Ü	  %
;
Ü	Ü	% &
case
Ş	Ş	  
RESULT_TYPE
Ş	Ş	! ,
.
Ş	Ş	, -
USER
Ş	Ş	- 1
:
Ş	Ş	1 2
opts
ß	ß	  $
.
ß	ß	$ %!
EnableUserCollector
ß	ß	% 8
=
ß	ß	9 :
true
ß	ß	; ?
;
ß	ß	? @
break
à	à	  %
;
à	à	% &
case
â	â	  
RESULT_TYPE
â	â	! ,
.
â	â	, -
KEY
â	â	- 0
:
â	â	0 1
opts
ã	ã	  $
.
ã	ã	$ % 
EnableKeyCollector
ã	ã	% 7
=
ã	ã	8 9
true
ã	ã	: >
;
ã	ã	> ?
break
ä	ä	  %
;
ä	ä	% &
case
æ	æ	  
RESULT_TYPE
æ	æ	! ,
.
æ	æ	, -
TPM
æ	æ	- 0
:
æ	æ	0 1
opts
ç	ç	  $
.
ç	ç	$ % 
EnableTpmCollector
ç	ç	% 7
=
ç	ç	8 9
true
ç	ç	: >
;
ç	ç	> ?
break
è	è	  %
;
è	è	% &
case
ê	ê	  
RESULT_TYPE
ê	ê	! ,
.
ê	ê	, -
PROCESS
ê	ê	- 4
:
ê	ê	4 5
opts
ë	ë	  $
.
ë	ë	$ %$
EnableProcessCollector
ë	ë	% ;
=
ë	ë	< =
true
ë	ë	> B
;
ë	ë	B C
break
ì	ì	  %
;
ì	ì	% &
case
î	î	  
RESULT_TYPE
î	î	! ,
.
î	î	, -
DRIVER
î	î	- 3
:
î	î	3 4
opts
ï	ï	  $
.
ï	ï	$ %#
EnableDriverCollector
ï	ï	% :
=
ï	ï	; <
true
ï	ï	= A
;
ï	ï	A B
break
ğ	ğ	  %
;
ğ	ğ	% &
case
ò	ò	  
RESULT_TYPE
ò	ò	! ,
.
ò	ò	, -
WIFI
ò	ò	- 1
:
ò	ò	1 2
opts
ó	ó	  $
.
ó	ó	$ %!
EnableWifiCollector
ó	ó	% 8
=
ó	ó	9 :
true
ó	ó	; ?
;
ó	ó	? @
break
ô	ô	  %
;
ô	ô	% &
}
õ	õ	 
}
ö	ö	 
}
÷	÷	 
}
ø	ø	 
Action
ú	ú	 
<
ú	ú	 
CollectObject
ú	ú	  
>
ú	ú	  !"
defaultChangeHandler
ú	ú	" 6
=
ú	ú	7 8
x
ú	ú	9 :
=>
ú	ú	; =
DatabaseManager
ú	ú	> M
.
ú	ú	M N
Write
ú	ú	N S
(
ú	ú	S T
x
ú	ú	T U
,
ú	ú	U V
opts
ú	ú	W [
.
ú	ú	[ \
RunId
ú	ú	\ a
)
ú	ú	a b
;
ú	ú	b c
var
ü	ü	 
dict
ü	ü	 
=
ü	ü	 
new
ü	ü	 
List
ü	ü	 
<
ü	ü	  
RESULT_TYPE
ü	ü	  +
>
ü	ü	+ ,
(
ü	ü	, -
)
ü	ü	- .
;
ü	ü	. /
if
ş	ş	 
(
ş	ş	 
opts
ş	ş	 
.
ş	ş	 '
EnableFileSystemCollector
ş	ş	 .
||
ş	ş	/ 1
opts
ş	ş	2 6
.
ş	ş	6 7!
EnableAllCollectors
ş	ş	7 J
)
ş	ş	J K
{
ÿ	ÿ	 

collectors
€
€
 
.
€
€
 
Add
€
€
 
(
€
€
 
new
€
€
 "!
FileSystemCollector
€
€
# 6
(
€
€
6 7
opts
€
€
7 ;
,
€
€
; <"
defaultChangeHandler
€
€
= Q
)
€
€
Q R
)
€
€
R S
;
€
€
S T
dict


 
.


 
Add


 
(


 
RESULT_TYPE


 $
.


$ %
FILE


% )
)


) *
;


* +
}
‚
‚
 
if
ƒ
ƒ
 
(
ƒ
ƒ
 
opts
ƒ
ƒ
 
.
ƒ
ƒ
 (
EnableNetworkPortCollector
ƒ
ƒ
 /
||
ƒ
ƒ
0 2
opts
ƒ
ƒ
3 7
.
ƒ
ƒ
7 8!
EnableAllCollectors
ƒ
ƒ
8 K
)
ƒ
ƒ
K L
{
„
„
 

collectors
…
…
 
.
…
…
 
Add
…
…
 
(
…
…
 
new
…
…
 "
OpenPortCollector
…
…
# 4
(
…
…
4 5
opts
…
…
5 9
,
…
…
9 :"
defaultChangeHandler
…
…
; O
)
…
…
O P
)
…
…
P Q
;
…
…
Q R
dict
†
†
 
.
†
†
 
Add
†
†
 
(
†
†
 
RESULT_TYPE
†
†
 $
.
†
†
$ %
PORT
†
†
% )
)
†
†
) *
;
†
†
* +
}
‡
‡
 
if
ˆ
ˆ
 
(
ˆ
ˆ
 
opts
ˆ
ˆ
 
.
ˆ
ˆ
 $
EnableServiceCollector
ˆ
ˆ
 +
||
ˆ
ˆ
, .
opts
ˆ
ˆ
/ 3
.
ˆ
ˆ
3 4!
EnableAllCollectors
ˆ
ˆ
4 G
)
ˆ
ˆ
G H
{
‰
‰
 

collectors
Š
Š
 
.
Š
Š
 
Add
Š
Š
 
(
Š
Š
 
new
Š
Š
 "
ServiceCollector
Š
Š
# 3
(
Š
Š
3 4
opts
Š
Š
4 8
,
Š
Š
8 9"
defaultChangeHandler
Š
Š
: N
)
Š
Š
N O
)
Š
Š
O P
;
Š
Š
P Q
dict
‹
‹
 
.
‹
‹
 
Add
‹
‹
 
(
‹
‹
 
RESULT_TYPE
‹
‹
 $
.
‹
‹
$ %
SERVICE
‹
‹
% ,
)
‹
‹
, -
;
‹
‹
- .
}
Œ
Œ
 
if


 
(


 
opts


 
.


 !
EnableUserCollector


 (
||


) +
opts


, 0
.


0 1!
EnableAllCollectors


1 D
)


D E
{


 

collectors


 
.


 
Add


 
(


 
new


 ""
UserAccountCollector


# 7
(


7 8
opts


8 <
,


< ="
defaultChangeHandler


> R
)


R S
)


S T
;


T U
dict


 
.


 
Add


 
(


 
RESULT_TYPE


 $
.


$ %
USER


% )
)


) *
;


* +
}
‘
‘
 
if
’
’
 
(
’
’
 
opts
’
’
 
.
’
’
 %
EnableRegistryCollector
’
’
 ,
||
’
’
- /
(
’
’
0 1
opts
’
’
1 5
.
’
’
5 6!
EnableAllCollectors
’
’
6 I
&&
’
’
J L 
RuntimeInformation
’
’
M _
.
’
’
_ `
IsOSPlatform
’
’
` l
(
’
’
l m

OSPlatform
’
’
m w
.
’
’
w x
Windows
’
’
x 
)’
’
 €
)’
’
€ 
)’
’
 ‚
{
“
“
 

collectors
”
”
 
.
”
”
 
Add
”
”
 
(
”
”
 
new
”
”
 "
RegistryCollector
”
”
# 4
(
”
”
4 5
opts
”
”
5 9
,
”
”
9 :"
defaultChangeHandler
”
”
; O
)
”
”
O P
)
”
”
P Q
;
”
”
Q R
dict
•
•
 
.
•
•
 
Add
•
•
 
(
•
•
 
RESULT_TYPE
•
•
 $
.
•
•
$ %
REGISTRY
•
•
% -
)
•
•
- .
;
•
•
. /
}
–
–
 
if
—
—
 
(
—
—
 
opts
—
—
 
.
—
—
 (
EnableCertificateCollector
—
—
 /
||
—
—
0 2
opts
—
—
3 7
.
—
—
7 8!
EnableAllCollectors
—
—
8 K
)
—
—
K L
{
˜
˜
 

collectors
™
™
 
.
™
™
 
Add
™
™
 
(
™
™
 
new
™
™
 ""
CertificateCollector
™
™
# 7
(
™
™
7 8
opts
™
™
8 <
,
™
™
< ="
defaultChangeHandler
™
™
> R
)
™
™
R S
)
™
™
S T
;
™
™
T U
dict
š
š
 
.
š
š
 
Add
š
š
 
(
š
š
 
RESULT_TYPE
š
š
 $
.
š
š
$ %
CERTIFICATE
š
š
% 0
)
š
š
0 1
;
š
š
1 2
}
›
›
 
if
œ
œ
 
(
œ
œ
 
opts
œ
œ
 
.
œ
œ
 %
EnableFirewallCollector
œ
œ
 ,
||
œ
œ
- /
opts
œ
œ
0 4
.
œ
œ
4 5!
EnableAllCollectors
œ
œ
5 H
)
œ
œ
H I
{


 

collectors


 
.


 
Add


 
(


 
new


 "
FirewallCollector


# 4
(


4 5
opts


5 9
,


9 :"
defaultChangeHandler


; O
)


O P
)


P Q
;


Q R
dict
Ÿ
Ÿ
 
.
Ÿ
Ÿ
 
Add
Ÿ
Ÿ
 
(
Ÿ
Ÿ
 
RESULT_TYPE
Ÿ
Ÿ
 $
.
Ÿ
Ÿ
$ %
FIREWALL
Ÿ
Ÿ
% -
)
Ÿ
Ÿ
- .
;
Ÿ
Ÿ
. /
}
 
 
 
if
¡
¡
 
(
¡
¡
 
opts
¡
¡
 
.
¡
¡
 &
EnableComObjectCollector
¡
¡
 -
||
¡
¡
. 0
(
¡
¡
1 2
opts
¡
¡
2 6
.
¡
¡
6 7!
EnableAllCollectors
¡
¡
7 J
&&
¡
¡
K M 
RuntimeInformation
¡
¡
N `
.
¡
¡
` a
IsOSPlatform
¡
¡
a m
(
¡
¡
m n

OSPlatform
¡
¡
n x
.
¡
¡
x y
Windows¡
¡
y €
)¡
¡
€ 
)¡
¡
 ‚
)¡
¡
‚ ƒ
{
¢
¢
 

collectors
£
£
 
.
£
£
 
Add
£
£
 
(
£
£
 
new
£
£
 " 
ComObjectCollector
£
£
# 5
(
£
£
5 6
opts
£
£
6 :
,
£
£
: ;"
defaultChangeHandler
£
£
< P
)
£
£
P Q
)
£
£
Q R
;
£
£
R S
dict
¤
¤
 
.
¤
¤
 
Add
¤
¤
 
(
¤
¤
 
RESULT_TYPE
¤
¤
 $
.
¤
¤
$ %
COM
¤
¤
% (
)
¤
¤
( )
;
¤
¤
) *
}
¥
¥
 
if
¦
¦
 
(
¦
¦
 
opts
¦
¦
 
.
¦
¦
 %
EnableEventLogCollector
¦
¦
 ,
||
¦
¦
- /
opts
¦
¦
0 4
.
¦
¦
4 5!
EnableAllCollectors
¦
¦
5 H
)
¦
¦
H I
{
§
§
 

collectors
¨
¨
 
.
¨
¨
 
Add
¨
¨
 
(
¨
¨
 
new
¨
¨
 "
EventLogCollector
¨
¨
# 4
(
¨
¨
4 5
opts
¨
¨
5 9
,
¨
¨
9 :"
defaultChangeHandler
¨
¨
; O
)
¨
¨
O P
)
¨
¨
P Q
;
¨
¨
Q R
dict
©
©
 
.
©
©
 
Add
©
©
 
(
©
©
 
RESULT_TYPE
©
©
 $
.
©
©
$ %
LOG
©
©
% (
)
©
©
( )
;
©
©
) *
}
ª
ª
 
if
«
«
 
(
«
«
 
opts
«
«
 
.
«
«
  
EnableTpmCollector
«
«
 '
||
«
«
( *
(
«
«
+ ,
opts
«
«
, 0
.
«
«
0 1!
EnableAllCollectors
«
«
1 D
&&
«
«
E G
(
«
«
H I 
RuntimeInformation
«
«
I [
.
«
«
[ \
IsOSPlatform
«
«
\ h
(
«
«
h i

OSPlatform
«
«
i s
.
«
«
s t
Windows
«
«
t {
)
«
«
{ |
||
«
«
} "
RuntimeInformation«
«
€ ’
.«
«
’ “
IsOSPlatform«
«
“ Ÿ
(«
«
Ÿ  

OSPlatform«
«
  ª
.«
«
ª «
Linux«
«
« °
)«
«
° ±
)«
«
± ²
)«
«
² ³
)«
«
³ ´
{
¬
¬
 

collectors
­
­
 
.
­
­
 
Add
­
­
 
(
­
­
 
new
­
­
 "
TpmCollector
­
­
# /
(
­
­
/ 0
opts
­
­
0 4
,
­
­
4 5"
defaultChangeHandler
­
­
6 J
)
­
­
J K
)
­
­
K L
;
­
­
L M
dict
®
®
 
.
®
®
 
Add
®
®
 
(
®
®
 
RESULT_TYPE
®
®
 $
.
®
®
$ %
TPM
®
®
% (
)
®
®
( )
;
®
®
) *
}
¯
¯
 
if
°
°
 
(
°
°
 
opts
°
°
 
.
°
°
  
EnableKeyCollector
°
°
 '
||
°
°
( *
opts
°
°
+ /
.
°
°
/ 0!
EnableAllCollectors
°
°
0 C
&&
°
°
D F
(
°
°
G H 
RuntimeInformation
°
°
H Z
.
°
°
Z [
IsOSPlatform
°
°
[ g
(
°
°
g h

OSPlatform
°
°
h r
.
°
°
r s
Windows
°
°
s z
)
°
°
z {
)
°
°
{ |
)
°
°
| }
{
±
±
 

collectors
²
²
 
.
²
²
 
Add
²
²
 
(
²
²
 
new
²
²
 "'
CryptographicKeyCollector
²
²
# <
(
²
²
< =
opts
²
²
= A
,
²
²
A B"
defaultChangeHandler
²
²
C W
)
²
²
W X
)
²
²
X Y
;
²
²
Y Z
dict
³
³
 
.
³
³
 
Add
³
³
 
(
³
³
 
RESULT_TYPE
³
³
 $
.
³
³
$ %
KEY
³
³
% (
)
³
³
( )
;
³
³
) *
}
´
´
 
if
µ
µ
 
(
µ
µ
 
opts
µ
µ
 
.
µ
µ
 $
EnableProcessCollector
µ
µ
 +
||
µ
µ
, .
opts
µ
µ
/ 3
.
µ
µ
3 4!
EnableAllCollectors
µ
µ
4 G
)
µ
µ
G H
{
¶
¶
 

collectors
·
·
 
.
·
·
 
Add
·
·
 
(
·
·
 
new
·
·
 "
ProcessCollector
·
·
# 3
(
·
·
3 4
opts
·
·
4 8
,
·
·
8 9"
defaultChangeHandler
·
·
: N
)
·
·
N O
)
·
·
O P
;
·
·
P Q
dict
¸
¸
 
.
¸
¸
 
Add
¸
¸
 
(
¸
¸
 
RESULT_TYPE
¸
¸
 $
.
¸
¸
$ %
PROCESS
¸
¸
% ,
)
¸
¸
, -
;
¸
¸
- .
}
¹
¹
 
if
º
º
 
(
º
º
 
opts
º
º
 
.
º
º
 #
EnableDriverCollector
º
º
 *
||
º
º
+ -
opts
º
º
. 2
.
º
º
2 3!
EnableAllCollectors
º
º
3 F
)
º
º
F G
{
»
»
 

collectors
¼
¼
 
.
¼
¼
 
Add
¼
¼
 
(
¼
¼
 
new
¼
¼
 "
DriverCollector
¼
¼
# 2
(
¼
¼
2 3
opts
¼
¼
3 7
,
¼
¼
7 8"
defaultChangeHandler
¼
¼
9 M
)
¼
¼
M N
)
¼
¼
N O
;
¼
¼
O P
dict
½
½
 
.
½
½
 
Add
½
½
 
(
½
½
 
RESULT_TYPE
½
½
 $
.
½
½
$ %
DRIVER
½
½
% +
)
½
½
+ ,
;
½
½
, -
}
¾
¾
 
if
¿
¿
 
(
¿
¿
 
opts
¿
¿
 
.
¿
¿
 !
EnableWifiCollector
¿
¿
 (
||
¿
¿
) +
opts
¿
¿
, 0
.
¿
¿
0 1!
EnableAllCollectors
¿
¿
1 D
)
¿
¿
D E
{
À
À
 

collectors
Á
Á
 
.
Á
Á
 
Add
Á
Á
 
(
Á
Á
 
new
Á
Á
 "
WifiCollector
Á
Á
# 0
(
Á
Á
0 1
opts
Á
Á
1 5
,
Á
Á
5 6"
defaultChangeHandler
Á
Á
7 K
)
Á
Á
K L
)
Á
Á
L M
;
Á
Á
M N
dict
Â
Â
 
.
Â
Â
 
Add
Â
Â
 
(
Â
Â
 
RESULT_TYPE
Â
Â
 $
.
Â
Â
$ %
WIFI
Â
Â
% )
)
Â
Â
) *
;
Â
Â
* +
}
Ã
Ã
 
if
Å
Å
 
(
Å
Å
 

collectors
Å
Å
 
.
Å
Å
 
Count
Å
Å
  
==
Å
Å
! #
$num
Å
Å
$ %
)
Å
Å
% &
{
Æ
Æ
 
Log
Ç
Ç
 
.
Ç
Ç
 
Warning
Ç
Ç
 
(
Ç
Ç
 
Strings
Ç
Ç
 #
.
Ç
Ç
# $
Get
Ç
Ç
$ '
(
Ç
Ç
' (
$str
Ç
Ç
( :
)
Ç
Ç
: ;
)
Ç
Ç
; <
;
Ç
Ç
< =
return
È
È
 
	ASA_ERROR
È
È
  
.
È
È
  !
NO_COLLECTORS
È
È
! .
;
È
È
. /
}
É
É
 
if
Ë
Ë
 
(
Ë
Ë
 
opts
Ë
Ë
 
.
Ë
Ë
 
	Overwrite
Ë
Ë
 
)
Ë
Ë
 
{
Ì
Ì
 
DatabaseManager
Í
Í
 
.
Í
Í
  
	DeleteRun
Í
Í
  )
(
Í
Í
) *
opts
Í
Í
* .
.
Í
Í
. /
RunId
Í
Í
/ 4
)
Í
Í
4 5
;
Í
Í
5 6
}
Î
Î
 
else
Ï
Ï
 
{
Ğ
Ğ
 
if
Ñ
Ñ
 
(
Ñ
Ñ
 
DatabaseManager
Ñ
Ñ
 #
.
Ñ
Ñ
# $
GetRun
Ñ
Ñ
$ *
(
Ñ
Ñ
* +
opts
Ñ
Ñ
+ /
.
Ñ
Ñ
/ 0
RunId
Ñ
Ñ
0 5
)
Ñ
Ñ
5 6
!=
Ñ
Ñ
7 9
null
Ñ
Ñ
: >
)
Ñ
Ñ
> ?
{
Ò
Ò
 
Log
Ó
Ó
 
.
Ó
Ó
 
Error
Ó
Ó
 
(
Ó
Ó
 
Strings
Ó
Ó
 %
.
Ó
Ó
% &
Get
Ó
Ó
& )
(
Ó
Ó
) *
$str
Ó
Ó
* @
)
Ó
Ó
@ A
)
Ó
Ó
A B
;
Ó
Ó
B C
return
Ô
Ô
 
	ASA_ERROR
Ô
Ô
 $
.
Ô
Ô
$ %
	UNIQUE_ID
Ô
Ô
% .
;
Ô
Ô
. /
}
Õ
Õ
 
}
Ö
Ö
 
Log
×
×
 
.
×
×
 
Information
×
×
 
(
×
×
 
Strings
×
×
 #
.
×
×
# $
Get
×
×
$ '
(
×
×
' (
$str
×
×
( /
)
×
×
/ 0
,
×
×
0 1
opts
×
×
2 6
.
×
×
6 7
RunId
×
×
7 <
)
×
×
< =
;
×
×
= >
var
Ù
Ù
 
run
Ù
Ù
 
=
Ù
Ù
 
new
Ù
Ù
 
AsaRun
Ù
Ù
  
(
Ù
Ù
  !
RunId
Ù
Ù
! &
:
Ù
Ù
& '
opts
Ù
Ù
( ,
.
Ù
Ù
, -
RunId
Ù
Ù
- 2
,
Ù
Ù
2 3
	Timestamp
Ù
Ù
4 =
:
Ù
Ù
= >
DateTime
Ù
Ù
? G
.
Ù
Ù
G H
Now
Ù
Ù
H K
,
Ù
Ù
K L
Version
Ù
Ù
M T
:
Ù
Ù
T U

AsaHelpers
Ù
Ù
V `
.
Ù
Ù
` a
GetVersionString
Ù
Ù
a q
(
Ù
Ù
q r
)
Ù
Ù
r s
,
Ù
Ù
s t
Platform
Ù
Ù
u }
:
Ù
Ù
} ~

AsaHelpersÙ
Ù
 ‰
.Ù
Ù
‰ Š
GetPlatformÙ
Ù
Š •
(Ù
Ù
• –
)Ù
Ù
– —
,Ù
Ù
— ˜
ResultTypesÙ
Ù
™ ¤
:Ù
Ù
¤ ¥
dictÙ
Ù
¦ ª
,Ù
Ù
ª «
TypeÙ
Ù
¬ °
:Ù
Ù
° ±
RUN_TYPEÙ
Ù
² º
.Ù
Ù
º »
COLLECTÙ
Ù
» Â
)Ù
Ù
Â Ã
;Ù
Ù
Ã Ä
DatabaseManager
Û
Û
 
.
Û
Û
 
	InsertRun
Û
Û
 %
(
Û
Û
% &
run
Û
Û
& )
)
Û
Û
) *
;
Û
Û
* +
Log
İ
İ
 
.
İ
İ
 
Information
İ
İ
 
(
İ
İ
 
Strings
İ
İ
 #
.
İ
İ
# $
Get
İ
İ
$ '
(
İ
İ
' (
$str
İ
İ
( 3
)
İ
İ
3 4
,
İ
İ
4 5

collectors
İ
İ
6 @
.
İ
İ
@ A
Count
İ
İ
A F
.
İ
İ
F G
ToString
İ
İ
G O
(
İ
İ
O P
CultureInfo
İ
İ
P [
.
İ
İ
[ \
InvariantCulture
İ
İ
\ l
)
İ
İ
l m
,
İ
İ
m n
Strings
İ
İ
o v
.
İ
İ
v w
Get
İ
İ
w z
(
İ
İ
z {
$strİ
İ
{ ‡
)İ
İ
‡ ˆ
)İ
İ
ˆ ‰
;İ
İ
‰ Š
using
ß
ß
 %
CancellationTokenSource
ß
ß
 )
source
ß
ß
* 0
=
ß
ß
1 2
new
ß
ß
3 6%
CancellationTokenSource
ß
ß
7 N
(
ß
ß
N O
)
ß
ß
O P
;
ß
ß
P Q
CancellationToken
à
à
 
token
à
à
 #
=
à
à
$ %
source
à
à
& ,
.
à
à
, -
Token
à
à
- 2
;
à
à
2 3
void
â
â
 
cancelKeyDelegate
â
â
 "
(
â
â
" #
object
â
â
# )
?
â
â
) *
sender
â
â
+ 1
,
â
â
1 2$
ConsoleCancelEventArgs
â
â
3 I
args
â
â
J N
)
â
â
N O
{
ã
ã
 
Log
ä
ä
 
.
ä
ä
 
Information
ä
ä
 
(
ä
ä
  
$str
ä
ä
  |
)
ä
ä
| }
;
ä
ä
} ~
source
å
å
 
.
å
å
 
Cancel
å
å
 
(
å
å
 
)
å
å
 
;
å
å
  
if
ç
ç
 
(
ç
ç
 
DatabaseManager
ç
ç
 #
is
ç
ç
$ &
null
ç
ç
' +
)
ç
ç
+ ,
{
è
è
 
Log
é
é
 
.
é
é
 
Error
é
é
 
(
é
é
 
$str
é
é
 7
,
é
é
7 8
$str
é
é
9 O
)
é
é
O P
;
é
é
P Q
}
ê
ê
 
else
ë
ë
 
{
ì
ì
 
DatabaseManager
í
í
 #
.
í
í
# $
CloseDatabase
í
í
$ 1
(
í
í
1 2
)
í
í
2 3
;
í
í
3 4
}
î
î
 
Environment
ï
ï
 
.
ï
ï
 
Exit
ï
ï
  
(
ï
ï
  !
(
ï
ï
! "
int
ï
ï
" %
)
ï
ï
% &
	ASA_ERROR
ï
ï
& /
.
ï
ï
/ 0
	CANCELLED
ï
ï
0 9
)
ï
ï
9 :
;
ï
ï
: ;
}
ğ
ğ
 
Console
ñ
ñ
 
.
ñ
ñ
 
CancelKeyPress
ñ
ñ
 "
+=
ñ
ñ
# %
cancelKeyDelegate
ñ
ñ
& 7
;
ñ
ñ
7 8

Dictionary
ó
ó
 
<
ó
ó
 
string
ó
ó
 
,
ó
ó
 
string
ó
ó
 %
>
ó
ó
% &
EndEvent
ó
ó
' /
=
ó
ó
0 1
new
ó
ó
2 5

Dictionary
ó
ó
6 @
<
ó
ó
@ A
string
ó
ó
A G
,
ó
ó
G H
string
ó
ó
I O
>
ó
ó
O P
(
ó
ó
P Q
)
ó
ó
Q R
;
ó
ó
R S
foreach
ô
ô
 
(
ô
ô
 
BaseCollector
ô
ô
 "
c
ô
ô
# $
in
ô
ô
% '

collectors
ô
ô
( 2
)
ô
ô
2 3
{
õ
õ
 
try
ö
ö
 
{
÷
÷
 
DatabaseManager
ø
ø
 #
.
ø
ø
# $
BeginTransaction
ø
ø
$ 4
(
ø
ø
4 5
)
ø
ø
5 6
;
ø
ø
6 7
c
ú
ú
 
.
ú
ú
 

TryExecute
ú
ú
  
(
ú
ú
  !
token
ú
ú
! &
)
ú
ú
& '
;
ú
ú
' (
FlushResults
ü
ü
  
(
ü
ü
  !
)
ü
ü
! "
;
ü
ü
" #
DatabaseManager
ş
ş
 #
.
ş
ş
# $
Commit
ş
ş
$ *
(
ş
ş
* +
)
ş
ş
+ ,
;
ş
ş
, -
}
ÿ
ÿ
 
catch
€€ 
(
€€ 
	Exception
€€  
e
€€! "
)
€€" #
{
 
Log
‚‚ 
.
‚‚ 
Error
‚‚ 
(
‚‚ 
Strings
‚‚ %
.
‚‚% &
Get
‚‚& )
(
‚‚) *
$str
‚‚* >
)
‚‚> ?
,
‚‚? @
c
‚‚A B
.
‚‚B C
GetType
‚‚C J
(
‚‚J K
)
‚‚K L
.
‚‚L M
Name
‚‚M Q
,
‚‚Q R
e
‚‚S T
.
‚‚T U
Message
‚‚U \
,
‚‚\ ]
e
‚‚^ _
.
‚‚_ `

StackTrace
‚‚` j
)
‚‚j k
;
‚‚k l
Console
„„ 
.
„„ 
CancelKeyPress
„„ *
-=
„„+ -
cancelKeyDelegate
„„. ?
;
„„? @
return
†† 
	ASA_ERROR
†† $
.
††$ %
FAILED_TO_COMMIT
††% 5
;
††5 6
}
‡‡ 
}
ˆˆ 
DatabaseManager
ŠŠ 
.
ŠŠ 
Commit
ŠŠ "
(
ŠŠ" #
)
ŠŠ# $
;
ŠŠ$ %
Console
‹‹ 
.
‹‹ 
CancelKeyPress
‹‹ "
-=
‹‹# %
cancelKeyDelegate
‹‹& 7
;
‹‹7 8
return
 
	ASA_ERROR
 
.
 
NONE
 !
;
! "
}
 	
private
 
static
 
void
 
FlushResults
 (
(
( )
)
) *
{
‘‘ 	
if
’’ 
(
’’ 
DatabaseManager
’’ 
is
’’  "
null
’’# '
)
’’' (
{
““ 
return
”” 
;
”” 
}
•• 
var
–– 
	prevFlush
–– 
=
–– 
DatabaseManager
–– +
.
––+ ,
	QueueSize
––, 5
;
––5 6
var
—— 
totFlush
—— 
=
—— 
	prevFlush
—— $
;
——$ %
var
™™ 
printInterval
™™ 
=
™™ 
new
™™  #
TimeSpan
™™$ ,
(
™™, -
$num
™™- .
,
™™. /
$num
™™0 1
,
™™1 2
$num
™™3 5
)
™™5 6
;
™™6 7
var
šš 
then
šš 
=
šš 
DateTime
šš 
.
šš  
Now
šš  #
;
šš# $
var
œœ 
	StopWatch
œœ 
=
œœ 
	Stopwatch
œœ %
.
œœ% &
StartNew
œœ& .
(
œœ. /
)
œœ/ 0
;
œœ0 1
TimeSpan
 
t
 
=
 
new
 
TimeSpan
 %
(
% &
)
& '
;
' (
string
 
answer
 
=
 
string
 "
.
" #
Empty
# (
;
( )
bool
ŸŸ $
warnedToIncreaseShards
ŸŸ '
=
ŸŸ( )
false
ŸŸ* /
;
ŸŸ/ 0
var
   
settings
   
=
   
DatabaseManager
   *
.
  * + 
GetCurrentSettings
  + =
(
  = >
)
  > ?
;
  ? @
while
¢¢ 
(
¢¢ 
DatabaseManager
¢¢ "
.
¢¢" #
HasElements
¢¢# .
)
¢¢. /
{
££ 
Thread
¤¤ 
.
¤¤ 
Sleep
¤¤ 
(
¤¤ 
$num
¤¤  
)
¤¤  !
;
¤¤! "
if
¥¥ 
(
¥¥ 
!
¥¥ 
DatabaseManager
¥¥ $
.
¥¥$ %
HasElements
¥¥% 0
)
¥¥0 1
{
¦¦ 
break
§§ 
;
§§ 
}
¨¨ 
if
©© 
(
©© 
!
©© $
warnedToIncreaseShards
©© +
&&
©©, .
	StopWatch
©©/ 8
.
©©8 9!
ElapsedMilliseconds
©©9 L
>
©©M N
$num
©©O T
&&
©©U W
settings
©©X `
.
©©` a
ShardingFactor
©©a o
<
©©p q
$num
©©r s
)
©©s t
{
ªª 
Log
«« 
.
«« 
Information
«« #
(
««# $
$str««$ —
)««— ˜
;««˜ ™$
warnedToIncreaseShards
¬¬ *
=
¬¬+ ,
true
¬¬- 1
;
¬¬1 2
}
­­ 
var
®® 
now
®® 
=
®® 
DateTime
®® "
.
®®" #
Now
®®# &
;
®®& '
if
¯¯ 
(
¯¯ 
now
¯¯ 
-
¯¯ 
then
¯¯ 
>
¯¯  
printInterval
¯¯! .
)
¯¯. /
{
°° 
var
±± 
actualDuration
±± &
=
±±' (
now
±±) ,
-
±±- .
then
±±/ 3
;
±±3 4
var
²² 
sample
²² 
=
²²  
DatabaseManager
²²! 0
.
²²0 1
	QueueSize
²²1 :
;
²²: ;
var
³³ 
curRate
³³ 
=
³³  !
	prevFlush
³³" +
-
³³, -
sample
³³. 4
;
³³4 5
var
´´ 
totRate
´´ 
=
´´  !
(
´´" #
double
´´# )
)
´´) *
(
´´* +
totFlush
´´+ 3
-
´´4 5
sample
´´6 <
)
´´< =
/
´´> ?
	StopWatch
´´@ I
.
´´I J!
ElapsedMilliseconds
´´J ]
;
´´] ^
try
¶¶ 
{
·· 
t
¸¸ 
=
¸¸ 
(
¸¸ 
curRate
¸¸ $
>
¸¸% &
$num
¸¸' (
)
¸¸( )
?
¸¸* +
TimeSpan
¸¸, 4
.
¸¸4 5
FromMilliseconds
¸¸5 E
(
¸¸E F
actualDuration
¸¸F T
.
¸¸T U
TotalMilliseconds
¸¸U f
*
¸¸g h
sample
¸¸i o
/
¸¸p q
curRate
¸¸r y
)
¸¸y z
:
¸¸{ |
TimeSpan¸¸} …
.¸¸… † 
FromMilliseconds¸¸† –
(¸¸– —
$num¸¸— Ÿ
)¸¸Ÿ  
;¸¸  ¡
answer
¹¹ 
=
¹¹  
string
¹¹! '
.
¹¹' (
Format
¹¹( .
(
¹¹. /
CultureInfo
¹¹/ :
.
¹¹: ;
InvariantCulture
¹¹; K
,
¹¹K L
$str
¹¹M o
,
¹¹o p
t
ºº0 1
.
ºº1 2
Hours
ºº2 7
,
ºº7 8
t
»»0 1
.
»»1 2
Minutes
»»2 9
,
»»9 :
t
¼¼0 1
.
¼¼1 2
Seconds
¼¼2 9
,
¼¼9 :
t
½½0 1
.
½½1 2
Milliseconds
½½2 >
)
½½> ?
;
½½? @
Log
¾¾ 
.
¾¾ 
Debug
¾¾ !
(
¾¾! "
$str
¾¾" _
,
¾¾_ `
sample
¾¾a g
,
¾¾g h
curRate
¾¾i p
,
¾¾p q
totRate
¾¾r y
*
¾¾z {
$num¾¾| €
,¾¾€ 
answer¾¾‚ ˆ
,¾¾ˆ ‰
actualDuration¾¾Š ˜
)¾¾˜ ™
;¾¾™ š
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ $
e
ÀÀ% &
)
ÀÀ& '
when
ÀÀ( ,
(
ÀÀ- .
e
ÁÁ 
is
ÁÁ 
OverflowException
ÁÁ .
)
ÁÁ. /
{
ÂÂ 
Log
ÃÃ 
.
ÃÃ 
Debug
ÃÃ !
(
ÃÃ! "
$"
ÃÃ" $
$str
ÃÃ$ 0
{
ÃÃ0 1
curRate
ÃÃ1 8
}
ÃÃ8 9
$str
ÃÃ9 :
{
ÃÃ: ;
totRate
ÃÃ; B
}
ÃÃB C
$str
ÃÃC D
{
ÃÃD E
sample
ÃÃE K
}
ÃÃK L
$str
ÃÃL M
{
ÃÃM N
t
ÃÃN O
}
ÃÃO P
$str
ÃÃP Q
{
ÃÃQ R
answer
ÃÃR X
}
ÃÃX Y
"
ÃÃY Z
)
ÃÃZ [
;
ÃÃ[ \
Log
ÄÄ 
.
ÄÄ 
Debug
ÄÄ !
(
ÄÄ! "
$str
ÄÄ" L
,
ÄÄL M
sample
ÄÄN T
,
ÄÄT U
curRate
ÄÄV ]
,
ÄÄ] ^
totRate
ÄÄ_ f
*
ÄÄg h
$num
ÄÄi m
)
ÄÄm n
;
ÄÄn o
}
ÅÅ 
then
ÇÇ 
=
ÇÇ 
now
ÇÇ 
;
ÇÇ 
	prevFlush
ÈÈ 
=
ÈÈ 
sample
ÈÈ  &
;
ÈÈ& '
}
ÉÉ 
}
ÊÊ 
	StopWatch
ÌÌ 
.
ÌÌ 
Stop
ÌÌ 
(
ÌÌ 
)
ÌÌ 
;
ÌÌ 
t
ÍÍ 
=
ÍÍ 
TimeSpan
ÍÍ 
.
ÍÍ 
FromMilliseconds
ÍÍ )
(
ÍÍ) *
	StopWatch
ÍÍ* 3
.
ÍÍ3 4!
ElapsedMilliseconds
ÍÍ4 G
)
ÍÍG H
;
ÍÍH I
answer
ÎÎ 
=
ÎÎ 
string
ÎÎ 
.
ÎÎ 
Format
ÎÎ "
(
ÎÎ" #
CultureInfo
ÎÎ# .
.
ÎÎ. /
InvariantCulture
ÎÎ/ ?
,
ÎÎ? @
$str
ÎÎA c
,
ÎÎc d
t
ÏÏ$ %
.
ÏÏ% &
Hours
ÏÏ& +
,
ÏÏ+ ,
t
ĞĞ$ %
.
ĞĞ% &
Minutes
ĞĞ& -
,
ĞĞ- .
t
ÑÑ$ %
.
ÑÑ% &
Seconds
ÑÑ& -
,
ÑÑ- .
t
ÒÒ$ %
.
ÒÒ% &
Milliseconds
ÒÒ& 2
)
ÒÒ2 3
;
ÒÒ3 4
Log
ÓÓ 
.
ÓÓ 
Debug
ÓÓ 
(
ÓÓ 
$str
ÓÓ 1
,
ÓÓ1 2
answer
ÓÓ3 9
)
ÓÓ9 :
;
ÓÓ: ;
}
ÔÔ 	
public
ÖÖ 
static
ÖÖ 
void
ÖÖ 
ClearCollectors
ÖÖ *
(
ÖÖ* +
)
ÖÖ+ ,
{
×× 	

collectors
ØØ 
=
ØØ 
new
ØØ 
List
ØØ !
<
ØØ! "
BaseCollector
ØØ" /
>
ØØ/ 0
(
ØØ0 1
)
ØØ1 2
;
ØØ2 3
}
ÙÙ 	
public
ÛÛ 
static
ÛÛ 
void
ÛÛ 
ClearMonitors
ÛÛ (
(
ÛÛ( )
)
ÛÛ) *
{
ÜÜ 	

collectors
İİ 
=
İİ 
new
İİ 
List
İİ !
<
İİ! "
BaseCollector
İİ" /
>
İİ/ 0
(
İİ0 1
)
İİ1 2
;
İİ2 3
}
ŞŞ 	
[
áá 	
System
áá	 
.
áá 
Diagnostics
áá 
.
áá 
CodeAnalysis
áá (
.
áá( )
SuppressMessage
áá) 8
(
áá8 9
$str
áá9 H
,
ááH I
$str
ááJ 
,áá €
Justificationáá 
=áá 
$stráá‘ ³
)áá³ ´
]áá´ µ
private
ââ 
static
ââ 
void
ââ 
WriteSpinner
ââ (
(
ââ( )
ManualResetEvent
ââ) 9
	untilDone
ââ: C
)
ââC D
{
ãã 	
int
ää 
counter
ää 
=
ää 
$num
ää 
;
ää 
while
åå 
(
åå 
!
åå 
	untilDone
åå 
.
åå 
WaitOne
åå %
(
åå% &
$num
åå& )
)
åå) *
)
åå* +
{
ææ 
counter
çç 
++
çç 
;
çç 
switch
èè 
(
èè 
counter
èè 
%
èè  !
$num
èè" #
)
èè# $
{
éé 
case
êê 
$num
êê 
:
êê 
Console
êê #
.
êê# $
Write
êê$ )
(
êê) *
$str
êê* -
)
êê- .
;
êê. /
break
êê0 5
;
êê5 6
case
ëë 
$num
ëë 
:
ëë 
Console
ëë #
.
ëë# $
Write
ëë$ )
(
ëë) *
$str
ëë* -
)
ëë- .
;
ëë. /
break
ëë0 5
;
ëë5 6
case
ìì 
$num
ìì 
:
ìì 
Console
ìì #
.
ìì# $
Write
ìì$ )
(
ìì) *
$str
ìì* .
)
ìì. /
;
ìì/ 0
break
ìì1 6
;
ìì6 7
case
íí 
$num
íí 
:
íí 
Console
íí #
.
íí# $
Write
íí$ )
(
íí) *
$str
íí* -
)
íí- .
;
íí. /
break
íí0 5
;
íí5 6
}
îî 
if
ïï 
(
ïï 
Console
ïï 
.
ïï 

CursorLeft
ïï &
>
ïï' (
$num
ïï) *
)
ïï* +
{
ğğ 
try
ññ 
{
òò 
Console
óó 
.
óó  
SetCursorPosition
óó  1
(
óó1 2
Console
óó2 9
.
óó9 :

CursorLeft
óó: D
-
óóE F
$num
óóG H
,
óóH I
Console
óóJ Q
.
óóQ R
	CursorTop
óóR [
)
óó[ \
;
óó\ ]
}
ôô 
catch
õõ 
(
õõ )
ArgumentOutOfRangeException
õõ 6
)
õõ6 7
{
öö 
Console
÷÷ 
.
÷÷  
SetCursorPosition
÷÷  1
(
÷÷1 2
$num
÷÷2 3
,
÷÷3 4
Console
÷÷5 <
.
÷÷< =
	CursorTop
÷÷= F
)
÷÷F G
;
÷÷G H
}
øø 
}
ùù 
}
úú 
}
ûû 	
}
üü 
}ıı ç
9D:\sonarcube_projects\AttackSurfaceAnalyzer\Cli\Helper.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Cli. 1
{ 
public		 

static		 
class		 
Helper		 
{

 
public 
class 
	GlowClass 
{ 	
public 
string 
	ClassName #
{$ %
get& )
;) *
set+ .
;. /
}0 1
=2 3
string4 :
.: ;
Empty; @
;@ A
} 	
public 
static 
string 
GetGlowClass )
() *
bool* .
value/ 4
)4 5
{ 	
return 
value 
? 
$str %
:& '
$str( 1
;1 2
} 	
public 
static 
void 

ToggleGlow %
(% &
Action& ,
RefreshCallback- <
,< =
	GlowClass> G
VariableH P
,P Q
boolR V
GlowTypeW _
,_ `
inta d
Duratione m
=n o
$nump s
)s t
{ 	
Variable 
. 
	ClassName 
=  
GetGlowClass! -
(- .
GlowType. 6
)6 7
;7 8
RefreshCallback 
( 
) 
; 
Task 
. 
Run 
( 
( 
) 
=> 
{ 
WaitAndResetGlow  
(  !
RefreshCallback! 0
,0 1
Variable2 :
,: ;
Duration< D
)D E
;E F
} 
) 
; 
}   	
static"" 
void"" 
WaitAndResetGlow"" $
(""$ %
Action""% +
RefreshCallback"", ;
,""; <
	GlowClass""= F
Variable""G O
,""O P
int""Q T
Duration""U ]
)""] ^
{## 	
Task$$ 
.$$ 
Delay$$ 
($$ 
Duration$$ 
)$$  
.$$  !
Wait$$! %
($$% &
)$$& '
;$$' (
Variable%% 
.%% 
	ClassName%% 
=%%  
string%%! '
.%%' (
Empty%%( -
;%%- .
RefreshCallback&& 
(&& 
)&& 
;&& 
}'' 	
}(( 
})) ´

?D:\sonarcube_projects\AttackSurfaceAnalyzer\Cli\SandboxState.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Cli. 1
{ 
public 

class 
SandboxState 
{ 
public 

Dictionary 
< 
string  
,  !
List" &
<& '
object' -
>- .
>. /
Objects0 7
{8 9
get: =
;= >
set? B
;B C
}D E
=F G
newH K

DictionaryL V
<V W
stringW ]
,] ^
List_ c
<c d
objectd j
>j k
>k l
(l m
)m n
;n o
public 
SandboxState 
( 
) 
{ 	
} 	
public 
SandboxState 
( 

Dictionary &
<& '
string' -
,- .
List/ 3
<3 4
object4 :
>: ;
>; <
objects= D
)D E
{ 	
Objects 
= 
objects 
; 
} 	
} 
} ‘
:D:\sonarcube_projects\AttackSurfaceAnalyzer\Cli\Startup.cs
	namespace 	
	Microsoft
 
. 
CST 
. !
AttackSurfaceAnalyzer -
.- .
Cli. 1
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. 
AddRazorPages "
(" #
)# $
;$ %
services 
. 
AddServerSideBlazor (
(( )
)) *
;* +
services 
. 
AddSingleton !
<! "
AppData" )
>) *
(* +
)+ ,
;, -
services 
.  
AddFileReaderService )
() *
)* +
;+ ,
}   	
public## 
void## 
	Configure## 
(## 
IApplicationBuilder## 1
app##2 5
,##5 6
IWebHostEnvironment##7 J
env##K N
)##N O
{$$ 	
if%% 
(%% 
env%% 
.%% 
IsDevelopment%% !
(%%! "
)%%" #
)%%# $
{&& 
app'' 
.'' %
UseDeveloperExceptionPage'' -
(''- .
)''. /
;''/ 0
}(( 
else)) 
{** 
app++ 
.++ 
UseExceptionHandler++ '
(++' (
$str++( 0
)++0 1
;++1 2
},, 
app.. 
... 
UseStaticFiles.. 
(.. 
)..  
;..  !
app00 
.00 

UseRouting00 
(00 
)00 
;00 
app22 
.22 
UseEndpoints22 
(22 
	endpoints22 &
=>22' )
{33 
	endpoints44 
.44 
MapBlazorHub44 &
(44& '
)44' (
;44( )
	endpoints55 
.55 
MapFallbackToPage55 +
(55+ ,
$str55, 4
)554 5
;555 6
}66 
)66 
;66 
}77 	
}88 
}99 